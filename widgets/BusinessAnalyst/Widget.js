// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/BusinessAnalyst/BAWizard":function(){define("dojo/_base/array dojo/_base/declare dojo/on dojo/when esri/dijit/geoenrichment/_Wizard esri/geometry/webMercatorUtils ./CreateBuffersPage ./ErrorPage ./RunReportsPage ./SelectPointPolygonPage ./utils/GEUtil ./utils/GeocodeUtil".split(" "),function(l,h,g,e,d,b,a,c,k,f,n,m){return h([d],{selectedPoint:{tradeAreas:[]},selectedPolygon:{},selectedCountryID:"",availableCountries:[],drawnPolygonGraphic:null,name:"BusinessAnalystWizard",
baseClass:"jimu-widget-business-analyst-wizard",postCreate:function(){this.inherited(arguments);var b=this;e(n.checkCapabilities(this.appConfig),function(d){d.hasPrivilege&&d.geServiceConfigured&&d.dirRoutingServiceConfigured?(b.pages.SELECT_POINT_POLYGON=new f({map:b.map,nls:b.nls,wizard:b,config:b.config,onNext:function(){b._loadCreateBuffersPage()}}),b.pages.CREATE_BUFFERS=new a({map:b.map,nls:b.nls,wizard:b,config:b.config,onBack:function(){b._loadSelectPointPolygonPage()},onNext:function(){b._loadRunReportsPage()}}),
b.pages.CREATE_BUFFERS.startup(),b.pages.RUN_REPORTS=new k({map:b.map,nls:b.nls,wizard:b,appConfig:b.appConfig,config:b.config,onBack:function(){b.selectedPoint.geometry?b._loadCreateBuffersPage():b._loadSelectPointPolygonPage()}}),b.loadPage("SELECT_POINT_POLYGON"),b.own(g(b.map.infoWindow,"Show",function(){b._featureSelected()})),b.own(g(b.map.infoWindow,"Hide",function(){b._featureUnselected()})),b.own(g(b.map.infoWindow,"set-features",function(){b._featureSelected()})),b.own(g(b.map.infoWindow,
"selection-change",function(){b._featureSelected()})),b.selectedCountryID=b.config.defaultCountryID,e(n.getAvailableCountries(),function(a){b.availableCountries=a.countries;b.setSelectedCountry(b.selectedCountryID)}),b.map.infoWindow&&b.map.infoWindow.features&&0<b.map.infoWindow.features.length&&b._featureSelected()):(b.pages.ERROR_PAGE=new c({nls:b.nls,displayErrors:{gePrivilege:!d.hasPrivilege,geServiceNotConfigured:!d.geServiceConfigured,dirRoutingServiceNotConfigured:!d.dirRoutingServiceConfigured}}),
b.pages.ERROR_PAGE.startup(),b.loadPage("ERROR_PAGE"))})},startup:function(){},resize:function(){this.pages.SELECT_POINT_POLYGON&&this.pages.SELECT_POINT_POLYGON.resize()},clearSelectedPointBuffers:function(){var a=this;l.forEach(this.selectedPoint.tradeAreas,function(f){f&&f.graphic&&a.map.graphics.remove(f.graphic)});this.selectedPoint.tradeAreas=[]},clearSelectedPoint:function(){this.clearSelectedPointBuffers();this.map.graphics.remove(this.selectedPoint.pointGraphic);this.selectedPoint={tradeAreas:[]}},
clearSelectedPolygon:function(){this.selectedPolygon={};this.drawnPolygonGraphic&&(this.map.infoWindow.clearFeatures(),this.map.graphics.remove(this.drawnPolygonGraphic),this.drawnPolygonGraphic=null)},setSelectedCountry:function(a){var f=this;3==a.length?l.forEach(this.availableCountries,function(c){c.abbr3==a&&(f.selectedCountryID=c.id)}):2==a.length&&(this.selectedCountryID=a);this.pages.RUN_REPORTS.loadReportsInfographicsForCountry(this.selectedCountryID)},_loadSelectPointPolygonPage:function(){this.clearSelectedPoint();
this.clearSelectedPolygon();this.loadPage("SELECT_POINT_POLYGON");this.resize()},_loadCreateBuffersPage:function(){this.loadPage("CREATE_BUFFERS");this.pages.CREATE_BUFFERS.refresh()},_loadRunReportsPage:function(){this.loadPage("RUN_REPORTS");this.pages.RUN_REPORTS.refresh()},refreshPage:function(){this.currentPage&&this.currentPage.refresh&&this.currentPage.refresh()},_featureSelected:function(){var a=this,f=-1<this.map.infoWindow.selectedIndex&&this.map.infoWindow.features&&this.map.infoWindow.features[this.map.infoWindow.selectedIndex];
if(!f)this.clearSelectedPoint(),this.clearSelectedPolygon();else if((this.selectedPoint.geometry?this.selectedPoint.geometry:this.selectedPolygon.geometry)!==f.geometry)if(this.clearSelectedPoint(),this.clearSelectedPolygon(),"point"===f.geometry.type){this.selectedPoint.geometry=f.geometry;this.selectedPoint.locationName=this._getFeatureName(f);this.selectedPoint.attributes=f.attributes?f.attributes:{};var c=b.xyToLngLat(f.geometry.x,f.geometry.y);this.selectedPoint.long=c[0].toFixed(5);this.selectedPoint.lat=
c[1].toFixed(5);e(m.reverseGeocode({x:c[0],y:c[1]}),function(f){a.setSelectedCountry(f.address.CountryCode);a._loadCreateBuffersPage()})}else"polygon"==f.geometry.type?(this.selectedPolygon.geometry=f.geometry,this.selectedPolygon.locationName=this._getFeatureName(f),this.selectedPolygon.feature=f,c=f.geometry.getCentroid(),c=b.xyToLngLat(c.x,c.y),e(n.getCountryForPolygon(f.geometry,this.config,this.selectedCountryID),function(f){a.setSelectedCountry(f);a._loadRunReportsPage()})):a._loadSelectPointPolygonPage()},
_featureUnselected:function(){this.clearSelectedPoint();this.clearSelectedPolygon();this.pages.SELECT_POINT_POLYGON.search&&this.pages.SELECT_POINT_POLYGON.search.clear();this._loadSelectPointPolygonPage()},_getFeatureName:function(a){return a.getTitle()?a.getTitle():a._layer.displayField&&a.attributes[a._layer.displayField]?a.attributes[a._layer.displayField]:""}})})},"esri/dijit/geoenrichment/_Wizard":function(){define(["esri/declare","dojo/_base/lang","dojo/dom-construct","dijit/_WidgetBase","./utils/animation/AnimationHelper"],
function(l,h,g,e,d){return l("esri.dijit.geoenrichment._Wizard",e,{currentPage:null,currentPageId:null,_anim:null,pages:null,stacking:"stretch",constructor:function(){this.pages={};this._anim=new d},buildRendering:function(){this.domNode=g.create("div",{"class":"_Wizard_Root"})},loadPage:function(b){var a=this.pages[b],c=this.currentPage;a!==c&&(this._anim.finish(),c&&this._animPage("Anim_FadeOut").then(h.hitch(this.domNode,"removeChild",c.domNode)),this.currentPage=a,this.currentPageId=b,g.place(this.currentPage.domNode,
this.domNode,"first"),c&&this._animPage("Anim_FadeIn"),a._started||(a.set("stacking",this.stacking),a.startup()),a.resize())},_animPage:function(b){return this._anim.start([{node:this.currentPage.domNode,classes:[b,"Wizard_FadeAnim"]}])},resize:function(){this.currentPage&&this.currentPage.resize()},destroy:function(){for(var b in this.pages)this.hasOwnProperty(b)&&this.pages[b].destroyRecursive();this.pages={};this.inherited(arguments)}})})},"esri/declare":function(){define(["dojo/_base/declare",
"dojo/_base/lang","./extend"],function(l,h,g){return function(e,d,b){var a=h.isString(e);a?b.declaredClass=e:(b=d,d=e);d=l(d,b);a&&g(e,d);return d}})},"esri/extend":function(){define(["dojo/_base/lang","dojo/has","./kernel"],function(l,h,g){return function(e,d){h("extend-esri")&&(e=e.substring(e.indexOf(".")+1),l.setObject(e,d,g))}})},"esri/dijit/geoenrichment/utils/animation/AnimationHelper":function(){define("esri/declare dojo/_base/array dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/sniff dojo/on esri/dijit/geoenrichment/Deferred".split(" "),
function(l,h,g,e,d,b,a,c,k){var f,n;n=!(29>a("chrome")||23>a("ff")||6>a("safari")||10>a("ie"));f=function(a,b){for(var k=function(a){var c=a.type;f=c;for(var k in d)k!==c&&(d[k].remove(),delete d[k]);b.apply(this,arguments)},d={},n=["animationend","webkitAnimationEnd"],e=0;e<n.length;e++)d[n[e]]=c(a,n[e],k);return{remove:function(){for(var a in d)d.hasOwnProperty(a)&&d[a].remove()}}};var m=l(null,{_oldNode:null,_targets:null,_deferred:null,start:function(a,b){this._oldNode=b;this._deferred=new k;
if(!n||!a.length||!a[0].node)return this.finish(),this._deferred.promise;this._targets=a;c.once(a[0].node,f,g.hitch(this,this.finish));for(b=0;b<a.length;b++){var d=a[b];e.add(d.node,d.classes);e.add(d.node,"Anim_Common")}return this._deferred.promise},finish:function(){if(this._targets){for(var a=0;a<this._targets.length;a++){var f=this._targets[a];f.node&&(e.remove(f.node,f.classes),e.remove(f.node,"Anim_Common"))}this._targets=null}this._oldNode&&(this.onNodePreDestroy(this._oldNode),d.destroy(this._oldNode),
this._oldNode=null);this._deferred.resolve()},onNodePreDestroy:function(a){}});return l(null,{progress:null,_items:null,_flySurfaceNode:null,_ltr:b.isBodyLtr(),constructor:function(a){this._flySurfaceNode=a;this._items=[]},start:function(a,f){var c=this,b=new m;b.onNodePreDestroy=function(a){c.onNodePreDestroy(a)};this._items.push(b);this.progress||(this.progress=new k);return b.start(a,f).then(g.hitch(this,this._onItemFinished,b))},_onItemFinished:function(a){a=h.indexOf(this._items,a);0<=a&&(this._items.splice(a,
1),0===this._items.length&&this.progress&&(this.progress.resolve(),this.progress=null))},finish:function(){for(var a=this._items;0<a.length;)a.pop().finish()},fly:function(a,f,c,b){b=b||a.cloneNode(!0);c||(c=["top",this._ltr?"left":"right"]);if(!n)return b;a=a.getBoundingClientRect();var k=this._flySurfaceNode.getBoundingClientRect();e.add(b,"Anim_FlyingObj");for(var d,m,p=0;p<c.length;p++){var g=c[p],q=a[g]-k[g];if("right"===g||"bottom"===g)q=-q;if("left"===g&&!this._ltr||"right"===g&&this._ltr)d=
g,m=q;b.style[g]=q+"px"}this._flySurfaceNode.appendChild(b);d&&(m+=a.width-b.getBoundingClientRect().width,b.style[d]=m+"px");this.start([{node:b,classes:[f]}],b);return b},onNodePreDestroy:function(a){}})})},"esri/dijit/geoenrichment/Deferred":function(){define(["dojo/Deferred"],function(l){return l})},"widgets/BusinessAnalyst/CreateBuffersPage":function(){define("dojo/_base/declare dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin esri/dijit/geoenrichment/_WizardPage esri/geometry/Polygon esri/symbols/SimpleFillSymbol esri/symbols/SimpleLineSymbol esri/Color esri/graphic ./utils/GEUtil ./utils/TravelModeUtil ./utils/ValidationUtil ./utils/SiteUtil dojo/text!./CreateBuffersPage.html jimu/dijit/TabContainer3 dijit/form/TextBox".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q,t,r){return l([g,h,d,e],{templateString:t,postCreate:function(){this.inherited(arguments);this.tab=new r({tabs:[{title:this.nls.rings,content:this.ringsContentPane},{title:this.nls.driveTime,content:this.driveTimeContentPane},{title:this.nls.walkTime,content:this.walkTimeContentPane}],selected:this.nls.rings});this.tab.placeAt(this.ringDtWtTabContainer);this.tab.startup();this._setConfigDefaults()},startup:function(){this.inherited(arguments)},refresh:function(){this._showHideTabs()},
_setConfigDefaults:function(){this._setRadii(this.config.ringDefaults,this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3);this.ringsBufferUnits.set("value",this.config.ringUnitDefault);this._setRadii(this.config.driveTimeDefaults,this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3);this.driveTimeBufferUnits.set("value",this.config.driveTimeUnitDefault);this._setRadii(this.config.walkTimeDefaults,this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3);
this.walkTimeBufferUnits.set("value",this.config.walkTimeUnitDefault)},_showHideTabs:function(){this.config.ringDisabled&&this.tab.removeTab(this.nls.rings);this.config.driveTimeDisabled&&this.tab.removeTab(this.nls.driveTime);this.config.walkTimeDisabled&&this.tab.removeTab(this.nls.walkTime);this.tab.getSelectedTitle()===this.nls.rings&&this.config.ringDisabled&&this.tab.selectTab(this.nls.driveTime);this.tab.getSelectedTitle()===this.nls.driveTime&&this.config.driveTimeDisabled&&this.tab.selectTab(this.nls.walkTime);
this.tab.getSelectedTitle()===this.nls.walkTime&&this.config.walkTimeDisabled&&this.tab.selectTab(this.nls.driveTime)},applyBuffer:function(){if(this._validateInput()){this.shelter.show();var d=this,e=[[16,59,143,1],[0,204,51,1],[204,51,0,1]],p=0,g={},h="",t="",l="",r=10,E;this.tab.getSelectedTitle()===this.nls.rings?(g.areaType="RingBuffer",g.bufferUnits=this.ringsBufferUnits.get("value"),l=this.ringsBufferUnits._getDisplayedValueAttr(),g.bufferRadii=this._getRadii(this.ringsBufferRadii1,this.ringsBufferRadii2,
this.ringsBufferRadii3),h=this.nls.ring):this.tab.getSelectedTitle()===this.nls.driveTime?(g.areaType="NetworkServiceArea",g.bufferUnits=this.driveTimeBufferUnits.get("value"),l=this.driveTimeBufferUnits._getDisplayedValueAttr(),g.bufferRadii=this._getRadii(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3),h=this.nls.driveTime,t="Driving "+("Minutes"===g.bufferUnits?"Time":"Distance"),r=(E=g.bufferRadii?q.getMaxRadiusInKilometers(g,!1):0)&&Math.max(1,Math.log(E/8)*
Math.LOG2E),r=E*Math.min(r,5)):(g.areaType="NetworkServiceArea",g.bufferUnits=this.walkTimeBufferUnits.get("value"),l=this.walkTimeBufferUnits._getDisplayedValueAttr(),g.bufferRadii=this._getRadii(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3),h=this.nls.walkTime,t="Walking "+("Minutes"===g.bufferUnits?"Time":"Distance"),r=(E=g.bufferRadii?q.getMaxRadiusInKilometers(g,!0):0)&&Math.max(1,Math.log(E/8)*Math.LOG2E),r=E*Math.min(r,3));var A=[];m.getTravelMode(t,r).then(function(m){m&&
(g.travelMode=m);n.createRingOrDriveTimes({geometry:d.wizard.selectedPoint.geometry,studyAreasOptions:g,sourceCountry:d.wizard.selectedCountryID}).then(function(n){d.wizard.clearSelectedPointBuffers();d.wizard.selectedPoint.areadesc2=h+d.nls.colon+" "+g.bufferRadii.join(", ")+" "+d.nls["headerDescription_"+l]+" "+d.nls.radii;n=n.results[0].value.FeatureSet[0].features.reverse();var m=g.bufferRadii.reverse(),q;for(q in n){var t=new b({rings:n[q].geometry.rings,spatialReference:{wkid:102100}});if(d.tab.getSelectedTitle()==
d.nls.rings)var r=new a(c.STYLE_SOLID,new c(c.STYLE_SOLID,new k(e[p]),2),new k([255,0,15,0]));else r=new k(e[p]),r.a=.5,r=new a(c.STYLE_SOLID,new c(c.STYLE_SOLID,new k(e[p]),2),r);t=new f(t,r);r={};r.graphic=t;r.name=d.wizard.selectedPoint.locationName+" - "+m[p]+" "+l;r.shortName=m[p]+" "+l;r.AREA_DESC=m[p]+" "+l;r.AREA_DESC2=h+d.nls.colon+" "+m[p]+" "+d.nls["headerDescription_"+l]+" "+d.nls.radius_lowercase;d.wizard.selectedPoint.tradeAreas.push(r);d.map.graphics.add(t);A.push(t);p++}d.wizard.selectedPoint.tradeAreas=
d.wizard.selectedPoint.tradeAreas.reverse();d.map.setExtent(d.wizard.selectedPoint.tradeAreas[d.wizard.selectedPoint.tradeAreas.length-1].graphic._extent);d.shelter.hide();d.onNext()},function(a){alert("Error: "+a);d.shelter.hide()})})}},backOnClick:function(){this.onBack()},_getRadii:function(a,f,c){a=a.get("value");f=f.get("value");c=c.get("value");var b=[];""!==a&&b.push(a);""!==f&&b.push(f);""!==c&&b.push(c);return b},_setRadii:function(a,f,c,b){0<a.length?f.set("value",a[0]):f.set("value","");
1<a.length?c.set("value",a[1]):c.set("value","");2<a.length?b.set("value",a[2]):b.set("value","")},_validateInput:function(){var a=!0,a=this.tab.getSelectedTitle()===this.nls.rings?p.validateInvalidValues(this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3,this.ringValidationErrorMessage,this.nls.thisEntryIsNotValid):this.tab.getSelectedTitle()===this.nls.driveTime?p.validateInvalidValues(this.driveTimeBufferRadii1,this.driveTimeBufferRadii2,this.driveTimeBufferRadii3,this.driveTimeValidationErrorMessage,
this.nls.thisEntryIsNotValid):p.validateInvalidValues(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3,this.walkTimeValidationErrorMessage,this.nls.thisEntryIsNotValid);return a?(a=this.tab.getSelectedTitle()===this.nls.rings?p.validateMinMaxValues(this.ringsBufferRadii1,this.ringsBufferRadii2,this.ringsBufferRadii3,p.MIN_RINGS_VALUE,p.MAX_RINGS_VALUE,this.ringValidationErrorMessage,this.nls.invalidValueRing):this.tab.getSelectedTitle()===this.nls.driveTime?p.validateMinMaxValues(this.driveTimeBufferRadii1,
this.driveTimeBufferRadii2,this.driveTimeBufferRadii3,p.MIN_DTWT_VALUE,p.MAX_DTWT_VALUE,this.driveTimeValidationErrorMessage,this.nls.invalidValueDTWT):p.validateMinMaxValues(this.walkTimeBufferRadii1,this.walkTimeBufferRadii2,this.walkTimeBufferRadii3,p.MIN_DTWT_VALUE,p.MAX_DTWT_VALUE,this.walkTimeValidationErrorMessage,this.nls.invalidValueDTWT))?!0:!1:!1}})})},"esri/dijit/geoenrichment/_WizardPage":function(){define("esri/declare dojo/_base/lang dojo/string dojox/mvc/Templated ./Grid ./ProgressHandler dojo/text!./templates/_WizardPage.html".split(" "),
function(l,h,g,e,d,b,a){return l("esri.dijit.geoenrichment._WizardPage",e,{buttonsNode:null,_progressHandler:null,buildRendering:function(){var c=this.templateString;c&&"\ufeff"==c[0]&&(c=c.substr(1));this.templateString=g.substitute(a,{content:c});this.inherited(arguments);this.layoutGrid.rows=[d.AUTO,d.AUTO,d.AUTO]},resize:function(){this.layoutGrid.resize()},_setStackingAttr:function(a){switch(a){case "stretch":this.layoutGrid.rows[1]=d.STRETCH;break;case "stack":this.layoutGrid.rows[1]=d.STACK}},
showProgress:function(a,k){this._progressHandler||(this._progressHandler=new b(this.progressDiv,{queryNode:this.domNode}),this.own(this._progressHandler));a=this._progressHandler.showProgress(a,"string"==typeof k?k:"");k=k?"function"==typeof k?k:this[k]:null;"function"==typeof k&&a.then(h.hitch(this,k));return a},cancelProgress:function(a){this._progressHandler&&this._progressHandler.cancelProgress("string"==typeof a?a:"")}})})},"dojox/mvc/Templated":function(){define("dojo/_base/declare dojo/_base/lang dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin ./at".split(" "),
function(l,h,g,e,d){return l("dojox.mvc.Templated",[g,e,d],{bindings:null,startup:function(){var b=h.isFunction(this.bindings)&&this.bindings.call(this)||this.bindings,a;for(a in b){var c=this[a],k=b[a];if(c)for(var f in k)c.set(f,k[f]);else console.warn("Widget with the following attach point was not found: "+a)}this.inherited(arguments)}})})},"dojox/mvc/at":function(){define(["dojo/_base/kernel","dojo/_base/lang","./sync","./_atBindingExtension"],function(l,h,g){l.experimental("dojox.mvc");l=function(e,
d){return{atsignature:"dojox.mvc.at",target:e,targetProp:d,bindDirection:g.both,direction:function(b){this.bindDirection=b;return this},transform:function(b){this.converter=b;return this},equals:function(b){this.equalsCallback=b;return this}}};l.from=g.from;l.to=g.to;l.both=g.both;return h.setObject("dojox.mvc.at",l)})},"dojox/mvc/sync":function(){define(["dojo/_base/lang","dojo/_base/config","dojo/_base/array","dojo/has"],function(l,h,g,e){function d(a,f,b,d,p,q,h,r,u,y){if(!(b(u,r)||"*"==p&&0>g.indexOf(d.get("properties")||
[h],h)||"*"==p&&h in(y||{}))){b="*"==p?h:p;if(e("mvc-bindings-log-api"))var k=c(d,b,q,h);try{u=a?a(u,f):u}catch(w){e("mvc-bindings-log-api")&&console.log("Copy from"+k.join(" to ")+" was not done as an error is thrown in the converter.");return}e("mvc-bindings-log-api")&&console.log(k.reverse().join(" is being copied from: ")+" (Value: "+u+" from "+r+")");l.isFunction(d.set)?d.set(b,u):d[b]=u}}var b=l.getObject("dojox.mvc",!0);e.add("mvc-bindings-log-api",(h.mvc||{}).debugBindings);var a,c=e("mvc-bindings-log-api")?
function(a,f,c,b){return[[c.canConvertToLoggable||!c.declaredClass?c:c.declaredClass,b].join(":"),[a.canConvertToLoggable||!a.declaredClass?a:a.declaredClass,f].join(":")]}:"";h={from:1,to:2,both:3};a=function(k,f,n,m,p){var q=(p||{}).converter,h,r,u;q&&(h={source:k,target:n},r=q.format&&l.hitch(h,q.format),u=q.parse&&l.hitch(h,q.parse));var y=[],v=[],w=l.mixin({},k.constraints,n.constraints),q=(p||{}).bindDirection||b.both,D=(p||{}).equals||a.equals;if(e("mvc-bindings-log-api"))var B=c(k,f,n,m);
if("*"==m){if("*"!=f)throw Error("Unmatched wildcard is specified between source and target.");p=n.get("properties");if(!p){p=[];for(var z in n)n.hasOwnProperty(z)&&"_watchCallbacks"!=z&&p.push(z)}v=n.get("excludes")}else p=[f];q&b.from&&(l.isFunction(k.set)&&l.isFunction(k.watch)?y.push(k.watch.apply(k,("*"!=f?[f]:[]).concat([function(a,f,c){d(r,w,D,n,m,k,a,f,c,v)}]))):e("mvc-bindings-log-api")&&console.log(B.reverse().join(" is not a stateful property. Its change is not reflected to ")+"."),g.forEach(p,
function(a){if("*"!=m||!(a in(v||{}))){var f=l.isFunction(k.get)?k.get(a):k[a];d(r,w,D,n,"*"==m?a:m,k,a,void 0,f)}}));q&b.to&&(q&b.from||g.forEach(p,function(a){if("*"!=m||!(a in(v||{}))){var f=l.isFunction(n.get)?n.get(m):n[m];d(u,w,D,k,a,n,"*"==m?a:m,void 0,f)}}),l.isFunction(n.set)&&l.isFunction(n.watch)?y.push(n.watch.apply(n,("*"!=m?[m]:[]).concat([function(a,c,b){d(u,w,D,k,f,n,a,c,b,v)}]))):e("mvc-bindings-log-api")&&console.log(B.join(" is not a stateful property. Its change is not reflected to ")+
"."));e("mvc-bindings-log-api")&&console.log(B.join(" is bound to: "));z={};z.unwatch=z.remove=function(){for(var a=null;a=y.pop();)a.unwatch();e("mvc-bindings-log-api")&&console.log(B.join(" is unbound from: "))};return z};l.mixin(b,h);return l.setObject("dojox.mvc.sync",l.mixin(a,{equals:function(a,f){return a===f||"number"==typeof a&&isNaN(a)&&"number"==typeof f&&isNaN(f)||l.isFunction((a||{}).getTime)&&l.isFunction((f||{}).getTime)&&a.getTime()==f.getTime()||(l.isFunction((a||{}).equals)?a.equals(f):
l.isFunction((f||{}).equals)?f.equals(a):!1)}},h))})},"dojox/mvc/_atBindingExtension":function(){define(["dojo/_base/config","dojo/has","dijit/_WidgetBase","./atBindingExtension"],function(l,h,g,e){h.add("mvc-extension-per-widget",(l.mvc||{}).extensionPerWidget);h("mvc-extension-per-widget")||e(g.prototype)})},"dojox/mvc/atBindingExtension":function(){define("dojo/aspect dojo/_base/array dojo/_base/lang dijit/_WidgetBase ./_atBindingMixin dijit/registry".split(" "),function(l,h,g,e,d){return function(b){h.forEach(arguments,
function(a){a.dataBindAttr?console.warn("Detected a widget or a widget class that has already been applied data binding extension. Skipping..."):(g._mixin(a,d.mixin),l.before(a,"postscript",function(a,b){this._dbpostscript(a,b)}),l.before(a,"startup",function(){this._started||this._startAtWatchHandles()}),l.before(a,"destroy",function(){this._stopAtWatchHandles()}),l.around(a,"set",function(a){return function(c,f){return c==d.prototype.dataBindAttr?this._setBind(f):"dojox.mvc.at"==(f||{}).atsignature?
this._setAtWatchHandle(c,f):a.apply(this,g._toArray(arguments))}}))});return arguments}})},"dojox/mvc/_atBindingMixin":function(){define("dojo/_base/array dojo/_base/lang dojo/_base/declare dojo/has dojo/Stateful ./resolve ./sync".split(" "),function(l,h,g,e,d,b,a){function c(a){var f;try{f=require("dijit/registry")}catch(r){return}for(a=a.domNode&&a.domNode.parentNode;a;){if(a=f.getEnclosingWidget(a)){var c=a._relTargetProp||"target";if((h.isFunction(a.get)?a.get(c):a[c])||c in a.constructor.prototype)return a}a=
a&&a.domNode.parentNode}}function k(k,d,m,g,l){function p(){q.Two&&q.Two.unwatch();delete q.Two;var c=t&&(h.isFunction(t.get)?t.get(r):t[r]),p=b(k,c),c=b(m,c);e("mvc-bindings-log-api")&&(!p||/^rel:/.test(k)&&!t)&&n(k,d);e("mvc-bindings-log-api")&&(!c||/^rel:/.test(m)&&!t)&&n(m,g);p&&c&&(!/^rel:/.test(k)&&!/^rel:/.test(m)||t)&&(p.set&&p.watch||"*"!=d?null==d?(h.isFunction(c.set)?c.set(g,p):c[g]=p,e("mvc-bindings-log-api")&&console.log("dojox/mvc/_atBindingMixin set "+p+" to: "+f(c,g))):q.Two=a(p,d,
c,g,l):e("mvc-bindings-log-api")&&n(k,d))}var q={},t=c(m),r=t&&t._relTargetProp||"target";p();if(t&&/^rel:/.test(k)||/^rel:/.test(m)&&h.isFunction(t.set)&&h.isFunction(t.watch))q.rel=t.watch(r,function(a,f,c){f!==c&&(e("mvc-bindings-log-api")&&console.log("Change in relative data binding target: "+t),p())});var u={};u.unwatch=u.remove=function(){for(var a in q)q[a]&&q[a].unwatch(),delete q[a]};return u}var f=e("mvc-bindings-log-api")?function(a,f){return[a._setIdAttr||!a.declaredClass?a:a.declaredClass,
f].join(":")}:"",n=e("mvc-bindings-log-api")?function(a,f){console.warn(f+" could not be resolved"+("string"==typeof a?" with "+a:"")+".")}:"",m={dataBindAttr:"data-mvc-bindings",_dbpostscript:function(a,f){f=this._refs=(a||{}).refs||{};for(var c in a)if("dojox.mvc.at"==(a[c]||{}).atsignature){var b=a[c];delete a[c];f[c]=b}var b=new d,k=this;b.toString=function(){return"[Mixin value of widget "+k.declaredClass+", "+(k.id||"NO ID")+"]"};b.canConvertToLoggable=!0;this._startAtWatchHandles(b);for(c in f)void 0!==
b[c]&&((a=a||{})[c]=b[c]);this._stopAtWatchHandles()},_startAtWatchHandles:function(a){this.canConvertToLoggable=!0;var f=this._refs;if(f){var c=this._atWatchHandles=this._atWatchHandles||{};this._excludes=null;for(var b in f)f[b]&&"*"!=b&&(c[b]=k(f[b].target,f[b].targetProp,a||this,b,{bindDirection:f[b].bindDirection,converter:f[b].converter,equals:f[b].equalsCallback}));"dojox.mvc.at"==(f["*"]||{}).atsignature&&(c["*"]=k(f["*"].target,f["*"].targetProp,a||this,"*",{bindDirection:f["*"].bindDirection,
converter:f["*"].converter,equals:f["*"].equalsCallback}))}},_stopAtWatchHandles:function(){for(var a in this._atWatchHandles)this._atWatchHandles[a].unwatch(),delete this._atWatchHandles[a]},_setAtWatchHandle:function(a,f){if("ref"==a)throw Error(this+": 1.7 ref syntax used in conjunction with 1.8 dojox/mvc/at syntax, which is not supported.");var c=this._atWatchHandles=this._atWatchHandles||{};c[a]&&(c[a].unwatch(),delete c[a]);this._excludes=this[a]=null;this._started?c[a]=k(f.target,f.targetProp,
this,a,{bindDirection:f.bindDirection,converter:f.converter,equals:f.equalsCallback}):this._refs[a]=f},_setBind:function(a){a=eval("({"+a+"})");for(var f in a){var c=a[f];"dojox.mvc.at"!=(c||{}).atsignature?console.warn(f+" in "+dataBindAttr+" is not a data binding handle."):this._setAtWatchHandle(f,c)}},_getExcludesAttr:function(){if(this._excludes)return this._excludes;var a=[],f;for(f in this._atWatchHandles)"*"!=f&&a.push(f);return a},_getPropertiesAttr:function(){if(this.constructor._attribs)return this.constructor._attribs;
var a=["onClick"].concat(this.constructor._setterAttrs);l.forEach(["id","excludes","properties","ref","binding"],function(f){f=l.indexOf(a,f);0<=f&&a.splice(f,1)});return this.constructor._attribs=a}};m[m.dataBindAttr]="";g=g("dojox/mvc/_atBindingMixin",null,m);g.mixin=m;return g})},"dojox/mvc/resolve":function(){define(["dojo/_base/lang","dijit/registry","dojo/Stateful"],function(l,h){return l.setObject("dojox.mvc.resolve",function(g,e){if("string"==typeof g){var d=g.match(/^(expr|rel|widget):(.*)$/)||
[];try{g="rel"==d[1]?l.getObject(d[2]||"",!1,e):"widget"==d[1]?h.byId(d[2]):l.getObject(d[2]||g,!1,e)}catch(b){}}return g})})},"esri/dijit/geoenrichment/Grid":function(){define(["../../declare","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dijit/layout/_LayoutWidget"],function(l,h,g,e,d){var b=l("esri.dijit.geoenrichment.Grid",[d],{_placeholder:null,layout:function(){var a=this.getChildren(),c=[],k,f,d;for(k=0;k<this.rows.length;k++)c.push(0);h.add(this.domNode,"Grid_Measure");var m=
[];for(k=0;k<a.length;k++){f=a[k];d=f.row;f=f.domNode;f.style.position="absolute";h.add(f,"GridCell_Measure");var p=f.scrollHeight;h.remove(f,"GridCell_Measure");f=p;m.push(f);f>c[d]&&(c[d]=f)}d=e.getContentBox(this.domNode).h;h.remove(this.domNode,"Grid_Measure");k=this.rows;for(f=m=0;f<c.length;f++)switch(k[f]){case b.AUTO:d-=c[f];break;case b.STRETCH:case b.STACK:m++}if(1<m)throw Error("Multiple rows with flexible heights are not supported");m=[0];for(f=0;f<c.length;f++){var q;switch(k[f]){case b.AUTO:q=
c[f];break;case b.STRETCH:q=d;break;case b.STACK:q=Math.min(d,c[f])}m.push(m[f]+q)}for(k=0;k<a.length;k++)f=a[k],d=f.row,c=m[d+1]-m[d],q=f.domNode.style,q.top=m[d]+"px",q.height=c+"px";this._placeholder||(this._placeholder=g.create("div",null,this.domNode));this._placeholder.style.height=m[m.length-1]+"px"}});b.AUTO="auto";b.STRETCH="stretch";b.STACK="stack";return b})},"esri/dijit/geoenrichment/ProgressHandler":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/when","dojo/dom-class",
"dojo/query"],function(l,h,g,e){return l(null,{progressNode:null,progressPromises:null,busyClass:null,errorClass:null,_allStates:null,constructor:function(d,b){b=b||{};this.busyClass=b.busyClass||"Wizard_Loading";this.errorClass=b.errorClass||"Wizard_Error";this._allStates=[this.busyClass,this.errorClass];var a=b.progressClass||"Wizard_Progress";d?(this.progressNode=d,g.add(this.progressNode,a)):b.queryNode&&(this.progressNode=e("."+a,b.queryNode)[0]);this.progressPromises={}},showProgress:function(d,
b){function a(){if(c.progressPromises[b]===d)return delete c.progressPromises[b],!0}b=b||"";d=h(d);if(d.isFulfilled())return this.progressPromises[b]&&(delete this.progressPromises[b],this._setState("done")),d;this.progressPromises[b]=d;var c=this;this._setState("busy");d.then(function(){a()&&c._setState("done")},function(b){a()&&("CancelError"==b.name?c._setState("done"):c._setState("error",b.toString()))});return d},cancelProgress:function(d){d=d||"";this.progressPromises[d]&&this.progressPromises[d].cancel()},
_setState:function(d,b){!this.progressNode||"done"==d&&Object.keys(this.progressPromises).length||(this.progressNode.innerHTML=b||"",g.remove(this.progressNode,this._allStates),"done"!=d&&g.add(this.progressNode,this[d+"Class"]))},destroy:function(){for(var d=Object.keys(this.progressPromises),b=0;b<d.length;b++)this.cancelProgress(d[b])}})})},"esri/dijit/geoenrichment/when":function(){define(["dojo/when"],function(l){return l})},"widgets/BusinessAnalyst/utils/GEUtil":function(){define("dojo/_base/array dojo/when esri/request ./GeocodeUtil esri/geometry/webMercatorUtils esri/dijit/geoenrichment/utils/FileUtil jimu/portalUtils".split(" "),
function(l,h,g,e,d,b,a){return{getAvailableCountries:function(){return a.getPortal(portalUrl).loadSelfInfo().then(function(a){return g({url:(a&&a.helperServices&&a.helperServices.geoenrichment&&a.helperServices.geoenrichment.url?a.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Countries",content:{appID:"webappbuilder",f:"json",langCode:"en-us"},handleAs:"json"})})},createRingOrDriveTimes:function(c){return a.getPortal(portalUrl).loadSelfInfo().then(function(a){return g({url:(a&&
a.helperServices&&a.helperServices.geoenrichment&&a.helperServices.geoenrichment.url?a.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Enrich",content:{appID:"webappbuilder",f:"json",langCode:"en-us",useData:JSON.stringify({sourceCountry:c.sourceCountry}),studyAreasOptions:JSON.stringify(c.studyAreasOptions),dataCollections:JSON.stringify(["GlobalIntersect"]),returnGeometry:!0,outSR:JSON.stringify({wkid:102100}),studyAreas:JSON.stringify([{geometry:c.geometry}]),
token:esri.id.credentials[0].token},handleAs:"json"})})},createReport:function(c){var k={appID:"webappbuilder",langCode:"en-us",report:"string"===typeof c.report?c.report:JSON.stringify(c.report),format:"pdf",f:"bin",token:esri.id.credentials[0].token,useData:JSON.stringify({sourceCountry:c.sourceCountry}),studyAreas:JSON.stringify(c.studyAreas),reportFields:JSON.stringify({locationname:c.locationName,latitude:c.lat,longitude:c.long,subtitle:"Prepared by Esri",areadesc2:c.areadesc2})};return a.getPortal(portalUrl).loadSelfInfo().then(function(a){return g({url:(a&&
a.helperServices&&a.helperServices.geoenrichment&&a.helperServices.geoenrichment.url?a.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/createReport",content:k,handleAs:"blob"}).then(function(a){return b.saveAs(a,c.reportDownloadName+".pdf")}).otherwise(function(a){alert("Error: "+a)})})},checkCapabilities:function(c){return a.getPortal(portalUrl).loadSelfInfo().then(function(a){var f=!1,b=!1,k=a&&a.user&&a.user.privileges,
d=a&&a.helperServices;a=d.geoenrichment&&d.geoenrichment.url;var d=d.routingUtilities&&d.routingUtilities.url,e=a?a:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver";!window.isBuilder&&!c.mode&&c.appProxies&&0<c.appProxies.length&&l.some(c.appProxies,function(a){return e.toLowerCase()===a.sourceUrl.toLowerCase()})?b=f=!0:l.forEach(k,function(a){"premium:user:geoenrichment"===a?f=!0:"premium:user:networkanalysis"===a&&(b=!0)});return{hasPrivilege:f&&b,geServiceConfigured:!!a,
dirRoutingServiceConfigured:!!d}})},getCountryForPolygon:function(c,b,f){return a.getPortal(portalUrl).loadSelfInfo().then(function(a){return g({url:(a&&a.helperServices&&a.helperServices.geoenrichment&&a.helperServices.geoenrichment.url?a.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver")+"/Geoenrichment/Enrich",content:{appID:"webappbuilder",f:"json",langCode:"en-us",dataCollections:JSON.stringify(["GlobalIntersect"]),outSR:JSON.stringify({wkid:102100}),
studyAreas:JSON.stringify([{geometry:c.toJson()}]),token:esri.id.credentials[0].token},handleAs:"json"}).then(function(a){if(a&&a.results&&1===a.results.length&&1===a.results[0].value.FeatureSet[0].features.length)return a.results[0].value.FeatureSet[0].features[0].attributes.sourceCountry;if(a&&a.results&&1===a.results.length&&1<a.results[0].value.FeatureSet[0].features.length){var k=c.getCentroid(),k=d.xyToLngLat(k.x,k.y),n=function(a){var c="";l.forEach(a,function(a){a.attributes.sourceCountry==
f&&(c=f)});if(c)return c;l.forEach(a,function(a){a.attributes.sourceCountry==b.defaultCountryID&&(c=defaultCountryID)});return c?c:a[0].attributes.sourceCountry};return h(e.reverseGeocode({x:k[0],y:k[1]})).then(function(f){return f&&f.address&&f.address.CountryCode?f.address.CountryCode:n(a.results[0].value.FeatureSet[0].features)}).otherwise(function(){return n(a.results[0].value.FeatureSet[0].features)})}return b.defaultCountryID})})},getGEProxyUrl:function(c){var b=!1;return a.getPortal(portalUrl).loadSelfInfo().then(function(a){geUrl=
a&&a.helperServices&&a.helperServices.geoenrichment&&a.helperServices.geoenrichment.url?a.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver";!window.isBuilder&&!c.mode&&c.appProxies&&0<c.appProxies.length&&l.forEach(c.appProxies,function(a){geUrl.toLowerCase()===a.sourceUrl.toLowerCase()&&(b=a.proxyUrl)});return b})}}})},"widgets/BusinessAnalyst/utils/GeocodeUtil":function(){define(["esri/request","jimu/portalUtils"],function(l,h){return{reverseGeocode:function(g){return h.getPortal(portalUrl).loadSelfInfo().then(function(e){return l({url:(e&&
e.isPortal&&e.helperServices&&e.helperServices.geocode&&0<e.helperServices.geocode.length?e.helperServices.geocode[0].url:"https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer")+"/reverseGeocode",content:{appID:"webappbuilder",f:"json",langCode:"en-us",location:JSON.stringify({x:g.x,y:g.y}),distance:250},handleAs:"json"})})}}})},"esri/dijit/geoenrichment/utils/FileUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","./DataUtil","./ImageUtil"],
function(l,h,g,e){function d(){return new l.reject(Error("Saving not supported."))}var b=d,a=/[\\/:*?"<>|]/g,c={savingSupported:function(){return void 0!==window.Blob},saveTextFile:function(a,f,b,k){return c.savingSupported()?c.saveAs(new Blob([a],{type:b||"text/plain"}),f||"text.txt",k):d()},saveImageFile:function(a,f){if(c.savingSupported()){var b;"string"===typeof a?(b=e.base64DataFromDataURL(a),b=g.binaryStringToByteArray(atob(b)).buffer):a instanceof ArrayBuffer&&(b=a);return c.saveAs(b?g.arrayBuffersToBlob([b],
"image/png"):a,f)}d()},_queue:[],_isSavePendingFlag:!1,_saveTimeoutH:null,saveAs:function(a,f,k){return k&&k.addDownloadIntervals?(k=new l,c._queue.push({blob:a,name:f||"download",dfd:k}),c._trySaveAsNext(),k.promise):b(a,c.validateName(f||"download"))},_trySaveAsNext:function(){if(c._queue.length&&!c._isSavePendingFlag){var a=c._queue.shift();c._isSavePendingFlag=!0;h(b(a.blob,c.validateName(a.name))).then(a.dfd.resolve,a.dfd.reject).always(function(){setTimeout(function(){c._isSavePendingFlag=!1;
c._trySaveAsNext()},100)})}},validateName:function(f){return String(f).trim().replace(a,"")}};if(!c.savingSupported())return c;if(window.navigator&&window.navigator.msSaveOrOpenBlob)return b=function(a,f){var c=new l;window.navigator.msSaveOrOpenBlob(a,f)?c.resolve():c.reject(Error("Failed to save or open downloaded file."));return c.promise},c;var k=window.URL||window.webkitURL;if("download"in window.document.createElement("a")){var f=function(a){var f;void 0!==window.MouseEvent?f=new MouseEvent("click",
{bubbles:!0,cancelable:!1}):(f=document.createEvent("MouseEvent"),f.initMouseEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null));a.dispatchEvent(f)},b=function(a,c){var b=new l,d=k.createObjectURL(a),n=window.document.createElement("a");n.href=d;n.download=c;f(n);setTimeout(function(){k.revokeObjectURL(d);n=null;b.resolve();b=null},1E3);return b.promise};return c}b=function(a,f){var c=new l;a=new File([a],f,{type:a.type});var b=k.createObjectURL(a);window.open(b,"_blank");setTimeout(function(){k.revokeObjectURL(b);
c.resolve()},1E3);return c.promise};return c})},"esri/dijit/geoenrichment/utils/DataUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],function(l,h){function g(a){return"string"==typeof a?{source:a,getLength:function(){return this.source.length},getByte:function(a){return this.source.charCodeAt(a)&255}}:window.ArrayBuffer&&a instanceof ArrayBuffer?{source:new Uint8Array(a),getLength:function(){return this.source.byteLength},getByte:function(a){return this.source[a]}}:
a}function e(a){for(var c=a.length,b=new Uint8Array(a.length),f=0;f<c;f++)b[f]=a.charCodeAt(f);return b}function d(a,c){a=new Uint8Array(a);c=Math.min(c,a.byteLength);for(var b="",f=0;f<c;f++)b+=String.fromCharCode(a[f]);return b}var b={arrayBufferFromBlob:function(a){var c=new l,b=new FileReader;b.onloadend=function(){b.error?c.reject(b.error):c.resolve(b.result)};b.readAsArrayBuffer(a);return c.promise},arrayBuffersToBlob:function(a,c){return new Blob(a,{type:c||"application/octet-stream"})},binaryStringFromByteSource:function(a){if("string"==
typeof a)return a;a=g(a);for(var c=a.getLength(),b=c%4,c=c-b,f="",d=0,e,p,h,t;d<c;)e=a.getByte(d++),p=a.getByte(d++),h=a.getByte(d++),t=a.getByte(d++),f+=String.fromCharCode(e,p,h,t);1==b?f+=String.fromCharCode(a.getByte(d)):2==b?f+=String.fromCharCode(a.getByte(d),a.getByte(d+1)):3==b&&(f+=String.fromCharCode(a.getByte(d),a.getByte(d+1),a.getByte(d+2)));return f},base64FromByteSource:function(a){a=g(a);for(var c=a.getLength(),b=c%3,c=c-b,f,d,e,p,h="",t=0;t<c;t+=3)p=a.getByte(t)<<16|a.getByte(t+1)<<
8|a.getByte(t+2),f=p>>18&63,d=p>>12&63,e=p>>6&63,p&=63,h+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[f]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[d]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p];1==b?(p=a.getByte(t),h+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p>>2&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p<<
4&63]+"\x3d\x3d"):2==b&&(p=a.getByte(t)<<8|a.getByte(t+1),h+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p>>10&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p>>4&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[p<<2&63]+"\x3d");return h},base64FromJson:function(a){return btoa(unescape(encodeURIComponent("string"===typeof a?a:JSON.stringify(a))))}};b.binaryStringToByteArray=e;b.base64ToByteArray=function(a){return e(atob(a))};b.getFirstBytes=
function(a,c){var b;if("string"==typeof a)b=a.substr(0,c);else if(window.ArrayBuffer&&a instanceof ArrayBuffer)b=d(a,c);else if(window.Blob&&a instanceof Blob){b=new l;var f=new FileReader;f.onloadend=function(){f.error?b.resolve(""):b.resolve(d(f.result,c))};f.readAsArrayBuffer(a.slice(0,c))}return h(b||"")};b.isBase64=function(a){return a&&0==a.length%4&&/^[ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+\/]+$/.test(a.replace(/={0,2}$/,""))};b.getContentType=function(a){a=b.getFileExtension(a);
if(null===a)return null;switch(a){case "png":return"image/png";case "jpg":case "jpeg":return"image/jpeg";case "gif":return"image/gif";case "json":return"application/json";case "txt":return"text/plain";case "xml":return"text/xml";default:return null}};b.getFileExtension=function(a){var b=a.lastIndexOf(".")+1;return b?a.substr(b).toLowerCase():null};return b})},"esri/dijit/geoenrichment/utils/ImageUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","./UrlUtil"],
function(l,h,g){var e={base64DataToDataURL:function(d,b){if(/^data:image/.test(d))return d;b||(b=atob(d.substr(0,16)),b=e.getImageContentType(b));return"data:"+(b||"image/png")+";base64,"+d},getImageContentType:function(d){if("\u00ff\u00d8\u00ff"===d.substr(0,3)&&"JFIF"===d.substr(6,4))return"image/jpeg";if("\u0089PNG\r\n\u001a\n"===d.substr(0,8))return"image/png";if("GIF89a"===d.substr(0,6)||"GIF87a"===d.substr(0,6))return"image/gif"},base64DataFromDataURL:function(d){0==d.indexOf("data:")&&(d=d.substr(d.indexOf(",")+
1));return d},getBase64DataIndex:function(d){d=0==d.indexOf("data:")?d.indexOf(";base64,"):-1;return 0<d?d+8:0},getContentType:function(d){var b=e.getBase64DataIndex(d);return b?d.substring(5,b-8):null},checkBase64FileSize:function(d,b){return e.getBase64FileSize(d)<=b},getBase64FileSize:function(d){return.75*d.length},imageToDataURL:function(d,b){b=b||{};var a=document.createElement("canvas"),c=a.getContext("2d");a.width=b.width||d.width;a.height=b.height||d.height;var k=b.opacity;null!=k&&!isNaN(k)&&
0<=k&&1>k&&(c.globalAlpha=+k,b.format="image/png");(k=b.pos)?c.drawImage(d,k.x||0,k.y||0):c.drawImage(d,0,0,a.width,a.height);return a.toDataURL(b.format)},imageFromUrl:function(d,b){var a=new l,c=new Image;0!==d.indexOf("data:")&&b&&b.crossOrigin&&c.setAttribute("crossOrigin",b.crossOrigin);c.onload=function(){if(c.width&&c.height)a.resolve(c);else{var k=Error("Error of reading an image from URL.");b&&b.ignoreError?a.resolve(null):a.reject(k)}c.onload=c.onerror=null};c.onerror=function(k){b&&b.ignoreError?
a.resolve(null):a.reject(k);c.onload=c.onerror=null};d=require.toUrl(d);/^http:/i.test(d)&&/^https/i.test(window.location.protocol)&&(d=g.toHttpsUrl(d));c.src=d;return a.promise},scaleImage:function(d,b){if("string"===typeof d)var a=e.base64DataToDataURL(d),c=e.getContentType(a),a=e.imageFromUrl(a);return h(a||d).then(function(a){var f=1,k=a.width,d=a.height;if(b.factor)f=b.factor;else if(b.maxDim)f=b.maxDim/Math.max(k,d);else if(b.imageDim){var g=b.imageDim.w,h=b.imageDim.h;b.imageDim.preserveRatio?
(f=Math.min(g/k,h/d),b.imageDim.reduceOnly&&1<f&&(f=1)):b.imageDim.reduceOnly?(k=Math.min(k,g),d=Math.min(d,h)):(k=g,d=h)}return e.imageToDataURL(a,{width:k*f,height:d*f,format:b.format||c,opacity:b.opacity})})},getImageViewType:function(d,b){return 1E3<=b?(d/=b,.025>=Math.abs(d-2)?"360":2<d?"pano":null):null}};return e})},"esri/dijit/geoenrichment/utils/UrlUtil":function(){define(["dojo/_base/url","esri/config","esri/kernel","esri/urlUtils","esri/arcgis/utils"],function(l,h,g,e,d){var b={getDomain:function(a){if("string"!==
typeof a)return null;a=a.replace(/^(http:\/\/|https:\/\/)/i,"");var b=a.indexOf("/");return 0>b?a:a.substr(0,b)},getPortalUrl:function(a){if("string"!==typeof a)return null;a=a.replace(/\?.*$/,"");var b=a.match(/^(.+)\/sharing(\/|$)/i);return b||(b=a.match(/^(.+)\/home$/i))?b[1]:(b=a.match(/^(.+)\/portal(\/|$)/i))?b[1]+"/portal":a},getProxyUrl:function(a){var c=h.defaults.io.proxyUrl;c&&!/^http/i.test(c)&&(c=e.getAbsoluteUrl(c));c&&a&&(c=b.toHttpsUrl(c));return c},registerCORS:function(a){(a=b.getDomain(a))&&
-1==h.defaults.io.corsEnabledServers.indexOf(a)&&h.defaults.io.corsEnabledServers.push(a);b._fixCORS()},_fixCORS:function(){h.defaults.io.corsEnabledServers=h.defaults.io.corsEnabledServers.filter(function(a){return a.indexOf&&0===a.indexOf("null://")?(console.log("WARNING: incorrect CORS URL detected: "+a),!1):!0})},indexOfQuery:function(a){var b=a.indexOf("?");0<=b&&(a=a.substr(b+1),/^(http:\/\/|https:\/\/)/i.test(a)&&(a=a.indexOf("?"),b=0<=a?b+1+a:-1));return b},removeQuery:function(a){var c=b.indexOfQuery(a);
return 0>c?a:a.substr(0,c)},addQueryPart:function(a,c){var k=0>b.indexOfQuery(a)?"?":"\x26";return a+k+c},getVariableValue:function(a,b){if(a&&"string"===typeof b){var c=e.urlToObject(a);if(c.query){var f={};Object.keys(c.query).forEach(function(a){f[a.toLowerCase()]=c.query[a]});return f[b.toLowerCase()]}}},addUrlVariable:function(a,c,k){c=encodeURIComponent(c);k=encodeURIComponent(k);return b.addQueryPart(a,c+"\x3d"+k)},securePortsMap:{80:"443",8080:"8443"},toHttpUrl:function(a){return!a||/^http/i.test(a)?
a:"http://"+a},toHttpsUrl:function(a){a&&(a=b.toHttpUrl(a));if(!a||!/^http:\/\//i.test(a))return a;var c=new l(a);a=a.replace(/^http/i,"https");var k=b.securePortsMap[c.port];k&&(a=a.replace(":"+c.port,":"+k));return a},combine:function(a,c){"number"===typeof c&&(c+="");if(c){if(/^(http:\/\/|https:\/\/)/i.test(c)||!a)return c;"/"!=c.charAt(0)&&(c="/"+c);if(1==c.length)return a;var k=a.length-1;"/"==a.charAt(k)&&(a=a.substr(0,k));var f=e.urlToObject(a);a=b.removeQuery(a);k=a.length-c.length;0<=k&&
a.substr(k).toLowerCase()==c.toLowerCase()&&(a=a.substr(0,k));a+=c;for(var d in f.query)b.addQueryPart(a,f.query[d])}return a},combineMulti:function(a){for(var c=a[0],k=1;k<a.length;k++)c=b.combine(c,a[k]);return c},openUrl:function(a,b){if(b)return window.open(a,"_blank");b=window.open();b.opener=null;b.referrer=null;b.location=a;return b},isPageRunOnWebService:function(){return/^http/i.test(window.location.protocol)},getToken:function(a){return(a=a&&g.id.findCredential(a)||g.id.credentials[0])&&
a.token},setArcgisUrl:function(a){a&&(d.arcgisUrl=b.combine(a,"/sharing/rest/content/items"))}};return b})},"widgets/BusinessAnalyst/utils/TravelModeUtil":function(){define(["esri/request","jimu/portalUtils","dojo/_base/array","dojo/Deferred","dojo/when"],function(l,h,g,e,d){var b=null;return{getTravelMode:function(a,b){return d(this._getTravelModes(),function(c){var f="";g.forEach(c.results,function(b){"supportedTravelModes"===b.paramName&&g.forEach(b.value.features,function(b){b.attributes&&b.attributes.Name===
a&&(f=b.attributes.TravelMode)})});if(!f)return f;b=Number(b);if(!b||10>=b)return f;c=JSON.parse(f);c.simplificationTolerance=b;return JSON.stringify(c)})},_getTravelModes:function(){b||(b=new e,h.getPortal(portalUrl).loadSelfInfo().then(function(a){l({url:a.helperServices.routingUtilities.url+"/GetTravelModes/execute",content:{appID:"webappbuilder",f:"json",langCode:"en-us"},handleAs:"json"}).then(function(a){b.resolve(a)})}));return b}}})},"widgets/BusinessAnalyst/utils/ValidationUtil":function(){define(["dojo/dom-class"],
function(l){return{MIN_RINGS_VALUE:0,MAX_RINGS_VALUE:1E3,MIN_DTWT_VALUE:0,MAX_DTWT_VALUE:300,validateInvalidValues:function(h,g,e,d,b){var a=h.get("value"),c=g.get("value"),k=e.get("value"),f=!0;0<a.length&&null===this._tryParseFloat(a)?(f=!1,l.remove(d,"hidden"),d.innerHTML=b,l.add(h.domNode,"invalidValue")):l.remove(h.domNode,"invalidValue");0<c.length&&null===this._tryParseFloat(c)?(f=!1,l.remove(d,"hidden"),d.innerHTML=b,l.add(g.domNode,"invalidValue")):l.remove(g.domNode,"invalidValue");0<k.length&&
null===this._tryParseFloat(k)?(f=!1,l.remove(d,"hidden"),d.innerHTML=b,l.add(e.domNode,"invalidValue")):l.remove(e.domNode,"invalidValue");f&&l.add(d,"hidden");return f},validateMinMaxValues:function(h,g,e,d,b,a,c){var k=h.get("value"),f=g.get("value"),n=e.get("value"),m=!0;0<k.length?(k=parseFloat(k),k<d||k>b?(m=!1,l.remove(a,"hidden"),a.innerHTML=c,l.add(h.domNode,"invalidValue")):l.remove(h.domNode,"invalidValue")):l.remove(h.domNode,"invalidValue");0<f.length?(k=parseFloat(f),k<d||k>b?(m=!1,l.remove(a,
"hidden"),a.innerHTML=c,l.add(g.domNode,"invalidValue")):l.remove(g.domNode,"invalidValue")):l.remove(g.domNode,"invalidValue");0<n.length?(k=parseFloat(n),k<d||k>b?(m=!1,l.remove(a,"hidden"),a.innerHTML=c,l.add(e.domNode,"invalidValue")):l.remove(e.domNode,"invalidValue")):l.remove(e.domNode,"invalidValue");m&&l.add(a,"hidden");return m},_tryParseFloat:function(h){var g=null;null!==h&&0<h.length&&(isNaN(h)||(g=parseFloat(h)));return g}}})},"widgets/BusinessAnalyst/utils/SiteUtil":function(){define(["esri/units",
"dojo/_base/array"],function(l,h){var g={testTimeUnits:function(d){return"Hours"===d||"Seconds"===d||"Minutes"===d}},e={};e[l.FEET]=.3048;e[l.YARDS]=.9144;e[l.METERS]=1;e[l.KILOMETERS]=1E3;e[l.MILES]=1609.3472186944373;e[l.NAUTICAL_MILES]=1852;e.Hours=6E4;e.Seconds=16.66666666666667;e.Minutes=1E3;e[l.SQUARE_FEET]=e[l.FEET]*e[l.FEET];e[l.SQUARE_YARDS]=e[l.YARDS]*e[l.YARDS];e[l.SQUARE_METERS]=1;e[l.SQUARE_KILOMETERS]=e[l.KILOMETERS]*e[l.KILOMETERS];e[l.SQUARE_MILES]=e[l.MILES]*e[l.MILES];e[l.ACRES]=
4046.8564224;e[l.HECTARES]=1E4;g.convertUnits=function(d,b,a){return d*(e[b]||0)/(a&&e[a]||1)};g.getMaxRadiusInKilometers=function(d,b){var a=0;d&&d.bufferRadii&&(h.forEach(d.bufferRadii,function(b){b>a&&(a=b)}),a=g.convertUnits(a,d.bufferUnits||l.MILES,l.KILOMETERS),b&&g.testTimeUnits(d.bufferUnits)&&(a/=12));return a};return g})},"widgets/BusinessAnalyst/ErrorPage":function(){define(["dojo/_base/declare","dijit/_TemplatedMixin","dijit/_WidgetBase","esri/dijit/geoenrichment/_WizardPage","dojo/text!./ErrorPage.html"],
function(l,h,g,e,d){return l([g,h,e],{templateString:d,postCreate:function(){this.inherited(arguments);var b=this.displayErrors;b.gePrivilege?this.noPermissionsErrorDiv.innerHTML=this.nls.noPermissions:this.noPermissionsErrorDiv.parentNode.removeChild(this.noPermissionsErrorDiv);b.geServiceNotConfigured||b.dirRoutingServiceNotConfigured?this.servicesErrorDiv.innerHTML=b.geServiceNotConfigured?b.dirRoutingServiceNotConfigured?this.nls.geAndDirRoutingServicesNotConfigured:this.nls.geServiceNotConfigured:
this.nls.dirRoutingServiceNotConfigured:this.servicesErrorDiv.parentNode.removeChild(this.servicesErrorDiv)},startup:function(){this.inherited(arguments)}})})},"widgets/BusinessAnalyst/RunReportsPage":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-style dojo/query dojo/when dijit/_TemplatedMixin dijit/_WidgetBase dijit/_WidgetsInTemplateMixin esri/geometry/webMercatorUtils esri/dijit/geoenrichment/SelectableTree esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/GEUtil esri/dijit/geoenrichment/ReportPlayer/ReportPlayer esri/dijit/geoenrichment/ReportPlayer/PlayerResizeModes esri/dijit/geoenrichment/ReportPlayer/PlayerThemes esri/dijit/geoenrichment/ReportPlayer/DataProviderGE esri/dijit/geoenrichment/ReportPlayer/PlayerCommands esri/dijit/geoenrichment/_WizardPage esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/ReportTemplateTypes ./utils/GEUtil ./utils/ReportUtil ./esriAnalystX/widgets/Selects/FilteringSelectTree dojo/text!./RunReportsPage.html jimu/dijit/TabContainer3 jimu/utils".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q,t,r,u,y,v,w,D,B,z,C,E,A,F){return h([f,k,w,n],{templateString:E,infographicsTabHidden:!1,reportsTabHidden:!1,_infograpicReports:null,_configForLightTheme:[{name:"DashboardTheme",style:"light"}],postCreate:function(){this.inherited(arguments);this.tab=new A({tabs:[{title:this.nls.infographics,content:this.infographicsContentPane},{title:this.nls.reports,content:this.reportsContentPane}],selected:this.nls.infographics});this.tab.placeAt(this.runReportTabContainer);
this.tab.startup()},startup:function(){this.inherited(arguments)},loadReportsInfographicsForCountry:function(a){var f=this;c(z.getAvailableClassicReports(a,this.config),function(b){var c=f._getSingleReportID(b),k=f._getCountryConfig(f.config,a);k&&k.defaultReportID&&(c=k.defaultReportID);f.filteredReportDropDown?f.filteredReportDropDown.set("tree",new p(b)):(f.filteredReportDropDown=new C({name:"filteredReportSelect",tree:new p(b),defaultExpand:c?f._getDefaultExpandedTreeForSelectedReport(b,c):f._getDefaultExpandedTree(b),
placeHolder:f.nls.selectReport,onChange:function(a){f._enableDisableButton(f.runReportBtn,a)}},f.reportFilteringSelectDropDownContainer),f.filteredReportDropDown.startup());c&&f.filteredReportDropDown.set("value",c);f.reportsTabHidden=f.config.reportsDisabled||!f._areReportsAvailable(b)});c(z.getAvailableInfographicReports(a,this.config),function(b){var c=f._getSingleReportID(b),k=f._getCountryConfig(f.config,a);k&&k.defaultInfographicID&&(c=k.defaultInfographicID);f.infographicDropDown?f.infographicDropDown.set("tree",
new p(b)):(f.infographicDropDown=new C({name:"filteredInfographicReportSelect",tree:new p(b),defaultExpand:c?f._getDefaultExpandedTreeForSelectedReport(b,c):f._getDefaultExpandedTree(b),placeHolder:f.nls.selectTemplate,onChange:function(a){f._enableDisableButton(f.runInfographicBtn,a)}},f.infographicDropDownContainer),f.infographicDropDown.startup());c&&f.infographicDropDown.set("value",c);f.infographicsTabHidden=f.config.infographicsDisabled||!f._areReportsAvailable(b);f._infograpicReports=b})},
_getCountryConfig:function(a,f){var b=-1;l.forEach(a.countryConfig,function(a,c){a.countryID==f&&(b=c)});return-1!=b?a.countryConfig[b]:null},_areReportsAvailable:function(a){if(0==a.length)return!1;var f=!1;l.forEach(a,function(a){0<a.children.length&&(f=!0)});return f},_getDefaultExpandedTree:function(a){if(0==a.length)return{esriReports:!0};var f={};f[a[0].value]=!0;return f},_getDefaultExpandedTreeForSelectedReport:function(a,f){if(0==a.length)return{esriReports:!0};returnVal={};l.forEach(a,function(a){l.forEach(a.children,
function(b){b.value===f&&(returnVal[a.value]=!0)})});return returnVal},_getSingleReportID:function(a){if(1!=a.length)return!1;var f=!1;l.forEach(a,function(a){1===a.children.length&&(f=a.children[0].value)});return f},refresh:function(){this._hideOrShowTabs()},_hideOrShowTabs:function(){this._hideOrShowTab(this.nls.infographics,this.infographicsTabHidden);this._hideOrShowTab(this.nls.reports,this.reportsTabHidden);this.infographicsTabHidden?this.tab.selectTab(this.nls.reports):this.tab.selectTab(this.nls.infographics)},
_hideOrShowTab:function(f,c){var k=a("td",this.tab.tabTr),d;l.some(k,function(a){if(a.label===f)return d=a,!0})&&b.set(d,"display",c?"none":"")},runInfographic:function(){if(!e.contains(this.runInfographicBtn,"jimu-state-disabled")){var a=this,f=this.infographicDropDown.get("value");this.reportPlayer&&this.reportPlayer.destroy();this.playerDiv&&d.destroy(this.playerDiv);this.playerDiv=d.create("div",null,document.body);var b=new y;this.config.exportInfographicsPrintOption&&b.registerCommand(v.PRINT);
this.config.exportInfographicsPDFOption&&b.registerCommand(v.PDF);this.config.exportInfographicsImageOption&&b.registerCommand(v.IMAGE);this.config.exportInfographicsDynamicHTMLOption&&b.registerCommand(v.DYNAMIC_HTML);var k=F.isMobileUa();this.reportPlayer=(new t({isSlidesView:k?!0:!1,theme:this._useLightTheme()?u.LIGHT:u.DARK,dataProvider:b,resizeMode:r.FIT_WINDOW,showCloseButton:!0,config:{esriDijitCssUrl:"https://js.arcgis.com/3.34/dijit/themes/claro/claro.css",esriCssUrl:"https://js.arcgis.com/3.34/esri/css/esri.css",
playerSourceRootUrl:"https://js.arcgis.com/3.34/"},onClose:function(){a.reportPlayer.destroy();d.destroy(a.playerDiv)}})).placeAt(this.playerDiv);var n=!0,b=new C({name:"filteredInfographicReportSelect",tree:new p(this._infograpicReports),defaultExpand:a._getDefaultExpandedTreeForSelectedReport(this._infograpicReports,f),placeHolder:a.nls.selectTemplate,value:f,onChange:function(f){n?n=!1:(a.infographicDropDown.set("value",f),m(f))}});this._useLightTheme()||e.add(this.reportPlayer.playerToolbar.domNode,
"jimu-main-background");b.startup();b.set("value",f);this.reportPlayer.playerToolbar.addInfographicsSelect(b);var m=function(f){var b=[];if(a.wizard.selectedPoint.long)l.forEach(a.wizard.selectedPoint.tradeAreas,function(f,c){var k={};k.name=f.name;k.shortName=f.shortName;k.feature=f.graphic;"undefined"===typeof k.feature.attributes&&(k.feature.attributes="undefined"!==typeof a.wizard.selectedPoint.attributes?a.wizard.selectedPoint.attributes:{});k.feature.attributes.STORE_LONG=a.wizard.selectedPoint.long;
k.feature.attributes.STORE_LAT=a.wizard.selectedPoint.lat;k.feature.attributes.radiusIndex=c;b.push(k)});else if(a.wizard.selectedPolygon.geometry){var b=[],c={};a.isPolygonFIPS(a.wizard.selectedPolygon)?c=a.GetFIPSAnalysisArea(a.wizard.selectedPolygon):(c.name=a.wizard.selectedPolygon.locationName,c.shortName=a.wizard.selectedPolygon.locationName,c.feature=a.wizard.selectedPolygon.feature);b.push(c)}a.reportPlayer.playReport({portalUrl:portalUrl,countryID:a.wizard.selectedCountryID,reportID:f,analysisAreas:b})};
c(B.getGEProxyUrl(this.appConfig),function(a){a&&(q.setGeoenrichmentUrl(a),q.getClient());m(f)})}},isPolygonFIPS:function(a){return a&&a.feature&&a.feature.attributes&&a.feature.attributes.FIPS||a&&a.feature&&a.feature.attributes&&a.feature.attributes.STATE_FIPS?!0:!1},GetFIPSAnalysisArea:function(a){var f={geographies:[]},b={sourceCountry:"US"},c="";if(a.feature.attributes.FIPS)switch(a.feature.attributes.FIPS.length){case 2:c="US.States";break;case 5:c="US.Counties";break;case 11:c="US.Tracts"}else a.feature.attributes.STATE_FIPS&&
(c="US.States");b.levelId=c;b.id=a.feature.attributes.FIPS?a.feature.attributes.FIPS.toString():a.feature.attributes.STATE_FIPS.toString();b.attributes=a.feature.attributes;a=a.geometry.getCentroid();a=m.xyToLngLat(a.x,a.y);b.attributes.STORE_ID="0";b.attributes.STORE_LONG=a[0].toString();b.attributes.STORE_LAT=a[1].toString();f.geographies.push(b);return f},GetFIPSStudyArea:function(a){var f={sourceCountry:"US"},b="";if(a.feature.attributes.FIPS)switch(a.feature.attributes.FIPS.length){case 2:b=
"US.States";break;case 5:b="US.Counties";break;case 11:b="US.Tracts"}else a.feature.attributes.STATE_FIPS&&(b="US.States");f.layer=b;f.ids=[a.feature.attributes.FIPS?a.feature.attributes.FIPS.toString():a.feature.attributes.STATE_FIPS.toString()];f.attributes=a.feature.attributes;return f},_useLightTheme:function(){var a=!1,f=self.getAppConfig();l.forEach(this._configForLightTheme,function(b){f&&f.theme&&f.theme.name==b.name&&f.theme.styles&&0<f.theme.styles.length&&l.forEach(f.theme.styles,function(f){f==
b.style&&(a=!0)})});f&&f.theme&&f.theme.customStyles&&f.theme.customStyles.mainBackgroundColor&&"#FFFFFF"==f.theme.customStyles.mainBackgroundColor.toUpperCase()&&(a=!0);return a},runReport:function(){if(!e.contains(this.runReportBtn,"jimu-state-disabled")){e.add(this.runReportBtn,"jimu-state-disabled");this.shelter.show();var a=this;this.wizard.selectedPoint.long?this.runReportForPoint().then(function(){a.shelter.hide();e.remove(a.runReportBtn,"jimu-state-disabled")}).otherwise(function(){a.shelter.hide();
e.remove(a.runReportBtn,"jimu-state-disabled")}):this.wizard.selectedPolygon.geometry&&this.runReportForPolygon().then(function(){a.shelter.hide();e.remove(a.runReportBtn,"jimu-state-disabled")}).otherwise(function(){a.shelter.hide();e.remove(a.runReportBtn,"jimu-state-disabled")})}},_enableDisableButton:function(a,f){"string"===typeof f&&"None"!==f?e.remove(a,"jimu-state-disabled"):e.add(a,"jimu-state-disabled")},runReportForPoint:function(){var a=this,f={studyAreas:[]},b={featureSet:{fields:[{name:"OBJECTID",
alias:"Object ID",type:"esriFieldTypeOID"},{name:"STORE_ID",alias:"STORE_ID",type:"esriFieldTypeString",length:1,nullable:!0},{name:"STORE_LONG",alias:"STORE_LONG",type:"esriFieldTypeDouble"},{name:"STORE_LAT",alias:"STORE_LAT",type:"esriFieldTypeDouble"},{name:"AREA_DESC",alias:"AREA_DESC",type:"esriFieldTypeString",length:7,nullable:!0},{name:"AREA_DESC2",alias:"AREA_DESC2",type:"esriFieldTypeString",length:19,nullable:!0}],spatialReference:this.map.spatialReference.toJson(),geometryType:"esriGeometryPolygon",
features:[]}};l.forEach(this.wizard.selectedPoint.tradeAreas,function(f){var c={};c.geometry=f.graphic.geometry;f.graphic.attributes?c.attributes=f.graphic.attributes:a.wizard.selectedPoint.attributes&&(c.attributes=g.clone(a.wizard.selectedPoint.attributes));c.attributes||(c.attributes={});c.attributes.OBJECTID=1;c.attributes.STORE_ID="1";c.attributes.STORE_LONG=a.wizard.selectedPoint.long;c.attributes.STORE_LAT=a.wizard.selectedPoint.lat;c.attributes.AREA_DESC=f.AREA_DESC;c.attributes.AREA_DESC2=
f.AREA_DESC2;b.featureSet.features.push(c)});f.studyAreas.push(b);this.filteredReportDropDown.getSelectedItem().reportType!=D.STANDARD&&(f.areadesc2=this.wizard.selectedPoint.areadesc2);f.locationName=this.wizard.selectedPoint.locationName;f.lat=this.wizard.selectedPoint.lat;f.long=this.wizard.selectedPoint.long;f.sourceCountry=this.wizard.selectedCountryID;f.report=this.filteredReportDropDown.getSelectedItem().item?this.filteredReportDropDown.getSelectedItem().item:this.filteredReportDropDown.getSelectedItem().value;
f.reportDownloadName=this.filteredReportDropDown.getSelectedItem().label;return B.createReport(f)},runReportForPolygon:function(){var a={studyAreas:[]},f={},f=this.isPolygonFIPS(this.wizard.selectedPolygon)?this.GetFIPSStudyArea(this.wizard.selectedPolygon):{geometry:this.wizard.selectedPolygon.geometry.toJson()};this.wizard.selectedPolygon.feature&&this.wizard.selectedPolygon.feature.attributes&&(f.attributes=this.wizard.selectedPolygon.feature.attributes);a.studyAreas.push(f);a.locationName=this.wizard.selectedPolygon.locationName;
a.sourceCountry=this.wizard.selectedCountryID;a.report=this.filteredReportDropDown.getSelectedItem().item?this.filteredReportDropDown.getSelectedItem().item:this.filteredReportDropDown.getSelectedItem().value;a.reportDownloadName=this.filteredReportDropDown.getSelectedItem().label;return B.createReport(a)},backOnClick:function(){this.onBack()}})})},"esri/dijit/geoenrichment/SelectableTree":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented ./when dojo/store/util/QueryResults dojo/store/util/SimpleQueryEngine dstore/QueryResults".split(" "),
function(l,h,g,e,d,b,a,c){var k=function(a,b){this.storage=a;this.data=b};k.prototype={storage:null,data:null,filter:function(a){return this.storage._filter(this.data,a)},sort:function(a,b){return this.storage._sort(this.data,a,b)},fetch:function(){return this.storage._fetchRange(this.data)},fetchRange:function(a){return this.storage._fetchRange(this.data,a)},mayHaveChildren:function(a){return this.storage.mayHaveChildren(a)},getChildren:function(a){return this.storage.getChildren(a,{returnCollection:!0})}};
return l(e,{idProperty:"id",bindingProperty:null,autoIdentify:!0,queryEngine:a,isDstoreTree:!1,root:null,data:null,_hash:null,_autoId:null,storage:null,constructor:function(a,b){h.mixin(this,b);this.storage=this;this.root={children:a||[]};h.mixin(this._provideBinding(this.root),{deepness:-1,selectCount:0,leafCount:0});this._hash={};this.idProperty&&this.autoIdentify&&(this._autoId=1);this._initializeNode(this.root,0);this.data=this.root.children},_provideBinding:function(a){var f=this._getBinding(a);
f||(a[this.bindingProperty]=f={});return f},_getBinding:function(a){return this.bindingProperty?a[this.bindingProperty]:a},_initializeNode:function(a,b){var f=this._provideBinding(a);f.selected=!!f.selected;a.children?(f.selectCount=0,f.leafCount=0,g.forEach(a.children,function(c){this._registerNode(c);var k=this._provideBinding(c);k.parent=a;k.deepness=b;this._initializeNode(c,b+1);f.selectCount+=k.selectCount;f.leafCount+=k.leafCount},this),f.selectCount)?f.selectCount===f.leafCount&&(f.selected=
!0):f.selected=!1:("number"!==typeof f.leafCount&&(f.leafCount=1),f.selectCount=f.selected?f.leafCount:0)},isOwned:function(a,b){return b||a!==this.root?this.get(this.getIdentity(a))===a:!0},_registerNode:function(a){this._autoId&&void 0===a[this.idProperty]&&(a[this.idProperty]=this._autoId++);this.idProperty&&(this._hash[a[this.idProperty]]=a)},_unregisterNode:function(a){this.isOwned(a,!0)&&delete this._hash[a[this.idProperty]]},clear:function(){this.root.children.length&&(g.forEach(this.root.children,
function(a){this._unbindNode(a)},this),this.data=this.root.children=[])},destroy:function(){this.clear()},_unbindNode:function(a){a.children&&g.forEach(a.children,function(a){delete this._getBinding(a).parent;this._unbindNode(a)},this);this._unregisterNode(a);var f=this._getBinding(a);f.parent&&(this._incrementCounts(f.parent,-f.selectCount,-f.leafCount),delete f.parent);f!==a&&delete a[this.bindingProperty]},removeNodes:function(a,b){g.forEach(a&&a.slice(),function(a){if(this.isOwned(a,!0)){var f=
this._getBinding(a).parent,b=g.indexOf(f.children,a);0<=b&&f.children.splice(b,1);this._unbindNode(a)}},this);!b&&this.emit("updated")},addNodes:function(a,b,c){if(!b)b=this.root;else if(!this.isOwned(b)||!b.children)return!1;var f=this._getBinding(b).deepness+1,k=0,d=0;g.forEach(a,function(a){if(!this.isOwned(a)){b.children.push(a);this._registerNode(a);var c=this._provideBinding(a);c.parent=b;c.deepness=f;this._initializeNode(a,f+1);k+=c.selectCount;d+=c.leafCount}},this);this._incrementCounts(b,
k,d);!c&&this.emit("updated");return!0},select:function(a,b){return this.changeSelect(a,!0,b)},deselect:function(a){this.changeSelect(a,!1)},changeSelect:function(a,b,c){c=c||this.root.leafCount;var f=a&&this._getBinding(a);if(f){b=!!b;var k=(b?f.leafCount:0)-f.selectCount,d=0>k||this.root.selectCount+k<=c;if(!a.children)return d&&(f.selected=b,k&&this._incrementCounts(a,k)),d;d&&(f.selected=b);g.forEach(a.children,function(a){this.changeSelect(a,b,c)},this);return d}},_incrementCounts:function(a,
b,c){a=this._getBinding(a);a.selectCount+=b;c&&(a.leafCount+=c);a.selectCount?a.selectCount==a.leafCount&&(a.selected=!0):a.selected=!1;a.parent&&this._incrementCounts(a.parent,b,c)},getSelectionState:function(a){if(!this.isOwned(a))return!1;a=this._getBinding(a);return a.selectCount&&a.selectCount!=a.leafCount?"mixed":a.selected=!!a.selectCount},getSelectedNodes:function(a){return this.getDescendingNodes(this.root,!0,a)},getDescendingNodes:function(a,b,c){if(!this.isOwned(a))return[];var f=[];this._collectNodes(a.children,
f,b,c);return f},_collectNodes:function(a,b,c,k){g.forEach(a,function(a){var f=this._getBinding(a),d=null===c||void 0===c?f.leafCount:c?f.selectCount:f.leafCount-f.selectCount;d&&(!a.children||!k&&d==f.leafCount?b.push(a):this._collectNodes(a.children,b,c,k))},this)},inspectChildren:function(a,b,c,k){k&&(b=h.hitch(k,b));a=a||this.root;(a=a.children)&&c&&(a=a.slice(),a.sort(c));return g.every(a,function(a){var f=b(a);return null===f?!1:!1!==f&&a.children?this.inspectChildren(a,b,c):!0},this)},updateExpandedNodes:function(a,
b){for(var f in this._hash)this.updateExpand(this._hash[f],!!a[f]);this._updateOddEven(null,b)},updateExpand:function(a,b,c,k){if(a){var f=!1;a.children&&(a=this._getBinding(a),a.expanded!==b&&(f=!0,a.expanded=b));b={};f&&c&&this._updateOddEven(b,k);return b}},_updateOddEven:function(a,b){var f=1;this.inspectChildren(null,function(b){!1!==b.visible&&(f=1-f);var c=this._getBinding(b);a&&c.isOdd!==f&&(a[this.getIdentity(b)]=f);c.isOdd=f;return!(!b.children||!c.expanded)},b,this)},isOdd:function(a){return(a=
this._getBinding(a))&&a.isOdd},get:function(a){return this._hash[a]},getIdentity:function(a){return this.idProperty?a[this.idProperty]:null},query:function(a,c){return b(this._query(this.data,a,c))},_query:function(a,b,c){return this.queryEngine(b,c)(a)},filter:function(a){return this._filter(this.data,a)},_filter:function(a,b){a=this._query(a,b);return new k(this.storage,a)},sort:function(a,b){return this._sort(this.data,a,b)},_sort:function(a,b,c){"function"===typeof b?(a=a.slice(),a.sort(b)):(b=
Array.isArray(b)?b.map(function(a){return{attribute:a.property,descending:a.descending}}):[{attribute:b,descending:c}],a=this._query(a,{},{sort:b}));return new k(this.storage,a)},mayHaveChildren:function(a){return!!a.children},getChildren:function(a,c){var f=this.isOwned(a,!0)?a.children:null;a=this.isDstoreTree||c&&c.returnCollection;c=this.queryEngine({},a?null:c)(f||[]);return a?new k(this.storage,c):b(c)},fetch:function(){return this._fetchRange(this.data)},fetchRange:function(a){return this._fetchRange(this.data,
a)},_fetchRange:function(a,b){return c(d(b?a.slice(b.start,b.end):a.slice()),{totalLength:d(a.length)})}})})},"dstore/QueryResults":function(){define(["dojo/_base/lang","dojo/when"],function(l,h){function g(e,d){return h(this,function(b){for(var a=0,c=b.length;a<c;a++)e.call(d,b[a],a,b)})}return function(e,d){var b=d&&"totalLength"in d;if(e.then){e=l.delegate(e);var a=e.then(function(a){var c=b?d.totalLength:a.totalLength||a.length;a.totalLength=c;return!b&&c});e.totalLength=b?d.totalLength:a;e.response=
d&&d.response}else e.totalLength=b?d.totalLength:e.length;e.forEach=g;return e}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/GEUtil":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all dojox/uuid/generateRandomUuid esri/kernel esri/request esri/urlUtils esri/dijit/geoenrichment/utils/CacheUtil esri/dijit/geoenrichment/utils/requests/FileContent esri/dijit/geoenrichment/utils/requests/UniversalClient esri/dijit/geoenrichment/utils/UrlUtil ./stdGeographies/StdGeographiesModel".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q){function t(b){return D?D:(b=b&&a.id.findCredential(b)||a.id.credentials[0])&&b.token}function r(a,b){var f=k.urlToObject(a);b=h.mixin({f:"json",token:t(a),langCode:dojo.locale},f.query||{},b);for(var c in b)a=b[c],a instanceof n||a&&"object"===typeof a&&(b[c]=JSON.stringify("function"===typeof a.toJson?a.toJson():a));return{url:f.path,taskParams:b}}function u(a){z||(z=new y(w));return!a||z.initialized?z:z.initialize()}var y=l(null,{url:null,_geInfo:null,_capabilities:null,
_supportedOperations:null,constructor:function(a){this._capabilities={};this._supportedOperations={};this.url=a},_initDfd:null,initialized:!1,initialize:function(){var a=this;if(this._initDfd)return this._initDfd.promise;this._initDfd=new g;m.requestPublicFirst(r(this.url).url+"/Geoenrichment",{content:{f:"json"},handleAs:"json"},{retryOnAnyError:!0}).then(function(b){a.initWithJson(b)});return this._initDfd.promise},initWithJson:function(a){this._geInfo=a;this._capabilities={};this._supportedOperations=
{};a.capabilities&&a.capabilities.forEach(function(a){this._capabilities[a.toLowerCase()]=!0},this);a.supportedOperations&&a.supportedOperations.forEach(function(a){this._supportedOperations[a.toLowerCase()]=!0},this);this._initDfd=this._initDfd||new g;this._initDfd.resolve();this.initialized=!0},hasCapability:function(a){return!!this._capabilities[a.toLowerCase()]},addCapability:function(a){this._capabilities[a.toLowerCase()]=!0},supportsOperation:function(a){return!!this._supportedOperations[a.toLowerCase()]},
enrich:function(a){a=r(this.url,a);a.taskParams.AddDerivativeVariables="all";return c({url:a.url+"/Geoenrichment/Enrich",content:a.taskParams,handleAs:"json"}).then(function(a){return a.results[0].value.FeatureSet||[]})},stdGeographyQuery:function(a){a=r(this.url,a);return c({url:a.url+"/StandardGeographyQuery/execute",content:a.taskParams,handleAs:"json"}).then(function(a){return a.results[0].value.features||[]})},getDataCollections:function(a,b,f){f=r(this.url,f);return c({url:f.url+"/Geoenrichment/DataCollections/"+
a+(b?"/"+b:""),content:f.taskParams,handleAs:"json"}).then(function(a){return a.DataCollections})},getCountries:function(){var a=r(this.url);return c({url:a.url+"/Geoenrichment/Countries",content:a.taskParams,handleAs:"json"}).then(function(a){return a.countries})},getCountryInfo:function(a){var b=this,k=f.get("GEUtil.countries");if(!k[a]){var n=r(this.url);k[a]=c({url:n.url+"/Geoenrichment/Countries/"+a,content:n.taskParams,handleAs:"json"}).then(function(f){var c=f.countries[0],k={};return d(c.hierarchies.map(function(f){return e(b._getStdGeographyModel(a,
f.ID),function(a){k[f.ID]=a})})).then(function(){return{country:c,geographiesModels:k}})})}return k[a]},_getStdGeographyModel:function(a,b){var k=f.get("GEUtil.stdModels"),d=a+b;if(!k[d]){var e=r(this.url);k[d]=c({url:e.url+"/Geoenrichment/StandardGeographyLevels/"+a+"/"+b,content:e.taskParams,handleAs:"json"}).then(function(f){return new q({countryID:a,hierarchyID:b,levels:f.geographyLevels[0].hierarchies[0].levels})})}return k[d]},formatReport:function(a){a=r(this.url,a);return m.request({url:a.url,
urlSuffix:"Geoenrichment/FormatReport"},{handleAs:"bin",content:a.taskParams}).then(function(a){return a&&a.data&&"text/plain"===a.data.type?null:a})},getReports:function(a){var b=r(this.url);return c({url:b.url+"/Geoenrichment/reports/"+a,content:b.taskParams,handleAs:"json"}).then(function(a){return a.reports})},createReport:function(a){var c=r(this.url,a),k=b();f.get("GEUtil.tasks")[k]={taskName:"createReport",taskParams:h.clone(a)};return m.request({url:c.url,urlSuffix:"Geoenrichment/createReport"},
{handleAs:"xml"===a.format?"text":"bin",content:c.taskParams}).then(function(a){return{taskID:k,result:a}})},consumeCredits:function(a){if(a=f.get("GEUtil.tasks")[a])return a=h.clone(a),delete a.taskParams.forStorage,this[a.taskName](a.taskParams)},getLayerInfos:function(a){var b=f.get("GEUtil.dataLayers");b[a]||(b[a]=this._getLayerInfos(a));return b[a]},_getLayerInfos:function(a){var b=r(this.url);return c({url:b.url+"/Geoenrichment/DataLayers/"+a,content:b.taskParams,handleAs:"json"}).then(function(a){return a&&
a.layers||[]}).otherwise(function(a){console.log(a);return[]})},getLayerInfo:function(a,b){var c=f.get("GEUtil.dataLayers"),k=a+"_"+b;c[k]||(c[k]=this._getLayerInfo(a,b));return c[k]},_getLayerInfo:function(a,b){var f=r(this.url);return c({url:f.url+"/Geoenrichment/DataLayers/"+a+"/"+b,content:f.taskParams,handleAs:"json"}).then(function(a){return a&&a.layer}).otherwise(function(a){console.log(a);return null})}}),v={},w,D,B=new g;v.setGeoenrichmentUrl=function(a,b){(w=a||w)&&p.registerCORS(w);D=b||
D;!B.promise.isFulfilled()&&B.resolve()};v.canMakeRequests=function(){return!!w};v.getInitPromise=function(){return B.promise};v.GEClient=y;var z;v.getClient=function(){return u()};v.initialize=function(){return e(u(!0))};v.initWithJson=function(a,b){v.setGeoenrichmentUrl(a);u().initWithJson(b)};v.enrich=function(a){return u().enrich(a)};v.stdGeographyQuery=function(a){return u().stdGeographyQuery(a)};v.getDataCollections=function(a,b,f){return u().getDataCollections(a,b,f)};v.formatReport=function(a){return u().formatReport(a)};
v.createReport=function(a){return u().createReport(a)};v.consumeCredits=function(a){return u().consumeCredits(a)};v.getLayerInfos=function(a){return u().getLayerInfos(a)};v.hasCapability=function(a){return e(u(!0),function(){return z&&z.hasCapability(a)})};v.addCapability=function(a){return u().addCapability(a)};v.supportsOperation=function(a){return e(u(!0),function(){return z&&z.supportsOperation(a)})};v.getCountryInfo=function(a){return u().getCountryInfo(a)};return v})},"esri/dijit/geoenrichment/promise/all":function(){define(["dojo/promise/all"],
function(l){return l})},"dojox/uuid/generateRandomUuid":function(){define(["./_base"],function(){dojox.uuid.generateRandomUuid=function(){function l(){for(var b=Math.floor(Math.random()%1*Math.pow(2,32)).toString(16);8>b.length;)b="0"+b;return b}var h=l(),g=l(),g=g.substring(0,4)+"-4"+g.substring(5,8),e=l(),e="8"+e.substring(1,4)+"-"+e.substring(4,8),d=l();return(h+"-"+g+"-"+e+d).toLowerCase()};return dojox.uuid.generateRandomUuid})},"dojox/uuid/_base":function(){define(["dojo/_base/kernel","dojo/_base/lang"],
function(l){l.getObject("uuid",!0,dojox);dojox.uuid.NIL_UUID="00000000-0000-0000-0000-000000000000";dojox.uuid.version={UNKNOWN:0,TIME_BASED:1,DCE_SECURITY:2,NAME_BASED_MD5:3,RANDOM:4,NAME_BASED_SHA1:5};dojox.uuid.variant={NCS:"0",DCE:"10",MICROSOFT:"110",UNKNOWN:"111"};dojox.uuid.assert=function(h,g){if(!h)throw g||(g="An assert statement failed.\nThe method dojox.uuid.assert() was called with a 'false' value.\n"),Error(g);};dojox.uuid.generateNilUuid=function(){return dojox.uuid.NIL_UUID};dojox.uuid.isValid=
function(h){h=h.toString();var g=l.isString(h)&&36==h.length&&h==h.toLowerCase();if(g){h=h.split("-");var g=5==h.length&&8==h[0].length&&4==h[1].length&&4==h[2].length&&4==h[3].length&&12==h[4].length,e;for(e in h)var d=parseInt(h[e],16),g=g&&isFinite(d)}return g};dojox.uuid.getVariant=function(h){if(!dojox.uuid._ourVariantLookupTable){var g=dojox.uuid.variant,e=[];e[0]=g.NCS;e[1]=g.NCS;e[2]=g.NCS;e[3]=g.NCS;e[4]=g.NCS;e[5]=g.NCS;e[6]=g.NCS;e[7]=g.NCS;e[8]=g.DCE;e[9]=g.DCE;e[10]=g.DCE;e[11]=g.DCE;
e[12]=g.MICROSOFT;e[13]=g.MICROSOFT;e[14]=g.UNKNOWN;e[15]=g.UNKNOWN;dojox.uuid._ourVariantLookupTable=e}h=h.toString();h=h.charAt(19);h=parseInt(h,16);dojox.uuid.assert(0<=h&&16>=h);return dojox.uuid._ourVariantLookupTable[h]};dojox.uuid.getVersion=function(h){dojox.uuid.assert(dojox.uuid.getVariant(h)==dojox.uuid.variant.DCE,"dojox.uuid.getVersion() was not passed a DCE Variant UUID.");h=h.toString();h=h.charAt(14);return parseInt(h,16)};dojox.uuid.getNode=function(h){dojox.uuid.assert(dojox.uuid.getVersion(h)==
dojox.uuid.version.TIME_BASED,"dojox.uuid.getNode() was not passed a TIME_BASED UUID.");h=h.toString();return h.split("-")[4]};dojox.uuid.getTimestamp=function(h,g){dojox.uuid.assert(dojox.uuid.getVersion(h)==dojox.uuid.version.TIME_BASED,"dojox.uuid.getTimestamp() was not passed a TIME_BASED UUID.");h=h.toString();g||(g=null);switch(g){case "string":case String:return dojox.uuid.getTimestamp(h,Date).toUTCString();case "hex":var e=h.split("-");h=e[0];g=e[1];e=e[2];e=e.slice(1);h=e+g+h;dojox.uuid.assert(15==
h.length);return h;case null:case "date":case Date:return e=h.split("-"),h=parseInt(e[0],16),g=parseInt(e[1],16),e=(parseInt(e[2],16)&4095)<<16,e=4294967296*(e+g),e+=h,new Date(e/1E4-122192928E5);default:dojox.uuid.assert(!1,"dojox.uuid.getTimestamp was not passed a valid returnType: "+g)}};return dojox.uuid})},"esri/dijit/geoenrichment/utils/CacheUtil":function(){define([],function(){var l={},h={};l.get=function(g,e){var d=h[g];d||e||(d=h[g]={});return d};l.set=function(g,e){return h[g]=e};l.clear=
function(g,e){h={}};return l})},"esri/dijit/geoenrichment/utils/requests/FileContent":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/utils/DataUtil"],function(l,h){function g(d){return d?/^image\//.test(d)?"base64":/^text\//.test(d)?"text":/application\/json/.test(d)?"json":"bin":"bin"}var e=l(null,{data:null,filename:null,contentType:"application/octet-stream",contentTransferEncoding:"binary",constructor:function(d,b,a){this.data=d;b&&(this.contentType=b);a&&(this.contentTransferEncoding=
a)},getBase64Data:function(){return this.data?"base64"==this.contentTransferEncoding?this.data:h.base64FromByteSource(this.data):null},toString:function(){return this.filename||"\x3cunknown\x3e"}});e.fromArrayBuffer=function(d,b){return new e(h.binaryStringFromByteSource(d),b)};e.fromBlob=function(d,b){return h.arrayBufferFromBlob(d).then(function(a){return new e(h.binaryStringFromByteSource(a),b||d.type)})};e.fromFileData=function(d,b,a){a=a||h.getContentType(d);if("object"==typeof b&&window.ArrayBuffer&&
(b instanceof ArrayBuffer||b.buffer instanceof ArrayBuffer))b=h.binaryStringFromByteSource(b.buffer||b);else{var c=g(a);"json"==c&&"object"==typeof b&&(b=JSON.stringify(b));if("string"!=typeof b)throw Error("Wrong file data.");switch(c){case "base64":b=atob(b);break;case "text":case "json":b=unescape(encodeURIComponent(b))}}b=new e(b,a);b.filename=d;return b};e.getContentConversionType=g;return e})},"esri/dijit/geoenrichment/utils/requests/UniversalClient":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred dojo/request/xhr dojo/io-query dojo/sniff esri/dijit/geoenrichment/when esri/kernel esri/config esri/lang esri/urlUtils ../UrlUtil ./BinaryData ./FileContent ./MultipartDataBuilder ./ErrorUtil".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q,t){function r(a,b){if(b)this.reject(b);else{b=a.xhr;var f=b.getResponseHeader&&b.getResponseHeader("Content-Type");a.status=b.status;a.data=new m(b.response||b.responseBody||b.responseText,f);this.resolve(a)}}var u=0,y=d("safari"),v=function(a){"string"===typeof a?this.url=a:"object"===typeof a&&l.mixin(this,a)};v.prototype={url:null,preventCache:null,usePost:!1,timeout:0,multipartThreshold:0,useCommonAuth:!1,useProxy:!1,allowSSL:null,send:function(a,b){return this.sendUrlRequest(this.prepareUrlRequest(a,
b),"UniversalClient.send")},prepareUrlRequest:function(b,d){"string"===typeof b?b={urlSuffix:b}:b||(b={});d||(d={});var g=b.url||this.url;b=b.urlSuffix;g||(g=b,b=null);if(!g)throw Error("URL is missing.");var m=f.urlToObject(g),g=n.combine(m.path,b);b=m.query||{};"object"===typeof d.content&&(b=l.mixin(b,d.content));m=d.requireSSL;!0!==m&&!1===this.allowSSL&&(m=!1);!1!==m&&!0===this.allowSSL&&/^https/i.test(window.location.protocol)&&(m=!0);if(a.id){var h=a.id.findCredential(g);!h&&this.useCommonAuth&&
(h="string"==typeof this.useCommonAuth?a.id.findCredential(this.useCommonAuth):a.id.credentials[0]);h&&(b.token||!1===b.token||(b.token=h.token),h.ssl&&!1!==m&&(m=!0))}!0===m&&(g=n.toHttpsUrl(g));!1===b.token&&delete b.token;var t=d.handleAs||"json";"json"===t&&(b.f="json");var h=(d.sendAs||(d.usePost||this.usePost||b.token?"post":"get")).toLowerCase(),m="multipart"==h?!0:d.sendAs||d.sizeLimit?!1:null,r=0,v;for(v in b){var w=b[v];if(w instanceof p)m=!0;else{var B=0,D=v.length;"object"===typeof w?
d.allowMultipleValues&&Array.isArray(w)?b[v]=w.map(function(a){a="object"===typeof a?JSON.stringify(a):a;B+=D+a+2;return a}):(b[v]=JSON.stringify(w),B+=D+b[v].length+2):B=D+(w?w.length:0)+2;!m&&0<this.multipartThreshold&&(r+=B)}}!1!==m&&0<this.multipartThreshold&&r>this.multipartThreshold&&(m=!0);if(d.useProxy||!f.hasSameOrigin(g,window.location.href)&&this.useProxy&&!d.hasOwnProperty("useProxy")){var I=n.getProxyUrl();I&&(g=I+"?"+g)}else f.getProxyRule(g)&&(g=f.getProxyRule(g).proxyUrl+"?"+g);v=
(v=d.hasOwnProperty("preventCache")?d.preventCache:this.preventCache)||null===v&&I||y?"_ts\x3d"+(new Date).getTime()+u++:"";I={handleAs:t};if(t=Number(k.isDefined(d.timeout)?d.timeout:this.timeout))I.timeout=t;t="get"!==h||m;h=m?null:e.objectToQuery(b);t||(t=h.length+g.length+v.length+1>=c.defaults.io.postLength);I.method=t?"POST":"GET";I.headers={"X-Requested-With":null};I.headers["Content-Type"]="undefined"!==typeof d.contentType?d.contentType:"application/x-www-form-urlencoded; charset\x3dutf-8";
m?(m=new q,m.addVariables(b),m.build(I)):t?I.data=h:h&&(g+="?"+h,v&&(g+="\x26"+v),v=null);!h&&v&&(g+="?"+v);return{url:g,options:I,sizeLimit:d.sizeLimit}},sendUrlRequest:function(a,f){var c="string"===typeof a.options.data?a.options.data.length:null;if(a.sizeLimit&&c&&("function"===typeof a.sizeLimit?a.sizeLimit(c):c>a.sizeLimit))return(new h).reject(Error("SIZE_LIMIT_EXCEEDED"));f=f||"UniversalClient.sendUrlRequest";var k=a.deferred||new h;if(c="bin"===a.options.handleAs)a.options.handleAs="blob";
var d=g(a.url,a.options,!0);c&&(d.handleResponse=r);var e=this;d.then(function(c){c="json"===a.options.handleAs&&c&&t.parseError(c)||c;if(c instanceof Error){var d;!0===e.useCommonAuth&&498===c.code&&(d=v.handleInvalidTokenError(c));b(d)["finally"](function(){k.reject(c)})}else k.resolve(e._makeResponse(f,c))},function(a){k.reject(t.makeError(a))});return k.promise},requestToUrl:function(a){if(a.options.headers&&a.options.headers["Content-Type"]&&0==a.options.headers["Content-Type"].indexOf("multipart/form-data"))return null;
var b=a.url;if(a=a.options.data){if(b.length+a.length>=c.defaults.io.postLength)return null;b+="?"+a}return b},_makeResponse:function(a,b){return b}};v.makeError=t.makeError;v.handleInvalidTokenError=function(a){};var w=new v({useCommonAuth:!0,allowSSL:!0});v.request=function(a,b){return w.send(a,b).otherwise(function(f){var c=b&&b.content&&b.content.token;if(498!==f.code||null!=c)return(new h).reject(f);b=l.mixin({},b);b.content=l.mixin({},b.content);b.content.token=!1;return w.send(a,b)})};v.requestPublicFirst=
function(a,b,f){var c=l.mixin({},b);c.content=l.mixin({},b.content);c.content.token=!1;return w.send(a,c).otherwise(function(c){return f&&f.retryOnAnyError||499===c.code||403===c.code?w.send(a,b):(new h).reject(c)})};return v})},"esri/dijit/geoenrichment/utils/requests/BinaryData":function(){define(["dojo/_base/declare"],function(l){return l(null,{data:null,type:null,constructor:function(h,g){this.type=g||h&&h.type||null;this.data=h}})})},"esri/dijit/geoenrichment/utils/requests/MultipartDataBuilder":function(){define(["dojo/_base/declare",
"dojo/request/util","esri/lang","./FileContent"],function(l,h,g,e){var d=l(null,{data:null,constructor:function(a){this.data=a}}),b=h.parseArgs;h.parseArgs=function(a,k,f){k.data&&k.data instanceof d&&(k.data=k.data.data,f=!0);return b(a,k,f)};var a=h.deepCreate;h.deepCreate=function(b,k){return k instanceof d?new d(k.data):a(b,k)};return l(null,{addVariables:function(a){for(var b in a)this.addVariable(b,a[b])},addVariable:function(a,b){g.isDefined(b)&&(b instanceof e?this._writeFileContent(a,b):
this._writeVariable(a,b.toString()))},build:function(a){this._writeBoundary(!0);a.data=new d(this._prepareBinaryData());var b=a.headers||{};b["Content-Type"]="multipart/form-data; boundary\x3d"+this._dataProvider.boundary;a.headers=b;this._dataProvider=null},_prepareBinaryData:function(){var a=this._dataProvider.buffer;if(!window.Uint8Array)return a;for(var b=a.length,f=new Uint8Array(new ArrayBuffer(b)),d=0;d<b;d++)f[d]=a.charCodeAt(d);return f},_dataProvider:null,_getDataProvider:function(){if(!this._dataProvider){for(var a=
"",b=0;32>b;b++)a+=String.fromCharCode(Math.floor(97+25*Math.random()));this._dataProvider={buffer:"",boundary:a}}return this._dataProvider},_writeVariable:function(a,b){this._writeBoundary();this._writeContentDisposition(a);this._writeLineBreak();this._writeData(this._toUTF8(b));this._writeLineBreak()},_writeFileContent:function(a,b){this._writeBoundary();this._writeContentDisposition(a,b.filename);b.contentType&&(this._writeData("Content-Type: "+b.contentType),this._writeLineBreak());b.contentTransferEncoding&&
(this._writeData("Content-Transfer-Encoding: "+b.contentTransferEncoding),this._writeLineBreak());this._writeLineBreak();this._writeData(b.data);this._writeLineBreak()},_writeBoundary:function(a){this._writeDoubleDash();this._writeData(this._getDataProvider().boundary);a?this._writeDoubleDash():this._writeLineBreak()},_writeContentDisposition:function(a,b){b=b?'"; filename\x3d"'+this._toUTF8(b.replace(/"/g,"'")):"";this._writeData('Content-Disposition: form-data; name\x3d"'+this._toUTF8(a)+b+'"');
this._writeLineBreak()},_writeDoubleDash:function(){this._writeData("--")},_writeLineBreak:function(){this._writeData("\r\n")},_writeData:function(a){this._getDataProvider().buffer+=a},_toUTF8:function(a){return unescape(encodeURIComponent(a))}})})},"esri/dijit/geoenrichment/utils/requests/ErrorUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","require"],function(l,h,g){function e(b){var a=new l;g(["./DataResource"],function(c){h((new c(b)).getFileContent(),
a.resolve,a.reject)});return a.promise}var d={getErrorFromBin:function(b){var a=/^text\/|^application\/json/;return b&&b.type&&!a.test(b.type)?null:h(b&&e(b),function(b){if(b){if(b.hasOwnProperty("contentType")&&!a.test(b.contentType))return null;try{var c=JSON.parse(decodeURIComponent(escape(b.data))),f=d.parseError(c);if(f)return f;if(c.messages&&c.messages.length){var e=c.messages[0];if("esriJobMessageTypeError"==e.type)return Error(e.description)}}catch(m){}}return Error("Binary data error.")})},
parseError:function(b){var a;b.error?a=d.makeError(b.error):"error"===b.status&&(a=d.makeError(b));a&&a.code&&null==a.httpCode&&(a.httpCode=a.code);return a},makeError:function(b){null==b?b=Error():"string"===typeof b&&(b={message:b});if(!(b instanceof Error)&&"object"===typeof b){var a=b;b=Error();a.code&&(b.code=a.code);a.message&&(b.message=a.message);a.details&&(b.details=a.details)}b.log=dojoConfig.isDebug;return b}};return d})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/stdGeographies/StdGeographiesModel":function(){define(["dojo/_base/declare"],
function(l){return l(null,{_levelsCache:null,_levels:null,constructor:function(h){this._initWithLevels(h.levels)},_initWithLevels:function(h){this._levels=h;this._levelsCache={};this._levels.forEach(function(g){delete g.description;this._levelsCache[g.id]=g;g.adminLevel&&(this._levelsCache[g.adminLevel]=g)},this)},getLevels:function(h){return h?this._levels.filter(function(g){return!g.isWholeCountry}):this._levels.slice()},getLevel:function(h){return this._levelsCache[h]},getLevelPluralName:function(h){return(h=
this.getLevel(h))?h.name||h.pluralName:null},toJson:function(){return{levels:this._levels}}})})},"esri/dijit/geoenrichment/ReportPlayer/ReportPlayer":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when dojo/on dojo/keys dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin ./config ./playerSupports/_CommandSupport ./playerSupports/_LogoSupport ./playerSupports/_MapSupport ./playerSupports/_PageNavigationSupport ./playerSupports/_PrintSupport ./playerSupports/_ReportContainersSwitcher ./playerSupports/_SmartLayoutSupport ./playerSupports/_ZoomSupport ./playerSupports/_WaitingSupport ./supportClasses/PlayerConfigurator ./supportClasses/PlayerToFullScreenAnimator ./toolbar/PlayerToolbar ./ReportPlayerViewModel ./PlayerResizeModes ./PlayerThemes ./PlayerViewModes ./ReportPlayerState ./PlayerZoomBehaviors ./DataProviderGE ./dataProvider/commands/supportClasses/LayoutXMLBuilder esri/dijit/geoenrichment/utils/DelayUtil esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/InvokeUtil esri/dijit/geoenrichment/utils/async/AsyncQueue dojo/text!./templates/ReportPlayer.html dojo/i18n!esri/nls/jsapi ./_devConfig".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q,t,r,u,y,v,w,D,B,z,C,E,A,F,G,H,J,L,I,P,N,S,O,Q,K,M){K=K.geoenrichment.dijit.ReportPlayer.ReportPlayer;return l([k,f,m,p,q,r,u,y,v,t,w],{templateString:Q,nls:K,isPlayer:!0,dataProvider:null,exportCommands:null,config:null,theme:void 0,viewMode:void 0,enableDataDrilling:!0,showToolbarInPopup:!1,showAreaTitle:void 0,showReportTitle:!1,scaleSlidesToFitWindow:void 0,showCloseButton:!1,showToFullScreenAnimation:!1,canAddMoreAreas:!1,areasSelectButtons:null,resizeMode:void 0,
printConfig:{subtitle:K.preparedByEsri,printDialogClass:"esri/dijit/geoenrichment/ReportPlayer/printing/PageOptionsDialog/PageOptionsDialog"},showProgressBar:!0,defaultZoomBehavior:void 0,nlsMap:null,isDataDrillingPlayer:!1,isPlayerOnServer:!1,_viewModel:null,_reportData:null,_analysisAreaIndex:0,_originalAreaViewMode:null,_showAllAreasSideBySide:!1,playerToolbar:null,postCreate:function(){this.config=h.mixin(n,this.config);if(n.isPlayerOnServer=this.isPlayerOnServer)n.maps.maxNumberOfMapsShownAtTheSameTime=
1E6,this.defaultZoomBehavior=H.RESET;this._viewModel=new (this._getViewModelClass());this._setUpDataProvider();D.configurePlayer(this);!this.isPlayerOnServer&&this._initToolbar();this._initContainerSwither();!this.isPlayerOnServer&&this._initSmartLayout();!this.isPlayerOnServer&&this._initCommands();!this.isPlayerOnServer&&this._initPageNavigationControls();!this.isPlayerOnServer&&this._initZoomControls();!this.isPlayerOnServer&&this._applyTheme();!this.isPlayerOnServer&&this._showError(!1);!this.isPlayerOnServer&&
this._initProgressController();P.isMobileDevice()&&(c.add(this.domNode,"esriGEReportPlayerMobile"),this._setUpMobileOrientationHandling());this._updateElementsVisibility()},_setUpDataProvider:function(){this.dataProvider=this.dataProvider||new J;this.exportCommands&&this.exportCommands.forEach(function(a){this.dataProvider.registerCommand(a)},this)},_orientationDfd:null,_setUpMobileOrientationHandling:function(){var a=this;this.own(b(window,"orientationchange",function(){a._orientationDfd&&a._orientationDfd.resolve("cancel");
var b=a._orientationDfd=new e;a._showWaiting(b.promise,"orientationchange");b.promise.then(function(b){"cancel"!==b&&(a._setViewMode(null),a.refresh())});d(a.getRenderPromise(),function(){I.delay(500).then(b.resolve,b.resolve)})}))},_getViewModelClass:function(){return C},_setViewMode:function(a){D.configurePlayer(this,a);this._refreshZoomControls()},_initToolbar:function(){var f=this;this.playerToolbar=(new z({player:this,popupButtonDiv:this.playerAfterToolbarDiv,showToolbarInPopup:this.showToolbarInPopup,
showAreaTitle:this.showAreaTitle,stretchToolbarNode:!this.showToolbarInPopup&&(this.resizeMode===E.FIT_WINDOW?document.body:this.domNode),showCloseButton:this.showCloseButton,canAddMoreAreas:this.canAddMoreAreas,areasSelectButtons:this.areasSelectButtons,onShowAnalysisAreaAt:function(a){f.showAnalysisAreaAt(a)},onCompareAreasSideBySide:function(){f.showAllAnalysisAreasSideBySide()},onShowPageAt:function(a){f.showPageAt(a)},isScrollShown:function(){var a=f.getCurrentReportContainer();return a&&a.isScrollShown&&
a.isScrollShown()},onClose:function(){f._onClose()},onAddMoreAreas:function(){f.onAddMoreAreas()},onRemoveAreas:function(a){f.onAreasPreRemoved(a);a.forEach(function(a){a.hidden=!0});if(f.viewMode===F.PANELS_IN_STACK_ALL)if(2>f.getAnalysisAreas().filter(function(a){return!a.hidden}).length)f._setAllAreasVisible(!1);else{var b={};a.forEach(function(a){b[a.index]=!1});f.getCurrentReportContainer().setAreasVisibilityState(b,{append:!0});f._updateAreaSelect()}else if(f.getCurrentAnalysisArea().hidden){var c=
f.getAnalysisAreas().filter(function(a){return!a.hidden})[0];c?f.showAnalysisAreaAt(c.index):f.refresh()}else f._updateAreaSelect();f.onAreasRemoved(a)}})).placeAt(this.playerToolbarDiv);this.own(this.playerToolbar);this.showCloseButton&&this.own(b(window,"keyup",function(b){f.getWaitingPromise()||G.isViewingDataDrillingZoom||G.isImageViewerShown||b.keyCode===a.ESCAPE&&f._onClose()}))},_applyTheme:function(){c.remove(this.domNode,"playerThemeDark playerThemeLight");c.add(this.domNode,this.theme===
A.DARK?"playerThemeDark":"playerThemeLight");this.playerToolbar.setTheme(this.theme)},playReport:function(a,b){return this._showWaiting(this._callAfterRendering("_doPlayReport",[a,b]),"playReport")},_doPlayReport:function(a,b){this.playerToolbar&&this.playerToolbar.closePopup();var f=this;this._showError(!1);this._progressController&&this._progressController.reset();this.showToFullScreenAnimation&&this.resizeMode===E.FIT_WINDOW&&B.animateTo(this);this.dataProvider._onCreateReportStarted=function(){f._viewModel.preInitialize()};
this._viewModel.reset();return d(this.dataProvider.getReportData(a,{progressCallback:function(a){f._progressController&&f._progressController.setLoadDataProgress(a)}}),function(a){if(f.viewMode===F.PANELS_IN_STACK_ALL){var c=f.viewMode;1<a.analysisAreas.length&&!a.isMultiFeature?f._originalAreaViewMode||(f._showAllAreasSideBySide=!0,f._originalAreaViewMode=D.getDefaultViewMode(f)):(f._showAllAreasSideBySide=!1,c=f._originalAreaViewMode||D.getDefaultViewMode(f));f._setViewMode(c)}return f.setReportData(a,
b)},function(a){f._showError(a)})},refresh:function(a){return this._reportData&&d(this.setReportData(this._reportData,{waitUntilAllContentIsReady:!(!a||!a.waitUntilAllContentIsReady)}),function(){this.showPageAt(0);return this.resize()}.bind(this))},_isDataBeingSetFlag:!1,_notifyShownPendingFlag:!1,setReportData:function(a,b){return this._showWaiting(this._callAfterRendering("_doSetReportData",[a,b]),"setReportData")},setReportDataAndExport:function(a,b){var f=this;if(a.reportObject.isMultiFeature)return this.setReportData(a,
{waitUntilAllContentIsReady:!0,disableAnimation:!0}).then(function(){return f.executeCommand(b.commandId,b.commandParams)});var c=function(){var e=f.dataProvider.reportDataToSingleAreaReportData(a,{currentFeatureIndex:n,reportTitle:a.reportTitle,templateJson:a.templateJson});f.setReportData(e,{waitUntilAllContentIsReady:!0,disableAnimation:!0}).then(function(){var e=h.mixin({},b.commandParams);e.pageNumerationInfo={startAreaIndex:n,numAreas:a.analysisAreas.length};return d(f.executeCommand(b.commandId,
e)).then(function(b){g.push(b);++n===a.analysisAreas.length?k.resolve(L.stitchDocuments(g)):setTimeout(c)})})},k=new e,n=0,g=[];c();return k.promise},_doSetReportData:function(a,b){var f=this;b=b||{};this._reportData=a;M.emulateErrors.playerError&&(a=null);if(!a||M.emulateErrors.emptyDataProviderResponse)this._showError(!0);else{this._isDataBeingSetFlag=!0;G.isAnimationSuspended=!0;this.onSetReportDataStart();var c=new e;this._viewModel.setAnimationAllowed(!b.disableAnimation);this._configureViewModel(a);
(f.isPlayerOnServer?d():I.delay(0)).then(function(){if(1===a.analysisAreas.length||a.isMultiFeature)f._destroyAllContainers(),f._resetMapBuilder(),f._applyReportData({analysisAreaIndex:0,rerenderContent:!0}).then(c.resolve,c.reject);else{var k=function(){for(;0<=e&&a.analysisAreas[e].hidden;)e--;0>e?c.resolve():f._applyReportData({analysisAreaIndex:e--,rerenderContent:!1,isFinalArea:0>e}).then(function(){(f.isPlayerOnServer?d():I.delay(0)).then(k)},c.reject)};!1!==b._resetLoadedContents&&(f._destroyAllContainers(),
f._resetMapBuilder());var e=a.analysisAreas.length-1;k()}});this._progressController&&this._progressController.setNumAreas(a.analysisAreas.length);this._progressController&&this._progressController.setLoadDataProgress(1);return c.promise.then(function(){return f._progressController&&f._progressController.finalize()}).otherwise(function(a){f._showError(a)}).always(function(){var a=f.getCurrentReportContainer();if(a&&a.domNode)return(f.isPlayerOnServer?d():I.delay(300)).then(function(){f._isDataBeingSetFlag=
!1;f._notifyShownPendingFlag=!N.isNodeInLayout(f.domNode);G.isAnimationSuspended=f.isPlayerOnServer;f.onSetReportDataEnd();f._emitPendingResizedEvent();f._progressController&&f._progressController.reset();if(b.waitUntilAllContentIsReady)return f.getRenderPromise()})})}},showAnalysisAreaAt:function(a){return this._callAfterRendering("_doShowAnalysisAreaAt",[a])},_doShowAnalysisAreaAt:function(a){var b=this;return d(this._setAllAreasVisible(!1),function(){if(b._analysisAreaIndex!==a&&b.getAnalysisAreas()[a]&&
!b.getAnalysisAreas()[a].hidden)return b._applyReportData({analysisAreaIndex:a,rerenderContent:!1})})},showAllAnalysisAreasSideBySide:function(){return this._callAfterRendering("_doShowAllAnalysisAreasSideBySide")},_doShowAllAnalysisAreasSideBySide:function(){return this._setAllAreasVisible(!0)},_setAllAreasVisible:function(a){if(this._showAllAreasSideBySide!==a)return a?(this._showAllAreasSideBySide=!0,this._originalAreaViewMode=this.viewMode===F.PANELS_IN_STACK_ALL?D.getDefaultViewMode(this):this.viewMode,
this._setViewMode(F.PANELS_IN_STACK_ALL)):(this._showAllAreasSideBySide=!1,this._setViewMode(this._originalAreaViewMode),this._originalAreaViewMode=null),this.refresh()},_applyReportData:function(a){var b=this;a=a||{};var f=this._reportData&&this._reportData.isMultiFeature?0:a.analysisAreaIndex||0,c=!1!==a.rerenderContent;this._analysisAreaIndex=f;this._showError(!this._reportData);if(this._reportData)return d(this._viewModel.initialize(!this._reportData.reportObject.isGraphicReport,this.viewMode),
function(){return b._setReportContainer(c)?b._doApplyTemplateJson({analysisAreaIndex:f,isFinalArea:a.isFinalArea}):b._updateAreaSelect()})},_doApplyTemplateJson:function(a){var b=this,f=this.getCurrentReportContainer(),c=h.clone(this._reportData.templateJson);M.emulateErrors.emptyTemplateJson&&(c.sectionsTables.length=0);var k=f.fromJson(c,{waitUntilAllContentIsReady:!0,progressCallback:function(f){b._progressController&&b._progressController.setProgressForAreaAt(f,a.analysisAreaIndex)},analysisAreaIndex:a.analysisAreaIndex,
isFinalArea:a.isFinalArea,renderSync:this.isPlayerOnServer}),c=f.getPagePromise?f.getPagePromise():k,f=f.getContentPromise?f.getContentPromise():k;this._registerContainerLoadPromise(f||c);this._updateAreaSelect();return d(c,function(){b._setCurrentContainerLoaded();b.showPageAt(b._currentPageIndex);return b.resize()})},_updateAreaSelect:function(){this.playerToolbar&&this.playerToolbar.updateAreaSelect({analysisAreas:this._reportData.analysisAreas,combinedAreasInfo:this._reportData.combinedAreasInfo,
currentAreaIndex:this._showAllAreasSideBySide?"all":this.getCurrentAnalysisAreaIndex(),isMultiFeature:this._reportData.isMultiFeature})},getReportData:function(){return this._reportData},getReportTitle:function(){return this._reportData&&this._reportData.reportTitle||""},getCurrentAnalysisAreaIndex:function(){return this._analysisAreaIndex},getCurrentAnalysisArea:function(){return this._reportData&&this._reportData.analysisAreas[this._analysisAreaIndex]},getAnalysisAreas:function(){return this._reportData&&
this._reportData.analysisAreas},reportDataToJson:function(a){return this._showWaiting(this.dataProvider.reportDataToJson(this.getReportData(),a),"reportDataToJson")},reportDataFromJson:function(a,b){var f=this;this._showError(!1);return this._showWaiting(d(this.dataProvider.reportDataFromJson(a),function(a){return f.setReportData(a,b)}),"reportDataFromJson")},_configureViewModel:function(a){this._viewModel.setTheme(this._reportData.templateJson.theme);this._viewModel.enableDataDrilling=!this.isPlayerOnServer&&
this.enableDataDrilling;this._viewModel.setDynamicReportInfo({fieldData:this._reportData.fieldData,analysisAreas:this._reportData.analysisAreas,combinedAreasInfo:this._reportData.combinedAreasInfo,attachmentsStore:this._reportData.attachmentsStore,createMapFunc:h.hitch(this,this._createMap),reportObject:this._reportData.reportObject,isMultiFeature:this._reportData.isMultiFeature,isFixedDataMode:!this._reportData.config.geoenrichmentUrl,geClient:this._reportData.geClient,templateVariableProvider:this._reportData.templateVariableProvider,
countryID:this._reportData.config.countryID,hierarchy:this._reportData.config.hierarchy,templateJson:this._reportData.templateJson});this._viewModel.getDynamicImageFunc=h.hitch(this,this._getReportLogo)},notifyShown:function(){!this._isDataBeingSetFlag&&this._notifyShownPendingFlag&&(this.getCurrentReportContainer()&&this.getCurrentReportContainer().notifyShown(),this._notifyShownPendingFlag=!1)},_isErrorShown:!1,_showError:function(a){this.errorViewDiv&&N.destroy(this.errorViewDiv);this.errorViewDiv=
null;N[a?"hide":"show"](this.printableDivContainer);c[a?"add":"remove"](this.domNode,"esriGEReportPlayerError");this._isErrorShown=!!a;this._updateElementsVisibility();a?(this.errorViewDiv=N.create("div",{"class":"esriGEReportPlayerErrorMessage",innerHTML:K.cantPlayReportError},this.domNode),this.playerToolbar&&this.playerToolbar.setErrorShown(!0),this._progressController&&this._progressController.reset(),console.log(a),this.onError(a)):this.playerToolbar&&this.playerToolbar.setErrorShown(!1)},isErrorShown:function(){return this._isErrorShown},
_updateElementsVisibility:function(){var a=0<this._waitingCount?!1:this._reportData||this._isErrorShown,b=0<this._waitingCount||this._isErrorShown?!1:!0,f=0<this._waitingCount||this._isErrorShown?!1:!0;this.playerToolbarDiv&&(this.playerToolbarDiv.style.opacity=a?"":"0.001");this.sidePageNavigator&&(this.sidePageNavigator.style.opacity=b?"":"0.001");this.reportContainerDiv.style.opacity=f?"":"0.001"},setPrintMode:function(a){c[a?"add":"remove"](this.domNode,"esriGEReportPlayerInPrinting")},resize:function(a,
b){this._resize({width:a,height:b});this._updatePageNavigator();this._updateZoomControls();this.playerToolbar&&this.playerToolbar.update()},_pendingResizeEvent:null,_emitResizedEvent:function(a){this._pendingResizeEvent={isPaginating:!!a};this._isDataBeingSetFlag||this._emitPendingResizedEvent()},_emitPendingResizedEvent:function(){this._pendingResizeEvent&&(this.onResized(this._pendingResizeEvent.isPaginating),this._pendingResizeEvent=null)},_onClose:function(){var a;this.showToFullScreenAnimation&&
this.resizeMode===E.FIT_WINDOW&&(a=B.animateFrom(this));d(a,function(){this.onClose()}.bind(this))},getVisualState:function(){return{type:"reportPlayer",viewMode:this.viewMode,reportContainers:this.getAllReportContainers().map(function(a){return a.getVisualState&&a.getVisualState()})}},setVisualState:function(a){return this._callAfterRendering("_doSetVisualState",[a])},_doSetVisualState:function(a){var b=a&&this.getAllReportContainers().map(function(b,f){return b.setVisualState&&b.setVisualState(a.reportContainers[f])});
return g(b)},_renderQueue:null,getRenderPromise:function(){return this._renderQueue&&this._renderQueue.getPromise()},_registerContainerLoadPromise:function(a){this._renderQueue=this._renderQueue||new O;this._renderQueue.add(a);this.playerToolbar&&this.playerToolbar.setContentLoadPromise(this.getRenderPromise())},_safeFuncCaller:null,_callAfterRendering:function(a,b){if(this.isPlayerOnServer)return this[a].apply(this,b);var f=this;this._safeFuncCaller=this._safeFuncCaller||{};this._safeFuncCaller[a]=
function(){return f[a].apply(f,b)};return d(this.getRenderPromise(),function(){return S.invoke(f._safeFuncCaller,a)})},onSetReportDataStart:function(){},onSetReportDataEnd:function(){},onResized:function(a){},onClose:function(){},onError:function(a){},onAddMoreAreas:function(){},onAreasPreRemoved:function(a){},onAreasRemoved:function(a){},destroy:function(){this._destroyAllContainers();this.inherited(arguments)}})})},"esri/dijit/geoenrichment/ReportPlayer/config":function(){define(["esri/kernel"],
function(l){function h(g){g=g.split(".");return Number((Number(g[0])+Number(g[1])/100).toFixed(2))}l=Math.max(h("3.34"),h(l.version)).toFixed(2);return{jsapiVersion:l,esriDijitCssUrl:"https://js.arcgis.com/"+l+"/dijit/themes/claro/claro.css",esriCssUrl:"https://js.arcgis.com/"+l+"/esri/css/esri.css",playerSourceRootUrl:"https://js.arcgis.com/"+l+"/",configScriptText:null,env:"prod",isPlayerOnServer:!1,updateVariableInfoFromDataXml:!0,runReportTask:{cacheResult:!0,ignoreErrors:!0,secondAttempt:!0},
maps:{maxNumberOfMapsShownAtTheSameTime:6},charts:{showErrorIfHasUnavailableData:!1},tables:{leaveEmptyCellsUponError:!0,showUnavailableData:!0},createImageCommand:{skipSavingFile:!1},createPDFCommand:{skipSavingFile:!1,skipCreditConsumption:!1},createPlayerCommand:{loadMapPortalItems:!1,compressData:!1,prettifyDataJson:!1,skipCreditConsumption:!1},exportToExcel:{skipSavingFile:!1},modules:{exportCommands:!0,complexCellTooltips:!0,paths:{panoramicViewer:null}},generalization:{factor:-1,maxVerticesInAllFeatures:1E5,
numVerticesPerFeature:5E4}}})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_CommandSupport":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/ReportPlayer/PlayerCommands esri/dijit/geoenrichment/ReportPlayer/config esri/dijit/geoenrichment/utils/DeviceUtil".split(" "),function(l,h,g,e,d,b,a){return l(null,{_initCommands:function(){a.isMobileDevice()||!b.modules.exportCommands?this.playerToolbar.notifyCommandButtonsAdded():
e(this.dataProvider.getCommands&&this.dataProvider.getCommands(),function(a){this._createCommandButtons(a);this.playerToolbar&&this.playerToolbar.notifyCommandButtonsAdded()}.bind(this))},_lastNonPrintCommandId:null,_executeExportCallback:null,_executePrintCallback:null,_createCommandButtons:function(a){function b(a){var b=new g,c=new g;f.onCommandSettingsShown(b.promise);f._saveVisualState();e(f._getPrintableContainer({commandId:a,showDialog:!0}),function(a){if(a){var b=a.getSelectedCommandId();
b&&b!==d.PRINT&&(f._lastNonPrintCommandId=b);e(f._executeCommand(b,{printableContainer:a}),c.resolve,c.reject)}else e(f._applySavedVisualState(),function(){f.onCommandCanceled();c.resolve()})}).always(b.resolve);return c.promise}var f=this;if(a&&a.length){var c,m=a.filter(function(a){return a.id===d.PRINT?(c=a,!1):!0});m.length&&(this._executeExportCallback=function(){return b(f._lastNonPrintCommandId||m[0].id)},this._createCommandButton(m[0],this._executeExportCallback));c&&(this._executePrintCallback=
function(){return b(c.id)},this._createCommandButton(c,this._executePrintCallback))}},executeExport:function(){return this._executeExportCallback&&this._executeExportCallback()},executePrint:function(){return this._executePrintCallback&&this._executePrintCallback()},_createCommandButton:function(a,b){return this.playerToolbar&&this.playerToolbar.createCommandButton(a,b)},getCommandExportDialogSettings:function(){return this._getPrintDialogSettings()},executeCommand:function(a,b){b=b||{};this._saveVisualState();
var f=this._viewModel.dynamicReportInfo.fieldData;!this.isPlayerOnServer||a!==d.PDF&&a!==d.IMAGE||(b.exportSettings=h.mixin({},f.reportInfo&&f.reportInfo.exportSettings,b.exportSettings));var c=this;return e(this._getPrintableContainer({commandId:a,showDialog:!1,exportSettings:b.exportSettings}),function(f){return c._executeCommand(a,h.mixin({printableContainer:f},b))})},_executeCommand:function(a,b){function f(){e(c.dataProvider.executeCommand&&c.dataProvider.executeCommand(a,c,b,function(a){c.onCommandProgress(a)}),
p.resolve,p.reject)}var c=this,k=this._viewModel.dynamicReportInfo.fieldData;a!==d.PDF&&a!==d.DYNAMIC_HTML||!k.runReportTaskIDs||(b.creditsTaskIDs=k.runReportTaskIDs);var p=new g;this.isPlayerOnServer?f():setTimeout(f);var h=p.promise.then(function(a){return e(c._applySavedVisualState(),function(){return a})});this.onCommandStart(h,a);this._showWaiting(h,"executeCommand");h.always(function(){c.onCommandEnd(h)});return h},_visualStateMemo:null,_saveVisualState:function(){this._visualStateMemo=this.getVisualState()},
_applySavedVisualState:function(){var a=this;return this.setVisualState(this._visualStateMemo).then(function(){a._visualStateMemo=null})},onCommandSettingsShown:function(a){},onCommandCanceled:function(){},onCommandStart:function(a,b){},onCommandProgress:function(a){},onCommandEnd:function(a){}})})},"esri/dijit/geoenrichment/ReportPlayer/PlayerCommands":function(){define([],function(){var l={HTML:"createHTML",PDF:"createPDF",PRINT:"print",DYNAMIC_HTML:"createDynamicHTML",IMAGE:"createImage",EXCEL:"exportToExcel",
isSupported:function(h){for(var g in l)if(l[g]===h)return!0;return!1}};return l})},"esri/dijit/geoenrichment/utils/DeviceUtil":function(){define(["dojo/sniff","dojo/domReady!"],function(l){var h={},g=function(){var d=window,b=d.navigator.platform,a=d.navigator.userAgent,c={ios:!1,android:!1,androidChrome:!1,desktop:!1,iphone:!1,ipod:!1,ipad:!1,edge:!1,ie:!1,firefox:!1,macos:!1,windows:!1,cordova:!(!d.cordova&&!d.phonegap),phonegap:!(!d.cordova&&!d.phonegap),electron:!1,nwjs:!1},k=d.screen.width,f=
d.screen.height,e=a.match(/(Android);?[\s\/]+([\d.]+)?/),g=a.match(/(iPad).*OS\s([\d_]+)/),p=a.match(/(iPod)(.*OS\s([\d_]+))?/),h=!g&&a.match(/(iPhone\sOS|iOS)\s([\d_]+)/),t=0<=a.indexOf("MSIE ")||0<=a.indexOf("Trident/"),r=0<=a.indexOf("Edge/"),u=0<=a.indexOf("Gecko/")&&0<=a.indexOf("Firefox/"),y="Win32"===b,v=0<=a.toLowerCase().indexOf("electron"),w="undefined"!==typeof nw&&"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.nw,b="MacIntel"===
b,D="1024x1366 1366x1024 834x1194 1194x834 834x1112 1112x834 768x1024 1024x768".split(" ");!g&&b&&l("touch")&&0<=D.indexOf(k+"x"+f)&&((g=a.match(/(Version)\/([\d.]+)/))||(g=[0,1,"13_0_0"]),b=!1);c.ie=t;c.edge=r;c.firefox=u;e&&!y&&(c.os="android",c.osVersion=e[2],c.android=!0,c.androidChrome=0<=a.toLowerCase().indexOf("chrome"));if(g||h||p)c.os="ios",c.ios=!0;h&&!p&&(c.osVersion=h[2].replace(/_/g,"."),c.iphone=!0);g&&(c.osVersion=g[2].replace(/_/g,"."),c.ipad=!0);p&&(c.osVersion=p[3]?p[3].replace(/_/g,
"."):null,c.ipod=!0);c.ios&&c.osVersion&&0<=a.indexOf("Version/")&&"10"===c.osVersion.split(".")[0]&&(c.osVersion=a.toLowerCase().split("version/")[1].split(" ")[0]);c.webView=!(!(h||g||p)||!a.match(/.*AppleWebKit(?!.*Safari)/i)&&!d.navigator.standalone)||d.matchMedia&&d.matchMedia("(display-mode: standalone)").matches;c.webview=c.webView;c.standalone=c.webView;c.desktop=!(c.ios||c.android)||v||w;c.desktop&&(c.electron=v,c.nwjs=w,c.macos=b,c.windows=y,c.macos&&(c.os="macos"),c.windows&&(c.os="windows"));
c.pixelRatio=d.devicePixelRatio||1;return c}();h.device=g;h.isMobileDevice=function(){return!g.desktop};h.isPCWithTouchScreen=function(){return g.desktop&&l("touch")};h.isLandscape=function(){return 90===Math.abs(window.orientation)};var e=null;h.isWebLayout=function(){var d;e||(d=document.createElement("div"),d.style="visibility:hidden;height:1in;width:1in;position:absolute;left: -100%;top:-100%;",document.body.appendChild(d),e=d.offsetHeight,d.parentNode.removeChild(d));d=e;d*=7;var b=document.body.offsetWidth;
if(b>=d)return!0;var a=document.body.offsetHeight;return b>=a&&Math.sqrt(b*b+a*a)>=d?!0:!1};h.press=g.desktop?"mousedown":"touchstart";h.release=g.desktop?"mouseup":"touchend";h.click=g.desktop?"click":"touchend";h.clickOrRelease=g.desktop?"click, mouseup":"touchend";h.move=g.desktop?"mousemove":"touchmove";return h})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_LogoSupport":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/when","../core/annotations/supportClasses/DynamicBehaviors",
"../core/supportClasses/images/DefaultLogoLoader"],function(l,h,g,e){return l(null,{_getReportLogo:function(d,b,a){function c(){return h(k._reportData.attachmentsStore&&k._reportData.attachmentsStore.getImages(),function(f){return h(f&&f[0]&&f[0].getThumbnail(),function(f){return f||k._getDefaultLogo(b,a)})})}var k=this;switch(d){case g.ATTACHMENTS:return c();default:return this._getDefaultLogo(b,a)}},_getDefaultLogo:function(d,b){return this._reportData.customLogo||b||e.getDefaultLogo(this._viewModel.getDocumentDefaultStyles())}})})},
"esri/dijit/geoenrichment/ReportPlayer/core/annotations/supportClasses/DynamicBehaviors":function(){define([],function(){var l={ATTACHMENTS:"attachments",LOGO:"logo",toSupportedValue:function(h,g){return h===l.ATTACHMENTS?h:h||g?l.LOGO:null}};return l})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/images/DefaultLogoLoader":function(){define(["require","esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/utils/ColorUtil"],function(l,h,g){return{_identifyDefaultLogoBackground:function(e){return!e||
g.isTransparent(e.backgroundColor)?"transparent":g.isLightColor(e.backgroundColor)?"light":"dark"},_loadLogo:function(e){var d=new h;l(["./"+e],function(b){d.resolve(b)});return d.promise},getDefaultLogo:function(e){switch(this._identifyDefaultLogoBackground(e)){case "light":return this._loadLogo("DefaultLogoGraphicReportDark");case "dark":return this._loadLogo("DefaultLogoGraphicReportLight");default:return this._loadLogo("DefaultLogoGraphicReportGeneric")}}}})},"esri/dijit/geoenrichment/utils/ColorUtil":function(){define(["dojo/_base/Color",
"dojox/color/_base","dojox/color/Palette"],function(l,h,g){function e(b,a,c){return Math.round((b&255)*(1-c)+(a&255)*c)}var d={toCSSColor:function(b,a,c){"string"!==typeof b||/^0x/i.test(b)||(b=l.fromString(b));if(b instanceof l)return a||1===b.a?b.toHex():b.toCss(!0);if(null==b||isNaN(b))return c?d.toCSSColor(c,a):"#000000";b="00000"+Number(b).toString(16);return"#"+b.substr(b.length-6)},toColor:function(b,a){return"object"===typeof b?(new l).setColor(b):l.fromString(d.toCSSColor(b,!1,a))},getCSSColorWithAlpha:function(b,
a){return d.toCSSColor(d.getColorWithAlpha(b,a))},getColorWithAlpha:function(b,a){b=(new l).setColor(b);b.a=a;return b},transform:function(b,a){var c=new g;c.colors=[new l(b)];return c.transform({use:void 0!==a.dl?"hsl":"hsv",dh:a.dh||0,ds:a.ds||0,dv:a.dv||0,dl:a.dl||0}).colors[0]},generateAnalogousColorScheme:function(b,a,c){return g.generators.analogous({base:b,high:a,low:c}).colors},applyColorHue:function(b,a){b=new h.Color(b);a=new h.Color(a);b=b.toHsl();var c=a.toHsl();b=h.fromHsl({h:b.h,s:0===
b.s?0:0===c.s?b.s:c.s,l:c.l});b.a=a.a;return b},getColorParams:function(b){b=new h.Color(b);var a=b.toHsv();a.l=b.toHsl().l;return a},generateGradient:function(b,a){b=b.map(d.toRGBColor);var c=[];if(0===b.length-1||1===a){b=b[0];for(var k=0;k<a;k++)c.push(b);return c}for(var f=1/(a-1),k=0;k<a;k++)c.push(d.getGradientRGBColor(b,k*f));return c},getGradientRGBColor:function(b,a,c){var k=b.length-1,f=1>k||0>=a?0:1<=a?k:-1;if(0<=f)return b[f];a*=k;f=Math.floor(a);f===k&&f--;return d.mixRGBColors(b[f],
b[f+1],a-f,c)},mixRGBColors:function(b,a,c,k){1<c?c=1:0>c&&(c=0);var f=e(b,a,c),d=e(b>>8,a>>8,c),g=e(b>>16,a>>16,c);return((k?e(b>>24,a>>24,c):0)<<24)+(g<<16)+(d<<8)+f},toRGBColor:function(b,a){b=d.toCSSColor(b,!0,a);return parseInt("0x"+b.substr(1))},getContrastColor:function(b,a,c,k){return d.isLightColor(b,k)?d.toColor(a,"#000000"):d.toColor(c,"#FFFFFF")},getHighlightColor:function(b,a){a=a||{};b=new h.Color(b);x=b.toHsl();if("darker"===a.method)x.l=50>x.l?x.l+30:x.l-20,0<x.s&&(x.s+=30);else{var c=
a.saturation||100,k=a.luminosity1||75;a=a.luminosity2||50;0===x.s?x.l=50>x.l?x.l+30:x.l-20:(x.s=c,x.l=x.l<a?k:x.l>k?a:x.l-a>k-x.l?a:k)}a=h.fromHsl(x);a.a=b.a;return a},getLightness:function(b){b=d.toRGBColor(b);return(299*(b>>16&255)+587*(b>>8&255)+114*(b&255))/1E3},isLightColor:function(b,a){return d.getLightness(b)>=(void 0===a?128:a)},colorsEqual:function(b,a){b instanceof l||(b=d.toColor(b));a instanceof l||(a=d.toColor(a));return b.a==a.a&&b.r==a.r&&b.g==a.g&&b.b==a.b},isTransparent:function(b){b=
d.toCSSColor(b);return"rgba(0,0,0,0)"===b.toLowerCase().replace(/\s/g,"")},generateRandomColor:function(b){function a(){return c+Math.round((k-c)*Math.random())}b=b||{};var c=b.min||0,k=b.max||255,f=b.randomizeAlpha?a():1;return b.grayScheme?(b=a(),new l([b,b,b,f])):new l([a(),a(),a(),f])}};return d})},"dojox/color/Palette":function(){define(["dojo/_base/lang","dojo/_base/array","./_base"],function(l,h,g){function e(a,b,c){var f=new g.Palette;f.colors=[];h.forEach(a.colors,function(a){f.colors.push(new g.Color({r:Math.min(255,
Math.max(0,"dr"==b?a.r+c:a.r)),g:Math.min(255,Math.max(0,"dg"==b?a.g+c:a.g)),b:Math.min(255,Math.max(0,"db"==b?a.b+c:a.b)),a:Math.min(1,Math.max(0,"da"==b?a.a+c:a.a))}))});return f}function d(a,b,c){var f=new g.Palette;f.colors=[];h.forEach(a.colors,function(a){a=a.toCmy();f.colors.push(g.fromCmy(Math.min(100,Math.max(0,"dc"==b?a.c+c:a.c)),Math.min(100,Math.max(0,"dm"==b?a.m+c:a.m)),Math.min(100,Math.max(0,"dy"==b?a.y+c:a.y))))});return f}function b(a,b,c){var f=new g.Palette;f.colors=[];h.forEach(a.colors,
function(a){a=a.toCmyk();f.colors.push(g.fromCmyk(Math.min(100,Math.max(0,"dc"==b?a.c+c:a.c)),Math.min(100,Math.max(0,"dm"==b?a.m+c:a.m)),Math.min(100,Math.max(0,"dy"==b?a.y+c:a.y)),Math.min(100,Math.max(0,"dk"==b?a.b+c:a.b))))});return f}function a(a,b,c){var f=new g.Palette;f.colors=[];h.forEach(a.colors,function(a){a=a.toHsl();f.colors.push(g.fromHsl(("dh"==b?a.h+c:a.h)%360,Math.min(100,Math.max(0,"ds"==b?a.s+c:a.s)),Math.min(100,Math.max(0,"dl"==b?a.l+c:a.l))))});return f}function c(a,b,c){var f=
new g.Palette;f.colors=[];h.forEach(a.colors,function(a){a=a.toHsv();f.colors.push(g.fromHsv(("dh"==b?a.h+c:a.h)%360,Math.min(100,Math.max(0,"ds"==b?a.s+c:a.s)),Math.min(100,Math.max(0,"dv"==b?a.v+c:a.v))))});return f}g.Palette=function(a){this.colors=[];a instanceof g.Palette?this.colors=a.colors.slice(0):a instanceof g.Color?this.colors=[null,null,a,null,null]:l.isArray(a)?this.colors=h.map(a.slice(0),function(a){return l.isString(a)?new g.Color(a):a}):l.isString(a)&&(this.colors=[null,null,new g.Color(a),
null,null])};l.extend(g.Palette,{transform:function(k){var f=e;if(k.use){var g=k.use.toLowerCase();0==g.indexOf("hs")?f="l"==g.charAt(2)?a:c:0==g.indexOf("cmy")&&(f="k"==g.charAt(3)?b:d)}else if("dc"in k||"dm"in k||"dy"in k)f="dk"in k?b:d;else if("dh"in k||"ds"in k)f="dv"in k?c:a;var g=this,m;for(m in k)"use"!=m&&(g=f(g,m,k[m]));return g},clone:function(){return new g.Palette(this)}});l.mixin(g.Palette,{generators:{analogous:function(a){var b=a.high||60,c=a.low||18;a=(l.isString(a.base)?new g.Color(a.base):
a.base).toHsv();var k=Math.max(10,95>=a.s?a.s+5:100-(a.s-95)),d=92<=a.v?a.v-9:Math.max(a.v+9,20),e=90>=a.v?Math.max(a.v+5,20):95+Math.ceil((a.v-90)/2),t=[k,1<a.s?a.s-1:21-a.s,a.s,k,k],r=[d,e,a.v,d,e];return new g.Palette(h.map([(a.h+c+360)%360,(a.h+Math.round(c/2)+360)%360,a.h,(a.h-Math.round(b/2)+360)%360,(a.h-b+360)%360],function(a,b){return g.fromHsv(a,t[b],r[b])}))},monochromatic:function(a){a=l.isString(a.base)?new g.Color(a.base):a.base;var b=a.toHsv(),c=9<b.s-30?b.s-30:b.s+30,k=b.s,d=20<b.v-
20?b.v-20:b.v+60,e=20<b.v-50?b.v-50:b.v+30;return new g.Palette([g.fromHsv(b.h,c,100-.8*(100-b.v)),g.fromHsv(b.h,k,e),a,g.fromHsv(b.h,c,e),g.fromHsv(b.h,k,d)])},triadic:function(a){a=l.isString(a.base)?new g.Color(a.base):a.base;var b=a.toHsv(),c=(b.h-157+360)%360,k=90<b.s?b.s-10:b.s+10,d=95<b.s?b.s-5:b.s+5,e=20<b.v-20?b.v-20:b.v+20,h=20<b.v-30?b.v-30:b.v+30,r=70<b.v-30?b.v-30:b.v+30;return new g.Palette([g.fromHsv((b.h+57+360)%360,20<b.s?b.s-10:b.s+10,b.v),g.fromHsv(b.h,k,h),a,g.fromHsv(c,k,e),g.fromHsv(c,
d,r)])},complementary:function(a){a=l.isString(a.base)?new g.Color(a.base):a.base;var b=a.toHsv(),c=360>2*b.h+137?2*b.h+137:Math.floor(b.h/2)-137,k=100-.9*(100-b.s),d=Math.min(100,b.s+20),e=20<b.v?b.v-30:b.v+30;return new g.Palette([g.fromHsv(b.h,Math.max(b.s-10,0),Math.min(100,b.v+30)),g.fromHsv(b.h,k,e),a,g.fromHsv(c,d,e),g.fromHsv(c,b.s,b.v)])},splitComplementary:function(a){var b=l.isString(a.base)?new g.Color(a.base):a.base,c=a.da||30;a=b.toHsv();var k=360>2*a.h+137?2*a.h+137:Math.floor(a.h/
2)-137,d=(k-c+360)%360,c=(k+c)%360,k=100-.9*(100-a.s),e=Math.min(100,a.s+20),h=20<a.v?a.v-30:a.v+30;return new g.Palette([g.fromHsv(d,Math.max(a.s-10,0),Math.min(100,a.v+30)),g.fromHsv(d,k,h),b,g.fromHsv(c,e,h),g.fromHsv(c,a.s,a.v)])},compound:function(a){a=l.isString(a.base)?new g.Color(a.base):a.base;var b=a.toHsv(),c=360>2*b.h+18?2*b.h+18:Math.floor(b.h/2)-18,k=360>2*b.h+120?2*b.h+120:Math.floor(b.h/2)-120,d=360>2*b.h+99?2*b.h+99:Math.floor(b.h/2)-99,e=80<b.s-10?b.s-10:b.s+10,h=10<b.s-25?b.s-25:
b.s+25,r=80<b.v-20?b.v-20:b.v+20,u=Math.max(b.v,20);return new g.Palette([g.fromHsv(c,10<b.s-40?b.s-40:b.s+40,10<b.v-40?b.v-40:b.v+40),g.fromHsv(c,e,r),a,g.fromHsv(k,h,u),g.fromHsv(d,e,r)])},shades:function(a){a=l.isString(a.base)?new g.Color(a.base):a.base;var b=a.toHsv(),c=100==b.s&&0==b.v?0:b.s,k=20<=b.v-25?b.v-25:b.v+55,d=20<=b.v-75?b.v-75:b.v+5,e=Math.max(b.v-10,20);return new g.Palette([new g.fromHsv(b.h,c,20<b.v-50?b.v-50:b.v+30),new g.fromHsv(b.h,c,k),a,new g.fromHsv(b.h,c,d),new g.fromHsv(b.h,
c,e)])}},generate:function(a,b){if(l.isFunction(b))return b({base:a});if(g.Palette.generators[b])return g.Palette.generators[b]({base:a});throw Error("dojox.color.Palette.generate: the specified generator ('"+b+"') does not exist.");}});return g.Palette})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_MapSupport":function(){define(["require","dojo/_base/declare","esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],function(l,h,g,e){return h(null,{_initBuilderPromise:null,
_mapBuilder:null,_initMapBuilder:function(){var d=this;if(this._initBuilderPromise)return this._initBuilderPromise;var b=new g;l([d.isPlayerOnServer?"../core/supportClasses/map/ServerMapBuilder":"../core/supportClasses/map/MapBuilder"],function(a){d._mapBuilder=new a({getPlayerZoomScale:function(a){var b=d.getCurrentReportContainer();return b&&b.getPanelZoomScale?b.getPanelZoomScale(a):b&&b.getZoomInfo&&b.getZoomInfo().scale}});b.resolve()});return this._initBuilderPromise=b.promise},collectMaps:function(d){return this._mapBuilder?
d&&d.allAreas?this._mapBuilder.collectAllAreasMaps():this._mapBuilder.collectAreaMaps(this.getCurrentAnalysisAreaIndex()):[]},_resetMapBuilder:function(){this._mapBuilder&&this._mapBuilder.reset()},_createMap:function(d,b){b=b||{};return e(this._initMapBuilder(),function(){this._mapBuilder.setFallbackMapImageInfos(this._reportData.mapImageInfos);return this._mapBuilder.createMap(d,{reportData:this._reportData,areaIndex:b.areaIndex,defaultBasemapId:this._getDefaultBasemapId()||b.defaultBasemapId,webMapId:b.webMapId,
additionalLayerInfos:b.additionalLayerInfos,calculatorFieldName:b.calculatorFieldName,pinSymbolJson:b.pinSymbolJson,areaSymbolJsons:b.areaSymbolJsons,areaSymbolRamp:b.areaSymbolRamp,locatorPointsControllers:b.locatorPointsControllers,stdPolygonsControllers:b.stdPolygonsControllers,thisAreasHighlightController:b.thisAreasHighlightController,legendController:b.legendController,fieldData:this._viewModel.dynamicReportInfo.fieldData,geClient:this._viewModel.dynamicReportInfo.geClient,countryID:this._viewModel.dynamicReportInfo.countryID,
hierarchy:this._viewModel.dynamicReportInfo.hierarchy,waitForLoad:b.waitForLoad,extent:b.extent,attachmentsStore:this._viewModel.dynamicReportInfo.attachmentsStore,onPanContainer:function(a,b){}})}.bind(this))},_getDefaultBasemapId:function(){return null}})})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_PageNavigationSupport":function(){define("dojo/_base/declare dojo/on dojo/dom-class dojo/dom-geometry dojo/dom-style ../PlayerResizeModes ../PlayerViewModes esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/TooltipUtil dojo/i18n!esri/nls/jsapi".split(" "),
function(l,h,g,e,d,b,a,c,k,f){f=f.geoenrichment.dijit.ReportPlayer.ReportPlayer;return l(null,{_currentPageIndex:null,_initPageNavigationControls:function(){var a=this;h(this.prevPageButton,"click",function(){a._showPrevPage()});h(this.nextPageButton,"click",function(){a._showNextPage()});c.hide(this.sidePageNavigator);k.setTooltipToNode(this.prevPageButton,f.previousPage);k.setTooltipToNode(this.nextPageButton,f.nextPage)},showPageAt:function(b){this.viewMode!==a.FULL_PAGES||this.isPlayerOnServer||
(b=Math.max(0,b),this._currentPageIndex=b=Math.min(this.getCurrentReportContainer().getNumberOfPages()-1,b),this.getCurrentReportContainer().showPageAt(b),this._updatePageNavigator())},_updatePageNavigator:function(){if(this.playerToolbar){var f=this.getCurrentReportContainer()&&this.getCurrentReportContainer().getNumberOfPages&&this.viewMode===a.FULL_PAGES;this.playerToolbar.setPageControlsVisible(f);if(f){var f=this.getCurrentReportContainer().getNumberOfPages(),k=1<f;k&&this._provideSideNavigationNodes();
c.display(this.sidePageNavigator,k);k&&(g[0===this._currentPageIndex?"add":"remove"](this.prevPageButton,"disabled"),g[this._currentPageIndex===f-1?"add":"remove"](this.nextPageButton,"disabled"),this.resizeMode===b.FIT_WINDOW&&(k=e.position(this.getCurrentReportContainer().stackContainer),d.set(this.sidePageNavigator,"left",Math.min(k.x+k.w+20,document.body.clientWidth-70)+"px"),d.set(this.sidePageNavigator,"top",Math.max(60,k.y+10)+"px")));this.playerToolbar.updatePageSelect(f,this._currentPageIndex)}else c.hide(this.sidePageNavigator)}},
_provideSideNavigationNodes:function(){var a=this;this.sidePageNavigator||(this.sidePageNavigator=c.create("div",{"class":"reportPlayer_sidePageNavigator"},this.domNode),this.prevPageButton=c.create("div",{"class":"reportPlayer_paginationArrowUp"},this.sidePageNavigator),this.nextPageButton=c.create("div",{"class":"reportPlayer_paginationArrowDown"},this.sidePageNavigator),h(this.prevPageButton,"click",function(){a._showPrevPage()}),h(this.nextPageButton,"click",function(){a._showNextPage()}),k.setTooltipToNode(this.prevPageButton,
f.previousPage),k.setTooltipToNode(this.nextPageButton,f.nextPage))},_showPrevPage:function(){0!==this._currentPageIndex&&(this._currentPageIndex--,this.showPageAt(this._currentPageIndex))},_showNextPage:function(){this._currentPageIndex!==this.getCurrentReportContainer().getNumberOfPages()-1&&(this._currentPageIndex++,this.showPageAt(this._currentPageIndex))}})})},"esri/dijit/geoenrichment/ReportPlayer/PlayerResizeModes":function(){define([],function(){var l={AUTO:"auto",FIT_WINDOW:"fitWindow",MANUAL:"manual",
isSupported:function(h){for(var g in l)if(l[g]===h)return!0;return!1},toSupportedValue:function(h){return l.isSupported(h)?h:l.FIT_WINDOW}};return l})},"esri/dijit/geoenrichment/ReportPlayer/PlayerViewModes":function(){define([],function(){var l={FULL_PAGES:"fullPages",PANELS_IN_SLIDES:"panelsInSlides",PANELS_IN_STACK:"panelsInStack",PANELS_IN_STACK_ALL:"panelsInStackAll",isSupported:function(h){for(var g in l)if(l[g]===h)return!0;return!1},toSupportedValue:function(h){return l.isSupported(h)?h:l.FULL_PAGES},
isMobileSupported:function(h){return h===l.PANELS_IN_SLIDES||h===l.PANELS_IN_STACK||h===l.PANELS_IN_STACK_ALL},isStackLike:function(h){return h===l.PANELS_IN_STACK||h===l.PANELS_IN_STACK_ALL},isStack:function(h){return h===l.PANELS_IN_STACK||h===l.PANELS_IN_STACK_ALL}};return l})},"esri/dijit/geoenrichment/utils/DomUtil":function(){define("dojo/_base/lang dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/query esri/dijit/geoenrichment/Deferred dojo/domReady!".split(" "),
function(l,h,g,e,d,b,a,c){function k(){n||(n=e.create("div",{"class":"esriGEOffscreen"},document.body));return n}var f={isHidden:function(a){return a&&g.contains(a,"esriGEHidden")},hasVisibleChildren:function(a){if(!a||!a.children.length)return!1;for(var b=0;b<a.children.length;b++)if(!f.isHidden(a.children[b]))return!0;return!1},hide:function(a){return f.addTag(a,"esriGEHidden")},show:function(a){return f.removeTag(a,"esriGEHidden")},display:function(a,b){return f[b?"show":"hide"](a)},addTag:function(a,
b){return f.applyCallback(a,function(a){a&&g.add(a,b)})},removeTag:function(a,b){return f.applyCallback(a,function(a){a&&g.remove(a,b)})},applyCallback:function(a,b,c){c&&(b=l.hitch(c,b));Array.isArray(a)?a.forEach(b):b(a);return a},getChildIndex:function(a,b){if(!a||!a.children||!b)return-1;for(var c=0;c<a.children.length;c++)if(a.children[c]===b)return c;return-1},getChildren:function(a){if(!a||!a.children)return null;for(var b=[],c=0;c<a.children.length;c++)b.push(a.children[c]);return b},getChildNodes:function(a){if(!a||
!a.childNodes)return null;for(var b=[],c=0;c<a.childNodes.length;c++)b.push(a.childNodes[c]);return b},isChildOf:function(a,b,c){var f=!1,k=function(a){if(c&&!c(a))return!1;a.parentNode===b?f=!0:a.parentNode&&k(a.parentNode)};a&&k(a);return f},isNodeInLayout:function(a){return f.isChildOf(a,document.body,function(a){return!f.isHidden(a)&&"none"!=b.get(a,"display")&&!g.contains(a,"dijitHidden")})},isNodeVisible:function(a){return f.isChildOf(a,document.body,function(a){return!g.contains(a,"dijitHidden")&&
"hidden"!=b.get(a,"visibility")})},isNodeOnscreen:function(a){return f.isChildOf(a,document.body,function(a){return!g.contains(a,"esriGEOffscreen")})},enableContent:function(a,c,f){if(a){f=f||{};var k=a.children.length-1;if(!(0>k)){k=a.children[k];g.contains(k,"esriGEDisabledContent")||(k=null);if(c)k&&a.removeChild(k);else if(k=k||e.create("div",{"class":"esriGEDisabledContent"+(f.overlayClass?" "+f.overlayClass:"")},a),f.textContent&&(k.textContent=f.textContent),!1!==f.fitParent&&(a=d[f.marginBox?
"getMarginBox":"getContentBox"](a).h))a=a.toString()+"px",b.set(k,{height:a,marginTop:"-"+a});return k}}},enableContentAbsolute:function(a,c,k){if(a){k=k||{};var d=b.get(a,"position");"relative"!==d&&"absolute"!==d&&b.set(a,"position","relative");return f.enableContent(a,c,{overlayClass:"esriGEAbsoluteStretched "+(k.overlayClass||"")+(k.isTransparent?" esriGEDisabledContentTransparent ":""),fitParent:!1,textContent:k.textContent})}}},n;f.hideNodeInBackground=function(a,b){if(a){if(a._hideNodeInBackgroundUndoController)return a._hideNodeInBackgroundUndoController;
var c=e.create("div",null,a,"after"),f=e.create("div",{style:"position: absolute; left: 0px; top: 0px;"},k());e.place(a,f);b="DomUtil.hideNodeInBackground"+(b?"."+b:"");h.set(c,"_bg_memo_node",b);h.set(f,"_bg_temp_node",b);b={undo:function(){c&&(c.parentNode&&e.place(a,c,"replace"),e.destroy(c),e.destroy(f),n.children.length||(e.destroy(n),n=null),c=null,delete a._hideNodeInBackgroundUndoController)},remove:function(){this.undo()}};return a._hideNodeInBackgroundUndoController=b}};f.showNodeFromBackground=
function(a){a&&a._hideNodeInBackgroundUndoController&&a._hideNodeInBackgroundUndoController.undo()};f.noTransformPosition=function(a){function c(a){for(var c={x:0,y:0};a.offsetParent;)c.x+=a.offsetLeft,c.y+=a.offsetTop,a=a.offsetParent,c.x+=b.get(a,"borderLeftWidth"),c.y+=b.get(a,"borderTopWidth");return c}function f(a){return b.get(a,"width")+b.get(a,"paddingLeft")+b.get(a,"paddingRight")+b.get(a,"borderLeftWidth")+b.get(a,"borderRightWidth")}function k(a){return b.get(a,"height")+b.get(a,"paddingTop")+
b.get(a,"paddingBottom")+b.get(a,"borderTopWidth")+b.get(a,"borderBottomWidth")}if(a){var d;if(a instanceof SVGElement&&a.getBBox)return d=(d=a.ownerSVGElement&&a.ownerSVGElement.parentNode)&&c(d),a=a.getBBox(),{x:(a.x||0)+d.x,y:(a.y||0)+d.y,w:a.width||0,h:a.height||0};d=c(a);return{x:d.x,y:d.y,w:f(a),h:k(a)}}};f.uniteNodeBoxes=function(a,b){var c=1E6,k=1E6,d=-1E6,e=-1E6;a.forEach(function(a){a=f.noTransformPosition(a);c=Math.min(c,a.x);k=Math.min(k,a.y);d=Math.max(d,a.x+a.w);e=Math.max(e,a.y+a.h)});
a={x:c,y:k,w:d-c,h:e-k};b&&(b=f.noTransformPosition(b),a.x-=b.x,a.y-=b.y);return a};f.getNodesBox=function(a,b){if(!a||!a.length)return null;for(var c=1E6,k=-1E6,e=1E6,g=-1E6,n=0;n<a.length;n++)var m=a[n],m=b&&b.ignoreTranformation?f.noTransformPosition(m):d.position(m),c=Math.min(c,m.x),e=Math.min(e,m.y),k=Math.max(k,m.x+m.w),g=Math.max(g,m.y+m.h);return{x:c,y:e,w:k-c,h:g-e}};f.traverseChildren=function(a,b){function c(a){if(a&&a.children)for(var f=0;f<a.children.length;f++){var k=a.children[f];
if(b(k))break;c(k)}}c(a)};f.scrollToListNode=function(a,b,c){var f=b.offsetTop+b.clientHeight,k=f-(a.scrollTop+a.clientHeight);0<k&&(a.scrollTop+=k);c&&(f-=b.clientHeight-c.offsetTop,k=a.scrollTop-f,0<k&&(a.scrollTop-=k))};var m;f.getScrollbarSize=function(){if(!m){var a=e.create("div",null,document.body);a.style.width="100px";a.style.height="100px";a.style.overflow="scroll";a.style.position="absolute";a.style.top="9999px";m={w:a.offsetWidth-a.clientWidth,h:a.offsetHeight-a.clientHeight};e.destroy(a)}return m};
f.hasScrollbars=function(a){var c=b.getComputedStyle(a);return{w:"scroll"===c.overflowX||a.offsetWidth>a.clientWidth&&"auto"===c.overflowX,h:"scroll"===c.overflowY||a.offsetHeight>a.clientHeight&&"auto"===c.overflowY}};f.getMeasureContext=function(a){a=a||{};a.style=a.style?a.style+" ":"";a.style+="display: inline-block; position: absolute; left: 0; top: 0;";return{div:e.create("div",a,document.body),measureText:function(a){this.div.innerHTML=a;a=d.getMarginBox(this.div);delete a.l;delete a.t;return a},
destroy:function(){e.destroy(this.div)}}};f.getTextBox=function(a,b){b=f.getMeasureContext(b);a=b.measureText(a);b.destroy();return a};f.getNodeFontFamily=function(a){return(a=b.get(a,"fontFamily")||b.getComputedStyle(a)["font-family"])?a.replace(/'|"/g,"").split(",")[0]:a};f.getNodeFontSize=function(a){return b.toPixelValue(a,b.get(a,"fontSize"))};f.stealFocus=function(){var a=new c;try{var b=e.create("input",{type:"text",style:"position: absolute; left: 0px; top: 0px;"});e.place(b,document.body);
b.select();e.destroy(b)}catch(t){}setTimeout(a.resolve,0);return a.promise};f.getWindowBox=function(){for(var a=[],b=0,c=document.body.children.length;b<c;b++){var k=document.body.children[b];f.isHidden(k)||(f.hide(k),a.push(k))}b={w:document.body.clientWidth,h:document.body.clientHeight};a.forEach(function(a){f.show(a)});return b};f.getBorder=function(a){return{t:b.toPixelValue(a,b.get(a,"borderTopWidth")),r:b.toPixelValue(a,b.get(a,"borderRightWidth")),b:b.toPixelValue(a,b.get(a,"borderBottomWidth")),
l:b.toPixelValue(a,b.get(a,"borderLeftWidth"))}};f.isBodyLtr=function(){return"ltr"===(document.body.dir||"ltr").toLowerCase()};f.setAttribute=function(a,b,c){return 2===arguments.length?h.set(a,b):h.set(a,b,c)};f.getAttribute=function(a,b,c){return 2===arguments.length?h.get(a,b):h.get(a,b,c)};f.addClass=function(a,b){return g.add(a,b)};f.removeClass=function(a,b){return g.remove(a,b)};f.toggleClass=function(a,b,c){return g[c?"add":"remove"](a,b)};f.replaceClass=function(a,b,c){return g.replace(a,
b,c)};f.containsClass=function(a,b){return g.contains(a,b)};f.getStyle=function(a,c){return b.get(a,c)};f.setStyle=function(a,c,f){return 2===arguments.length?b.set(a,c):b.set(a,c,f)};f.toPixelValue=function(a,b){return parseFloat(b)||0};f.getComputedStyle=function(a){return a&&1===a.nodeType&&window.getComputedStyle(a)};f.position=function(a,b){return d.position(a,b)};f.getMarginBox=function(a,b){return d.getMarginBox(a,b)};f.setMarginBox=function(a,b){return d.setMarginBox(a,b)};f.getMarginExtents=
function(a,b){return d.getMarginExtents(a,b)};f.getContentBox=function(a,b){return d.getContentBox(a,b)};f.getPadBorderExtents=function(a,b){return d.getPadBorderExtents(a,b)};f.getPadExtents=function(a,b){return d.getPadExtents(a,b)};f.getBorderExtents=function(a,b){return d.getBorderExtents(a,b)};f.docScroll=function(){return d.docScroll()};f.create=function(a,b,c,f){return e.create(a,b,c,f)};f.toDom=function(a){return e.toDom(a)};f.place=function(a,b,c){return e.place(a,b,c)};f.empty=function(a){return e.empty(a)};
f.destroy=function(a){return e.destroy(a)};f.query=function(b,c){b=a(b,c);c=[];for(var f=0,k=b.length;f<k;f++)c.push(b[f]);return c};return f})},"esri/dijit/geoenrichment/utils/TooltipUtil":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/on dojo/mouse dojo/sniff dijit/Tooltip dijit/place dojox/gfx ./DeviceUtil ./DnDUtil ./DomUtil ./MouseUtil esri/dijit/geoenrichment/ReportPlayer/config dojo/domReady!".split(" "),function(l,
h,g,e,d,b,a,c,k,f,n,m,p,q,t,r,u){function y(){}var v={},w=l(f._MasterTooltip,{_customClasses:null,_customStyle:null,_orientKey:null,addCustomClasses:function(a){a&&(g.add(this.domNode,a),this._customClasses=a)},setCustomStyle:function(a){this._customStyle=a},show:function(a,b,c,k,d,g,m){if(!this.aroundNode||this.aroundNode!==b||this.containerNode.innerHTML!=a)if("playing"==this.fadeOut.status())this._onDeck=arguments;else{"string"===typeof a?this.containerNode.innerHTML=a:(this.containerNode.innerHTML=
"",e.place(a.domNode||a,this.containerNode));d&&this.set("textDir",d);this.containerNode.align=k?"right":"left";var p=n.around(this.domNode,b,c&&c.length?c:f.defaultPosition,!k,h.hitch(this,"orient")),l=p.aroundNodePos;"M"==p.corner.charAt(0)&&"M"==p.aroundCorner.charAt(0)?(this.connectorNode.style.top=l.y+(l.h-this.connectorNode.offsetHeight>>1)-p.y+"px",this.connectorNode.style.left=""):"M"==p.corner.charAt(1)&&"M"==p.aroundCorner.charAt(1)?this.connectorNode.style.left=l.x+(l.w-this.connectorNode.offsetWidth>>
1)-p.x+"px":(this.connectorNode.style.left="",this.connectorNode.style.top="");this._drawBackground();this.domNode.style.opacity="0";this.fadeIn.play();this.isShowingNow=!0;this.aroundNode=b;this.onMouseEnter=g||y;this.onMouseLeave=m||y}},orient:function(a,b,c,f,e){this.connectorNode.style.top="";var g=f.h;f=f.w;a.className="dijitTooltip "+{"MR-ML":"dijitTooltipRight","ML-MR":"dijitTooltipLeft","TM-BM":"dijitTooltipAbove","BM-TM":"dijitTooltipBelow","BL-TL":"dijitTooltipBelow dijitTooltipABLeft",
"TL-BL":"dijitTooltipAbove dijitTooltipABLeft","BR-TR":"dijitTooltipBelow dijitTooltipABRight","TR-BR":"dijitTooltipAbove dijitTooltipABRight","BR-BL":"dijitTooltipRight","BL-BR":"dijitTooltipLeft"}[this._orientKey=b+"-"+c];this.addCustomClasses(this._customClasses);this.domNode.style.width="auto";var n=d.position(this.domNode);n.w=Math.ceil(n.w);if(k("ie")||k("trident"))n.w+=2;d.setMarginBox(this.domNode,{w:Math.min(Math.max(f,1),n.w)});"B"==c.charAt(0)&&"B"==b.charAt(0)?(a=d.position(a),b=this.connectorNode.offsetHeight,
a.h>g?(this.connectorNode.style.top=g-(e.h+b>>1)+"px",this.connectorNode.style.bottom=""):(this.connectorNode.style.bottom=Math.min(Math.max(e.h/2-b/2,0),a.h-b)+"px",this.connectorNode.style.top="")):(this.connectorNode.style.top="",this.connectorNode.style.bottom="");this._drawBackground();return Math.max(0,n.w-f)},_surface:null,_surfaceContainer:null,_drawBackground:function(){if(this._orientKey){var a=this.domNode.clientWidth,b=this.domNode.clientHeight,c=d.position(this.domNode),f=d.position(this.connectorNode),
k=d.position(this.containerNode);f.x-=c.x;f.y-=c.y;k.x-=c.x;k.y-=c.y;k.x+=1;k.y+=1;k.w-=2;k.h-=2;this._surface&&this._surface.destroy();this._surfaceContainer&&e.destroy(this._surfaceContainer);c=this._surfaceContainer=e.create("div",{"class":"esriGEAbsoluteStretched"},this.domNode,"first");c.style.pointerEvents="none";a=this._surface=m.createSurface(c,a,b);b=[{x:k.x,y:k.y},{x:k.x+k.w,y:k.y},{x:k.x+k.w,y:k.y+k.h},{x:k.x,y:k.y+k.h},{x:k.x,y:k.y}];c=f.x+f.w/2;f=f.y+f.h/2;switch(this._orientKey){case "BL-TL":case "BM-TM":case "BR-TR":k=
[{x:c-5,y:k.y},{x:c,y:f},{x:c+5,y:k.y}];b.splice.apply(b,[1,0].concat(k));break;case "ML-MR":case "BL-BR":k=[{x:k.x+k.w,y:f-5},{x:c,y:f},{x:k.x+k.w,y:f+5}];b.splice.apply(b,[2,0].concat(k));break;case "TM-BM":case "TL-BL":case "TR-BR":k=[{x:c+5,y:k.y+k.h},{x:c,y:f},{x:c-5,y:k.y+k.h}];b.splice.apply(b,[3,0].concat(k));break;case "MR-ML":case "BR-BL":k=[{x:k.x,y:f+5},{x:c,y:f},{x:k.x,y:f-5}],b.splice.apply(b,[4,0].concat(k))}k=a.createPolyline(b);f="function"===typeof this._customStyle?this._customStyle():
this._customStyle;k.setFill(f&&f.backgroundColor||"white").setStroke({color:"#d3d3d3",width:1,join:"round"});f&&f.color&&(this.containerNode.style.color=f.color)}}}),D={show:function(a,b,c,f,k){"string"===typeof c&&(c=[c]);c=c&&c.map(function(a){return{after:"after-centered",before:"before-centered"}[a]||a});var d=new w;k&&d.setCustomStyle(k);d.addCustomClasses(f);d.show(a,b,c);return d}};v.setTooltipToNode=function(b,f,k){function d(){!e&&v.showTooltipForNode(b,f,k)}k=k||{};if(b&&!u.isPlayerOnServer&&
(v.hideTooltipForNode(b),b.__setTooltipToNodeMouseEnterHandle&&b.__setTooltipToNodeMouseEnterHandle.remove(),f)){var e=!1;p.isMobileDevice()?b.__setTooltipToNodeMouseEnterHandle=q.addNoDragClickHandler(b,d):b.__setTooltipToNodeMouseEnterHandle=a(b,c.enter,d);k.showTooltip&&d();return{remove:function(){f=null;v.hideTooltipForNode(b)},suspend:function(){v.hideTooltipForNode(b);e=!0},resume:function(){e=!1},refresh:function(){b._shownTooltip&&d()}}}};v.showTooltipForNode=function(b,f,k){function d(){v.hideTooltipForNode(b);
var a=Array.isArray(k.classes)?k.classes.join(" "):k.classes,a=(a||"")+" esriGETooltip";k.notRestricted&&(a+=" notRestricted");b._shownTooltip=n=D.show(e,b,k.position||["after","before"],a,k.style)}if(b&&!u.isPlayerOnServer){v.hideTooltipForNode(b);var e="function"==typeof f?f():f;if(e){k.textAlign&&(e="\x3cdiv class\x3d'"+("start"===k.textAlign?"esriGEStart":"end"===k.textAlign?"esriGEEnd":"")+"'\x3e"+e+"\x3c/div\x3e");g.add(b,"esriGESimpleTextTooltip");var n;d();var m=v.hideTooltipForNode.bind(v,
b);p.isMobileDevice()?b.__setTooltipToNodeMouseLeaveHandle=a(document.body,"touchstart",function(a){r.isMouseOver(b,{event:a})||m()}):b.__setTooltipToNodeMouseLeaveHandle=a.once(b,c.leave,function(){!k.stayOnHover&&m()});k.ignoreNodeRemoval||(b.__setTooltipToNodeInLayoutHandle=setInterval(function(){!t.isNodeInLayout(b)&&m()},300));p.isMobileDevice()||(b.__setTooltipToNodeMouseOverHandle=setInterval(function(){k.stayOnHover&&r.isMouseOver(n.domNode)||r.isMouseOver(b)||m()},300),b.__setTooltipToNodeClickHandle=
a(b,"click",function(a){k.hideOnClick?m():!b._shownTooltip&&d()}),k.stayOnHover&&(b.__setTooltipToNodeMouseLeaveMasterHandle=a(n.domNode,c.leave,m)));return b._shownTooltip}}};v.isShown=function(a){return!(!a||!a._shownTooltip)};v.hideTooltipForNode=function(a){a&&(a.title="",g.remove(a,"esriGESimpleTextTooltip"),a._shownTooltip&&a._shownTooltip.destroy(),delete a._shownTooltip,a.__setTooltipToNodeMouseLeaveHandle&&a.__setTooltipToNodeMouseLeaveHandle.remove(),clearInterval(a.__setTooltipToNodeInLayoutHandle),
clearInterval(a.__setTooltipToNodeMouseOverHandle),a.__setTooltipToNodeClickHandle&&a.__setTooltipToNodeClickHandle.remove(),a.__setTooltipToNodeMouseLeaveMasterHandle&&a.__setTooltipToNodeMouseLeaveMasterHandle.remove())};var B,z;v.autoTooltip=function(b){u.isPlayerOnServer||a(b,".TrimWithEllipses:mouseover",function(){if(this!==B&&this.offsetWidth<this.scrollWidth){var b=function(){B=null;z&&(z.tooltip.destroy(),z.mouseOutH.remove(),z.mouseMoveH.remove(),z=null)};b();B=this;z={tooltip:D.show(B.textContent,
B,["above","below"]),mouseOutH:a.once(B,"mouseout, mousedown, touchstart",b),mouseMoveH:a(document.body,"mousemove",function(){r.isMouseOver(B)||b()})}}})};v.showClosableTooltip=function(a){var b=v._createClosableTooltip(a.message,a.tooltipClass,a.position);return v._placeClosableTooltip(b,a.node,a.timeout,a.position,a.onClosed)};v.removeClosableTooltip=function(a){a&&a._removeFunc&&a._removeFunc()};v._createClosableTooltip=function(a,b,c){function f(){var a=e.create("div",{"class":"esriGEClosableTooltipTip"},
d);g.add(a,"right"===c?"esriGEClosableTooltipTipRight":"esriGEClosableTooltipTipLeft")}function k(){n=e.create("div",{"class":"esriGEClosableTooltipBody"},d);e.create("div",{innerHTML:a,"class":"esriGEClosableTooltipLabel"},n);m=e.create("div",{"class":"esriGEClosableTooltipCloseButton"},n)}var d=e.create("div",{"class":"esriGEClosableTooltip esriGENonSelectable "+(b||"")},document.body),n,m;"right"!==c?(k(),f()):(f(),k());d.style.position="fixed";return{tooltip:d,body:n,closeButton:m}};v._placeClosableTooltip=
function(c,f,k,e,g){function n(){var a=d.position(f),k=a.x+";"+a.y+";"+a.w+";"+a.h;k!==h&&(h=k,k=d.getMarginBox(c.tooltip),b.set(c.tooltip,{left:(m?a.x+a.w:a.x-k.w)+"px",top:a.y+a.h/2-k.h/2+"px"}))}var m="rtl"===document.dir&&"right"!==e||"rtl"!==document.dir&&"right"===e,h;n();var p,l,q,r,u,y=function(){p&&clearTimeout(p);l&&clearInterval(l);q&&clearInterval(q);r&&r.remove();c.tooltip.parentNode&&c.tooltip.parentNode.removeChild(c.tooltip)};l=setInterval(function(){t.isNodeInLayout(f)&&f.parentNode||
(u=!1,y());t.isNodeVisible(f)&&t.isNodeOnscreen(f)?(u=!0,t.show(c.tooltip)):(u=!1,t.hide(c.tooltip))},0);q=setInterval(function(){u&&n()},0);k&&(p=setTimeout(y,k));r=a(c.closeButton,"click",function(){y();g&&g()});c.tooltip._removeFunc=y;return c.tooltip};v.showTooltipForNode(document.body,"Normal \x3cb\x3eBold\x3c/b\x3e \x3ci\x3eItalic\x3c/i\x3e",{});v.hideTooltipForNode(document.body);return v})},"esri/dijit/geoenrichment/utils/DnDUtil":function(){define(["dojo/on","dojo/sniff","./DeviceUtil","./KeyboardUtil"],
function(l,h,g,e){var d={MOBILE_TOLERANCE:10,LONG_PRESS_TIMEOUT:500,addNoDragClickHandler:function(b,a,c){c=c||{};return g.isMobileDevice()?d._addMobile(b,a,c):d._addPC(b,a,c)},_addPC:function(b,a,c){var k=c.tolerance||0,f,d,g=l(b,"mousedown",function(b){d&&d.remove();var c=b.clientX,g=b.clientY,n;f=l(document.body,"mousemove",function(a){if(!a.shiftKey&&!e.isCtrl(a)){var b=a.clientY;if(0<Math.abs(a.clientX-c)||0<Math.abs(b-g))n=!0}});d=l.once(document.body,"mouseup",function(b){f.remove();var d=
b.clientX,e=b.clientY;!n&&Math.abs(d-c)<=k&&Math.abs(e-g)<=k&&a(b)})});return{remove:function(){f&&f.remove();d&&d.remove();g&&g.remove()}}},_addMobile:function(b,a,c){function k(){g&&g.remove();h&&h.remove();q&&q.remove();clearTimeout(t)}var f=c.tolerance||d.MOBILE_TOLERANCE,e,g,h,q,t;e=l(b,"touchstart",function(e){function n(a){return Math.abs(e.clientX-a.clientX)<f&&Math.abs(e.clientY-a.clientY)<f}k();var m;if(c.detectLongPress){var p;h=l(b,"touchmove",function(a){p=a});t=setTimeout(function(){n(p||
e)&&(c.ignoreReleaseIfLongPressHappened&&(m=!0),c.longPressCallback(e))},c.longPressTimeout||d.LONG_PRESS_TIMEOUT)}g=l.once(b,"touchend",function(b){!m&&n(b)&&a(b);k()});q=l.once(b,"touchcancel",k)});return{remove:function(){e&&e.remove();k()}}},addGlobalDragHanlder:function(b){function a(){c&&c.remove();k&&k.remove();f&&f.remove();d&&d.remove();m&&b.destroyDnDBox&&b.destroyDnDBox(m)}b.tolerance=0<b.tolerance?b.tolerance:5;var c,k,f,d,m;return l(b.node,b.downEventName||g.press,function(n){a();if(!b.onMouseDown||
b.onMouseDown(n)){var p=n.clientX,t=n.clientY,r=p,u=t;c=l(document.body,g.move,function(n){function q(){a();b.dragEnded&&b.dragEnded()}n.shiftKey||e.isCtrl(n)||!(Math.abs(p-n.clientX)>=b.tolerance||Math.abs(t-n.clientY)>=b.tolerance)||(c.remove(),b.dragStarted&&!b.dragStarted(n,n.clientX-r,n.clientY-u))||(r=n.clientX,u=n.clientY,m=b.createDnDBox&&b.createDnDBox(),k=l(document.body,g.move,function(a){b.dragMoved&&b.dragMoved(a,a.clientX-r,a.clientY-u,q);r=a.clientX;u=a.clientY}),f=l.once(document.body,
h("ie")||h("trident")?"mouseup, touchend, click":"mouseup, touchend",function(){q()}),d=l(document.body,"keyup",function(c){27==c.keyCode&&(a(),b.dragCanceled&&b.dragCanceled())}))});l.once(document.body,h("ie")||h("trident")?"mouseup, touchend, click":"mouseup, touchend",function(){c.remove()})}})}};return d})},"esri/dijit/geoenrichment/utils/KeyboardUtil":function(){define(["dojo/on","dojo/sniff","./DomUtil"],function(l,h,g){var e={listenToKeyboardCombinationOverNode:function(d){return l(document.body,
"keydown",function(b){if(!d.isCtrl||e.isCtrl(b))if(!d.isShift||b.shiftKey)if(!d.isAlt||b.altKey)String.fromCharCode(b.keyCode).toLowerCase()!==d["char"]||d.node&&!g.isNodeInLayout(d.node)||d.callback(b)})},isCtrl:function(d){return h("mac")?d.metaKey:d.ctrlKey}};return e})},"esri/dijit/geoenrichment/utils/MouseUtil":function(){define("dojo/_base/lang dojo/on dojo/sniff dojo/touch dojo/dom-geometry ./DomUtil dojo/domReady!".split(" "),function(l,h,g,e,d,b){var a={_latestEvent:null,_setLatestEvent:function(b){a._latestEvent=
b}};g("touch")?(h(document.body,e.press,function(b){a._setLatestEvent(a.fixTouchEvent(b,!0))}),h(document.body,e.move,function(b){a._setLatestEvent(a.fixTouchEvent(b,!0))})):h(document.body,"mousemove",function(b){a._setLatestEvent(a.fixTouchEvent(b,!0))});var c;h(document.body,"mousedown",function(){c||(c=!0,h.once(document.body,"mouseup, click",function(){c=!1}))});a.getCursorPosition=function(){return a._latestEvent};a.isMouseOver=function(c,f){var k=f&&f.event||a._latestEvent;if(!(c&&c.parentNode&&
c.getBoundingClientRect&&k))return!1;if(f&&f.checkAllChildren){f=l.mixin({},f);delete f.checkAllChildren;var e=!1;b.traverseChildren(c,function(b){if(a.isMouseOver(b,f))return e=!0});return e}return a.isMouseOverBox(d.position(c),f)};a.isMouseOverBox=function(b,c){if(!b)return!1;var f=c&&c.event||a._latestEvent;c&&c.ignoreBorderTolerance&&(c=c.ignoreBorderTolerance,b=l.mixin({},b),b.x+=c,b.y+=c,b.w-=2*c,b.h-=2*c);return b.x<=f.clientX&&b.x+b.w>=f.clientX&&b.y<=f.clientY&&b.y+b.h>=f.clientY};a.fixTouchEvent=
function(a,b){a=b?l.mixin({},a):a;a.touches&&1===a.touches.length?(b=a.touches[0],a.clientX=b.clientX,a.clientY=b.clientY,a.pageX=b.pageX,a.pageY=b.pageY):a.changedTouches&&1===a.changedTouches.length&&(b=a.changedTouches[0],a.clientX=b.clientX,a.clientY=b.clientY,a.pageX=b.pageX,a.pageY=b.pageY);return a};a.isBeingDragged=function(){return c};a.addOverOutHandler=function(b){function c(){clearTimeout(d);k&&k.remove()}var k,d,e=h(b.node,"mouseover",function(f){function e(){a.isMouseOver(b.node)&&(b.onMouseOver(f),
k=h(document.body,"mousemove",function(f){a.isMouseOver(b.node)||(c(),b.onMouseOut(f))}))}c();b.delayTimeout?d=setTimeout(e,b.delayTimeout):e()});return{remove:function(){e.remove();c()}}};a.addOutHandler=function(b,c){return h(document.body,"mousemove",function(f){a.isMouseOver(b,{checkAllChildren:!0})||c(f)})};return a})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_PrintSupport":function(){define(["require","dojo/_base/declare","esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when",
"../ReportPlayerState"],function(l,h,g,e,d){function b(){var a=new g;l(["../printing/PrintableContainer"],function(b){a.resolve(b)});return a.promise}return h(null,{_getPrintableContainer:function(a){var c=this;d.isAnimationSuspended=!0;return c._showWaiting(b(),"loadPrintModules").then(function(b){var f=new b(c,c._viewModel);a.onShowWaiting=function(a){c._showWaiting(a,"initPrintContainer")};return e(f.initialize(a),function(a){d.isAnimationSuspended=!1;return a?a:e(f.stop(),function(){return null})})})},
_getPrintDialogSettings:function(){var a=this;return b().then(function(b){return(new b(a,a._viewModel)).getPrintDialogSettings()})}})})},"esri/dijit/geoenrichment/ReportPlayer/ReportPlayerState":function(){define([],function(){return{isImageViewerShown:!1,isViewingDataDrillingZoom:!1,isViewingDynamicSettings:!1,isAnimationSuspended:!1}})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_ReportContainersSwitcher":function(){define("dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct ../PlayerViewModes esri/dijit/geoenrichment/utils/DomUtil".split(" "),
function(l,h,g,e,d,b){var a={createContainer:function(a,b){var c=a.getCurrentAnalysisAreaIndex();a.viewMode===d.PANELS_IN_STACK_ALL&&(c=0);var f=b.getContainer(c);if(!f){switch(a.viewMode){case d.PANELS_IN_SLIDES:f=this._createPaginationReportContainer(a);break;case d.PANELS_IN_STACK:f=this._createStackReportContainer(a);break;case d.PANELS_IN_STACK_ALL:f=this._createStackReportContainerAll(a);break;default:f=this._createFullPageReportContainer(a)}f.isCurrentContainer=function(){return a.getCurrentReportContainer()===
f}}b.setContainer(f,c);return f},_createPaginationReportContainer:function(a){var b=a._viewModel;return b.layoutBuilder.createElement("reportContainerPagination",{viewModel:b,parentWidget:a,currentFeatureIndex:a.getCurrentAnalysisAreaIndex(),scaleSectionsToFit:a.scaleSlidesToFitWindow,onResized:function(b){a.playerToolbar.update();a._emitResizedEvent(b)},onPendingDataApplied:function(){a._emitResizedEvent()}},a.reportContainerDiv)},_createStackReportContainer:function(a){var b=a._viewModel,c={center:!0,
minRight:10,minBottom:10,minLeft:10,minTop:a.showToolbarInPopup?43:10};return b.layoutBuilder.createElement("reportContainerStack",{viewModel:b,parentWidget:a,currentFeatureIndex:a.getCurrentAnalysisAreaIndex(),isVertical:!0,renderOptions:c,onPendingDataApplied:function(){a._emitResizedEvent()}},a.reportContainerDiv)},_createStackReportContainerAll:function(a){var b=a._viewModel;return b.layoutBuilder.createElement("reportContainerStackAll",{viewModel:b,parentWidget:a,isVertical:!0,renderOptions:{center:!0,
minRight:10,minBottom:10,minLeft:10,minTop:a.showToolbarInPopup?43:0},onPendingDataApplied:function(){a._emitResizedEvent()},onSwitchToSingleAreaView:function(){a.showAnalysisAreaAt(0)}},a.reportContainerDiv)},_createFullPageReportContainer:function(a){var b=a._viewModel,c={viewModel:b,parentWidget:a,currentFeatureIndex:a.getCurrentAnalysisAreaIndex(),onPendingDataApplied:function(){a._emitResizedEvent()}};c.renderOptions={center:!0,minRight:10,minBottom:10,minLeft:10,minTop:a.showToolbarInPopup?
43:10};return b.layoutBuilder.createElement(a.getReportData().reportObject.isGraphicReport?"reportContainerGrid":"reportContainer",c,a.reportContainerDiv)}},c=l(null,{_containerInfos:null,constructor:function(){this._containerInfos=[]},getContainer:function(a){return this._getInfo(a,"container")},getContainers:function(){return this._containerInfos.map(function(a){return a.container})},getContainerIndex:function(a){return this.getContainers().indexOf(a)},setContainer:function(a,b){h.set(a.domNode,
"area-index",b);this._getInfo(b,null,a)},isLoaded:function(a){return this._getInfo(a,"loaded")},setLoaded:function(a){if(a=this._getInfo(a))a.loaded=!0},resetAllLoaded:function(){this._containerInfos.forEach(function(a){a.loaded=!1})},destroyAllContainers:function(){this._containerInfos.forEach(function(a){a.container.destroy()});this._containerInfos.length=0},_getInfo:function(a,b,c){var f=this._containerInfos[a];!f&&c&&(f=this._containerInfos[a]={container:c,loaded:!1});return b?f&&f[b]:f}}),k=
l(null,{_lastVisuals:null,reset:function(){this._lastVisuals=null},rememberCurrentContainerVisuals:function(a){this._lastVisuals=a?{scrollTop:a.getScrollableContainer&&a.getScrollableContainer().scrollTop||0,pageIndex:a.getCurrentPageIndex&&a.getCurrentPageIndex()||0,slideIndex:a.getCurrentSlideIndex&&a.getCurrentSlideIndex()||0,zoomInfo:a.getZoomInfo&&a.getZoomInfo()}:null},applyCurrentContainerVisuals:function(a){this._lastVisuals&&(a.getScrollableContainer&&(a.getScrollableContainer().scrollTop=
this._lastVisuals.scrollTop||0),a.showSlideAt&&a.showSlideAt(this._lastVisuals.slideIndex||0),a.showPageAt?a.showPageAt(this._lastVisuals.pageIndex||0):a.notifyShown(),a.setZoomInfo&&a.setZoomInfo(this._lastVisuals.zoomInfo))}});return l(null,{_containerDict:null,_visualsHelper:null,_initContainerSwither:function(){this._containerDict=new c;this._visualsHelper=new k},getCurrentReportContainer:function(){return this._currentReportContainer},getAllReportContainers:function(){return this._containerDict.getContainers()},
_destroyAllContainers:function(){this._containerDict.destroyAllContainers();this._currentReportContainer=null},_setReportContainer:function(a){a?this._resetLoadedFlags():this._visualsHelper.rememberCurrentContainerVisuals(this._currentReportContainer);this._switchToCurrentReportContainer();return!a&&this._containerDict.isLoaded(this.getCurrentAnalysisAreaIndex())?(this._resize({isPaginating:!0}),this._visualsHelper.applyCurrentContainerVisuals(this._currentReportContainer),!1):!0},_switchToCurrentReportContainer:function(){this._currentReportContainer&&
this._hideContainer(this._currentReportContainer);this._currentReportContainer=a.createContainer(this,this._containerDict);g.remove(this.domNode,"esriGEReportPlayerFullView esriGEReportPlayerPaginationView esriGEReportPlayerStackView");switch(this.viewMode){case d.PANELS_IN_SLIDES:g.add(this.domNode,"esriGEReportPlayerPaginationView");break;case d.PANELS_IN_STACK:g.add(this.domNode,"esriGEReportPlayerStackView");break;case d.PANELS_IN_STACK_ALL:g.add(this.domNode,"esriGEReportPlayerStackAllView");
break;default:g.add(this.domNode,"esriGEReportPlayerFullView")}this._showContainer(this._currentReportContainer);this._connectZoomToCurrentContainer();this.notifyShown()},_hideContainer:function(a){this.isPlayerOnServer||(a.__undoHideContainerHandle=b.hideNodeInBackground(a.domNode,"reportContainer_"+this._containerDict.getContainerIndex(a)),a.own(a.__undoHideContainerHandle))},_showContainer:function(a){!this.isPlayerOnServer&&a.__undoHideContainerHandle&&(a.__undoHideContainerHandle.undo(),delete a.__undoHideContainerHandle)},
_showAllContainers:function(){var a=this;this.getAllReportContainers().forEach(function(b){a._showContainer(b);a.reportContainerDiv.removeChild(b.domNode);e.place(b.domNode,a.reportContainerDiv)});return{undo:function(){a.getAllReportContainers().forEach(function(b){a._hideContainer(b)});a._switchToCurrentReportContainer()}}},_resetLoadedFlags:function(){this._visualsHelper.reset();this._containerDict.resetAllLoaded()},_setCurrentContainerLoaded:function(){this._visualsHelper.applyCurrentContainerVisuals(this._currentReportContainer);
this._containerDict.setLoaded(this.getCurrentAnalysisAreaIndex())}})})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_SmartLayoutSupport":function(){define("dojo/_base/declare dojo/dom-class dojo/on esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/DomUtil ../PlayerResizeModes ../PlayerViewModes".split(" "),function(l,h,g,e,d,b,a){return l(null,{_width:0,_height:0,_measuredWinBox:null,_initSmartLayout:function(){var a=this;this.resizeMode===b.FIT_WINDOW&&this.own(g(window,
"resize, orientationchange",function(){setTimeout(function(){a._measuredWinBox=null;a.resize()})}));this._resize()},_resize:function(a){a=a||{};h.remove(this.domNode,"esriGEReportPlayerFullScreen esriGEReportPlayerAutoResize esriGEReportPlayerManualResize");switch(this.resizeMode){case b.FIT_WINDOW:return this._resize_fitWindow(a);case b.AUTO:return this._resize_auto(a);case b.MANUAL:return this._resize_manual(a)}},_resize_fitWindow:function(a){this._measuredWinBox=this._measuredWinBox||d.getWindowBox();
this._width=this._maxWidth=this._measuredWinBox.w;this._height=this._maxHeight=this._measuredWinBox.h;h.add(this.domNode,"esriGEReportPlayerFullScreen");this.domNode.style.width=this._width+"px";this.domNode.style.height=this._height+"px";this._currentReportContainer&&(this._currentReportContainer.setMaxWidth&&this._currentReportContainer.setMaxWidth(this._maxWidth),this._currentReportContainer.setMaxHeight&&this._currentReportContainer.setMaxHeight(this._maxHeight-this._getToolbarHeight()),this._currentReportContainer.resize(this._width,
this._height-this._getToolbarHeight()),this._emitResizedEvent(a.isPaginating))},_resize_auto:function(a){this._height=this._width=0;h.add(this.domNode,"esriGEReportPlayerAutoResize");this.domNode.style.width="auto";this.domNode.style.height="auto";this._currentReportContainer&&(this._currentReportContainer.setMaxWidth&&this._currentReportContainer.setMaxWidth(this._maxWidth),this._currentReportContainer.setMaxHeight&&this._currentReportContainer.setMaxHeight(this._maxHeight-this._getToolbarHeight()),
this._currentReportContainer.resize(0,0),this._emitResizedEvent(a.isPaginating))},_resize_manual:function(a){this._width=void 0!==a.width?a.width:this._width;this._height=void 0!==a.height?a.height:this._height;this._width&&this._height&&(this._maxWidth&&(this._width=Math.min(this._maxWidth,this._width)),this._maxHeight&&(this._height=Math.min(this._maxHeight,this._height)),h.add(this.domNode,"esriGEReportPlayerManualResize"),this.domNode.style.width=this._width+"px",this.domNode.style.height=this._height+
"px",this._currentReportContainer&&(this._currentReportContainer.setMaxWidth&&this._currentReportContainer.setMaxWidth(this._maxWidth||this._width),this._currentReportContainer.setMaxHeight&&this._currentReportContainer.setMaxHeight((this._maxHeight||this._height)-this._getToolbarHeight()),this._currentReportContainer.resize(this._width,this._height-this._getToolbarHeight()),this._emitResizedEvent(a.isPaginating)))},_getToolbarHeight:function(){if(this.showToolbarInPopup)return 0;var b=this.playerToolbar&&
0===this.playerToolbar.toolbarHolder.infographicsSelectDiv.children.length,k=!this.showAreaTitle,f=this._reportData&&(this._reportData.isMultiFeature||1===this._reportData.analysisAreas.length),d=this.viewMode===a.PANELS_IN_SLIDES,g=e.isMobileDevice();return b&&k&&f&&d&&g?0:50},_maxWidth:0,_maxHeight:0,setMaxWidth:function(a){this._maxWidth=a},setMaxHeight:function(a){this._maxHeight=a}})})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_ZoomSupport":function(){define(["dojo/_base/declare",
"dojo/aspect","../PlayerResizeModes","../PlayerViewModes","../PlayerZoomBehaviors"],function(l,h,g,e,d){return l(null,{_initZoomControls:function(){var b=this;this.playerToolbar.onZoomToFitPage=function(){b.getCurrentReportContainer().zoomToFitPage({showAnimation:!0})};this.playerToolbar.onZoomToFitPageWidth=function(){b.getCurrentReportContainer().zoomToFitPageWidth({showAnimation:!0})};this.playerToolbar.onZoomToFitPageHeight=function(){b.getCurrentReportContainer().zoomToFitPageHeight({showAnimation:!0})};
this.playerToolbar.onSetZoomPercent=function(a){b.getCurrentReportContainer().setZoomPercent(a,{showAnimation:!0})};this._refreshZoomControls()},_refreshZoomControls:function(){this.playerToolbar&&this.playerToolbar.setZoomSupportsInfo(this._getZoomSupportsInfo())},setBestZoom:function(){this._callZoomMethod("setBestZoom")},zoomToFitPage:function(){this._callZoomMethod("zoomToFitPage")},zoomToFitPageWidth:function(){this._callZoomMethod("zoomToFitPageWidth")},zoomToFitPageHeight:function(){this._callZoomMethod("zoomToFitPageHeight")},
resetZoom:function(){this._callZoomMethod("resetZoom")},_callZoomMethod:function(b){if(this._getZoomSupportsInfo().supported){var a=this.getCurrentReportContainer();a&&a[b]&&a[b]()}},_getZoomSupportsInfo:function(){var b={supported:!1,canFitPage:!1,canFitPageWidth:!1,canFitPageHeight:!1};this.viewMode!==e.PANELS_IN_SLIDES&&(b.supported=!0,this.resizeMode!==g.AUTO&&(b.canFitPage=!e.isStackLike(this.viewMode),b.canFitPageWidth=!0,b.canFitPageHeight=!1));return b},_updateZoomControls:function(){this._connectZoomToCurrentContainer();
this._applyDefaultZoomBehavior()},_reportContainerZoomChangedHandle:null,_connectZoomToCurrentContainer:function(){var b=this.getCurrentReportContainer();this._reportContainerZoomChangedHandle&&this._reportContainerZoomChangedHandle.remove();this._reportContainerZoomChangedHandle=b&&h.after(b,"onZoomChanged",function(){if(this.playerToolbar){var a=this.getCurrentReportContainer();a&&a.getZoomInfo&&this.playerToolbar.setZoomInfo(this.getCurrentReportContainer().getZoomInfo());this._updatePageNavigator();
this.playerToolbar.update()}}.bind(this));b&&b.own(this._reportContainerZoomChangedHandle)},_applyDefaultZoomBehavior:function(){var b=this._getZoomSupportsInfo();b.supported&&b.canFitPage&&this.defaultZoomBehavior===d.FIT_PAGE?this.zoomToFitPage():b.supported&&b.canFitPageWidth&&this.defaultZoomBehavior===d.FIT_PAGE_WIDTH?this.zoomToFitPageWidth():b.supported&&b.canFitPageHeight&&this.defaultZoomBehavior===d.FIT_PAGE_HEIGHT?this.zoomToFitPageHeight():this.resetZoom()}})})},"esri/dijit/geoenrichment/ReportPlayer/PlayerZoomBehaviors":function(){define([],
function(){var l={RESET:"reset",FIT_PAGE:"fitPage",FIT_PAGE_WIDTH:"fitPageWidth",FIT_PAGE_HEIGHT:"fitPageHeight",isSupported:function(h){for(var g in l)if(l[g]===h)return!0;return!1},toSupportedValue:function(h){return l.isSupported(h)?h:l.RESET}};return l})},"esri/dijit/geoenrichment/ReportPlayer/playerSupports/_WaitingSupport":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when dojo/dom-class dojo/dom-construct ../PlayerResizeModes esri/dijit/geoenrichment/utils/DelayUtil esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/WaitingUtil esri/dijit/geoenrichment/utils/progress/SmoothProgress".split(" "),
function(l,h,g,e,d,b,a,c,k,f){var n=l(null,{_dataProgress:0,_areaProgresses:null,_numAreas:0,constructor:function(a){h.mixin(this,a);this.reset()},reset:function(){this._dataProgress=0;this._areaProgresses={};this._fireProgress()},setLoadDataProgress:function(a){this._dataProgress=a;this._fireProgress()},setNumAreas:function(a){this._numAreas=a},setProgressForAreaAt:function(a,b){this._areaProgresses[b]=a;this._fireProgress()},finalize:function(){this.onChange(1);return a.delay(300)},_fireProgress:function(){var a=
.25*this._dataProgress,b=.75/this._numAreas,c;for(c in this._areaProgresses)a+=b*(this._areaProgresses[c]||0);a=Math.min(.999999,Math.max(0,a));this.onChange(a);this._printProgress()},_printProgress:function(){},onChange:function(a){}});return l(null,{_progressController:null,_initProgressController:function(){var a=this;this.showProgressBar&&(this._progressController=new n,(new f(this._progressController)).onChange=function(b){k.showProgressBar({value:b,node:a.domNode,position:"top"})})},_waitingCount:0,
_hideUndoHandle:null,_waitNode:null,getWaitingPromise:function(){return k.getProgressPromiseForNode(this._waitNode||this.domNode)},_showWaiting:function(a,f){var e=this;if(this.isPlayerOnServer)return a;this.onWaitingShown(a);return this.resizeMode!==b.FIT_WINDOW?(0===this._waitingCount++&&(this._updateElementsVisibility(),this._waitNode=d.create("div",{"class":"esriGEReportPlayerWaitingNode"},this.domNode.parentNode),this._waitNode.style.width=this.domNode.clientWidth?this.domNode.clientWidth+"px":
"",this._waitNode.style.height=this.domNode.clientHeight?this.domNode.clientHeight+"px":"",this._waitNode.style.position="relative",this._hideUndoHandle=c.hideNodeInBackground(this.domNode)),g(a)["finally"](function(){0===--e._waitingCount&&(e._hideUndoHandle.undo(),e._hideUndoHandle=null,d.destroy(e._waitNode),e._updateElementsVisibility())}),k.showProgressPromise(this._waitNode,a,{progressClass:"esriGEReportPlayerProgress"})):this._showWaitingFullScreen(a,f)},_showWaitingFullScreen:function(b,c){return k.showProgressPromise(this.domNode,
b,{progressClass:"esriGEReportPlayerProgress",onShowProgress:function(){this._waitingCount++;this._updateElementsVisibility()}.bind(this),onRemoveProgress:function(){if(this.domNode){this._waitingCount--;this._updateElementsVisibility();var b=this.getCurrentReportContainer();b&&!b.__isBeingAnimated&&(b.__isBeingAnimated=!0,b.domNode&&e.add(b.domNode,"esriGEReportPlayer_fadeIn1000"),b.notifyShown(),a.delay(1500).then(function(){b.__isBeingAnimated=!1;b.domNode&&e.remove(b.domNode,"esriGEReportPlayer_fadeIn1000")}))}}.bind(this)})},
onWaitingShown:function(a){}})})},"esri/dijit/geoenrichment/utils/DelayUtil":function(){define(["esri/dijit/geoenrichment/Deferred"],function(l){return{delay:function(h,g){var e=new l,d="function"===typeof h?h:null;setTimeout(e.resolve,("number"===typeof h?h:g)||0);return e.promise.then(function(){return d&&d()})}}})},"esri/dijit/geoenrichment/utils/WaitingUtil":function(){define("esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when dojo/dom-construct dojo/dom-geometry dojo/dom-style esri/dijit/geoenrichment/ReportPlayer/config".split(" "),
function(l,h,g,e,d,b){var a={showProgress:function(a,k){b.isPlayerOnServer||a&&!a["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"]&&(a["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"]=g.create("div",{"class":"esriGEProgress esriGEProgressAbsolute "+(k||"")},a))},removeProgress:function(a){a&&a["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"]&&(g.destroy(a["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"]),delete a["esri.dijit.geoenrichment.util.WaitingUtil.waitingDiv"])},
showProgressBar:function(a){var b=a.node;if(b){b._progressBar&&g.destroy(b._progressBar);delete b._progressBar;var c=Number(a.value);0>=c||isNaN(c)||(c=Math.min(c,1),b._progressBar=g.create("div",{"class":"esriGEWaitingMessageProgressBar esriGEWaitingMessageProgressBar_"+(a.position||"bottom")},b),d.set(b._progressBar,"width",e.position(b).w*c+"px"))}},showProgressPromise:function(b,k,f){if(!b)return k;f=f||{};void 0===b.__progressIndex&&(b.__progressIndex=0);0===b.__progressIndex&&(b.__progressDfd=
new l,a.showProgress(b,f.progressClass),f.onShowProgress&&f.onShowProgress());b.__progressIndex++;h(k)["finally"](function(){b.__progressIndex=Math.max(0,--b.__progressIndex);0===b.__progressIndex&&(b.__progressDfd&&b.__progressDfd.resolve(),delete b.__progressDfd,a.removeProgress(b),f.onRemoveProgress&&f.onRemoveProgress())});return k},getProgressPromiseForNode:function(a){return a&&a.__progressDfd&&a.__progressDfd.promise}};return a})},"esri/dijit/geoenrichment/utils/progress/SmoothProgress":function(){define(["dojo/_base/declare",
"dojo/aspect"],function(l,h){return l(null,{elasticTime:1E3,fireInterval:30,_intervalHandle:null,_progressHandle:null,_realProgress:0,_smoothProgress:0,_runAheadSpeed:2.5E-4,_currentSpeed:0,constructor:function(g){0<g.fireInterval&&(this.fireInterval=g.fireInterval);0<g.elasticTime&&(this.elasticTime=g.elasticTime);0<g.timeEstimate&&(this._runAheadSpeed=Math.min(this.fireInterval/g.timeEstimate,.5));var e=this;this._progressHandle=h.after(g,"onChange",function(d){1<=d?e._finalize():e._updateProgress(d)},
!0)},start:function(){this._updateProgress(0,!0)},_updateProgress:function(g,e){this._realProgress=Math.max(g,0);if(0===this._realProgress&&(this._smoothProgress=0,this._setIntervalHandle(!1),this.onChange(0),!e))return;this._setIntervalHandle(!0);this._currentSpeed=this._smoothProgress>=this._realProgress?this._runAheadSpeed:(this._realProgress-this._smoothProgress)*this.fireInterval/this.elasticTime},_setIntervalHandle:function(g){g!==!!this._intervalHandle&&(g?this._intervalHandle=setInterval(this._tryFireProgress.bind(this),
this.fireInterval):(clearInterval(this._intervalHandle),this._intervalHandle=null))},_tryFireProgress:function(){0!==this._currentSpeed&&(this._smoothProgress+=this._currentSpeed,this._smoothProgress=Math.min(1-this._runAheadSpeed,this._smoothProgress),this._smoothProgress>=this._realProgress&&(this._currentSpeed=this._runAheadSpeed),this.onChange(this._smoothProgress))},_finalize:function(){this._smoothProgress=this._realProgress=1;this.onChange(1)},onChange:function(g){},destroy:function(){this._progressHandle.remove();
this._setIntervalHandle(!1)}})})},"esri/dijit/geoenrichment/ReportPlayer/supportClasses/PlayerConfigurator":function(){define("../PlayerResizeModes ../PlayerZoomBehaviors ../PlayerThemes ../PlayerViewModes ../config esri/dijit/geoenrichment/utils/DeviceUtil".split(" "),function(l,h,g,e,d,b){var a={configurePlayer:function(c,k){c._originalConfigurationSettings||(c.theme=c.theme&&g.toSupportedValue(c.theme)||g.DARK,c.viewMode=c.viewMode&&e.toSupportedValue(c.viewMode),c.resizeMode=c.resizeMode&&l.toSupportedValue(c.resizeMode)||
l.FIT_WINDOW,c.defaultZoomBehavior=c.defaultZoomBehavior&&h.toSupportedValue(c.defaultZoomBehavior),c._originalConfigurationSettings={viewMode:c.viewMode,defaultZoomBehavior:c.defaultZoomBehavior,scaleSlidesToFitWindow:c.scaleSlidesToFitWindow,showAreaTitle:c.showAreaTitle});c.viewMode=k||c._originalConfigurationSettings.viewMode||a.getDefaultViewMode(c);switch(c.viewMode){case e.FULL_PAGES:a._configure_fullPages(c);break;case e.PANELS_IN_SLIDES:a._configure_panelsInSlides(c);break;case e.PANELS_IN_STACK:a._configure_panelsInStack(c);
break;case e.PANELS_IN_STACK_ALL:a._configure_panelsInStackAll(c)}c._viewModel.setAnimationSuspended(c.viewMode===e.PANELS_IN_STACK_ALL);b.isMobileDevice()&&(d.modules.exportCommands=!1);d.modules.complexCellTooltips=c.viewMode===e.FULL_PAGES||c.viewMode===e.PANELS_IN_STACK_ALL},getDefaultViewMode:function(a){return b.isMobileDevice()&&!b.isWebLayout()?b.isLandscape()?e.PANELS_IN_SLIDES:e.PANELS_IN_STACK:e.FULL_PAGES},_configure_fullPages:function(a){a.showAreaTitle=!1!==a._originalConfigurationSettings.showAreaTitle;
a.scaleSlidesToFitWindow=!1;switch(a.resizeMode){case l.FIT_WINDOW:a.defaultZoomBehavior=a._originalConfigurationSettings.defaultZoomBehavior||(b.isMobileDevice()?h.FIT_PAGE_WIDTH:null)||h.FIT_PAGE;break;case l.AUTO:a.defaultZoomBehavior=h.RESET;break;case l.MANUAL:a.defaultZoomBehavior=a._originalConfigurationSettings.defaultZoomBehavior||h.FIT_PAGE}},_configure_panelsInSlides:function(a){a.showAreaTitle=!!a._originalConfigurationSettings.showAreaTitle;a.defaultZoomBehavior=null;switch(a.resizeMode){case l.FIT_WINDOW:a.scaleSlidesToFitWindow=
!1!==a._originalConfigurationSettings.scaleSlidesToFitWindow;break;case l.AUTO:a.scaleSlidesToFitWindow=!1;break;case l.MANUAL:a.scaleSlidesToFitWindow=!1!==a._originalConfigurationSettings.scaleSlidesToFitWindow}},_configure_panelsInStack:function(a){a.showAreaTitle=!!a._originalConfigurationSettings.showAreaTitle;a.scaleSlidesToFitWindow=!1;switch(a.resizeMode){case l.FIT_WINDOW:a.defaultZoomBehavior=h.FIT_PAGE_WIDTH;break;case l.AUTO:a.defaultZoomBehavior=h.RESET;break;case l.MANUAL:a.defaultZoomBehavior=
h.FIT_PAGE_WIDTH}},_configure_panelsInStackAll:function(a){a.showAreaTitle=!1!==a._originalConfigurationSettings.showAreaTitle;a.scaleSlidesToFitWindow=!1;switch(a.resizeMode){case l.FIT_WINDOW:a.defaultZoomBehavior=h.FIT_PAGE_WIDTH;break;case l.AUTO:a.defaultZoomBehavior=h.RESET;break;case l.MANUAL:a.defaultZoomBehavior=h.FIT_PAGE_WIDTH}},configurePlayerForCustomBuild:function(a,b){b=b||d;b.esriDijitCssUrl=a+"/dijit/themes/claro/claro.css";b.esriCssUrl=a+"/esri/css/esri.css";b.playerSourceRootUrl=
a+"/dojo/dojo.js";b.configScriptText='var dojoConfig \x3d { baseUrl: "'+a+'/", waitSeconds: 60, async: true, locale: typeof dojoConfig !\x3d\x3d "undefined" \x26\x26 dojoConfig.locale || null, packages: [{ name: "dojo", location: "./dojo" }, { name: "dijit", location: "./dijit" }, { name: "dojox", location: "./dojox" }, { name: "dgrid1", location: "./dgrid1" }, { name: "dstore", location: "./dstore" }, { name: "xstyle", location: "./xstyle" }, { name: "esri", location: "./esri" }, { name: "moment", location: "./moment", main: "moment/moment" }] }'}};
return a})},"esri/dijit/geoenrichment/ReportPlayer/PlayerThemes":function(){define([],function(){var l={LIGHT:"light",DARK:"dark",isSupported:function(h){for(var g in l)if(l[g]===h)return!0;return!1},toSupportedValue:function(h){return l.isSupported(h)?h:l.DARK}};return l})},"esri/dijit/geoenrichment/ReportPlayer/supportClasses/PlayerToFullScreenAnimator":function(){define(["esri/dijit/geoenrichment/utils/animation/AnimationUtil","esri/dijit/geoenrichment/utils/DelayUtil"],function(l,h){return{animateTo:function(g){if(!g._isAnimatedTo){g._isAnimatedTo=
!0;var e=l.animateResize({duration:300,domNode:g.domNode,startScaleX:.3,startScaleY:.3,fromOffset:{x:"c",y:"c"},toBox:{x:0,y:0,w:document.body.clientWidth,h:document.body.clientHeight}});l.animateFadeIn({domNode:g.domNode,duration:300});return e.then(function(){return h.delay(100)})}},animateFrom:function(g){if(g._isAnimatedTo){g._isAnimatedTo=!1;var e=l.animateResize({duration:300,domNode:g.domNode,endScaleX:.3,endScaleY:.3,toOffset:{x:"c",y:"c"},toBox:{x:(document.body.clientWidth-300)/2,y:(document.body.clientHeight-
200)/2,w:300,h:200}});l.animateFadeOut({domNode:g.domNode,duration:300});return e.then(function(){return h.delay(100)})}}}})},"esri/dijit/geoenrichment/utils/animation/AnimationUtil":function(){define(["dojo/dom-construct","dojo/dom-style","dojo/sniff","./Animator","esri/dijit/geoenrichment/utils/DomUtil"],function(l,h,g,e,d){var b={animateResize:function(a){function b(b){a.domNode=l.create("div",{"class":a.ghostClass},document.body);h.set(a.domNode,{width:b.w+"px",height:b.h+"px"})}function k(b,
c,f){var k,d=a.fromOffset.x,e=a.fromOffset.y;if("number"!==typeof d)switch(k=c.w*f.x,d){case "l":d=0;break;case "r":d=(b.w||0)-k;break;default:d=((b.w||0)-k)/2}if("number"!==typeof e)switch(k=c.h*f.y,e){case "t":e=0;break;case "b":e=(b.h||0)-k;break;default:e=((b.h||0)-k)/2}return{x:b.x+d,y:b.y+e}}function f(b,c,f){var k,d=a.toOffset.x,e=a.toOffset.y;if("number"!==typeof d)switch(k=b.w*f.x,d){case "l":d=0;break;case "r":d=(c.w||0)-k;break;default:d=((c.w||0)-k)/2}if("number"!==typeof e)switch(k=b.h*
f.y,e){case "t":e=0;break;case "b":e=(c.h||0)-k;break;default:e=((c.h||0)-k)/2}return{x:c.x+d,y:c.y+e}}var n=a.fromBox||(a.domFrom||a.domNode)&&d.noTransformPosition(a.domFrom||a.domNode);a.animateGhost&&b(n);var m=a.toBox||d.noTransformPosition(a.domTo);if(n&&m){var p=function(b,c){var f={x:a.startScaleX,y:a.startScaleY},k=0;"fit"===f.x&&(b.w?k=f.x=b.w/c.w:f.x=0);"fit"===f.y&&(b.h?k=Math.max(f.y=b.h/c.h,k):f.y=0);f.x=f.x||k||1;f.y=f.y||k||1;return f}(n,m),q=function(b,c){var f={x:a.endScaleX,y:a.endScaleY},
k=0;"fit"===f.x&&(c.w?k=f.x=c.w/b.w:f.x=0);"fit"===f.y&&(c.h?k=Math.max(f.y=c.h/b.h,k):f.y=0);f.x=f.x||k||1;f.y=f.y||k||1;return f}(n,m);a.fromOffset&&(n=k(n,m,p));a.toOffset&&(m=f(n,m,q));var t=g("webkit")?"webkitTransformOrigin":"transformOrigin";a.domNode.style[t]="0% 0%";return e.animateProperty({obj:a.domNode,duration:a.duration||250,properties:{__x:{start:n.x,end:m.x},__y:{start:n.y,end:m.y},__scaleX:{start:p.x||1,end:q.x},__scaleY:{start:p.y||1,end:q.y}},endFunction:function(){a.animateGhost&&
l.destroy(a.domNode);a.onEnd&&a.onEnd()},progressFunction:function(b,c){var f=g("webkit")?"webkitTransform":"transform";"__x"==b?a.domNode.style.left=c+"px":"__y"==b?a.domNode.style.top=c+"px":"__scaleX"==b?a.domNode.style[f]="scaleX("+c+") scaleY("+(a.domNode.__scaleY||1)+")":"__scaleY"==b&&(a.domNode.style[f]="scaleX("+(a.domNode.__scaleX||1)+") scaleY("+c+")")}}).promise}a.onEnd&&a.onEnd()},animateShrinkResize:function(a){a.endScaleX=a.endScaleX||.1;a.endScaleY=a.endScaleY||.05;return b.animateResize(a)},
animateFadeIn:function(a){return e.animateProperty({obj:a.domNode.style,duration:a.duration||250,properties:{opacity:{start:0,end:1}},endFunction:function(){a.onEnd&&a.onEnd()}}).promise},animateFadeOut:function(a){return e.animateProperty({obj:a.domNode.style,duration:a.duration||250,properties:{opacity:{start:1,end:0}},endFunction:function(){a.onEnd&&a.onEnd()}}).promise},animateSlide:function(a,b,k){var c=k.width;e.animateProperty({obj:a.style,duration:k.duration||250,properties:{left:{start:k.leftToRight?
0:-c,end:k.leftToRight?-c:0,units:"px"},right:{start:k.leftToRight?0:c,end:k.leftToRight?c:0,units:"px"}},endFunction:function(){k.onEnd&&k.onEnd()}});return e.animateProperty({obj:b.style,duration:k.duration||250,properties:{left:{start:k.leftToRight?c:0,end:k.leftToRight?0:c,units:"px"},right:{start:k.leftToRight?-c:0,end:k.leftToRight?0:-c,units:"px"}}}).promise},animateExpand:function(a,b,k){k=k||{};a.style.overflow="hidden";b&&d.show(a);var c=h.get(a,"height");return e.animateProperty({obj:a.style,
duration:k.duration,properties:{height:{start:b?0:c,end:b?c:0,units:"px"}},progressFunction:k.progressFunction,endFunction:function(){!b&&d.hide(a);h.set(a,"height","");h.set(a,"overflow","")}}).promise}};return b})},"esri/dijit/geoenrichment/utils/animation/Animator":function(){define(["esri/dijit/geoenrichment/Deferred","dojo/fx/easing","dojox/gfx/matrix"],function(l,h,g){function e(b){1>b.progress&&!b.isStopped?a.setTimeout(function(){if(b.isStopped)b.endFunction();else{var a=(new Date).getTime();
b.progress=1-(b.endTime-a)/b.duration;b.progress=Math.min(1,b.progress);d(b);e(b)}}):b.endFunction()}function d(a){for(var b in a.params.properties){var c=a.params.properties[b],d=c.easing?"function"===typeof c.easing?c.easing:h[c.easing]:null,d=d?d(a.progress):a.progress,e=c.start+d*(c.end-c.start);a.obj[b]=c.units?e+c.units:e;a.progressFunction&&a.progressFunction(b,e,d)}}var b={},a={_funcs:null,setTimeout:function(a){var b=this;this._funcs?this._funcs.push(a):(this._funcs=[a],setTimeout(function(){var a=
b._funcs;b._funcs=null;a.forEach(function(a){a()})},33))}};b.animateProperty=function(a){var b={},c=new l;b.promise=c.promise;b.params=a;b.obj=a.obj||a.node||{};b.duration=void 0!==a.duration?a.duration:1E3;b.startTime=(new Date).getTime();b.endTime=b.startTime+b.duration;b.progress=0;b.endFunction=function(){a.endFunction&&a.endFunction();c.resolve()};b.progressFunction=a.progressFunction;b.stop=function(){b.isStopped=!0};d(b);e(b);return b};b.animateTransform=function(a){var c=a.shape;c.setTransform(null);
return b.animateProperty({duration:a.duration,properties:{p:{start:0,end:1,easing:a.easing}},progressFunction:function(b,k,d){var f,e,n,m;a.transform.forEach(function(a){var b=a.start[0]+(a.end[0]-a.start[0])*d,c=a.start[1]+(a.end[1]-a.start[1])*d;"translate"===a.name?(f=b,e=c):"scale"===a.name&&(n=b,m=c)});c.setTransform(new g.Matrix2D({dx:f,dy:e,xx:n,yy:m}))},endFunction:function(){c.setTransform(null);a.onEnd&&a.onEnd()}}).promise};return b})},"dojo/fx/easing":function(){define(["../_base/lang"],
function(l){var h={linear:function(g){return g},quadIn:function(g){return Math.pow(g,2)},quadOut:function(g){return g*(g-2)*-1},quadInOut:function(g){g*=2;return 1>g?Math.pow(g,2)/2:-1*(--g*(g-2)-1)/2},cubicIn:function(g){return Math.pow(g,3)},cubicOut:function(g){return Math.pow(g-1,3)+1},cubicInOut:function(g){g*=2;return 1>g?Math.pow(g,3)/2:(Math.pow(g-2,3)+2)/2},quartIn:function(g){return Math.pow(g,4)},quartOut:function(g){return-1*(Math.pow(g-1,4)-1)},quartInOut:function(g){g*=2;return 1>g?
Math.pow(g,4)/2:-.5*(Math.pow(g-2,4)-2)},quintIn:function(g){return Math.pow(g,5)},quintOut:function(g){return Math.pow(g-1,5)+1},quintInOut:function(g){g*=2;return 1>g?Math.pow(g,5)/2:(Math.pow(g-2,5)+2)/2},sineIn:function(g){return-1*Math.cos(Math.PI/2*g)+1},sineOut:function(g){return Math.sin(Math.PI/2*g)},sineInOut:function(g){return-1*(Math.cos(Math.PI*g)-1)/2},expoIn:function(g){return 0==g?0:Math.pow(2,10*(g-1))},expoOut:function(g){return 1==g?1:-1*Math.pow(2,-10*g)+1},expoInOut:function(g){if(0==
g)return 0;if(1==g)return 1;g*=2;if(1>g)return Math.pow(2,10*(g-1))/2;--g;return(-1*Math.pow(2,-10*g)+2)/2},circIn:function(g){return-1*(Math.sqrt(1-Math.pow(g,2))-1)},circOut:function(g){return Math.sqrt(1-Math.pow(g-1,2))},circInOut:function(g){g*=2;return 1>g?-.5*(Math.sqrt(1-Math.pow(g,2))-1):.5*(Math.sqrt(1-Math.pow(g-2,2))+1)},backIn:function(g){return Math.pow(g,2)*(2.70158*g-1.70158)},backOut:function(g){--g;return Math.pow(g,2)*(2.70158*g+1.70158)+1},backInOut:function(g){g*=2;if(1>g)return Math.pow(g,
2)*(3.5949095*g-2.5949095)/2;g-=2;return(Math.pow(g,2)*(3.5949095*g+2.5949095)+2)/2},elasticIn:function(g){if(0==g||1==g)return g;--g;return-1*Math.pow(2,10*g)*Math.sin(2*(g-.075)*Math.PI/.3)},elasticOut:function(g){return 0==g||1==g?g:Math.pow(2,-10*g)*Math.sin(2*(g-.075)*Math.PI/.3)+1},elasticInOut:function(g){if(0==g)return 0;g*=2;if(2==g)return 1;var e=.3*1.5,d=e/4;if(1>g)return--g,-.5*Math.pow(2,10*g)*Math.sin(2*(g-d)*Math.PI/e);--g;return.5*Math.pow(2,-10*g)*Math.sin(2*(g-d)*Math.PI/e)+1},bounceIn:function(g){return 1-
h.bounceOut(1-g)},bounceOut:function(g){return g<1/2.75?7.5625*Math.pow(g,2):g<2/2.75?7.5625*Math.pow(g-1.5/2.75,2)+.75:g<2.5/2.75?7.5625*Math.pow(g-2.25/2.75,2)+.9375:7.5625*Math.pow(g-2.625/2.75,2)+.984375},bounceInOut:function(g){return.5>g?h.bounceIn(2*g)/2:h.bounceOut(2*g-1)/2+.5}};l.setObject("dojo.fx.easing",h);return h})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/PlayerToolbar":function(){define("dojo/_base/declare dojo/on dojo/string esri/dijit/geoenrichment/when dojo/dom-class dojo/dom-construct dijit/_WidgetBase dijit/_TemplatedMixin ../PlayerCommands ../PlayerThemes ./Select ./AreasSelect ./ZoomSelect ./ToolbarArranger ./ZoomUtil esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/InvokeUtil esri/dijit/geoenrichment/utils/MouseUtil esri/dijit/geoenrichment/utils/PopupUtil esri/dijit/geoenrichment/utils/TooltipUtil dojo/text!../templates/PlayerToolbarHolder.html dojo/i18n!esri/nls/jsapi".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q,t,r,u,y,v,w,D,B,z){z=z.geoenrichment.dijit.ReportPlayer.PlayerToolbar;var C=l([a,c],{templateString:B,nls:z,player:null,areaTitleFormatter:null,areaTitleMultiFormatter:null,showAreaTitle:!1,stretchToolbarNode:null,canAddMoreAreas:!1,areasSelectButtons:null,areasSelect:null,pageSelect:null,zoomSelect:null,_toolbarArranger:null,_infographicSelect:null,postCreate:function(){u.hide(this.commandButtonsContainer);this._toolbarArranger=new q({showAreaTitle:this.showAreaTitle,
stretchToolbarNode:this.stretchToolbarNode,domNode:this.domNode,infographicsSelectDiv:this.infographicsSelectDiv,areaTitleDiv:this.areaTitleDiv,areaTitleInnerDiv:this.areaTitleInnerDiv,rightSideControlsBlock:this.rightSideControlsBlock,areasSelectDiv:this.areasSelectDiv,zoomSelectDiv:this.zoomSelectDiv,pageSelectDiv:this.pageSelectDiv,commandButtonsContainer:this.commandButtonsContainer});this._initAreaSelect();this._initPageSelect();this._initZoomSelect();D.autoTooltip(this.domNode)},_initAreaSelect:function(){var a=
this;this.areasSelect=(new m({player:this.player,canAddMoreAreas:this.canAddMoreAreas,areasSelectButtons:this.areasSelectButtons,onChange:function(b){a.onShowAnalysisAreaAt(b.value);a.onClosePopup()},onAddMoreAreas:function(){a.onAddMoreAreas();a.onClosePopup()},onRemoveAreas:function(b,c){a.onRemoveAreas(b);c&&a.onClosePopup()},onCompareAreasSideBySide:function(){a.onCompareAreasSideBySide();a.onClosePopup()},onStopComparison:function(b){a.onShowAnalysisAreaAt(b);a.onClosePopup()}})).placeAt(this.areasSelectDiv);
this.own(this.areasSelect)},updateAreaSelect:function(a){var b=a.analysisAreas,c=a.combinedAreasInfo,f=a.currentAreaIndex,k=a.isMultiFeature;this.areasSelect.buildAreaOptions(a);this.areasSelect.set("value",f);a=1<this.areasSelect.get("options").length&&!k;u[a?"show":"hide"](this.areasSelectDiv);this._toolbarArranger.syncRightSideVisibility();this.player.showReportTitle?500<document.body.clientWidth||!a?(this.infographicsSelectDiv.innerHTML="\x3cdiv class\x3d'TrimWithEllipses' style\x3d'max-width:"+
.4*document.body.clientWidth+"px;'\x3e"+this.player.getReportTitle()+"\x3c/div\x3e",this._toolbarArranger.showAreaTitle=!0):(this.infographicsSelectDiv.innerHTML="",this._toolbarArranger.showAreaTitle=!1):k?this.areaTitleMultiFormatter?this.areaTitleMultiFormatter(this.areaTitleInnerDiv,c):this._formatAreaTitleMulti(c):(b=b["all"===f?0:f],this.areaTitleFormatter?this.areaTitleFormatter(this.areaTitleInnerDiv,b):this._formatAreaTitle(b,f))},_formatAreaTitle:function(a,b){this.areaTitleInnerDiv.innerHTML=
"all"===b?z.allAreas:a.locationName||a.name},_formatAreaTitleMulti:function(a){this.areaTitleInnerDiv.innerHTML=a.locationName||a.name||a.shortName||""},_pageControlsVisible:!0,_initPageSelect:function(){var a=this;this.pageSelect=(new n({onChange:function(b){a.onShowPageAt(b.value);a.onClosePopup()}})).placeAt(this.pageSelectDiv);this.own(this.pageSelect)},setPageControlsVisible:function(a){this._pageControlsVisible=a;u[a?"show":"hide"](this.pageSelectDiv)},updatePageSelect:function(a,b){for(var c=
[],f=0;f<a;f++)c.push({label:g.substitute(z.pageIndex,{index:f+1}),value:f});this.pageSelect.set("options",c);this.pageSelect.set("value",b);u[this._pageControlsVisible&&1<a?"show":"hide"](this.pageSelectDiv)},_initZoomSelect:function(){var a=this;this.zoomSelect=(new p({onChange:function(b){if(b.value===t.FIT_PAGE)a.onZoomToFitPage();else if(b.value===t.FIT_PAGE_WIDTH)a.onZoomToFitPageWidth();else if(b.value===t.FIT_PAGE_HEIGHT)a.onZoomToFitPageHeight();else a.onSetZoomPercent(b.value);a.onClosePopup()}})).placeAt(this.zoomSelectDiv);
this.own(this.zoomSelect)},setZoomSupportsInfo:function(a){u[a.supported?"show":"hide"](this.zoomSelectDiv);this._toolbarArranger.syncRightSideVisibility();this.zoomSelect.store.data.forEach(function(b){b.hidden=!1;b.value!==t.FIT_PAGE||a.canFitPage?b.value!==t.FIT_PAGE_WIDTH||a.canFitPageWidth?b.value!==t.FIT_PAGE_HEIGHT||a.canFitPageHeight||(b.hidden=!0):b.hidden=!0:b.hidden=!0})},setZoomInfo:function(a){a=a.isFitPageScale?t.FIT_PAGE:a.isFitPageWidthScale?t.FIT_PAGE_WIDTH:a.isFitPageHeightScale?
t.FIT_PAGE_HEIGHT:t.getClosestZoomAndUpdateOptions(100*a.scale,this.zoomSelect.get("options"));a!==this.zoomSelect.get("value")&&this.zoomSelect.set("value",a)},createCommandButton:function(a,b){return this.createCustomCommandButton({callback:b,buttonClass:a.id===k.PRINT?"playerPrintButton":"playerExportButton",tooltip:a.id===k.PRINT?z.printInfographic:z.exportInfographic,visibleOnError:!1})},createCustomCommandButton:function(a){u.show(this.commandButtonsContainer);var c=b.create("div",{"class":"playerToolbar_commandButtonContainer dijitInline"},
this.commandButtonsContainer,a.addFirst?"first":"last");c.__visibleOnError=a.visibleOnError;c=b.create("div",{"class":"playerToolbar_commandButton"},c);a.buttonClass&&d.add(c,a.buttonClass);a.tooltip&&D.setTooltipToNode(c,a.tooltip);h(c,"click",a.callback);return c},setTheme:function(a){d.remove(this.domNode,"playerThemeDark playerThemeLight");d.add(this.domNode,a===f.DARK?"playerThemeDark":"playerThemeLight");this.areasSelect.setTheme(a);this.pageSelect.setTheme(a);this.zoomSelect.setTheme(a)},setErrorShown:function(a){if(a)for(u.hide([this.areaTitleDiv,
this.areasSelectDiv,this.pageSelectDiv,this.zoomSelectDiv]),a=0;a<this.commandButtonsContainer.children.length;a++){var b=this.commandButtonsContainer.children[a];u[b.__visibleOnError?"show":"hide"](b)}},arrangeControls:function(){this._toolbarArranger.arrangeControls()},hasVisibleControls:function(){return this._toolbarArranger.hasVisibleControls()},addInfographicsSelect:function(a){this._infographicSelect=a;a.placeAt(this.infographicsSelectDiv)},isMouseOver:function(){return v.isMouseOver(this.domNode)||
this.areasSelect&&this.areasSelect.isMouseOver()||this.pageSelect&&this.pageSelect.isMouseOver()||this.zoomSelect&&this.zoomSelect.isMouseOver()||this._infographicSelect&&this._infographicSelect.isMouseOver&&this._infographicSelect.isMouseOver()},setContentLoadPromise:function(a){u.enableContentAbsolute(this.commandButtonsContainer,!1);u.enableContentAbsolute(this.infographicsSelectDiv,!1);e(a,function(){u.enableContentAbsolute(this.commandButtonsContainer,!0);u.enableContentAbsolute(this.infographicsSelectDiv,
!0)}.bind(this))},onShowPageAt:function(a){},onShowAnalysisAreaAt:function(a){},onCompareAreasSideBySide:function(){},onZoomToFitPage:function(){},onZoomToFitPageWidth:function(){},onZoomToFitPageHeight:function(){},onSetZoomPercent:function(a){},onClosePopup:function(){},onAddMoreAreas:function(){},onRemoveAreas:function(a){}});return l([a,c],{templateString:"\x3cdiv class\x3d'esriGEPlayerToolbarOuter'\x3e\x3c/div\x3e",player:null,popupButtonDiv:null,areaTitleFormatter:null,areaTitleMultiFormatter:null,
showToolbarInPopup:!1,showAreaTitle:!1,stretchToolbarNode:null,showCloseButton:!1,canAddMoreAreas:!1,areasSelectButtons:null,toolbarHolder:null,postCreate:function(){var a=this;this.inherited(arguments);this.toolbarHolder=(new C({player:this.player,showAreaTitle:this.showAreaTitle,stretchToolbarNode:this.stretchToolbarNode,canAddMoreAreas:this.canAddMoreAreas,areasSelectButtons:this.areasSelectButtons,onShowPageAt:function(b){a.onShowPageAt(b)},onShowAnalysisAreaAt:function(b){a.onShowAnalysisAreaAt(b)},
onCompareAreasSideBySide:function(){a.onCompareAreasSideBySide()},onZoomToFitPage:function(){a.onZoomToFitPage()},onZoomToFitPageWidth:function(){a.onZoomToFitPageWidth()},onZoomToFitPageHeight:function(){a.onZoomToFitPageHeight()},onSetZoomPercent:function(b){a.onSetZoomPercent(b)},onClosePopup:function(){a.closePopup()},onAddMoreAreas:function(){a.onAddMoreAreas()},onRemoveAreas:function(b){a.onRemoveAreas(b)}})).placeAt(this.domNode);this.own(this.toolbarHolder)},updateAreaSelect:function(a){this.toolbarHolder.areaTitleFormatter=
this.areaTitleFormatter;this.toolbarHolder.areaTitleMultiFormatter=this.areaTitleMultiFormatter;this.toolbarHolder.updateAreaSelect(a)},setPageControlsVisible:function(a){this.toolbarHolder.setPageControlsVisible(a)},updatePageSelect:function(a,b){this.toolbarHolder.updatePageSelect(a,b)},setZoomSupportsInfo:function(a){this.toolbarHolder.setZoomSupportsInfo(a)},setZoomInfo:function(a){this.toolbarHolder.setZoomInfo(a)},createCommandButton:function(a,b){return this.toolbarHolder.createCommandButton(a,
b)},setTheme:function(a){this.toolbarHolder.setTheme(a)},setErrorShown:function(a){this.toolbarHolder.setErrorShown(a);this._arrangeControls()},_arrangeControls:function(){u.show(this.domNode);this.toolbarHolder.arrangeControls();u[this.toolbarHolder.hasVisibleControls()?"show":"hide"]([this._popupButton,this.domNode])},_popupHandle:null,_popupButton:null,update:function(){y.invoke(this,"_doUpdateToolbar")},_doUpdateToolbar:function(){d[this.isScrollShown()?"add":"remove"](this.popupButtonDiv,"playerToolbar_parentHasScroll");
d[r.isMobileDevice()?"add":"remove"](this.popupButtonDiv,"isMobileDevice");d[r.isMobileDevice()?"add":"remove"](this.toolbarHolder.domNode,"isMobileDevice");this._resetToolbarNode();var a=w.isOpen(this.toolbarHolder);this._popupHandle&&this._popupHandle.remove();this._popupHandle=null;this.showToolbarInPopup?(this._popupButton=b.create("div",{"class":"dijitInline playerToolbar_outerButton playerToolbar_settingsButton"},this.popupButtonDiv,"first"),this._popupHandle=w.makePopup(this.toolbarHolder,
this,this._popupButton,{orient:["before","below"],openPopup:a})):b.place(this.toolbarHolder.domNode,this.domNode);this._arrangeControls()},_resetToolbarNode:function(){this.toolbarHolder.domNode.parentNode&&this.toolbarHolder.domNode.parentNode.removeChild(this.toolbarHolder.domNode);this.domNode.innerHTML="";this._popupButton&&b.destroy(this._popupButton);this._popupButton=null},closePopup:function(){this.showToolbarInPopup&&w.close(this.toolbarHolder)},isScrollShown:function(){return!1},createCustomCommandButton:function(a){return this.toolbarHolder.createCustomCommandButton(a)},
notifyCommandButtonsAdded:function(){if(this.showCloseButton)if(this.showToolbarInPopup){var a=b.create("div",{"class":"dijitInline playerToolbar_outerButton playerToolbar_closeButtonOuter"},this.popupButtonDiv);D.setTooltipToNode(a,z.close);h(a,"click",function(){this.onClose()}.bind(this))}else this.createCustomCommandButton({buttonClass:"playerToolbar_closeButton",tooltip:z.close,callback:function(){this.closePopup();this.onClose()}.bind(this),visibleOnError:!0})},addInfographicsSelect:function(a){this.toolbarHolder.addInfographicsSelect(a)},
isMouseOver:function(){return v.isMouseOver(this.domNode)||this.toolbarHolder.isMouseOver()},setContentLoadPromise:function(a){this.toolbarHolder.setContentLoadPromise(a)},onShowPageAt:function(a){},onShowAnalysisAreaAt:function(a){},onCompareAreasSideBySide:function(){},onZoomToFitPage:function(){},onZoomToFitPageWidth:function(){},onZoomToFitPageHeight:function(){},onSetZoomPercent:function(a){},onClose:function(){},onAddMoreAreas:function(){},onRemoveAreas:function(a){}})})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/Select":function(){define(["dojo/_base/declare",
"dojo/dom-class","esri/dijit/geoenrichment/OnDemandSelect","../PlayerThemes"],function(l,h,g,e){return l(g,{"class":"esriGEOnDemandSelectNoBackground",listClass:"esriGEOnDemandSelectVeryTallList esriGEOnDemandSelectSpacedOut",allowRepetitiveSelection:!1,setTheme:function(d){h[d===e.DARK?"add":"remove"](this.domNode,"esriGEOnDemandSelectWhite")}})})},"esri/dijit/geoenrichment/OnDemandSelect":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/dom-construct dojo/dom-class dojo/dom-style dojo/dom-geometry dojo/store/Memory dijit/_WidgetBase dijit/_TemplatedMixin ./lists/FlowList ./lists/FlowListDefaultItemRenderer ./lists/_FlowListHoverSupport ./utils/DeviceUtil ./utils/DomUtil ./utils/MouseUtil ./utils/PopupUtil ./utils/TooltipUtil dojo/text!./templates/OnDemandSelect.html".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q,t,r,u,y,v){var w=l([n,p]),D={_currentSelect:null,_keyHandler:null,_mouseMoveHandler:null,_currentItemIndex:-1,_currentSearchLetter:null,setFocusedSelect:function(a){this._currentSelect=a;this._updateHandlers()},_updateHandlers:function(){var a=this;this._keyHandler&&this._keyHandler.remove();this._keyHandler=null;this._mouseMoveHandler&&this._mouseMoveHandler.remove();this._mouseMoveHandler=null;this._currentItemIndex=-1;this._currentSearchLetter=null;this._setNodeFocused(null);
this._currentSelect&&(this._keyHandler=g(document.body,"keyup",function(b){b=String.fromCharCode(b.keyCode);1===b.length&&(b=b.toLowerCase(),a._tryHighlightNextItemForKey(b))}),this._mouseMoveHandler=g(this._currentSelect.popupList.domNode,"mousemove",function(){a._setNodeFocused(null)}))},_tryHighlightNextItemForKey:function(a){a===this._currentSearchLetter?this._currentItemIndex++:this._currentItemIndex=0;this._currentSearchLetter=a;var b=this,c=this._currentSelect.store.query(function(c){return(c=
c[b._currentSelect.labelProperty])&&c.toLowerCase().charAt(0)===a});if(c.length){this._currentItemIndex>c.length-1&&(this._currentItemIndex=0);var f=(c=c[this._currentItemIndex])&&this._currentSelect.popupList.getItemNode(c);c&&this._currentSelect.popupList.scrollToItem(c);this._setNodeFocused(f)}},_currentFocusedNode:null,_setNodeFocused:function(a){this._currentFocusedNode&&(d.remove(this._currentFocusedNode,"listItemFocused"),this._currentFocusedNode=null);a&&(d.add(a,"listItemFocused"),this._currentFocusedNode=
a)}};return l([k,f],{templateString:v,value:null,popupList:null,listClass:null,placeHolderClass:"placeHolder",idProperty:"value",labelProperty:"label",options:null,store:null,itemRenderer:null,itemClass:null,placeHolder:null,requireSelection:!0,renderSelectionAsItem:!1,makePopupListWidthMatchOpenButtonWidth:!0,orient:null,noPopupOverflow:!1,stopOpenEventPropagation:!1,stopPopupInteractionEventPropagation:!0,onClickComponent:null,clearPopupOnClose:!0,detectItemHover:!1,hasSelectableItems:!0,allowRepetitiveSelection:!0,
labelTextToKeep:null,nodeToKeepAsSelected:null,openMouseEvent:null,toggleOnClick:!0,supportsKeyNavigation:!0,_closePopupOnChangeFunc:null,_lastPopupListScrollTop:0,postCreate:function(){var a=this;this.inherited(arguments);this._normalizeValue();this.labelTextToKeep?this.selectedLabel.innerHTML=this.labelTextToKeep:this.requireSelection||this._tryAssignPlaceholder();this.nodeToKeepAsSelected?this._updateSelection():t.hide(this.selectedItemHolder);this._createPopupList();this.own(this.popupList);this.listClass&&
d.add(this.popupList.domNode,this.listClass);this._popupCreationHandler=g(this.openButton,this.openMouseEvent||q.click,function(b){a.stopOpenEventPropagation&&("function"===typeof a.stopOpenEventPropagation?a.stopOpenEventPropagation(b):b.stopPropagation());a.openPopup()});this.popupList.startup();this._trySelectValue();g(this.popupList.domNode,q.clickOrRelease,function(b){a.stopPopupInteractionEventPropagation&&b.stopPropagation()});g(this.popupList.domNode,"scroll",function(b){a._lastPopupListScrollTop=
a.popupList.domNode.scrollTop});y.autoTooltip(this.domNode)},_createPopupList:function(){var a=this,b=this.itemRenderer||new m;this.popupList=new (this.detectItemHover?w:n)(h.mixin({"class":"esriGEOnDemandSelectFlowList",idProperty:this.idProperty,labelProperty:this.labelProperty,itemRenderer:b,itemClass:this.itemClass,stopMouseEventPropagation:this.stopPopupInteractionEventPropagation,hasSelectableItems:this.hasSelectableItems,allowRepetitiveSelection:this.allowRepetitiveSelection,onChange:function(){a._processOnChangeEvent()},
onItemHovered:function(b){a.onItemHovered(b)}},this._buildAdditionalPopupListProperties()))},_buildAdditionalPopupListProperties:function(){return null},_processOnChangeEvent:function(){if(this.popupList.selectedItem){var a=this.value,b=this.popupList.selectedItem;this.value=b[this.idProperty];this._updateSelection();this.onChange&&this.onChange({type:"change",value:this.value,previousValue:a,selectedItem:b})}this._closePopupOnChangeFunc&&!this._closePopupOnChangeFunc(this.value)||u.close(this.popupList)},
_makePopup:function(){if(this._popupCreationHandler){this._popupCreationHandler.remove();delete this._popupCreationHandler;var c=this;u.makePopup(this.popupList,this,this.openButton,{openMouseEvent:this.openMouseEvent,stopEventPropagation:this.stopOpenEventPropagation,toggleOnClick:this.toggleOnClick,wrapperClass:this.listClass?this.listClass.split(" ").map(function(a){return a+"Popup"}).join(" "):null,orient:this.orient,allowAutoOrientation:this.allowAutoOrientation,noOverflow:this.noPopupOverflow,
onClickComponent:this.onClickComponent,onPreShow:function(){c.onPopupListPreBuild();c.makePopupListWidthMatchOpenButtonWidth&&b.set(c.popupList.domNode,"minWidth",a.getContentBox(c.domNode).w+"px");c._updatePopupListStore();c.onPopupPreOpened()},onShow:function(){c.onPopupOpened();D.setFocusedSelect(c);c._onPopupOpened()},onClose:function(){c.onPopupClosed();D.setFocusedSelect(null);c.clearPopupOnClose&&c._clearPopup()},isMouseOver:function(){return c.isMouseOverList()}})}},_clearPopup:function(){this.popupList&&
this.popupList.clear&&this.popupList.clear()},_tryAssignPlaceholder:function(){if(this.placeHolder&&null===this.value)return this.selectedLabel.innerHTML=this.placeHolder,d.add(this.selectedLabel,this.placeHolderClass),!0;d.remove(this.selectedLabel,this.placeHolderClass);return!1},_normalizeValue:function(){null!==this.value&&(void 0===this.value?this.value=null:("string"===typeof this.value&&(this.value=this.value.trim()),String(this.value)||(this.value=null)))},trySelectValue:function(a){this.value=
a;this._normalizeValue();return this._trySelectValue()},_trySelectValue:function(){if(null!==this.value&&this._setValueAttr(this.value,!0))return!0;if(this.requireSelection){var a=this.store&&this.store.query();if(a&&a.length){var b=this;this.value&&a.some(function(a){return b.value===a[b.idProperty]})?this._setValueAttr(this.value,!0):this._setValueAttr(a[0][this.idProperty],!0)}}return!1},_setValueAttr:function(a,b){this.value=a;this._normalizeValue();if(!this.store||!this.popupList)return!1;var c=
this;(a=this.store.query(function(a){return a[c.idProperty]===c.value})[0])&&this.popupList.setSelectedItem(a);this._updateSelection(a);return!!a},_setOptionsAttr:function(a){this.options=a;this.store=this._createStore(a);this._updatePopupListStore();this._trySelectValue()},_setStoreAttr:function(a){this.options=(this.store=this._createStore(a))&&this.store.query();a.idProperty&&(this.idProperty=a.idProperty);this._updatePopupListStore();this._trySelectValue()},_createStore:function(a){return a instanceof
Array?new c({data:a,idProperty:this.idProperty}):a},_updatePopupListStore:function(){this.popupList&&(this.popupList.store&&this.popupList.store===this.store&&!this.clearPopupOnClose||this.popupList.setStore(this.store,!0),this.popupList.setSelectedItem(this.getSelectedItem()),this._lastPopupListScrollTop&&(this.popupList.domNode.scrollTop=this._lastPopupListScrollTop))},getSelectedItem:function(){if(!this.store)return null;var a=this.get("value"),b=this;return void 0!==a&&this.store.query(function(c){return c[b.idProperty]===
a})[0]},setSelectedItem:function(a){this.store&&this.popupList&&a&&this._setValueAttr(a[this.idProperty],!0)},getSelectedIndex:function(){var a=this,b=-1;if(this.store){var c=this.get("value");void 0!==c&&this.store.query().some(function(f,k){if(f[a.idProperty]==c)return b=k,!0})}return b},setSelectedIndex:function(a){this.setSelectedItem(this.store&&this.store.data[a])},_nodeToKeepAsSelectedPlacedFlag:!1,_updateSelection:function(a){a=a||this.getSelectedItem();this.nodeToKeepAsSelected?this._nodeToKeepAsSelectedPlacedFlag||
(t.hide(this.selectedLabel),t.show(this.selectedItemHolder),this.selectedItemHolder.innerHTML="",e.place(this.nodeToKeepAsSelected,this.selectedItemHolder),this._nodeToKeepAsSelectedPlacedFlag=!0):this.renderSelectionAsItem?(t.hide(this.selectedLabel),t.show(this.selectedItemHolder),this.selectedItemHolder.innerHTML="",a&&this.popupList.itemRenderer.createPresentation(a,!1,this.selectedItemHolder,this.popupList)):(t.hide(this.selectedItemHolder),this.labelTextToKeep?this.selectedLabel.innerHTML=this.labelTextToKeep:
(this.selectedLabel.innerHTML=a?a[this.labelProperty]:"",this.selectedLabel.innerHTML&&d.remove(this.selectedLabel,this.placeHolderClass),t[this.selectedLabel.innerHTML||this._tryAssignPlaceholder()?"show":"hide"](this.selectedLabel)))},refresh:function(){this.popupList.refresh();this._updateSelection()},isPopupOpen:function(){return u.isOpen(this.popupList)},openPopup:function(){this.isPopupOpen()||(this._makePopup(),u.open(this.popupList))},closePopup:function(){this._popupCreationHandler||u.close(this.popupList)},
refreshPopup:function(){this.isPopupOpen()&&u.refresh(this.popupList)},isMouseOver:function(a){return r.isMouseOver(this.domNode,{event:a})||this.isMouseOverList(a)},isMouseOverList:function(a){return this.popupList&&r.isMouseOver(this.popupList.domNode,{event:a})},onPopupListPreBuild:function(){},onPopupPreOpened:function(){},onPopupOpened:function(){},_onPopupOpened:function(){},onPopupClosed:function(){},onChange:function(a){},onItemHovered:function(a){},destroy:function(){this._popupCreationHandler&&
this._popupCreationHandler.remove();this.closePopup(this.popupList);this.popupList.destroy();this.inherited(arguments)}})})},"esri/dijit/geoenrichment/lists/FlowList":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-construct dojo/dom-class dojo/on ../utils/DeviceUtil ../utils/DnDUtil ../utils/MouseUtil ../utils/TooltipUtil ./FlowListDefaultItemRenderer ../utils/PopupUtil dijit/_WidgetBase dijit/_TemplatedMixin".split(" "),function(l,h,g,e,d,b,a,c,k,f,n,m,p){var q=l([m,p],{templateString:"\x3cdiv class\x3d'esriGEFlowList esriGENonSelectable'\x3e\x3c/div\x3e",
idProperty:"value",labelProperty:"label",selectedIndex:-1,selectedItem:null,items:null,store:null,defaultItemRendererClass:f,itemRenderer:null,itemClass:null,itemClassSelected:null,keepScrollPosition:!1,allowRepetitiveSelection:!0,selectOnMouseDown:!1,noDragTolerance:0,selectionValidator:null,allowManualSelection:!0,stopMouseEventPropagation:!0,hasSelectableItems:!0,autoDetectUrlsInLabels:!1,storeItemsInInnerDiv:!1,_addedWrappers:null,_clickHandles:null,_valueOnCreation:null,_isCreated:!1,itemsDiv:null,
postCreate:function(){this.inherited(arguments);this.itemsDiv=this.storeItemsInInnerDiv?g.create("div",{"class":"esriGEFlowList_innerDiv"},this.domNode):this.domNode;this._clearHandlers();this._setUpItemRenderer();k.autoTooltip(this.domNode);this._isCreated=!0;this._valueOnCreation?this._setValueAttr(this._valueOnCreation):this.refresh()},_setUpItemRenderer:function(){this.itemRenderer||(this.itemRenderer=new this.defaultItemRendererClass);this.itemClass&&(this.itemRenderer.itemClass=this.itemClass);
this.itemClassSelected&&(this.itemRenderer.itemClassSelected=this.itemClassSelected)},_getValueAttr:function(){return this.selectedItem&&this.selectedItem[this.idProperty]},_setValueAttr:function(a){var b=this;if(this._isCreated){var c=this.items||this.store&&this.store.data;c&&c.some(function(c){if(c[b.idProperty]==a)return b.setSelectedItem(c),!0})}else this._valueOnCreation=a},_scrollTopMemo:0,memoScroll:function(){this._scrollTopMemo=this.domNode.scrollTop},applyScrollFromMemo:function(){this.domNode.scrollTop=
this._scrollTopMemo||0},_setItemsAttr:function(a){this.setItems(a)},setItems:function(a,b){this.keepScrollPosition&&this.memoScroll();this.clear();this.items=a;b||(this.items&&this._isCreated?(this._addItems(a),this._checkIfStillSelected(),this.keepScrollPosition&&this.applyScrollFromMemo()):this._checkIfStillSelected())},_checkIfStillSelected:function(){if(-1!=this.selectedIndex||this.selectedItem){var a=this;this._addedWrappers&&this._addedWrappers.some(function(b,c){return a._isItemSelected(b,
c)})||(this.selectedIndex=-1,this.selectedItem=null)}},refresh:function(){this.store?this.setStore(this.store):this.setItems(this.items)},setSelectedItem:function(a,b){this.hasSelectableItems&&(this.selectedItem=a,this.selectedIndex=-1,this.refresh(),b&&this._dispatchChangeEvent())},setSelectedIndex:function(a,b){this.hasSelectableItems&&(this.selectedIndex=a,this.selectedItem=null,this.refresh(),b&&this._dispatchChangeEvent())},getItemNode:function(a){var b;this._addedWrappers&&this._addedWrappers.some(function(c){if(c.itemRef===
a)return b=c.__itemPresentation,!0});return b},getItemByNode:function(a){var b;this._addedWrappers&&this._addedWrappers.some(function(c){if(c.__itemPresentation===a)return b=c.itemRef,!0});return b},getItemByValue:function(a){var b,c=this;this._addedWrappers&&this._addedWrappers.some(function(f){if(f[c.idProperty]===a)return b=f.itemRef,!0});return b},__selectedPresentation:null,_addItems:function(a){this._addedWrappers=this._addedWrappers||[];var b=this;a.forEach(function(a){var c=h.mixin({},a);
c.itemRef=a;b.__addWrapper(c)})},__addWrapper:function(a){var b=this._addedWrappers.length,c=this.itemRenderer.createPresentation(a.itemRef,this._isItemSelected(a,b),this.itemsDiv,this,a);c&&(c.index=b,c.item=a.itemRef,a.__itemPresentation=c,this._isItemSelected(a,b)&&(this.selectedItem=a.itemRef,this.selectedIndex=b,this.__selectedPresentation=c),this._addClickHandler(c),this._addedWrappers.push(a),a=this._addedWrappers.length-1,e.add(c,"listItem_"+a),e.add(c,"listItem_"+(0==a%2?"even":"odd")))},
_isItemSelected:function(a,b){return this.hasSelectableItems&&this._isItemClickable(a)?b==this.selectedIndex||a.itemRef===this.selectedItem?!0:a.itemRef&&this.selectedItem?(a=a.itemRef[this.idProperty],b=this.selectedItem[this.idProperty],void 0!==a&&a===b):!1:!1},_isItemClickable:function(a){return this.selectionValidator?this.selectionValidator(a):this._selectionValidatorDefault(a)},_selectionValidatorDefault:function(a){return!!a&&!a.isSeparator&&!1!==a.enabled},_addClickHandler:function(c){function f(){(k.allowRepetitiveSelection||
k.__selectedPresentation!=c)&&k._isItemClickable(c.item)&&(k.__selectedPresentation&&k.itemRenderer.selectPresentation&&k.itemRenderer.selectPresentation(k.__selectedPresentation,!1,k.__selectedPresentation.item),k.itemRenderer.selectPresentation&&k.itemRenderer.selectPresentation(c,k.hasSelectableItems,c.item),k.__selectedPresentation=c,k.selectedIndex=c.index,k.selectedItem=c.item,k._dispatchChangeEvent())}var k=this;if(this.allowManualSelection){var e;e=this.selectOnMouseDown||!this.noDragTolerance?
d(c,this.selectOnMouseDown?b.press:b.click,function(a){k.stopMouseEventPropagation&&a.stopPropagation();f()}):a.addNoDragClickHandler(c,f,{tolerance:this.noDragTolerance});this._clickHandles.push(e)}},_dispatchChangeEvent:function(){this.onChange({type:"change",selectedIndex:this.selectedIndex,selectedItem:this.selectedItem,value:this.selectedItem&&this.selectedItem[this.idProperty]})},clear:function(){this.__selectedPresentation=null;this._addedWrappers=this._addedWrappers||[],this._addedWrappers.forEach(function(a){a.destroyPresentation&&
a.destroyPresentation()});this._addedWrappers.length=0;this.itemsDiv&&(this.itemsDiv.innerHTML="");this._clearHandlers()},_clearHandlers:function(){this._clickHandles=this._clickHandles||[];this._clickHandles.forEach(function(a){a.remove()});this._clickHandles.length=0},scrollToItem:function(a){if(a=this.getItemNode(a))this.domNode.scrollTop=a.offsetTop},store:null,onDemandModeLoadStep:1E3,onDemandPopulateLimit:1E3,onDemandPopulatePeriod:200,_storeScrollHandler:null,_setStoreAttr:function(a){this.setStore(a)},
setStore:function(a){if(this.domNode)if(this.keepScrollPosition&&this._memoScroll(),this.clear(),this.idProperty=(this.store=a)&&a.idProperty,this.store&&this._isCreated){this._loadNextPart();this._checkIfStillSelected();this.keepScrollPosition&&this.applyScrollFromMemo();var b=this;this._storeScrollHandler=this._storeScrollHandler||d(this.domNode,"scroll",function(){var a=b._addedWrappers[b._addedWrappers.length-30];(a=a?a.__itemPresentation:null)&&a.offsetTop<b.domNode.scrollTop&&b._loadNextPart()})}else this._checkIfStillSelected()},
_loadNextPart:function(){if(this.store&&this.store.query().length!=this._addedWrappers.length){var a=this.store.query(null,{start:this._addedWrappers.length,count:this.onDemandModeLoadStep});delete a.total;this._addItems(a);a.length&&this._addedWrappers.length<this.onDemandPopulateLimit&&(a=this._loadNextPart.bind(this),setTimeout(a,this.onDemandPopulatePeriod))}},isMouseOver:function(a){return c.isMouseOver(this.domNode,{event:a})},onChange:function(a){},destroy:function(){this.clear();this.inherited(arguments)}});
q.createPopup=function(a){function b(){c||(c=new q({"class":a.listClass,itemRenderer:a.itemRenderer,items:a.options,onChange:function(b){a.onChange(b);!a.keepSelection&&c.setSelectedItem(null);n.close(c)}}),a.doNotOwn||a.wizard.own(c),a.isDeferred&&a.isDeferred(c));return c}var c;n.makePopup(a.isDeferred?b:b(),a.wizard,a.aroundNode,a.popupOptions||{});return c};return q})},"esri/dijit/geoenrichment/lists/FlowListDefaultItemRenderer":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct ../utils/DomUtil ../utils/TooltipUtil ../utils/RegExpUtil ../utils/UrlUtil".split(" "),
function(l,h,g,e,d,b,a,c){return l(null,{itemClass:"",itemClassSelected:"",labelClass:"",createLabelNode:!1,createImageAfterLabel:!1,constructor:function(a){h.mixin(this,a)},createPresentation:function(a,b,c,m,h){if(a.isSeparator)return b=e.create("div",{"class":"flowList_listSeparator"},c),a.hidden&&d.hide(b),b;c=e.create("div",{"class":"listItem "+(this.itemClass||" ")+(a.itemClass||""),style:a.style},c);a.isLink&&g.add(c,"esriGELink");!1===a.enabled&&g.add(c,"disabled");this._createParts(a,c,m);
this._setTooltip(a,c,m);this.selectPresentation(c,b,a);a.hidden&&d.hide(c);return c},_setTooltip:function(a,c,d){a.tooltip&&d.own(b.setTooltipToNode(c,a.tooltip))},_createParts:function(a,b,c){var f;this.createImageAfterLabel&&(this._createLabel(a,b,c),f=!0);this._createImage(a,b,c);!f&&this._createLabel(a,b,c)},_createImage:function(a,b,c){if(b=this._createImageNode(a,b,c))a.imageClass&&g.add(b,a.imageClass),a.imageUrl&&(b.style="background-image: url("+a.imageUrl+");")},_createImageNode:function(a,
b,c){return b},_createLabel:function(a,b,c){if(this.createLabelNode)return b=e.create("div",{innerHTML:a[c.labelProperty],"class":"dijitInline TrimWithEllipses listItemLabel"},b),a.labelClass&&g.add(b,a.labelClass),this.labelClass&&g.add(b,this.labelClass),c.autoDetectUrlsInLabels&&this._tryConvertToUrls(b),b;a[c.labelProperty]&&(b.innerHTML=a[c.labelProperty],c.autoDetectUrlsInLabels&&this._tryConvertToUrls(b))},_tryConvertToUrls:function(b){var f=b.innerHTML.match(a.IS_URL_RE);if(f=f&&f[0])b.innerHTML=
b.innerHTML.replace(f,"\x3ca href\x3d'"+c.toHttpsUrl(f)+"' target\x3d'_blank'\x3e"+f+"\x3c/a\x3e")},selectPresentation:function(a,b,c){g[b?"add":"remove"](a,"listItemSelected "+this.itemClassSelected)}})})},"esri/dijit/geoenrichment/utils/RegExpUtil":function(){define([],function(){var l={createRegExp:function(a,b,f){a=l.trimText(a);return!a&&f?null:new RegExp(a,b)},trimText:function(a){return a?a.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,"").trim():""},replace:function(a,b,f){return null==a?"":(""+
a).replace(b,function(a){return f[a]||""})}},h=/&|<|>/g,g=/&|<|>|"|'/g,e={"\x26":"\x26amp;","\x3c":"\x26lt;","\x3e":"\x26gt;",'"':"\x26quot;","'":"\x26apos;"};l.encodeXML=function(a,b){return l.replace(a,b?g:h,e)};var d=/&amp;|&lt;|&gt;|&quot;|&apos;/g,b={"\x26amp;":"\x26","\x26lt;":"\x3c","\x26gt;":"\x3e","\x26quot;":'"',"\x26apos;":"'"};l.decodeXML=function(a){return l.replace(a,d,b)};l.IS_RICH_TEXT_RE=/<\w/;l.IS_URL_RE=/((www\.|http:\/\/|https:\/\/)[A-Za-z0-9_.\-~]+\.[A-Za-z0-9_.\-~/]+)|([A-Za-z0-9_.\-~]+\.com[A-Za-z0-9_.\-~/]*)/;
l.isRichText=function(a){return a&&l.IS_RICH_TEXT_RE.test(a)};l.isUrl=function(a){return a&&l.IS_URL_RE.test(a)};var a=/^[0-9a-fA-F]{32}$/;l.isId=function(b){return b&&a.test(b)};return l})},"esri/dijit/geoenrichment/utils/PopupUtil":function(){define("dojo/_base/lang esri/dijit/geoenrichment/utils/onClickTouch dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style esri/dijit/geoenrichment/when esri/dijit/geoenrichment/ReportPlayer/config dijit/popup dijit/place dijit/Viewport ./DeviceUtil ./DnDUtil ./MouseUtil dojo/domReady!".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q){function t(a){if(!a)return["below"];var b=[];a.forEach(function(a){var c=d.isBodyLtr();switch(a){case "before-alt":c=!c;case "after-alt":b.push(c?{aroundCorner:"BR",corner:"BL"}:{aroundCorner:"BL",corner:"BR"});b.push(c?{aroundCorner:"TR",corner:"TL"}:{aroundCorner:"TL",corner:"TR"});return}b.push(a)});return b}var r={makePopup:function(f,y,v,w){function u(a){if(w.overlay&&a._popupWrapper){var c=e.create("div",{"class":w.overlay.overlayClass});if(w.overlay.overlayParent)e.place(c,
w.overlay.overlayParent);else{e.place(c,F,"before");var f=b.get(a._popupWrapper,"zIndex");b.set(c,"zIndex",f)}a.__popupOverlay=c}}function B(a){a.__popupOverlay&&(e.destroy(a.__popupOverlay),a.__popupOverlay=null)}function z(a){G=!1;a.__bodyClickHandler&&a.__bodyClickHandler.remove();a.__bodyClickHandler=null;a.__popupWidgetOpenFlag=!1;B(a);w.onClose&&w.onClose()}function C(b){b&&w.stopEventPropagation&&b.stopPropagation();G||(G=!0,a(A||("function"==typeof f?f():f),function(b){A=b;A.domNode?(A.__openPopupWidgetFunc=
C,F=k.moveOffScreen(A),a(w.onPreShow&&w.onPreShow(),function(){var a=t(w.orient);if(F&&!1!==w.allowAutoOrientation){var b=a.indexOf("below");-1!==b&&-1===a.indexOf("above")&&a.splice(b+1,0,"above")}b=-1;if(-1!==a.indexOf("after")||-1!==a.indexOf("before"))var b=n.getEffectiveBox(this.ownerDocument),c=d.position(v,!1),b=Math.floor(Math.max(c.y+c.h,b.h-c.y))-10;w.noOverflow&&(A.baseClass="esriGENoOverflow "+A.baseClass);k.open({parent:y,popup:A,around:v,maxHeight:b,orient:a,onClose:function(){z(A)}});
w.suppressReposition&&clearTimeout(k._aroundMoveListener);w.noOverflow&&(A.baseClass=A.baseClass.replace("esriGENoOverflow ",""));F&&w.wrapperClass&&g.add(F,w.wrapperClass);A.__popupInfo=l.mixin({},k.getTopPopup());A.__popupInfo.orient=a;A.__popupInfo.around=v;B(A);u(A);w.onShow&&w.onShow();A.__popupWidgetOpenFlag=!0;H&&A.own&&A.own(H);A.__bodyClickHandler&&A.__bodyClickHandler.remove();if(!1!==w.closeOnClickOutside){var f="function"===typeof w.closeOnClickOutside?w.closeOnClickOutside:null;setTimeout(function(){A.__bodyClickHandler&&
A.__bodyClickHandler.remove();A.__bodyClickHandler=h(document.body,m.isMobileDevice()?m.press:E,function(a){G&&(q.fixTouchEvent(a),f&&!f(a)||q.isMouseOver(F)||w.isMouseOver&&w.isMouseOver()||A.isMouseOver&&A.isMouseOver()||A.__lockPopupWidgetFlag||r.close(A))})})}})):G=!1}))}if(f){if(c.isPlayerOnServer)return{remove:function(){}};w=w||{};var E=w.openMouseEvent?w.openMouseEvent:m.clickOrRelease,A="function"!==typeof f?f:null;if(A)var F=k.moveOffScreen(A);var G=!1;A&&(A.__openPopupWidgetFunc=C);var H;
if(!1!==w.openOnMouseEvent){var J=C;if(w.toggleOnClick)var L,J=function(a){L=L||a.type;A?L===a.type&&r.toggle(A):C()};H=!1===w.onClickComponent?null:void 0!==w.noDragClickTolerance?p.addNoDragClickHandler(w.onClickComponent||v,J,{tolerance:w.noDragClickTolerance}):h(w.onClickComponent||v,E,J)}w.openPopup&&C();return{remove:function(){A&&"function"!==typeof A&&(r.close(A),z(A),A._popupWrapper&&(A.domNode&&A.domNode.parentNode===A._popupWrapper&&A._popupWrapper.removeChild(A.domNode),e.destroy(A._popupWrapper),
delete A._popupWrapper),delete A.__openPopupWidgetFunc,delete A.__popupWidgetOpenFlag);H&&H.remove()}}}},setLocked:function(a,b){a.__lockPopupWidgetFlag=b},open:function(a){a&&!a.__lockPopupWidgetFlag&&!a.__popupWidgetOpenFlag&&a.__openPopupWidgetFunc&&a.__openPopupWidgetFunc()},close:function(a){a&&!a.__lockPopupWidgetFlag&&k.close(a)},isOpen:function(a){return!(!a||!a.__popupWidgetOpenFlag)},toggle:function(a){r.isOpen(a)?r.close(a):r.open(a)},refresh:function(a){if(a){a=a.__popupInfo;var b=d.isBodyLtr();
a&&f.around(a.wrapper,a.around,a.orient,b)}},getWrapper:function(a){return a&&a._popupWrapper}};return r})},"esri/dijit/geoenrichment/utils/onClickTouch":function(){define(["dojo/_base/lang","dojo/on","dojo/sniff"],function(l,h,g){var e=g("touch");return l.mixin(function(d,b,a,c){if(e){switch(b){case "click":b="touchstart,click";break;case "mousedown":b="touchstart,mousedown";break;case "mouseup":b="touchend,mouseup";break;case "clickend":b="touchend,click";break;default:return h(d,b,a,c)}var k=!1;
return h(d,b,function(b){"touchstart"===b.type||"touchend"===b.type?(a.call(this,b),k=!0,setTimeout(function(){k=!1},500)):k||a.call(this,b)},c)}"clickend"===b&&(b="click");return h(d,b,a,c)},h)})},"esri/dijit/geoenrichment/lists/_FlowListHoverSupport":function(){define(["dojo/_base/declare","dojo/on","../utils/MouseUtil"],function(l,h,g){var e=l(null,{_list:null,_checkIntervalH:null,constructor:function(d){this._list=d},setHoveredItem:function(d){clearInterval(this._checkIntervalH);this._emitHoverEvent(d);
this._checkIntervalH=setInterval(function(){g.isMouseOver(d)||this.setHoveredItem(null)}.bind(this),100)},_emitHoverEvent:function(d){this._list.onItemHovered({type:"itemHover",index:d?d.index:-1,item:d?d.item:null,value:d?d.item[this._list.idProperty]:void 0})}});return l(null,{_mouseHelper:null,postCreate:function(){this._mouseHelper=new e(this);this.inherited(arguments)},_addClickHandler:function(d){this.inherited(arguments);this._clickHandles.push(h(d,"mouseover",function(){this._mouseHelper.setHoveredItem(d)}.bind(this)))},
onItemHovered:function(d){}})})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/AreasSelect":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct esri/dijit/geoenrichment/TriStateItem esri/dijit/geoenrichment/ToggleButton esri/dijit/geoenrichment/lists/FlowListDefaultItemRenderer ../PlayerViewModes ./Select ./ComparisonSettings ../dataProvider/supportClasses/areas/AnalysisAreaUtil esri/dijit/geoenrichment/utils/DeviceUtil esri/dijit/geoenrichment/utils/PopupUtil esri/dijit/geoenrichment/utils/TooltipUtil dojo/i18n!esri/nls/jsapi".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q,t){t=t.geoenrichment.dijit.ReportPlayer.PlayerToolbar;var r=l(a,{canRemoveAreas:!1,canMoveAreas:!1,wrapInCards:!1,nls:null,createPresentation:function(a,c,f,k){var n=this,m=this.inherited(arguments);if(a.isSeparator)return m;m.innerHTML="";if("all"===a.value){m.style.cursor="pointer";var h=e.create("div",{"class":"dijitInline esriGEReportPlayerToolbar_checkboxRoot"},m);(new b(h,{mode:"toggle"})).set("checked",this.isCompareAll());e.create("div",{"class":"dijitInline",
innerHTML:a.label},m);m.addEventListener("click",function(){if(n.isCompareAll())n.onStopComparison();else n.onCompareAreasSideBySide()});q.setTooltipToNode(m,this.isCompareAll()?this.nls.compareAreasSideBySideTooltipOff:this.nls.compareAreasSideBySideTooltipOn,{position:["before","after"]});return m}if("addAreas"===a.value)return m.style.cursor="pointer",e.create("div",{"class":"dijitInline esriGESpaceAfterBig esriGEReportPlayerToolbar_addMoreAreasIcon"},m),e.create("div",{"class":"dijitInline",innerHTML:a.label},
m),m.addEventListener("click",function(){n.onAddMoreAreas()}),m;if(a.isAdditional)return m.style.cursor="pointer",a.buttonInfo.imageClass&&e.create("div",{"class":"dijitInline esriGESpaceAfterBig "+a.buttonInfo.imageClass},m),e.create("div",{"class":"dijitInline",innerHTML:a.label},m),m.addEventListener("click",function(b){a.buttonInfo.callback(b);n.onClosePopup()}),a.buttonInfo.tooltip&&(h=e.create("div",{"class":"dijitInline esriGESpaceBeforeBig esriGEInfoIcon"},m),q.setTooltipToNode(h,a.buttonInfo.tooltip,
a.buttonInfo.tooltipParams)),a.buttonInfo.onCreated&&a.buttonInfo.onCreated(m),m;if(a.canSelect){var h=e.create("div",{"class":"dijitInline esriGEReportPlayerToolbar_checkboxRoot"},m),p=new d(h);p.autoToggle=!1;p.set("checked",a.selected);m.addEventListener("click",function(){a.selected=!a.selected;p.set("checked",a.selected);a.isGroup?a.children.forEach(function(b){b.selected=a.selected}):a.parent&&(a.parent.selected=a.parent.children.some(function(a){return a.selected}));n.onVisibilityChanged()})}this.canRemoveAreas&&
a.isHost&&(h=e.create("div",{"class":"esriGEFloatEnd esriGESpaceBeforeBig esriGEReportPlayerToolbar_removeAreaButton"},m),h.addEventListener("click",function(b){b.stopPropagation();n.onRemoveAreas(a.isArea?[a.analysisArea]:a.analysisAreas)}),q.setTooltipToNode(h,a.isGroup?this.nls.removeAreasFromInfographic:this.nls.removeAreaFromInfographic));this.canMoveAreas&&a.isHost&&this.isCompareAll()&&(h=e.create("div",{"class":"esriGEFloatEnd upDownArrowsBlock"},m),0<a.hostIndex&&e.create("div",{"class":"dijitInline upArrow"},
h).addEventListener("click",function(b){b.stopPropagation();n.onMoveUp(a)}),a.hostIndex<this.getNumHostItems()-1&&e.create("div",{"class":"dijitInline downArrow"},h).addEventListener("click",function(b){b.stopPropagation();n.onMoveDown(a)}));h=e.create("div",{"class":"dijitInline",innerHTML:a.label},m);a.parent&&(h.style.paddingLeft="20px");this.wrapInCards&&(a.isArea&&!a.parent?g.add(m,"areaCard_only"):a.isGroup?g.add(m,"areaCard_groupTop"):a.isArea&&g.add(m,a.parent.children.indexOf(a)===a.parent.children.length-
1?"areaCard_groupBottom":"areaCard_groupMiddle"));this.selectPresentation(m,c,a);return m},isCompareAll:function(){return!1},getNumHostItems:function(){return 0},onAddMoreAreas:function(){},onRemoveAreas:function(a){},onVisibilityChanged:function(){},onMoveUp:function(a){},onMoveDown:function(a){},onCompareAreasSideBySide:function(){},onStopComparison:function(){},onClosePopup:function(){}});return l(k,{"class":"dijitInline esriGEOnDemandSelectNoBackground",listClass:"esriGEOnDemandSelectVeryTallList800 esriGEOnDemandSelectSpacedOut esriGEReportPlayerToolbar_areasSelectList",
player:null,canAddMoreAreas:!1,areasSelectButtons:null,comparisonSettingsBlock:null,comparisonSettings:null,_nls:null,buildRendering:function(){var a=this;this.inherited(arguments);this._nls=h.mixin({},t,this.player.nlsMap);this.itemRenderer=new r({nls:this._nls,onAddMoreAreas:function(){a.onAddMoreAreas();a.closePopup()},onRemoveAreas:function(b){var c=2>=a._getNumHostItems();a.onRemoveAreas(b,c);c&&a.closePopup()},isCompareAll:function(){return a.player.viewMode===c.PANELS_IN_STACK_ALL},getNumHostItems:function(){return a._getNumHostItems()},
onVisibilityChanged:function(){var b={};a.get("options").forEach(function(a){a.isArea&&(b[a.analysisArea.index]=a.selected)});a.refresh();a.player.getCurrentReportContainer().setAreasVisibilityState(b,{append:!0})},onMoveUp:function(a){},onMoveDown:function(a){},onCompareAreasSideBySide:function(){a.onCompareAreasSideBySide();a.closePopup()},onStopComparison:function(){var b=-1;a.get("options").some(function(a){if(a.analysisArea&&!a.analysisArea.hidden)return b=a.analysisArea.index,!0});a.onStopComparison(b);
a.closePopup()},onClosePopup:function(){a.closePopup()}})},_buildAdditionalPopupListProperties:function(){var a=this;return{selectionValidator:function(b){return a.player.viewMode!==c.PANELS_IN_STACK_ALL&&!!b&&!b.isSeparator&&!1!==b.enabled}}},buildAreaOptions:function(a){var b=n.groupAreas(a),f=1<b.groupInfos.length&&!b.isOnlyAreasInOnlyGroup;this.itemRenderer.wrapInCards=f;this.itemRenderer.canRemoveAreas=f&&!m.isMobileDevice();this.itemRenderer.canMoveAreas=!1;var k=[],d=0;b.groupInfos.forEach(function(a,
b){var c;a.isRealGroup&&(c={isGroup:!0,isHost:!0,hostIndex:d++,label:a.label,value:"group_"+b,enabled:!1,analysisAreas:a.areas,children:[]},k.push(c));a.areas.forEach(function(a){a={isArea:!0,label:a.shortName||a.name||"",value:a.index,analysisArea:a,parent:c,isHost:!c};a.isHost&&(a.hostIndex=d++);k.push(a);c&&c.children.push(a)})});b={isSeparator:!0};k.push(b);this.player.viewMode!==c.PANELS_IN_SLIDES&&(!m.isMobileDevice()&&1<a.analysisAreas.filter(function(a){return!a.hidden}).length&&k.push({label:this._nls.compareAreasSideBySide,
value:"all"}),this.canAddMoreAreas&&k.push({label:this._nls.addMoreAreas,value:"addAreas"}));this.areasSelectButtons&&this.areasSelectButtons.forEach(function(a){a.isVisible&&!a.isVisible()||k.push({label:a.label,value:a.id,isAdditional:!0,buttonInfo:a})});k[k.length-1]===b&&k.pop();this._updateTreeSelection(k);this.set("options",k);this._updateComparisonSettings()},_getNumHostItems:function(){var a=0;this.get("options").some(function(b){b.isHost&&a++});return a},onPopupListPreBuild:function(){this._updateTreeSelection()},
_updateTreeSelection:function(a){if(this.player.viewMode===c.PANELS_IN_STACK_ALL){var b=this.player.getCurrentReportContainer().getAreasVisibilityState();a=a||this.get("options");a.forEach(function(a){if(a.isGroup||a.isArea)a.canSelect=!0,a.isGroup?(a.children.forEach(function(a){a.selected=b[a.analysisArea.index]}),a.selected=a.children.some(function(a){return a.selected})):a.selected=b[a.analysisArea.index]})}},_updateComparisonSettings:function(){var a=this;this.comparisonSettings&&this.comparisonSettings.destroy();
this.comparisonSettings=null;this.comparisonSettingsBlock&&e.destroy(this.comparisonSettingsBlock);this.comparisonSettingsBlock=null;this.player.viewMode===c.PANELS_IN_STACK_ALL&&(this.comparisonSettingsBlock=e.create("div",{"class":"dijitInline esriGEClickable"},this.domNode.parentNode),e.create("div",{"class":"dijitInline esriGESpaceBeforeBig esriGEIcon16 esriGEReportPlayerToolbar_comparisonSettingsIcon"},this.comparisonSettingsBlock),p.makePopup(function(){a.comparisonSettings||(a.comparisonSettings=
new f({player:a.player,onChange:function(){a.player.getCurrentReportContainer().setComparisonSettings(a.comparisonSettings.getSettings())}}));a.comparisonSettings.setSettings(a.player.getCurrentReportContainer().getComparisonSettings());return a.comparisonSettings},this,this.comparisonSettingsBlock))},onAddMoreAreas:function(){},onRemoveAreas:function(a,b){},onCompareAreasSideBySide:function(){},onStopComparison:function(a){},destroy:function(){this.comparisonSettings&&this.comparisonSettings.destroy();
this.inherited(arguments)}})})},"esri/dijit/geoenrichment/TriStateItem":function(){define("dojo/_base/declare dojo/_base/event dojo/_base/lang dojo/Stateful dojo/on dojo/dom-construct dojo/dom-class ./utils/DeviceUtil".split(" "),function(l,h,g,e,d,b,a,c){return l(e,{domNode:null,checkboxNode:null,checked:!1,disabled:!1,autoToggle:!0,_currentClass:null,_lastChecked:!1,constructor:function(k,f,e){var n=c.isMobileDevice()?"touchstart":"click";f=f||{};var h=f["class"];f["class"]=(h?h+" ":"")+"esriTriStateCheckBoxIcon";
if(h=f.label){if(k instanceof HTMLLabelElement)k.innerHTML="\x26nbsp;"+h;else{var l=f.labelAttrs||{};l.innerHTML="\x26nbsp;"+h;l=b.create("label",l);k&&b.place(l,k);k=l}f=g.mixin({},f);delete f.label;delete f.labelAttrs}this.checkboxNode=b.create("div",f,k,k instanceof HTMLLabelElement?"first":e);this._currentClass=this._composeClass();a.add(this.checkboxNode,this._currentClass);k instanceof HTMLLabelElement?(d(k,n,g.hitch(this,this._onClick)),a.add(k,"esriTriStateCheckBoxLabel")):d(this.checkboxNode,
n,g.hitch(this,this._onClick));this.domNode=h?k:this.checkboxNode},postscript:function(){},_onClick:function(a){this.disabled||(this.autoToggle&&this.toggle(),a.checked=this.checked,this.onClick(h.fix(a)))},onClick:function(a){},toggle:function(){this.set("checked",!this._lastChecked);return this.checked},_checkedSetter:function(a){a!==this.checked&&(this.checked="mixed"===a?a:this._lastChecked=!!a,this._updateClass())},_disabledSetter:function(a){this.disabled=!!a;this._updateClass()},_updateClass:function(){var b=
this._composeClass();b!==this._currentClass&&(a.replace(this.checkboxNode,b,this._currentClass),this._currentClass=b)},_composeClass:function(){var a="esriTriStateCheckBox"+("mixed"==this.checked?"Mixed":this.checked?"Checked":"");return this.disabled?a+"Disabled":a}})})},"esri/dijit/geoenrichment/ToggleButton":function(){define(["dojo/_base/declare","dojo/Stateful","dojo/on","dojo/dom-construct","dojo/dom-class"],function(l,h,g,e,d){return l(h,{domNode:null,checked:!1,disabled:!1,mode:"toggle",constructor:function(b,
a,c){a=a||{};var k=a["class"];this.checked=!!a.checked;this.mode=a.mode||"toggle";this.domNode=e.create("div",{"class":(k?k+" ":"")+"esriGEToggleButton"},b,c);this._updateClass();g(this.domNode,"click",function(a){this.disabled||(a.checked=this.toggle(),this.onClick(a))}.bind(this))},postscript:function(){},_checkedSetter:function(b){this.checked=!!b;this._updateClass()},_modeSetter:function(b){this.mode=b;this._updateClass()},_disabledSetter:function(b){this.disabled=b;this._updateClass()},_updateClass:function(){d.remove(this.domNode,
"checked unchecked switch toggle");d.add(this.domNode,"toggle"===this.mode?"toggle":"switch");d.add(this.domNode,this.checked?"checked":"unchecked");d[this.disabled?"add":"remove"](this.domNode,"disabled")},onClick:function(b){},toggle:function(){this.set("checked",!this.checked);return this.checked}})})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/ComparisonSettings":function(){define("dojo/_base/declare esri/dijit/geoenrichment/TriStateItem dijit/_WidgetBase dijit/_TemplatedMixin esri/dijit/geoenrichment/utils/DomUtil esri/dijit/geoenrichment/utils/NodeLabelEditor esri/dijit/geoenrichment/utils/TooltipUtil dojo/text!../templates/ComparisonSettings.html dojo/i18n!esri/nls/jsapi".split(" "),
function(l,h,g,e,d,b,a,c,k){k=k.geoenrichment.dijit.ReportPlayer.PlayerToolbar;return l([g,e],{templateString:c,nls:k,player:null,showBackgroundImageCheckbox:null,splitPanelsCheckbox:null,postCreate:function(){var b=this;this.inherited(arguments);this.showBackgroundImageCheckbox=new h(this.showBackgroundImageLabel);this.showBackgroundImageCheckbox.onClick=function(){b._onChange()};this.splitPanelsCheckbox=new h(this.splitPanelsLabel);this.splitPanelsCheckbox.onClick=function(){b._update();b._onChange()};
a.setTooltipToNode(this.splitPanelsInfoIcon,k.splitPanelsTooltip);var c=this.player.nlsMap&&this.player.nlsMap.zoomPanelsTooltip||k.zoomPanelsTooltip;d[c?"show":"hide"](this.zoomPanelsInfoIcon);a.setTooltipToNode(this.zoomPanelsInfoIcon,c);this._initZoomControls();this._initZoomSplitControls()},_zoomEditor:null,_zoom:0,_initZoomControls:function(){var a=this;this._zoomEditor=new b({numericOnly:!0,onApply:function(b){a._setZoom(b)},onCancel:function(){a._updateZoomLabel()}});this.zoomLabel.addEventListener("click",
function(){a._zoomEditor.range={min:10,max:500};a._zoomEditor.editNodeLabel(a.zoomLabel,a._zoom)});this.zoomOutButton.addEventListener("click",function(){a._setZoom(Math.max(10,a._zoom-10))});this.zoomInButton.addEventListener("click",function(){a._setZoom(Math.min(500,a._zoom+10))});this.resetButton.addEventListener("click",function(){a._setZoom(100)})},_setZoom:function(a,b){a=Math.round(a);this._zoom!==a&&(this._zoom=a,this._updateZoomLabel(),this._update(),!b&&this._onChange())},_updateZoomLabel:function(){this.zoomLabel.innerHTML=
this._zoom+"%"},_zoomSplitEditor:null,_zoomSplit:0,_initZoomSplitControls:function(){var a=this;this._zoomSplitEditor=new b({numericOnly:!0,onApply:function(b){a._setZoomSplit(b)},onCancel:function(){a._updateZoomSplitLabel()}});this.zoomSplitLabel.addEventListener("click",function(){a._zoomSplitEditor.range={min:10,max:500};a._zoomSplitEditor.editNodeLabel(a.zoomSplitLabel,a._zoomSplit)});this.zoomOutSplitButton.addEventListener("click",function(){a._setZoomSplit(Math.max(10,a._zoomSplit-10))});
this.zoomInSplitButton.addEventListener("click",function(){a._setZoomSplit(Math.min(500,a._zoomSplit+10))});this.resetSplitButton.addEventListener("click",function(){a._setZoomSplit(100)})},_setZoomSplit:function(a,b){a=Math.round(a);this._zoomSplit!==a&&(this._zoomSplit=a,this._updateZoomSplitLabel(),this._update(),!b&&this._onChange())},_updateZoomSplitLabel:function(){this.zoomSplitLabel.innerHTML=this._zoomSplit+"%"},_update:function(){this.resetButton.style.visibility=100===this._zoom?"hidden":
"visible";this.resetSplitButton.style.visibility=100===this._zoomSplit?"hidden":"visible";d.hide([this.zoomBlock,this.zoomSplitBlock]);d.show(this.splitPanelsCheckbox.get("checked")?this.zoomSplitBlock:this.zoomBlock)},setSettings:function(a){this.showBackgroundImageCheckbox.set("checked",!a.hideBackgroundImage);this.splitPanelsCheckbox.set("checked",a.splitPanels);this._setZoom(100*(a.scale||1),!0);this._setZoomSplit(100*(a.scaleSplit||1),!0);this._update()},getSettings:function(){return{hideBackgroundImage:!this.showBackgroundImageCheckbox.get("checked"),
splitPanels:this.splitPanelsCheckbox.get("checked"),scale:this._zoom/100,scaleSplit:this._zoomSplit/100}},_onChange:function(){this._update();this.onChange()},onChange:function(){}})})},"esri/dijit/geoenrichment/utils/NodeLabelEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/keys dojo/dom-construct dojo/dom-geometry dojo/dom-style esri/dijit/geoenrichment/utils/MouseUtil esri/dijit/geoenrichment/utils/ObjectUtil".split(" "),function(l,h,g,e,d,b,a,c,k){return l(null,{_textMemo:null,
_handlers:null,_textBox:null,_node:null,numericOnly:!1,range:null,keepLabelDimensions:!0,constructor:function(a){h.mixin(this,a)},editNodeLabel:function(f,k){var m=this;this._stopEdit();this._node=f;this._textMemo="string"===typeof k||"number"===typeof k?k:f.innerHTML;k=b.position(f).w;f.innerHTML="";this._textBox=d.create("input",{type:"text"},f);this._textBox.name="node-label";this._textBox.value=this._textMemo;this._textBox.focus();this._textBox.select();this.keepLabelDimensions&&a.set(this._textBox,
"width",k+"px");this._handlers=[g(document.body,"keyup",function(a){a.keyCode===e.ESCAPE?m._cancelEdit():a.keyCode===e.ENTER&&m._applyEdit()}),g(document.body,"click",function(){c.isMouseOver(f)||m._cancelEdit()})]},_checkCanApply:function(a){if(!this.numericOnly)return!0;a=k.parseNumber(a);return isNaN(a)||this.range&&void 0!==this.range.min&&this.range.min>a||this.range&&void 0!==this.range.max&&this.range.max<a?!1:!0},_applyEdit:function(){var a=this._textBox.value;this._checkCanApply(a)?(this._node.innerHTML=
a,this._stopEdit(),this.onApply(a)):this._cancelEdit()},_cancelEdit:function(){this._node.innerHTML=this._textMemo;this._stopEdit();this.onCancel()},_stopEdit:function(){this._handlers&&this._handlers.forEach(function(a){a.remove()});this._textMemo=this._handlers=null;d.destroy(this._textBox);this._node=this._textBox=null},onApply:function(a){},onCancel:function(){}})})},"esri/dijit/geoenrichment/utils/ObjectUtil":function(){define(["dojo/number"],function(l){var h={};Math.log10=Math.log10||function(e){return Math.log(e)*
Math.LOG10E};h.populateObject=function(e,d,b){function a(c,k){function f(f){var d=c[f],e=k[f],g=d&&"object"===typeof d;void 0!==d&&(void 0===e?k[f]=d:e&&"object"===typeof e&&g?a(d,e):b&&(g?(e=k[f]={},a(d,e)):k[f]=c[f]))}if(c&&k&&!(Array.isArray(c)&&!Array.isArray(k)||Array.isArray(k)&&!Array.isArray(c)))if(Array.isArray(c))c.forEach(function(a,b){f(b)});else for(var d in c)f(d)}a(d,e);return e};h.filterByPattern=function(e,d){function b(a,k,f){for(var c in a){var d=a[c],e=k[c];if(Array.isArray(d)){var g=
d[0];if(e&&Array.isArray(e)){var h=f[c]=[];e.forEach(function(a){if(a&&"object"===typeof a){var c=Array.isArray(a)?[]:{};b(g,a,c);h.push(c)}})}}else if("object"===typeof d){if(e&&"object"===typeof e){var l=f[c]={};b(d,e,l)}}else void 0!==e&&(f[c]=e)}}var a={};b(d,e,a);return a};h.traverseObject=function(e,d){for(var b in e){var a=e[b];d(a,b,e);a&&"object"===typeof a&&h.traverseObject(a,d)}};h.copyOwnJsonProperties=function(e,d,b){d=d||{};for(var a in e){var c=e[a];e.hasOwnProperty(a)&&"function"!=
typeof c&&(c&&"object"==typeof c&&b&&(c=b(a,c)),void 0!==c&&(d[a]=c))}return d};h.removeUndefinedProperties=function(e){e&&Object.keys(e).forEach(function(d){void 0===e[d]&&delete e[d]});return e};h.getValue=function(e,d){if("string"!==typeof d)return e;d=d.split(".");for(var b=0;b<d.length;b++)e=e&&e[d[b]];return e};h.setValue=function(e,d,b){if("string"===typeof d&&(d=d.split("."),d.length)){for(var a=0;a<d.length-1;a++)e=e&&e[d[a]];e&&(e[d[d.length-1]]=b)}};h.isNumber=function(e){return!isNaN(parseFloat(e))&&
isFinite(e)};h.roundNumber=function(e,d){return"number"!==typeof e?e:parseFloat(e.toFixed(void 0!==d?d:0))};h.getBestPrecision=function(e){return 0===e?0:Math.max(0,Math.round(Math.log10(3E3/Math.abs(e))))};h.getPlaces=function(e,d){function b(b,f){var k=e.indexOf(b,a);if(0>k)return c;b=e.charAt(k+b.length);return!b||0>f.indexOf(b)?c:k-a}e=+e;if(isNaN(e))return-1;e+="";var a=e.indexOf(".")+1,c=a?e.length-a:0;if(2>=c||!d)return c;d=0;if(!+e.substr(0,a-1))for(;"0"===e.charAt(a);)a++,d++,c--;for(var k=
c-1;2<=k;k--){var f=Math.min(b("000000000000000".substr(0,k),"01234"),b("999999999999999".substr(0,k),"56789"));if(f!==c){c=f;break}}return c+d};h.formatNumber=function(e,d){d="number"===typeof d?{places:d}:d||{};var b=d.places,a={};0<=b?a.places=b:b=-1;e=l.format(e,a);if(d.noSeparator){var a=h.getSeparator(),c;if(a)for(;0<=(c=e.indexOf(a));)e=e.substr(0,c)+e.substr(c+1)}if(d.preserveTrailingZeroes||0>=b||!e)return e;for(d=e.length;0<b&&"0"==e.charAt(d-1);)d--,--b||d--;return e.substr(0,d)};h.formatNumberAsCurrency=
function(e,d,b){return d?d.split(";")[0>e?1:0].replace("0",h.formatNumber(Math.abs(e),b)):h.formatNumber(e,b)};var g;h.getSeparator=function(){void 0===g&&(g=l.format(9999,{places:0}).replace(/9/g,""));return g};h.parseNumber=function(e,d,b,a){if(""===e)return"undefined"!==typeof b?b:NaN;if(null==e||"string"!==typeof e&&isNaN(e))return NaN;e=String(e);if(!e.trim())return void 0!==b?b:NaN;b=l.parse(e,{strict:a});isNaN(b)&&e.trim().length&&(b=a?l.parse(e,{strict:a,locale:"en-US"}):Number(e));return isNaN(b)||
void 0===d||0>d?b:l.round(b,d)};h.parsePercentOrCurrency=function(e,d,b,a,c){"string"===typeof e&&(e=e.replace("%",""),d&&(d=d.split(";")[0].replace("0",""),e=e.replace(d,"")));return h.parseNumber(e,b,a,c)};h.compareEqual=function(e,d,b){return void 0===b?e===d:Number(Number(e).toFixed(b))===Number(Number(d).toFixed(b))};return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/AnalysisAreaUtil":function(){define(["dojo/_base/lang","esri/geometry/webMercatorUtils","esri/dijit/geoenrichment/utils/CoordinateUtil"],
function(l,h,g){var e={geometryToLatLong:function(d){var b=d.spatialReference.wkid;return b===g.WGS_84_WKID?{STORE_LONG:d.x,STORE_LAT:d.y}:g.isWebMercator(b)?(d=h.xyToLngLat(d.x,d.y),{STORE_LONG:d[0],STORE_LAT:d[1]}):null},populateCombinedAreasInfo:function(d,b){var a={},c={};b.forEach(function(b){b.latitude&&(a[b.latitude]=1);b.longitude&&(c[b.longitude]=1)});d.name=d.name||b.map(function(a){return a.name}).join(", ");d.shortName=d.shortName||b.map(function(a){return a.shortName||a.name}).join(", ");
d.description=d.description||b.map(function(a){return a.description||a.name}).join(", ");d.address=d.address||b.map(function(a){return a.address||a.name}).join(", ");d.latitude=d.latitude||Object.keys(a).join(", ");d.longitude=d.longitude||Object.keys(c).join(", ");return d},groupAreas:function(d){function b(a){var b=a.locationName||a.name;return{isSingleAreaGroup:!0,label:b,hideGroupLabel:b===(a.shortName||a.name),areas:[a]}}var a=d.combinedAreasInfo&&d.combinedAreasInfo.groups||[],c=[],k=[],f={};
d.analysisAreas.forEach(function(e){if(!(d.filter&&!d.filter(e)||e.hidden))if(e.isGrouped){if(!f[e.groupIndex]){var g=a[e.groupIndex],g=f[e.groupIndex]={isRealGroup:!0,label:g.locationName||g.name,areas:[]};k.push(g);c.push(g)}f[e.groupIndex].areas.push(e)}else c.push(b(e))});var e;1===c.length&&c[0].isRealGroup&&(c=c[0].areas.map(b),k.length=0,e=!0);return{groupInfos:c,isOnlyAreasInOnlyGroup:e}},parseSites:function(d){if(d.sites){d.analysisAreas=[];d.sites.forEach(function(a){a.areas.forEach(function(a){d.analysisAreas.push(a)})});
d.combinedAreasInfo={groups:d.sites.map(function(a){var b=l.mixin({},a);delete b.areas;delete b.attributes;delete b.notes;delete b.images;b.indexes=a.areas.map(function(a){return d.analysisAreas.indexOf(a)});return b})};e.populateCombinedAreasInfo(d.combinedAreasInfo,d.sites);if(!d.attachmentsProvider||!d.attachmentsProvider.getAttributesForAreaAt){d.attachmentsProvider={};d.attachmentsProvider.supportsMultipleAreas=1<d.sites.length;var b=d.attachmentsProvider.areaAttachments=[];d.sites.forEach(function(a){a.areas.forEach(function(c){b.push({attributes:a.attributes,
notes:a.notes,images:a.images})})})}delete d.sites}}};return e})},"esri/dijit/geoenrichment/utils/CoordinateUtil":function(){define(["esri/geometry/webMercatorUtils","esri/geometry/jsonUtils"],function(l,h){var g={},e=[4326,102100,102113,3857];g.WGS_84_WKID=4326;g.WEB_MERCATOR_WKID=102100;g.getSupportedWKIDs=function(){return e.slice()};g.testSpatialReferenceWKID=function(d){d=e.indexOf(Number(d&&"object"===typeof d?d.wkid:d));return 0<=d?e[0===d?0:1]:0};g.isWebMercator=function(d){return 102100===
g.testSpatialReferenceWKID(d)};g.isWGS84=function(d){return 4326===g.testSpatialReferenceWKID(d)};g.getGeometryConverter=function(d,b){d=g.testSpatialReferenceWKID(d);b=g.testSpatialReferenceWKID(b);return d&&b&&d!==b?4326===d?l.geographicToWebMercator:l.webMercatorToGeographic:null};g.toWGS84=function(d){return g.toSpatialReference(d,4326)};g.toWebMercator=function(d){return g.toSpatialReference(d,102100)};g.toSpatialReference=function(d,b){d&&!d.toJson&&(d=h.fromJson(d));b=g.getGeometryConverter(d&&
d.spatialReference,b);return null!=b?b(d):d};return g})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/ZoomSelect":function(){define("dojo/_base/declare dojo/dom-construct esri/dijit/geoenrichment/lists/FlowListDefaultItemRenderer ./Select ./ZoomUtil esri/dijit/geoenrichment/utils/NodeLabelEditor dojo/i18n!esri/nls/jsapi".split(" "),function(l,h,g,e,d,b,a){a=a.geoenrichment.dijit.ReportPlayer.PlayerToolbar;var c=l(g,{createPresentation:function(c,f,d,e){var k=this,g=this.inherited(arguments);if(c.isCustomZoom){g.innerHTML=
"";var n=h.create("div",{"class":"esriGELink",innerHTML:a.customZoom},g),m=new b({numericOnly:!0,onApply:function(b){k.onCustomZoomApplied(b);n.innerHTML=a.customZoom},onCancel:function(){n.innerHTML=a.customZoom}});n.addEventListener("click",function(){m.range={min:10,max:1E3};m.editNodeLabel(n,"")})}else this.selectPresentation(g,f);return g},onCustomZoomApplied:function(a){}});return l(e,{listClass:"esriGEOnDemandSelectUnlimitedTallList esriGEOnDemandSelectSpacedOut",buildRendering:function(){var a=
this;this.inherited(arguments);this.itemRenderer=new c({onCustomZoomApplied:function(b){a.set("value",b);a.onChange({value:b});a.closePopup()}})},postCreate:function(){this.inherited(arguments);var a=d.getOptions().slice();a.push({isCustomZoom:!0,enabled:!1});this.set("options",a);this.set("value",100)}})})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/ZoomUtil":function(){define(["dojo/i18n!esri/nls/jsapi"],function(l){var h={};l=l.geoenrichment.dijit.ReportPlayer.PlayerToolbar;h.FIT_PAGE="fitPage";
h.FIT_PAGE_WIDTH="fitPageWidth";h.FIT_PAGE_HEIGHT="fitPageHeight";h.getOptions=function(){var g=[{value:h.FIT_PAGE,label:l.fitPage},{value:h.FIT_PAGE_WIDTH,label:l.fitPageWidth},{value:h.FIT_PAGE_HEIGHT,label:l.fitPageHeight}];[{value:400,label:"400%"},{value:200,label:"200%"},{value:150,label:"150%"},{value:125,label:"125%"},{value:100,label:"100%"},{value:90,label:"90%"},{value:80,label:"80%"},{value:70,label:"70%"},{value:60,label:"60%"},{value:50,label:"50%"}].forEach(function(e){g.push({isCustom:!0,
value:-1,label:""});g.push(e)});g.push({isCustom:!0,value:-1,label:""});return g};h.getClosestZoomAndUpdateOptions=function(g,e){e.forEach(function(a){a.isCustom&&(a.value=-1,a.hidden=!0)});var d=[];e.forEach(function(a){a.isCustom||"number"!==typeof a.value||d.push({option:a,value:a.value,score:g<a.value?g/a.value:a.value/g})});d.sort(function(a,b){return b.score-a.score});var b=d[0];if(1===b.score)return b.value;var a=e.indexOf(b.option);e=e[a+(g>b.value?-1:1)];e.value=g;e.label=Math.round(g)+"%";
e.hidden=!1;return e.value};return h})},"esri/dijit/geoenrichment/ReportPlayer/toolbar/ToolbarArranger":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-style","esri/dijit/geoenrichment/utils/DomUtil"],function(l,h,g,e){return l(null,{showAreaTitle:!1,stretchToolbarNode:null,domNode:null,infographicsSelectDiv:null,areaTitleDiv:null,areaTitleInnerDiv:null,rightSideControlsBlock:null,areasSelectDiv:null,zoomSelectDiv:null,pageSelectDiv:null,commandButtonsContainer:null,constructor:function(d){h.mixin(this,
d)},arrangeControls:function(){e[0<this.infographicsSelectDiv.children.length?"show":"hide"](this.infographicsSelectDiv);e[this.showAreaTitle?"show":"hide"](this.areaTitleDiv);this.domNode.style.width="";this.areaTitleDiv.style.marginLeft="";this.areaTitleInnerDiv.style.maxWidth="";this.rightSideControlsBlock.style.position=this.stretchToolbarNode?"absolute":"static";this.stretchToolbarNode&&(this.domNode.style.width=this.stretchToolbarNode.clientWidth+"px",this._processStretchSpecialCases(this.stretchToolbarNode));
this.syncRightSideVisibility()},_processStretchSpecialCases:function(d){function b(b){return e.isHidden(b)?0:b.clientWidth+a(b)}function a(a){return e.isHidden(a)?0:g.get(a,"marginLeft")+g.get(a,"marginRight")}this.showAreaTitle&&(d=d.clientWidth,d-=b(this.infographicsSelectDiv),d-=b(this.rightSideControlsBlock),d-=b(this.areasSelectDiv),d-=a(this.areaTitleDiv),this.areaTitleInnerDiv.style.maxWidth=d+"px",e.isHidden(this.infographicsSelectDiv)||e.isHidden(this.infographicsSelectDiv)||(this.areaTitleDiv.style.marginLeft=
Math.min(d-this.areaTitleDiv.clientWidth,(this.domNode.clientWidth-this.areaTitleDiv.clientWidth)/2-b(this.infographicsSelectDiv))+"px"))},hasVisibleControls:function(){return[this.infographicsSelectDiv,this.areaTitleDiv,this.areasSelectDiv,this.pageSelectDiv,this.zoomSelectDiv,this.commandButtonsContainer].some(e.isNodeInLayout)},syncRightSideVisibility:function(){e.show(this.rightSideControlsBlock);var d=[this.pageSelectDiv,this.zoomSelectDiv,this.commandButtonsContainer].some(e.isNodeInLayout);
e[d?"show":"hide"](this.rightSideControlsBlock)}})})},"esri/dijit/geoenrichment/utils/InvokeUtil":function(){define(["esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],function(l,h){return{invoke:function(g,e,d,b,a){g.__invokeTimeoutIDs||(g.__invokeTimeoutIDs={});var c=g.__invokeTimeoutIDs[e];if(c){if(null==d||!1===b)return c.dfd.promise;clearTimeout(c.handle)}c||(c=g.__invokeTimeoutIDs[e]={dfd:new l});c.handle=setTimeout(function(){delete g.__invokeTimeoutIDs[e];h(a?g[e].apply(g,
a):g[e](),function(a){c.dfd.resolve(a)},function(a){c.dfd.reject(a)})},d||0);return c.dfd.promise},hasPendingInvoke:function(g,e){return!(!g.__invokeTimeoutIDs||!g.__invokeTimeoutIDs[e])},cancelInvoke:function(g,e){g.__invokeTimeoutIDs&&g.__invokeTimeoutIDs[e]&&(clearTimeout(g.__invokeTimeoutIDs[e].handle),delete g.__invokeTimeoutIDs[e])}}})},"esri/dijit/geoenrichment/ReportPlayer/ReportPlayerViewModel":function(){define("dojo/_base/declare dojo/aspect esri/dijit/geoenrichment/promise/all ./core/layout/LayoutBuilder ./core/themes/ThemeLibrary ./core/themes/ReportThemes ./core/supportClasses/map/layers/locator/LocatorPointsController ./core/supportClasses/map/layers/std/StdPolygonsController ./core/supportClasses/map/layers/thisAreas/ThisAreasHighlightController ./core/supportClasses/EditorUnits ../utils/ColorUtil".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n){return l(null,{isReportPlayerViewModel:!0,isGraphicStyle:!1,layoutBuilder:null,dynamicReportInfo:null,enableDataDrilling:!1,preInitialize:function(){this.layoutBuilder=this.layoutBuilder||new e;return this.layoutBuilder.initCoreComponents()},initialize:function(a,b){this.preInitialize();return this.layoutBuilder[a?"initClassicComponents":"initGraphicComponents"](b)},_animationAllowed:!1,_animationSuspended:!1,isAnimationAllowed:function(){return this._animationAllowed&&
!this._animationSuspended},setAnimationAllowed:function(a){this._animationAllowed=a},setAnimationSuspended:function(a){this._animationSuspended=a},_theme:null,getCurrentTheme:function(a){return a||this._theme},setTheme:function(a){this._theme=a||d.getReportThemeById(b.GRAPHIC)},getTableDefaultStyles:function(a,b){a=this.getCurrentTheme(a).table.overrideStyles;return b?a[b]:a},getChartDefaultStyles:function(a){return this.getCurrentTheme(a).chart},getDocumentDefaultStyles:function(a){return this.getCurrentTheme(a).document},
getInfographicDefaultStyles:function(a){return this.getCurrentTheme(a).infographic},getStaticInfographicDefaultStyles:function(a){return(a=this.getInfographicDefaultStyles(a))&&a.staticInfographic},isLightDocumentTheme:function(a){return n.isLightColor(this.getCurrentTheme(a).document.backgroundColor)},setDynamicReportInfo:function(a){this.dynamicReportInfo=a;this.isGraphicStyle=a.reportObject.isGraphicReport},getDynamicImageFunc:function(a,b,c){},_locatorPointsControllers:null,getLocatorPointsController:function(b,
c){var f=b.calculatorName+"_"+c;this._locatorPointsControllers=this._locatorPointsControllers||{};var d=this._locatorPointsControllers[f];d||(d=this._locatorPointsControllers[f]=new a(b,this.dynamicReportInfo.fieldData,this.dynamicReportInfo.isMultiFeature,c),h.after(d,"destroy",function(){delete this._locatorPointsControllers[f]}.bind(this)));return d},_stdPolygonsControllers:null,getStdPolygonsController:function(a,b){this._stdPolygonsControllers=this._stdPolygonsControllers||{};var f=a+"_"+(b||
0),d=this._stdPolygonsControllers[f];d||(d=this._stdPolygonsControllers[f]=new c(a,this.dynamicReportInfo.fieldData,this.dynamicReportInfo.isMultiFeature,b),h.after(d,"destroy",function(){delete this._stdPolygonsControllers[f]}.bind(this)));return d},loadAllStdFeatures:function(){var a=[],b;for(b in this._stdPolygonsControllers)a.push(this._stdPolygonsControllers[b].loadAllFeatures());return g(a)},_thisAreasHighlightController:null,getThisAreasHighlightController:function(){this._thisAreasHighlightController||
(this._thisAreasHighlightController=new k,h.after(this._thisAreasHighlightController,"destroy",function(){this._thisAreasHighlightController=null}.bind(this)));return this._thisAreasHighlightController},_legendControllers:null,registerLegendController:function(a,b,c){this._legendControllers=this._legendControllers||{};var f=this._legendControllers[b]=this._legendControllers[b]||{};f[c]=a;var d=a.addCallback(function(b,c){if(c)for(var d in f)c=f[d],c!==a&&c.setLegendVisible(b)},"viewModel");return{remove:function(){delete f[c];
d.remove()}}},_benchmarkController:null,_benchmarkDisabled:!1,getBenchmarkController:function(){return!this._benchmarkDisabled&&this._benchmarkController},registerBenchmarkController:function(a){this._benchmarkController&&this._benchmarkController.destroy();this._benchmarkController=a;h.after(this._benchmarkController,"destroy",function(){this._benchmarkController=null}.bind(this))},isBenchmarkedArea:function(a){return this._benchmarkDisabled?!1:"number"===typeof a&&this._benchmarkController&&0<=
this._benchmarkController.getAreaIndex()&&this._benchmarkController.getAreaIndex()!==a},setBenchmarkDisabled:function(a){this._benchmarkDisabled=a},reset:function(){[this._locatorPointsControllers,this._stdPolygonsControllers].forEach(function(a){a&&Object.keys(a).forEach(function(b){(b=a[b])&&b.destroy()})});this._stdPolygonsControllers=this._locatorPointsControllers=null;this._thisAreasHighlightController&&this._thisAreasHighlightController.destroy();this._thisAreasHighlightController=null},canExportToExcel:function(){return!1},
exportToExcel:function(a){},pepareExportToExcelParameters:function(a){},getUnits:function(){return"px"},provideUnits:function(a){return f.provideUnits(a,this.getUnits())},roundForUnits:function(a){return f.round(a,this.getUnits())}})})},"esri/dijit/geoenrichment/ReportPlayer/core/layout/LayoutBuilder":function(){define(["dojo/_base/declare","dojo/_base/lang","esri/dijit/geoenrichment/Deferred","dojo/dom-construct"],function(l,h,g,e){return l(null,{_moduleMap:null,_getModulePaths:function(){return{core:{section:"esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionRenderer",
grid:"esri/dijit/geoenrichment/ReportPlayer/core/grid/AdjustableGrid",image:"esri/dijit/geoenrichment/ReportPlayer/core/annotations/image/ImageRenderer",chart:"esri/dijit/geoenrichment/ReportPlayer/core/charts/ChartRenderer",map:"esri/dijit/geoenrichment/ReportPlayer/core/map/MapRenderer"},classic:{reportContainer:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainer/ReportContainer"},graphicCore:{shape:"esri/dijit/geoenrichment/ReportPlayer/core/annotations/shape/ShapeRenderer",infographic:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicRenderer"},
graphic_fullPages:{reportContainerGrid:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerGrid/ReportContainerGrid"},graphic_panelsInSlides:{reportContainerPagination:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerPagination/ReportContainerPagination",infographicPage:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicsPage"},graphic_panelsInStack:{reportContainerStack:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerStack/ReportContainerStack",infographicPageStack:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicsPageStack"},
graphic_panelsInStackAll:{reportContainerStack:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerStack/ReportContainerStack",reportContainerStackAll:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerStack/ReportContainerStackAll",infographicPageStack:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicsPageStack"},graphic_panelsInRow:{reportContainerStack:"esri/dijit/geoenrichment/ReportPlayer/core/reportContainerStack/ReportContainerStack",infographicPageStack:"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicsPageStack"}}},
initCoreComponents:function(){var d=this._getModulePaths();return this._initPaths(h.mixin({},d.core,d.graphicCore))},initClassicComponents:function(){var d=this._getModulePaths();return this._initPaths(h.mixin({},d.core,d.classic))},initGraphicComponents:function(d){var b=this._getModulePaths();return this._initPaths(h.mixin({},b.core,b.graphicCore,b["graphic_"+d]||b.graphic_fullPages))},_initPaths:function(d){var b=this;this._moduleMap=this._moduleMap||{};var a=[],c;for(c in d)a.push({id:c,path:d[c]});
var k=new g;require(a.map(function(a){return a.path}),function(){for(var c=0;c<arguments.length;c++)b._moduleMap[a[c].id]=arguments[c];k.resolve()});return k.promise},createElement:function(d,b,a,c){switch(d){case "grid":case "reportContainer":case "reportContainerGrid":case "reportContainerPagination":case "reportContainerStack":case "reportContainerStackAll":case "infographicPage":case "infographicPageStack":return new this._moduleMap[d](b,a?e.create("div",null,a,c):void 0);case "section":return this._moduleMap.section.createSection(b,
a,c);case "emptySection":return this._moduleMap.section.createEmptySection(b,a,c);case "image":return this._moduleMap.image.createImageContainer(b);case "shape":return this._moduleMap.shape.createShapeContainer(b);case "chart":return this._moduleMap.chart.createChartPage(b);case "infographic":return this._moduleMap.infographic.createInfographicPage(b);case "map":return this._moduleMap.map.createMapContainer(b)}return!1},getClass:function(d){return this._moduleMap[d]}})})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ThemeLibrary":function(){define("dojo/_base/lang ./PageBorderStyles ../charts/utils/ChartLineStyles ./ReportThemes ./ThemeUtil esri/dijit/geoenrichment/utils/ObjectUtil dojo/i18n!esri/nls/jsapi".split(" "),
function(l,h,g,e,d,b,a){function c(a){a=a||{};a=a.defaultFontFamilty||"Avenir Next";return{backgroundColor:"#FFFFFF",padding:5,icon:{backgroundColor:"#56a5d8"},highlightedIcon:{backgroundColor:"#D6851A"},iconBarBackground:{backgroundColor:"#AAAAAA",borderColor:"#AAAAAA"},titleLine:{color:"#A8A7A8"},titleStyle:{fontFamily:a,color:"#828282",fontSize:16,backgroundColor:"transparent"},variableLabelStyle:{fontFamily:a,color:"#56a5d8",fontSize:24,backgroundColor:"transparent"},variableLabelStyleHighlighted:{fontFamily:a,
fontSize:24},variableLabelStyleContrast:{fontFamily:a,fontSize:24},variableDescriptionStyle:{fontFamily:a,color:"#828282",fontSize:13,backgroundColor:"transparent"}}}function k(){return{style:h.ALL,lineStyle:"dashed",thickness:1,color:"#b2b2b2"}}function f(a){a=a||{};var b=a.defaultFontFamilty||"Avenir Next",f=a.defaultFontSize||13;return{document:{fontSize:f,fontFamily:b,backgroundImage:{data:null,position:"center",repeat:!1,scale:!0,opacity:1,size:null},border:k()},icon:{backgroundColor:"#56a5d8"},
highlightedIcon:{backgroundColor:"#D6851A"},table:{dataTablePadding:5,tooltip:{color:"#4c4c4c",backgroundColor:"#FFFFFF"},tooltipLink:{color:"#4c4c4c"}},chart:{renderSingleDataSeriesWithSameColor:!0,outlineStyle:g.SOLID,titleStyle:{fontFamily:b,fontSize:16},xAxis:{gridLinesStyle:g.SOLID,axisStyle:{fontFamily:b,fontSize:9},titleStyle:{fontFamily:b,fontSize:f}},yAxis:{gridLinesStyle:g.SOLID,baseLineStyle:g.SOLID,axisStyle:{fontFamily:b,fontSize:9},titleStyle:{fontFamily:b,fontSize:f}},dataLabelsStyle:{fontFamily:b,
fontSize:10},legendStyle:{fontFamily:b,fontSize:10},minMaxLegend:{titleStyle:{fontFamily:b,fontSize:10},minVariableLabelStyle:{fontFamily:b,fontSize:16},maxVariableLabelStyle:{fontFamily:b,fontSize:16}},icon:{backgroundColor:"#56a5d8"},line:{},column:{},bar:{},pie:{},donut:{},ring:{},pictureColumn:{},pictureBar:{},gauge:{dataLabelStyle:{fontFamily:b}},waffle:{dataValueStyle:{fontFamily:b,fontSize:30},dataLabelStyle:{fontFamily:b,fontSize:16}},tooltip:{color:"#4c4c4c",backgroundColor:"#FFFFFF"},tooltipLink:{color:"#4c4c4c"}},
infographic:{staticInfographic:c(a)}}}var n={DEFAULT_FONT_FAMILY_CLASSIC:"Verdana",DEFAULT_FONT_FAMILY_GRAPHIC:"Avenir Next",DEFAULT_FONT_SIZE_CLASSIC:10,DEFAULT_FONT_SIZE_GRAPHIC:13,CHART_DATA_FONT_SIZE:10,defaultStaticInfographic:c(),standardRamps:[{id:e.CLASSIC,colors:["#FFFFFF","#13729F","#DEA429"],additional:{table:{overrideStyles:{Default:{color:"#4C4C4C",backgroundColor:"#FFFFFF"},ReportTitle:{color:"#FFFFFF",backgroundColor:"#00436D"},TableHeader:{color:"#4C4C4C",backgroundColor:"#CCCCCC"},
GreyText:{color:"#AAAAAA",backgroundColor:"#FFFFFF"},BlueText:{color:"#00436D",backgroundColor:"#FFFFFF"},AlternatingRow:{color:"#4C4C4C",backgroundColor:"#EEEEEE"}}},chart:{renderSingleDataSeriesWithSameColor:!1,colors:"#13729F #DEA429 #6A9741 #A75523 #456E35 #D7DF22 #868686 #3C546D #829AB3 #DEDEDE #03406E #B1B1B1".split(" ")}}},{id:e.GRAPHIC,colors:["#FFFFFF","#56A5D8","#D6851A"],additional:{chart:{colors3series:["#56A5D8","#AED6F1","#2874A6"],colors:"#AED6F1 #85C1E9 #5DADE2 #3498DB #2E86C1 #2874A6 #21618C #1B4F72".split(" ")}}},
{id:"red",colors:["#d3d3d3","#8b4513","#ff4500"],additional:{chart:{colors3series:["#8b4513","#F1948A","#E74C3C"],colors:"#8b4513 #F1948A #EC7063 #E74C3C #CB4335 #B03A2E #943126 #78281F".split(" ")}}},{id:"dark",colors:["#6A6A6A","#FFFFFF","#EEEEEE"],additional:{chart:{colors3series:["#FFFFFF","#CACFD2","#A6ACAF"],colors:"#FFFFFF #D7DBDD #CACFD2 #BDC3C7 #A6ACAF #909497 #797D7F #626567 #4d4d4d #3e3e3e #262626".split(" ")}}},{id:"green",colors:["#556b2f","#90ee90","#ffffe0"],additional:{chart:{colors3series:["#E9F7EF",
"#A9DFBF","#27AE60"],colors:"#E9F7EF #A9DFBF #7DCEA0 #52BE80 #27AE60 #229954 #1E8449 #196F3D #145A32".split(" ")}}},{id:"green2",colors:["#FFFFFF","#0B7AC0","#35AC46"],additional:{chart:{colors3series:["#56A5D8","#AED6F1","#2874A6"],colors:"#56A5D8 #AED6F1 #85C1E9 #5DADE2 #3498DB #2E86C1 #2874A6 #21618C #1B4F72".split(" ")}}}]},m={};n.standardRamps.forEach(function(a){var c=l.mixin({},a.additional);c.id=a.id;var k=f({defaultFontFamilty:a.id===e.CLASSIC?"Verdana":"Avenir Next",defaultFontSize:a.id===
e.CLASSIC?10:13});d.applyThemeColorsToTheme({theme:k,colors:a.colors});b.populateObject(k,c,!0);n[a.id]=k;m[a.id]=k});n.TABLE_STYLES="Default ReportTitle TableHeader GreyText BlueText AlternatingRow".split(" ");n.getReportThemeById=function(a){return m[a]};n.isStandardTheme=function(a){return!!m[a]};n.getStandardThemes=function(){return Object.keys(m).map(function(a){return m[a]})};n.getDefaultStaticInfographicSettings=function(){return l.clone(n.defaultStaticInfographic)};n.getDefaultBorderSettings=
function(){return k()};n.getDefaultTheme=function(a){return f(a)};return n})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/PageBorderStyles":function(){define([],function(){var l={NONE:"none",ALL:"all",INNER_ONLY:"innerOnly",OUTER_ONLY:"outerOnly",HORIZONTAL_INNER_ONLY:"horizontalInnerOnly",VERTICAL_INNER_ONLY:"verticalInnerOnly",isSupported:function(h){for(var g in l)if(l[g]===h)return!0;return!1},toSupportedValue:function(h){return l.isSupported(h)?h:l.ALL}};return l})},"esri/dijit/geoenrichment/ReportPlayer/core/charts/utils/ChartLineStyles":function(){define([],
function(){var l={SOLID:"Solid",DASHED:"Dashed",DOTTED:"Dotted",isSupported:function(h){for(var g in l)if(l[g]===h)return!0;return!1},toGFXValue:function(h,g){switch(h){case "Dashed":return 1>g?"LongDash":"Dash";case "Dotted":return 1>g?"Dash":"Dot";default:return"Solid"}}};return l})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ReportThemes":function(){define([],function(){return{GRAPHIC:"graphic",CLASSIC:"classic",COMPARISON:"comparison"}})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ThemeUtil":function(){define(["dojo/_base/lang",
"esri/dijit/geoenrichment/utils/ColorUtil","esri/dijit/geoenrichment/utils/ObjectUtil"],function(l,h,g){function e(a){var b=h.isLightColor(a);return h.transform(a,{dv:b?-7:7}).toHex()}var d={getPanelTitleColor:function(a){var b=h.isLightColor(a);return h.transform(a,{dv:b?-50:50}).toHex()},getChartElementBackgroundColor:function(a){var b=h.isLightColor(a);return h.transform(a,{dv:b?-13:13}).toHex()}},b={getThemeColors:function(a){return[a.document.backgroundColor,a.icon.backgroundColor,a.highlightedIcon.backgroundColor]},
generateChartColors:function(a,b,f){f=f||{};var c=f.gradientFactor||1,d=[b,h.transform(b,{dv:-20*c}).toHex(),h.transform(b,{dv:-40*c}).toHex(),h.transform(b,{dv:-50*c}).toHex(),h.transform(b,{dv:-55*c}).toHex(),h.transform(b,{dv:-60*c}).toHex(),h.transform(b,{dv:-65*c}).toHex(),h.transform(b,{dv:-70*c}).toHex()];if(f.numLighterColors)for(var k=0;k<f.numLighterColors;k++)d.unshift(h.transform(b,{dv:20*c*(k+1),ds:-20*(k+1)}).toHex());a&&a!==b&&d.unshift(a);var e={};return d.filter(function(a){return e[a]?
!1:e[a]=!0})},applyThemeColorsToTheme:function(a){var c=a.theme,f=a.colors,n=a.preserveForegroundColor,m=a.chartColors,l=a.colors3series;a=a.preprocessGeneratedThemeFunc;var q=f[0],t=f[1],f=f[2],r=n&&c.chart&&c.chart.dataLabelsStyle&&c.chart.dataLabelsStyle.color||h.getContrastColor(q).toHex(),n=n&&c.document.color||("#FFFFFF"===q.toUpperCase()?"#4C4C4C":r),u=h.isLightColor(q),y=d.getChartElementBackgroundColor(q),v=d.getPanelTitleColor(q),w=h.transform(q,{dv:u?-33:33}).toHex(),D={overrideStyles:{Default:{color:n,
backgroundColor:"transparent"},TableHeader:{color:h.getContrastColor(t,void 0,void 0,200).toHex(),backgroundColor:t},AlternatingRow:{color:n,backgroundColor:h.transform(q,{dv:u?-7:7}).toHex()},ReportTitle:{color:f,backgroundColor:"transparent"},GreyText:{color:w,backgroundColor:"transparent"},BlueText:{color:"#56A5D8",backgroundColor:"transparent"}}},B={lineColor:r,gridLinesColor:r,gridStripesColor:e(q),gridStripesColorAlt:"transparent",axisStyle:{color:r},titleStyle:{color:r}},z={lineColor:r,gridLinesColor:r,
gridStripesColor:e(q),gridStripesColorAlt:"transparent",baseLineColor:r,axisStyle:{color:r},titleStyle:{color:r}},C=h.isLightColor(q),q={document:{color:n,backgroundColor:q,border:{color:w}},icon:{backgroundColor:t},highlightedIcon:{backgroundColor:f},table:D,chart:{backgroundColor:"transparent",outlineColor:void 0,titleStyle:{color:v},dataLabelsAltColor:r,dataLabelsStyle:{color:r},xAxis:B,yAxis:z,legendStyle:{color:r,backgroundColor:"transparent"},minMaxLegend:{titleStyle:{color:r}},comparisonInfo:{lineColor:C?
"#666666":"#BBBBBB"},icon:{backgroundColor:t},ring:{ringBackground:{backgroundColor:y}},gauge:{dataLabelStyle:{color:t},othersColor:y,arrowIndicator:{lineColor:v,backgroundColor:v}},waffle:{dataValueStyle:{color:t},dataLabelStyle:{color:t},othersColor:y},columnBarBackground:{backgroundColor:y}},infographic:{backgroundColor:"transparent",agePyramid:{theme:u?"light":"common",male:{backgroundColor:t},female:{backgroundColor:f}},staticInfographic:{backgroundColor:"transparent",icon:{backgroundColor:t},
highlightedIcon:{backgroundColor:f},iconBarBackground:{},titleLine:{color:h.transform(q,{dv:u?-40:40}).toHex()},titleStyle:{color:v},variableLabelStyle:{color:t},variableLabelStyleHighlighted:{color:f},variableLabelStyleContrast:{color:q},variableDescriptionStyle:{color:h.transform(q,{dv:u?-50:50}).toHex()}}}};a&&a(q);g.populateObject(c,q,!0);c.chart.colors=m&&m.length?m:b.generateChartColors(t,f);c.chart.colors3series=l},applyTextStyleToTheme:function(a,d){function c(a,b){var c=l.mixin({},d);a&&
delete c.color;b||delete c.fontSize;return c}d=b.filterTextStyles(d);var k={document:c(!1,!0),table:{overrideStyles:{Default:c(!1,!0),TableHeader:c(!1,!0),AlternatingRow:c(!1,!0),ReportTitle:c(!1,!0),GreyText:c(!1,!0),BlueText:c(!1,!0)}},chart:{titleStyle:c(),dataLabelsStyle:c(),xAxis:{axisStyle:c(),titleStyle:c()},yAxis:{axisStyle:c(),titleStyle:c()},legendStyle:c(),minMaxLegend:{titleStyle:c(),minVariableLabelStyle:c(!0),maxVariableLabelStyle:c(!0)},gauge:{dataLabelStyle:c()},waffle:{dataValueStyle:c(),
dataLabelStyle:c()}},infographic:{staticInfographic:{titleStyle:c(),variableLabelStyle:c(),variableLabelStyleHighlighted:c(),variableLabelStyleContrast:c(),variableDescriptionStyle:c()}}};g.populateObject(a,k,!0)}},a={fontFamily:1,fontSize:1,fontWeight:1,fontStyle:1,textDecoration:1,color:1};b.filterTextStyles=function(b){var c={},f;for(f in a){var d=b[f];void 0!==d&&(c[f]=d)}return c};return b})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/layers/locator/LocatorPointsController":function(){define("dojo/_base/declare dojo/on dijit/Destroyable ../../../../../dataProvider/supportClasses/data/AreaDataUtil ../../MapEventUtil esri/dijit/geoenrichment/utils/DeviceUtil".split(" "),
function(l,h,g,e,d,b){return l(g,{_info:null,_fieldData:null,_isMultiFeature:null,_calcDataArray:null,_currentFeatureIndex:null,_layerNames:null,constructor:function(a,b,d,f){this._info=a;this._fieldData=b;this._isMultiFeature=d;this._currentFeatureIndex=f;this._layerIndexes={};this._layerNames={};this._rendererJsons={};this._mapInfos={};this._graphicLayerInfos={}},_getCalculatorName:function(){return this._info.calculatorName},getVariableObjects:function(){return this._info.variableObjects},getLayerID:function(){return this._info.layerID},
getLayerUrl:function(){return this._info.layerUrl},getLayerName:function(a){return this._layerNames[a]||this._info.layerName},setLayerName:function(a,b){this._layerNames[a]=b},getCalculatorDataArray:function(){if(!this._calcDataArray)if(this._isMultiFeature){var a=e.combineAreaDataObjectCalculators(this._fieldData.areaData,this._getCalculatorName());this._calcDataArray=e.removeDuplicacatedCalcData(a.thisAreas.concat(a.comparisonLevels))}else this._calcDataArray=(a=e.getAreaDataObjectCalculator(this._fieldData.areaData[this._currentFeatureIndex],
this._getCalculatorName()))&&[a.data].concat(a.comparisonLevels);return this._calcDataArray},_rendererJsons:null,getRendererJson:function(a){return this._rendererJsons[a]},setRendererJson:function(a,b){this._rendererJsons[a]=b},_layerIndexes:null,getLayerIndex:function(a){return this._layerIndexes[a]},setLayerIndex:function(a,b){this._layerIndexes[a]=b},_mapInfos:null,getMapInfo:function(a){return this._mapInfos[a]},getMapInfos:function(){var a=[],b;for(b in this._mapInfos)a.push(this._mapInfos[b]);
return a},setMapInfo:function(a,b){this._mapInfos[a]=b},_getPointIndexForCellFunc:null,_getCellForPointAtFunc:null,_highlightedCell:null,setLocatorTableCallbacks:function(a){this._getPointIndexForCellFunc=a.getPointIndexForCellFunc;this._getCellForPointAtFunc=a.getCellForPointAtFunc},registerLocatorTable:function(a){var b=this,d;a.set("highlightRowsOnHover",!0);h(a.domNode,"mouseover,mousemove",function(){var c=a.getOverFieldCell();c&&c!==d&&(d=c,b._highlightGraphicForFieldCell(d))});h(a.domNode,
"mouseout",function(){b._highlightGraphicForFieldCell(null);d=null})},_highlightRowForGraphic:function(a,b){this._highlightedCell&&(this._highlightedCell.parentGrid&&this._highlightedCell.parentGrid.setCellRowHighlighted(this._highlightedCell,!1),this._highlightedCell=null);b&&this._getCellForPointAtFunc&&(a=a.getPointIndexForGraphicFunc(b),(a=this._getCellForPointAtFunc(a))&&a.parentGrid&&(a.parentGrid.setCellRowHighlighted(a,!0),this._highlightedCell=a))},_graphicLayerInfos:null,setLocatorPointsLayer:function(a,
b,d,f){this._unSetInfo(a);b={map:d,graphicsLayer:b,getPointIndexForGraphicFunc:f.getPointIndexForGraphicFunc,getGraphicForPointAtFunc:f.getGraphicForPointAtFunc,setGraphicHighlightedFunc:f.setGraphicHighlightedFunc,layerMouseOverHandle:null,layerMouseOutHandle:null,highlightedGraphic:null,overGraphic:null};this._graphicLayerInfos[a]=b;this._addLayerListeners(b)},_addLayerListeners:function(a){var c=this,k=a.map,f=a.graphicsLayer;a.layerMouseOverHandle=d.onLayerMouseOver(f,k,function(d){d.graphic&&
d.graphic._graphicsLayer===f&&a.overGraphic!==d.graphic&&((a.layerMouseOutHandle&&a.layerMouseOutHandle.remove(),a.layerMouseOutHandle=null,c._removeHighlight(a),a.overGraphic=d.graphic,c._highlightRowForGraphic(a,a.overGraphic),a.setGraphicHighlightedFunc(a.overGraphic,!0),b.isMobileDevice())?k.infoWindow&&(k.infoWindow.setFeatures([a.overGraphic]),k.infoWindow.show(d.mapPoint,{closestFirst:!0})):a.layerMouseOutHandle=h.once(f,"mouse-out",function(b){c._removeHighlight(a,!0)}))})},_highlightGraphicForFieldCell:function(a){for(var b in this._graphicLayerInfos){var d=
this._graphicLayerInfos[b];this._removeHighlight(d);if(a){var f=this._getPointIndexForCellFunc(a);if(f=d.getGraphicForPointAtFunc(f))d.setGraphicHighlightedFunc(f,!0),d.highlightedGraphic=f}}},_removeHighlight:function(a,b){this._highlightRowForGraphic(a,null);a.highlightedGraphic&&(a.setGraphicHighlightedFunc(a.highlightedGraphic,!1),a.highlightedGraphic=null);a.overGraphic&&a.setGraphicHighlightedFunc(a.overGraphic,!1);a.overGraphic=null;!b&&a.map.infoWindow&&a.map.infoWindow.hide()},setPointVisibleAt:function(a,
b){for(var c in this._graphicLayerInfos){var f=this._graphicLayerInfos[c].getGraphicForPointAtFunc(a);if(f)f[b?"show":"hide"]()}},_unSetInfo:function(a){var b=this._graphicLayerInfos[a];delete this._graphicLayerInfos[a];b&&(b.layerMouseOverHandle&&b.layerMouseOverHandle.remove(),b.layerMouseOutHandle&&b.layerMouseOutHandle.remove())},_unSetLayers:function(){Object.keys(this._graphicLayerInfos).forEach(this._unSetInfo.bind(this));this._graphicLayerInfos={}},destroy:function(){this._unSetLayers()}})})},
"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/data/AreaDataUtil":function(){define(["dojo/_base/lang","../../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil","../../../_devConfig"],function(l,h,g){var e={getAreaDataValue:function(d){function b(a){!1!==u&&(y=a[u]);void 0===y&&(y=a[c])}function a(){if(l)b(l);else{var a=f[e];a&&b(a.data)}}var c=d.fieldName,k=d.fieldData,f=d.areaDataObject,e=d.calculatorName,m=d.featureIndex,l=d.featureAttributes,q=d.ignoreMetadata,
t=d.isMultiFeature;if(!g.showAreaDataUtilUndefinedData&&c){var r=c.indexOf("."),u=!1;-1!==r&&(u=c.substr(r+1));e||-1===r||(e=c.substr(0,r));m=void 0===m?0:Number(m)||0;if((f=d.areaDataObject||k.areaData[m])||l){var y;t&&e===h.AREA_ATTRIBUTES_CALCULATOR_NAME&&!q&&k&&b(k.metadata);void 0===y&&a();if(e)return y;void 0===y&&!q&&k&&b(k.metadata);if(void 0===y&&!l)for(var v in f)if(b(f[v].data),void 0!==y)break;return y}}},getAreaDataObjectCalculator:function(d,b,a){if(!d)return null;var c=d[b];!c&&a&&
(c=d[b]=e.createCalculator());return c},createCalculator:function(d,b){return{data:d||{},comparisonLevels:b||[]}},combineAreaDataObjectCalculators:function(d,b,a){var c=[],k=[];d.forEach(function(a){if(a=e.getAreaDataObjectCalculator(a,b))c.push(a.data),k=k.concat(a.comparisonLevels)});a&&a.removeDuplicates&&(k=e.removeDuplicacatedCalcData(k));return{thisAreas:c,comparisonLevels:k}},removeDuplicacatedCalcData:function(d){if(!d.length)return d;var b=[],a={},c=Object.keys(d[0]);d.forEach(function(d){var f=
function(a){var b="";c.forEach(function(c){b+=a[c]+";"});return b}(d);a[f]||(a[f]=!0,b.push(d))});return b},setAreaDataValue:function(d,b,a,c,k){k=void 0===k?0:Number(k)||0;e.setAreaDataObjectValue(d,b,a[k],c)},setAreaDataObjectValue:function(d,b,a,c){a&&c&&null!==b&&void 0!==b&&(e.getAreaDataObjectCalculator(a,c,!0).data[d]=b)},mergeAreaData:function(d,b){b.forEach(function(a,b){(b=d[b])&&e.mergeAreaDataObjects(b,a)})},mergeAreaDataObjects:function(d,b){for(var a in d){var c=d[a],k=b[a];k?c.comparisonLevels.length!==
k.comparisonLevels.length?console.log("Error: can't merge calculators with different comparison levels!"):(l.mixin(k.data,c.data),c.comparisonLevels.forEach(function(a,b){l.mixin(k.comparisonLevels[b],a)})):b[a]=c}console.log("AreaDataUtil.js merging area data \x3d\x3e areaData");console.log(b)}};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil":function(){define(["esri/dijit/geoenrichment/utils/MaskUtil","./FieldLibrary"],function(l,
h){var g={SCRIPT_PREFIX:"",DEFAULT_SCRIPT_NAME:"Custom",TOTAL_SCRIPT_NAME:"Total",AVG_SCRIPT_NAME:"Average",SCRIPT_PREFIX_RE:/^SCRIPT_/i,FIRST_SYMBOL_IS_NUMBER_RE:/^[0-9]/,DATA_COLLECTIONS_CALCULATOR_NAME:"dataCollectionsCalculator",MAPS_CALCULATOR_NAME:"mapsCalculator",UNITED_MAPS_CALCULATOR_NAME:"unitedMapsCalculator",AREA_ATTRIBUTES_CALCULATOR_NAME:"headers",ENRICHED_DATA_NO_LEVELS:"enrichFieldData_noLevels",SCRIPTS_CALCULATOR_NAME:"scripts",createFieldNameFromSource:function(e,d){if(!e)return"";
var b="";e.isSiteAttribute?b=e.attribute.name:e.isChartAttribute?b=e.id:e.isWebMap?b=e.webMapFieldName||e.fieldName:(e=(e.fullName||e).replace(/_|\.|\s/g,""),d=d||"n",e+="n"===d?"":"_"+d,g.FIRST_SYMBOL_IS_NUMBER_RE.test(e)&&(e="_"+e),b=e.toUpperCase());return g._validateName(b)},createFieldNameFromScript:function(e){e=e.name;g.SCRIPT_PREFIX_RE.test(e)&&(e=e.replace(g.SCRIPT_PREFIX_RE,""));return g._validateName(g.SCRIPT_PREFIX+e.replace(/\.|-/g,""))},_validateName:function(e){return g._checkXMLValidName(g._maskUnicodeInName(e))},
_XML_MASK_NAME_RE:/(_X)(\d\d\d\d)/i,_checkXMLValidName:function(e){return g._XML_MASK_NAME_RE.test(e)?e.replace(g._XML_MASK_NAME_RE,"$1_$2"):e},_XML_UNICODE_RE:/&#x|;/ig,_maskUnicodeInName:function(e){return l.maskWithUnicodeXML(e).replace(g._XML_UNICODE_RE,"")},renderScriptName:function(e){return e.replace(g.SCRIPT_PREFIX_RE,"")},provideQualifiedFieldInfoTemplateName:function(e,d){e&&(e.templateName=d?d+"."+e.name:e.isWebMap?g.AREA_ATTRIBUTES_CALCULATOR_NAME+"."+e.name:e.isSiteAttribute?g.AREA_ATTRIBUTES_CALCULATOR_NAME+
"."+e.name:g.DATA_COLLECTIONS_CALCULATOR_NAME+"."+e.name)},getCalculatorName:function(e){return e&&e.templateName&&e.templateName.substr(0,e.templateName.indexOf("."))},isAreaAttributesFieldInfo:function(e){return g.getCalculatorName(e)===g.AREA_ATTRIBUTES_CALCULATOR_NAME},updateCalculatorName:function(e,d){e&&(e.hasVariable||e.script)&&(e.templateName=d+e.templateName.substr(e.templateName.indexOf(".")))},refreshNameAndTemplateName:function(e){e.statefulName&&e.fullName&&(e.name=g.createFieldNameFromSource(e,
e.statefulName.charAt(0)),e.templateName=e.templateName.substr(0,e.templateName.lastIndexOf(".")+1)+e.name)},getFieldInfoAlias:function(e){return e?e.script?e.script.alias:e.hasVariable||e.isMissing?e.alias:h.getFieldLabel(e.name):null}};return g})},"esri/dijit/geoenrichment/utils/MaskUtil":function(){define([],function(){function l(h,g){return"string"!==typeof h?h:String(h).replace(/[^\x20-\x7f]/g,function(e){e=e.charCodeAt(0).toString(16).toUpperCase();return g(e)})}return{maskWithUnicode:function(h){return l(h,
function(g){return"\\u000".substr(0,6-g.length)+g})},maskWithUnicodeXML:function(h){return l(h,function(g){return"\x26#x000".substr(0,7-g.length)+g+";"})},removeUnicode:function(h,g){return l(h,function(e){return g||""})},removeXMLMasks:function(h,g){return h.replace(/&#x.*?;/g,g||"")}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldLibrary":function(){define(["dojo/string","dojo/i18n!esri/nls/jsapi"],function(l,h){var g=h.geoenrichment.dijit.ReportPlayer.FieldInfoLabels;
h=h.geoenrichment.dijit.ReportPlayer.FieldInfoPreview;g={_SPECIAL_HEADER_FIELDS_NAME_MAP:{SITE_NAME:"SiteName",STORE_ADDR:"SiteAddr",AREA_DESC2:"SiteDesc",STORE_LAT:"Latitude",STORE_LONG:"Longitude",AREA_ID:"AreaID",AREA_DESC:"AreaDesc",STORE_ID:"StoreID",RING:"Ring",STORE_NAME:"StoreName",GROUPCOUNT:"SummaryCount"},_ADDITIONAL_HEADER_FIELDS_MAP:{SITENOTE:"SiteNote",SITENOTE2:"SiteNote2",SITENOTE3:"SiteNote3",SITENOTE4:"SiteNote4",SITENOTE5:"SiteNote5",SITENOTE6:"SiteNote6",SITENOTE7:"SiteNote7",
SITENOTE8:"SiteNote8",SITENOTE9:"SiteNote9",SITENOTE10:"SiteNote10",SITENOTES:"SiteNotes",CHART_AREA_NAME:"ChartAreaName",CHART_SERIES_NAME:"ChartSeriesName",CHART_POINT_NAME:"ChartVariableName",CHART_POINT_VALUE:"ChartVariableValue"},_REPORT_VAR_FIELDS_MAP:{REPORTNAME:"Title",REPORTTITLE2:"Subtitle",CURRPAGE:"Page",COPYRIGHT:"Copyright",TRIALURLTEXT:"TrialUrlText",PHONENUMBER:"PhoneNumber",PRODUCTURL:"ProductUrl",PRODUCTLABEL:"ProductLabel",SOURCE:"Source",CENSUSYEAR:"CensusYear",CURRENTYEAR:"CurrentYear",
FUTUREYEAR:"FutureYear",LATITUDELABEL:"LatitudeLabel",LONGITUDELABEL:"LongitudeLabel",PAGEFORMAT:"PageFormat",BANDFROM0TO1UNIT2:"BandFrom0To1Unit2",RADIUS0UNIT1:"Radius0Unit1",AREADELIMITER:"AreaDelimiter",BANDREGIONFROM0TO1:"BandRegionFrom0To1",ET_AL:"ET_AL",LINEBUFFERSEGMENTFROM0TO1UNIT2RADIUS:"LineBufferSegmentFrom0To1Unit2Radius",LINEBUFFERRADIUS0UNIT1RADIUS:"LineBufferRadius0Unit1Radius",RINGVALUE0UNIT1RADIUS:"RingValue0Unit1Radius",RINGSVALUES0UNIT1RADII:"RingsValues0Unit1Radii",RINGBUFFERBANDFROM0TO1UNIT2RADIUS:"RingBufferBandFrom0To1Unit2Radius",
DRIVETIMEBANDFROM0TO1UNIT2RADIUS:"DriveTimeBandFrom0To1Unit2Radius",RINGBUFFERBANDSBANDS0UNIT1RADII:"RingBufferBandsBands0Unit1Radii",RINGBUFFERBANDRING0UNIT1RADIUS:"RingBufferBandRing0Unit1Radius",DRIVETIMEBANDBAND0UNIT1RADIUS:"DriveTimeBandBand0Unit1Radius",DRIVETIMESRINGS0UNIT1RADII:"DriveTimesRings0Unit1Radii",DRIVETIMERING0UNIT1RADIUS:"DriveTimeRing0Unit1Radius",DRIVEDISTANCEVALUE0UNIT1RADIUS:"DriveDistanceValue0Unit1Radius",DRIVEDISTANCESRINGS0UNIT1RADII:"DriveDistancesRings0Unit1Radii",DRIVEDISTANCERING0UNIT1RADIUS:"DriveDistanceRing0Unit1Radius"},
_SPECIAL_HEADER_FIELDS_NAME_MAP_BACK:{},_ADDITIONAL_HEADER_FIELDS_MAP_BACK:{},_REPORT_VAR_FIELDS_MAP_BACK:{},_PREVIEW:{Title:h.fieldPreviewTitle,Title_graphic:h.fieldPreviewTitleGraphic,Subtitle:h.fieldPreviewSubtitle,Date:h.fieldPreviewDate,Page:h.fieldPreviewPage,Count:h.fieldPreviewLocationsCount,Copyright:h.fieldPreviewCopyright,TrialUrlText:h.fieldPreviewTrialUrlText,PhoneNumber:h.fieldPreviewPhoneNumber,ProductUrl:h.fieldPreviewProductUrl,ProductLabel:h.fieldPreviewProductLabel,Source:h.fieldPreviewSource,
SITE_NAME:h.fieldPreviewSiteName,SITE_NAME_multi:h.fieldPreviewSiteNameMulti,STORE_LAT:h.fieldPreviewLat,STORE_LONG:h.fieldPreviewLong,AREA_DESC2:h.fieldPreviewAreaDesc2,STORE_ADDR:h.fieldPreviewStoreAddr,AREA_DESC:h.fieldPreviewAreaDesc,CHART_AREA_NAME:h.fieldPreview_chartArea,CHART_SERIES_NAME:h.fieldPreview_seriesName,CHART_POINT_NAME:h.fieldPreview_pointName},_LABELS:{CHART_AREA_NAME:g.chartAreaName,CHART_SERIES_NAME:g.chartSeriesName,CHART_POINT_NAME:g.chartPointName,CHART_POINT_VALUE:g.chartPointValue},
DATE_FIELD_NAME:"Date",DATE_FIELD_ALIAS:"Date",DATE_FIELD_DEFAULT_FORMAT:"d-MMMM dd, yyyy",GROUPCOUNT_FIELD_NAME:"SummaryCount",GROUPCOUNT_FIELD_ALIAS:"SummaryCount",SITENOTES_FIELD_NAME:"SiteNotes",SITENOTES_FIELD_ALIAS:"SiteNotes",init:function(){for(var e in this._SPECIAL_HEADER_FIELDS_NAME_MAP)this._SPECIAL_HEADER_FIELDS_NAME_MAP_BACK[this._SPECIAL_HEADER_FIELDS_NAME_MAP[e].toUpperCase()]=e;for(e in this._ADDITIONAL_HEADER_FIELDS_MAP)this._ADDITIONAL_HEADER_FIELDS_MAP_BACK[this._ADDITIONAL_HEADER_FIELDS_MAP[e].toUpperCase()]=
e;for(e in this._REPORT_VAR_FIELDS_MAP)this._REPORT_VAR_FIELDS_MAP_BACK[this._REPORT_VAR_FIELDS_MAP[e].toUpperCase()]=e},templateToUIHeader:function(e){e=e&&this.trimTemplateHeaderName(e).toUpperCase();return this._SPECIAL_HEADER_FIELDS_NAME_MAP[e]||this._ADDITIONAL_HEADER_FIELDS_MAP[e]},qualifyTemplateHeaderName:function(e){return e&&0!==e.indexOf("headers.")?"headers."+e:e},trimTemplateHeaderName:function(e){if(!e)return e;0===e.indexOf("headers.")&&(e=e.substr(e.indexOf(".")+1));return e},templateToUIReportVar:function(e){e=
e&&e.toUpperCase();return this._REPORT_VAR_FIELDS_MAP[e]},uiToTemplate:function(e){e=e&&e.toUpperCase();return this._SPECIAL_HEADER_FIELDS_NAME_MAP_BACK[e]||this._ADDITIONAL_HEADER_FIELDS_MAP_BACK[e]||this._REPORT_VAR_FIELDS_MAP_BACK[e]},getPreview:function(e,d,b){e=this.trimTemplateHeaderName(e);if(!e)return null;d&&"Title"===e&&(e+="_graphic");b&&"SITE_NAME"===e&&(e+="_multi");return"SiteNotes"===e?h.fieldPreviewSiteNotes:0===e.indexOf("SiteNote")?l.substitute(h.fieldPreviewSiteNote,{index:e.replace("SiteNote",
"")||1}):this._PREVIEW[e]},hasField:function(e){return!!(this.uiToTemplate(e)||this.templateToUIHeader(e)||this.templateToUIReportVar(e))},isAdditionalHeadersField:function(e){e=e&&this.trimTemplateHeaderName(e).toUpperCase();return this._ADDITIONAL_HEADER_FIELDS_MAP[e]},isChartAttribute:function(e){return this.isAdditionalHeadersField(e)&&-1!==e.toUpperCase().indexOf("CHART_")},getSiteNoteFieldNameAt:function(e){return"SiteNote"+(!e||1>=Number(e)?"":e)},getFieldLabel:function(e){e=e&&this.trimTemplateHeaderName(e).toUpperCase();
return this._LABELS[e]},getReportVarSelfTagsMap:function(){return{Page:"currPage",Title:"reportName",Subtitle:"reportTitle2"}},getReportVarTextTagsMap:function(){var e=this.getReportVarSelfTagsMap(),d={},b;for(b in this._REPORT_VAR_FIELDS_MAP){var a=this._REPORT_VAR_FIELDS_MAP[b];e[a]||(d[a]=a)}return d}};g.init();return g})},"esri/dijit/geoenrichment/ReportPlayer/_devConfig":function(){define([],function(){return{logData:!1,showAreaDataUtilUndefinedData:!1,createPlayerCommand:{saveDataJsonAsTextFile:!1,
useTestBuild:!1,configUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/release/reportPlayer/config.js",baseUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/release",mainUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/release/dojo/dojo.js",esriDijitCssUrl:"https://js.arcgis.com/3.31/dijit/themes/claro/claro.css",esriCssUrl:"https://laci2.esri.com/jenkins/job/report-player-jsapi-pr/lastSuccessfulBuild/artifact/release/reportPlayer/reportPlayer.css"},
createPDFCommand:{removeUnicodeChars:!1},preview:{bigValues:!1},charts:{enableEffects:!1},table:{printGridRefresh:!1},emulateErrors:{playerError:!1,contentErrors:!1,themeParseError:!1,metadataParseError:!1,layoutParseError:0,reportContainerRenderError:!1,createReportError:!1,createReportNaN:!1,createReportNull:!1,getMapItemError:!1,emptyDataProviderResponse:!1,emptyTemplateJson:!1}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/MapEventUtil":function(){define(["dojo/on","dojo/sniff",
"esri/dijit/geoenrichment/utils/DeviceUtil"],function(l,h,g){return{onLayerMouseOver:function(e,d,b){var a=g.isMobileDevice();e=a?e:h("touch")?d:e;a=a?"mouse-over":h("touch")?"mouse-down, mouse-move":"mouse-move";return l(e,a,b)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/layers/std/StdPolygonsController":function(){define("dojo/_base/declare esri/dijit/geoenrichment/Deferred dojo/on esri/dijit/geoenrichment/promise/all dijit/Destroyable ../../MapEventUtil ../../../../comparison/ComparisonUtil esri/dijit/geoenrichment/ReportPlayer/countryConfig".split(" "),
function(l,h,g,e,d,b,a,c){return l(d,{currentFeatureIndex:null,_calculatorName:null,_fieldData:null,_isMultiFeature:null,_hasRegisteredLayers:!1,_hasRegisteredInfographics:!1,constructor:function(a,b,c,d){this._calculatorName=a;this._fieldData=b;this._isMultiFeature=c;this.currentFeatureIndex=d;this._layerIndexes={};this._rendererJsons={};this._labelRendererJsons={};this._mapInfos={};this._graphicLayerInfos={};this._pendingLayerInfos={}},getCalculatorName:function(){return this._calculatorName},_rendererJsons:null,
_labelRendererJsons:null,getRendererJson:function(a){return this._rendererJsons[a]},getLabelRendererJson:function(a){return this._labelRendererJsons[a]},setRendererJson:function(a,b){this._rendererJsons[a]=b},setLabelRendererJson:function(a,b){this._labelRendererJsons[a]=b},_layerIndexes:null,getLayerIndex:function(a,b){var f=c.getGeographiesModel().getLevels(),d=-1;f.some(function(a,c){if(a.id===b)return d=c,!0});return this._layerIndexes[a]+d/f.length},setLayerIndex:function(a,b){this._layerIndexes[a]=
b},_mapInfos:null,getMapInfo:function(a){return this._mapInfos[a]},getMapInfos:function(){var a=[],b;for(b in this._mapInfos)a.push(this._mapInfos[b]);return a},setMapInfo:function(a,b){this._mapInfos[a]=b},_attributeFields:null,getAttributeFields:function(){return this._attributeFields},setAttributeFields:function(a){this._attributeFields=a},_shownFeatureAttributes:null,_featuresChangedHandlers:null,getShownFeatureAttributes:function(){return this._shownFeatureAttributes},setShownFeaturesChangedListener:function(a){var b=
this;this._featuresChangedHandlers=this._featuresChangedHandlers||[];this._featuresChangedHandlers.push(a);return{remove:function(){var c=b._featuresChangedHandlers;if(c){var f=c.indexOf(a);-1!==f&&c.splice(f,1)}}}},setShownFeatureAttributes:function(a){this._shownFeatureAttributes=a||[];this._featuresChangedHandlers&&this._featuresChangedHandlers.forEach(function(a){a()})},_allFeatureAttributes:null,_loadAllFeaturesHandlers:null,getAllFeatureAttributes:function(){return this._allFeatureAttributes||
[]},setAllFeatureAttributes:function(a){this._allFeatureAttributes=a},setLoadAllFeaturesListener:function(a){var b=this;this._loadAllFeaturesHandlers=this._loadAllFeaturesHandlers||[];this._loadAllFeaturesHandlers.push(a);return{remove:function(){var c=b._loadAllFeaturesHandlers;if(c){var f=c.indexOf(a);-1!==f&&c.splice(f,1)}}}},loadAllFeatures:function(){return this._loadAllFeaturesHandlers&&e(this._loadAllFeaturesHandlers.map(function(a){return a()}))},buildGeometryFieldName:function(a){return"__stdGeometry_"+
a},saveGeometryInCalculatorData:function(b,c){a.copyValueToCalculatorData(b,{fieldName:c,fieldData:this._fieldData,isMultiFeature:this._isMultiFeature,currentFeatureIndex:this.currentFeatureIndex,calculatorName:this._calculatorName})},provideGeometryFromCalculatorData:function(b,c){a.copyValueFromCalculatorData(b,{fieldName:c,fieldData:this._fieldData,isMultiFeature:this._isMultiFeature,currentFeatureIndex:this.currentFeatureIndex,calculatorName:this._calculatorName})},_highlightInfographicForAttributesFunc:null,
_registerInfographicDfd:null,registerInfographic:function(a){this._highlightInfographicForAttributesFunc=a.highlightInfographicForAttributes;this._registerInfographicDfd=new h;this._hasRegisteredLayers&&this._registerInfographicDfd.resolve();this._hasRegisteredInfographics||(this._hasRegisteredInfographics=!0,this._doRegisterLayers());return this._registerInfographicDfd.promise},_graphicLayerInfos:null,_pendingLayerInfos:null,setStdPolygonsLayer:function(a,b,c,d){this._unSetInfo(a);this._pendingLayerInfos[a]=
{map:c,graphicsLayer:b,getGraphicForAttributesFunc:d.getGraphicForAttributesFunc,setGraphicHighlightedFunc:d.setGraphicHighlightedFunc,layerMouseOverHandle:null,layerMouseOutHandle:null,highlightedGraphic:null};this._hasRegisteredInfographics&&this._doRegisterLayers();this._hasRegisteredLayers||(this._hasRegisteredLayers=!0,this._registerInfographicDfd&&this._registerInfographicDfd.resolve())},_doRegisterLayers:function(){for(var a in this._pendingLayerInfos){var b=this._pendingLayerInfos[a];this._graphicLayerInfos[a]=
b;this._addLayerListeners(b)}this._pendingLayerInfos={}},_addLayerListeners:function(a){var c=this,d=a.graphicsLayer,k;a.layerMouseOverHandle=b.onLayerMouseOver(d,a.map,function(b){b.graphic&&b.graphic._graphicsLayer===d&&k!==b.graphic&&(a.layerMouseOutHandle&&a.layerMouseOutHandle.remove(),a.layerMouseOutHandle=null,k&&a.setGraphicHighlightedFunc(k,!1),k=b.graphic,c._highlightInfographicForAttributesFunc(k.attributes),a.setGraphicHighlightedFunc(k,!0),a.layerMouseOutHandle=g.once(d,"mouse-out",function(b){c._highlightInfographicForAttributesFunc(null);
k&&a.setGraphicHighlightedFunc(k,!1);k=null}))})},highlightGraphicForAttributes:function(a){for(var b in this._graphicLayerInfos){var c=this._graphicLayerInfos[b];c.highlightedGraphic&&(c.setGraphicHighlightedFunc(c.highlightedGraphic,!1),c.highlightedGraphic=null);if(a){var d=c.getGraphicForAttributesFunc(a);d&&(c.setGraphicHighlightedFunc(d,!0),c.highlightedGraphic=d)}}},_unSetInfo:function(a){var b=this._graphicLayerInfos[a];delete this._graphicLayerInfos[a];b&&(b.layerMouseOverHandle&&b.layerMouseOverHandle.remove(),
b.layerMouseOutHandle&&b.layerMouseOutHandle.remove())},_unSetLayers:function(){Object.keys(this._graphicLayerInfos).forEach(this._unSetInfo.bind(this));this._graphicLayerInfos={}},destroy:function(){this._unSetLayers()}})})},"esri/dijit/geoenrichment/ReportPlayer/core/comparison/ComparisonUtil":function(){define(["esri/dijit/geoenrichment/utils/ObjectUtil","../../dataProvider/supportClasses/data/AreaDataUtil","dojo/i18n!esri/nls/jsapi"],function(l,h,g){g=g.geoenrichment.dijit.ReportPlayer.ReportPlayer;
var e={valueFormatFunction:function(d,b){return b&&b.isMissing?g.missingVariable:void 0===d||"string"===typeof d?d:l.formatNumber(d,{places:b.decimals,preserveTrailingZeroes:!0})},copyValueToCalculatorData:function(d,b){var a=e._findAttrsInCalcData(b,d);a&&(a[b.fieldName]=d[b.fieldName])},copyValueFromCalculatorData:function(d,b){var a=e._findAttrsInCalcData(b,d);a&&(d[b.fieldName]=a[b.fieldName])},_findAttrsInCalcData:function(d,b){d=(d=d.isMultiFeature?h.combineAreaDataObjectCalculators(d.fieldData.areaData,
d.calculatorName):h.getAreaDataObjectCalculator(d.fieldData.areaData[d.currentFeatureIndex],d.calculatorName))&&d.comparisonLevels||[];var a;d.some(function(c){if(c.StdGeographyLevel&&c.StdGeographyLevel===b.StdGeographyLevel&&c.StdGeographyID===b.StdGeographyID)return a=c,!0});return a}};return e})},"esri/dijit/geoenrichment/ReportPlayer/countryConfig":function(){define(["./dataProvider/supportClasses/stdGeographies/StdGeographiesModel"],function(l){function h(){if(!e||!e.hierarchies)return"census";
var a=e.hierarchies[0].ID;if(1==e.hierarchies.length)return a;if(e.defaultDatasetID)for(var b in e.hierarchies){var c=e.hierarchies[b];if(c.datasets&&c.datasets.some(function(a){return a==e.defaultDatasetID})){a=c.ID;break}}return a}var g={},e;g.getCurrentCountry=function(){return e};g.getCountryID=function(){return e&&e.id};g.getCurrencySymbol=function(){return e&&e.currencySymbol||"$"};g.getCurrencyFormat=function(){if(e&&e.currencyFormat)return e.currencyFormat;var a=g.getCurrencySymbol();return a+
"0;-"+a+"0"};g.setCountry=function(a){e=a};var d,b;g.getSingleUnits=function(){return d};g.getPluralUnits=function(){return b};g.setSingleAndPluralUnits=function(a,c){d=a;b=c};var a;g.getHierarchyID=function(){return a};g.setHierarchyID=function(b){a=b||h()};var c;g.getGeographiesModel=function(){return c};g.setGeographiesModel=function(a){c=a};g.reset=function(){c=b=d=a=e=null};g.toJson=function(){return{country:{id:g.getCountryID(),currencySymbol:g.getCurrencySymbol(),currencyFormat:g.getCurrencyFormat()},
hierarchy:a,geographiesModel:c&&c.toJson()}};g.fromJson=function(b){b&&(e=b.country,a=b.hierarchy,c=b.geographiesModel&&new l(b.geographiesModel))};return g})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/layers/thisAreas/ThisAreasHighlightController":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/Deferred","dojo/on","dijit/Destroyable","../../MapEventUtil"],function(l,h,g,e,d){return l(e,{_hasRegisteredLayers:!1,_hasRegisteredTables:!1,constructor:function(b){this._graphicLayerInfos=
{};this._registerTableDfds=[];this._highlightTableForAreaIndexFuncs=[];this._pendingLayerInfos={}},_highlightTableForAreaIndexFuncs:null,_registerTableDfds:null,registerTable:function(b){this._highlightTableForAreaIndexFuncs.push(b.highlightTableForAreaIndex);b=new h;this._registerTableDfds.push(b);this._hasRegisteredLayers&&this._doRegisterTables();this._hasRegisteredTables||(this._hasRegisteredTables=!0,this._doRegisterLayers());return b.promise},_doRegisterTables:function(){this._registerTableDfds.forEach(function(b){b.resolve()});
this._registerTableDfds.length=0},_graphicLayerInfos:null,_pendingLayerInfos:null,setThisAreaLayer:function(b,a,c,d){this._unSetInfo(b);this._pendingLayerInfos[b]={graphicsLayer:a,areaIndex:d.thisAreaIndex,getGraphicForAreaIndexFunc:d.getGraphicForAreaIndexFunc,setGraphicHighlightedFunc:d.setGraphicHighlightedFunc,layerMouseOverHandle:null,layerMouseOutHandle:null,highlightedGraphic:null,map:c};this._hasRegisteredTables&&this._doRegisterLayers();this._hasRegisteredLayers||(this._hasRegisteredLayers=
!0,this._doRegisterTables())},_doRegisterLayers:function(){for(var b in this._pendingLayerInfos){var a=this._pendingLayerInfos[b];this._graphicLayerInfos[b]=a;this._addLayerListeners(a)}this._pendingLayerInfos={}},_addLayerListeners:function(b){var a=this,c=b.graphicsLayer,k;b.layerMouseOverHandle=d.onLayerMouseOver(c,b.map,function(f){f.graphic&&f.graphic._graphicsLayer===c&&k!==f.graphic&&(b.layerMouseOutHandle&&b.layerMouseOutHandle.remove(),b.layerMouseOutHandle=null,k&&b.setGraphicHighlightedFunc(k,
!1),k=f.graphic,a._highlightTableForAreaIndexFuncs.forEach(function(a){a(b.areaIndex)}),b.setGraphicHighlightedFunc(k,!0),b.layerMouseOutHandle=g.once(c,"mouse-out",function(c){a._highlightTableForAreaIndexFuncs.forEach(function(a){a(null)});k&&b.setGraphicHighlightedFunc(k,!1);k=null}))})},highlightGraphicForAreaIndex:function(b){for(var a in this._graphicLayerInfos){var c=this._graphicLayerInfos[a];c.highlightedGraphic&&(c.setGraphicHighlightedFunc(c.highlightedGraphic,!1),c.highlightedGraphic=
null);var d=c.getGraphicForAreaIndexFunc(b);d&&(c.setGraphicHighlightedFunc(d,!0),c.highlightedGraphic=d)}},_unSetInfo:function(b){var a=this._graphicLayerInfos[b];delete this._graphicLayerInfos[b];a&&(a.layerMouseOverHandle&&a.layerMouseOverHandle.remove(),a.layerMouseOutHandle&&a.layerMouseOutHandle.remove())},_unSetLayers:function(){Object.keys(this._graphicLayerInfos).forEach(this._unSetInfo.bind(this));this._graphicLayerInfos={}},destroy:function(){this._unSetLayers()}})})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/EditorUnits":function(){define(["esri/dijit/geoenrichment/utils/ObjectUtil",
"dojo/i18n!esri/nls/jsapi"],function(l,h){h=h.geoenrichment.dijit.ReportPlayer.units;var g={},e=["px","pt","mm","cm","in"],d={px:0,pt:1,mm:1,cm:2,"in":2};g.getSupportedUnits=function(){return e};g.getShortName=function(b){return h.shortNames[b]};g.getLongName=function(b){return h.longNames[b]};g.getLongNameWithUnits=function(b){return h.longNamesWithUnits[b]};g.getPlaces=function(b){return d[b]||0};g.round=function(b,a){return l.roundNumber(b,g.getPlaces(a))};g.provideUnits=function(b,a){return b.replace("${units}",
g.getShortName(a))};return g})},"esri/dijit/geoenrichment/ReportPlayer/DataProviderGE":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/when esri/kernel ./dataProvider/_CommandSupport ./dataProvider/_SerializationSupport ./dataProvider/_ServerSerializationSupport ./dataProvider/supportClasses/areas/AnalysisAreaUtil ./dataProvider/supportClasses/areas/AnalysisAreaJsonUtil ./dataProvider/supportClasses/areas/AreasPreprocessor ./dataProvider/supportClasses/CustomReportsManager ./dataProvider/supportClasses/TemplateJsonLoader ./dataProvider/supportClasses/ReportDataProcessor ./dataProvider/supportClasses/GEUtil ./dataProvider/supportClasses/attachments/DefaultAttachmentsStore ./dataProvider/supportClasses/attachments/CustomAttachmentsStore ./dataProvider/supportClasses/PortalManager ./dataProvider/supportClasses/data/VariablesUtil ./dataProvider/commands/mapToImage/MapToURLUtil ./core/themes/ThemeLibrary ./core/themes/ReportThemes esri/dijit/geoenrichment/ReportPlayer/config esri/dijit/geoenrichment/ReportPlayer/countryConfig esri/dijit/geoenrichment/utils/ProjectionUtil esri/dijit/geoenrichment/utils/UrlUtil".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q,t,r,u,y,v,w,D,B,z,C,E,A){return l([b,a,c],{analysisAreasLimit:-1,cacheTemplates:!0,printMapTaskUrl:null,resetReportItemsCache:!0,constructor:function(a){h.mixin(this,a)},_getAttachmentsStore:function(a){return(new r(a)).initialize()},getCustomReports:function(a){return m.getCustomReports(a)},_currentContext:null,getReportData:function(a,b){var c=this,d=b&&b.progressCallback||function(){},l=h.mixin({},a);l.portalUrl=A.getPortalUrl(l.portalUrl);z.isPlayerOnServer||
A.setArcgisUrl(l.portalUrl);k.parseSites(l);C.reset();l.hierarchy||l.analysisAreas.some(function(a){if(a.geographies&&a.geographies[0].hierarchy)return l.hierarchy=a.geographies[0].hierarchy,!0});c.resetReportItemsCache&&m.resetCache();c._currentContext=l;l.analysisAreas=f.areasFromJson(l.analysisAreas);l.combinedAreasInfo=l.combinedAreasInfo&&f.combinedAreasInfoFromJson(l.combinedAreasInfo)||{};k.populateCombinedAreasInfo(l.combinedAreasInfo,l.analysisAreas);l.fieldData={specialTradeAreaCalculatorName:null,
runReportTaskIDs:null,metadata:{},areaData:[],errors:[],reportInfo:null};return g([e(m.tryFindReportIdByAlias(l),function(a){l.reportID=a||l.reportID}),this._discoverPortal(l),function(){return l.variables&&e(v.preprocessVariables(l.variables,l.portalUrl),function(a){l.variables=a})}()]).then(function(){return e(n.preprocessAreas(l,{analysisAreasLimit:c.analysisAreasLimit}),function(){d(.25);setTimeout(function(){c._onCreateReportStarted()});var a=l.attachmentsProvider?u(l.attachmentsProvider):c._getAttachmentsStore(l.analysisAreas),
b={initGE:t.initialize(),countryInfo:t.getCountryInfo(l.countryID),attachmentsStore:a};l.reportID?(b.reportObject=m.getCustomReportByID(l),b.templateJsonInfo=p.getTemplateJsonByID(l,c.cacheTemplates),b.runReportResult=q.runReportAndGetData(l,a)):l.variables&&(b.reportObject=m.getFakeCustomReportByContext(l),b.templateJsonInfo=p.createTemplateJsonFromVariables(l),b.runReportResult=q.runReportFromVariables(l));return g(b).then(function(a){var b=a.reportObject,c=a.attachmentsStore,f=a.templateJsonInfo.templateJson,
k=a.templateJsonInfo.templateVariableProvider,g=a.runReportResult;d(.75);if(!f||!b||!l.fieldData)return null;C.setCountry(a.countryInfo.country);C.setHierarchyID(l.hierarchy);C.setGeographiesModel(a.countryInfo.geographiesModels[C.getHierarchyID()]);f.theme||(f.theme=D.getReportThemeById(b.isGraphicReport?B.GRAPHIC:B.CLASSIC));var n={isMultiFeature:b.isMultiFeature&&1<l.analysisAreas.length,reportTitle:l.reportTitle||b.title,templateJson:f,reportObject:b,fieldData:l.fieldData,analysisAreas:l.analysisAreas,
combinedAreasInfo:l.combinedAreasInfo,reverseAnalysisAreasOnMap:l.reverseAnalysisAreasOnMap,attachmentsStore:c,geClient:t.getClient(),templateVariableProvider:k,customLogo:l.customLogo,config:{portalUrl:l.portalUrl,geoenrichmentUrl:l.geoenrichmentUrl,geometryServiceUrl:l.geometryServiceUrl,printMapTaskUrl:l.printMapTaskUrl,countryID:l.countryID,hierarchy:l.hierarchy,reportID:l.reportID,variables:l.variables}};return e(q.applyRunReportAndGetDataResults(g,n),function(){d(1);return n})})})})},_discoverPortal:function(a){return y.getPortalInfo(a.portalUrl).then(function(b){a.geoenrichmentUrl=
a.geoenrichmentUrl||b.portal.helperServices.geoenrichment.url;var c=d.id.findCredential(a.portalUrl);t.setGeoenrichmentUrl(a.geoenrichmentUrl,c&&c.token);a.geometryServiceUrl=a.geometryServiceUrl||b.portal.helperServices.geometry.url;E.setGeometryServiceUrl(a.geometryServiceUrl);a.printMapTaskUrl=a.printMapTaskUrl||b.portal.helperServices.printTask.url;w.setPrintMapTaskUrl(a.printMapTaskUrl)})},reportDataToSingleAreaReportData:function(a,b){var c=b.currentFeatureIndex||0,f=h.mixin({},a.fieldData);
f.areaData=[f.areaData[c]];var d=[h.mixin({},a.analysisAreas[c])];n.removeGroupInfo(d);var k=a.attachmentsStore;return{isMultiFeature:!1,reportTitle:b.reportTitle,templateJson:b.templateJson,reportObject:a.reportObject,fieldData:f,analysisAreas:d,combinedAreasInfo:null,reverseAnalysisAreasOnMap:!1,attachmentsStore:k&&{getImages:function(){k.supportsMultipleAreas&&k.setCurrentAnalysisAreaIndex(c);return k.getImages()},getAttributes:function(){k.supportsMultipleAreas&&k.setCurrentAnalysisAreaIndex(c);
return k.getAttributes()},getNotes:function(){k.supportsMultipleAreas&&k.setCurrentAnalysisAreaIndex(c);return k.getNotes()}},geClient:a.geClient,templateVariableProvider:a.templateVariableProvider,config:a.config}},_getCurrentContext:function(){return this._currentContext},_onCreateReportStarted:function(){}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/_CommandSupport":function(){define("require dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ../PlayerCommands ./supportClasses/GEUtil esri/dijit/geoenrichment/ReportPlayer/config".split(" "),
function(l,h,g,e,d,b,a,c){var k={};return h(null,{_commands:null,_commandIndex:0,_initCommandsPromise:null,constructor:function(){this._commands={}},_initCommands:function(){var f=this;if(this._initCommandsPromise)return d(this._initCommandsPromise);var g=new e;if(c.modules.exportCommands)l(["./commands/CreateHTMLCommand","./commands/CreatePDFCommand","./commands/CreateImageCommand","./commands/PrintReportCommand","./commands/CreatePlayerCommand"],function(c,f,d,e,n){k[b.HTML]=c;k[b.PDF]=f;k[b.IMAGE]=
d;k[b.PRINT]=e;k[b.DYNAMIC_HTML]=n;a.getInitPromise().then(g.resolve)});else return g.resolve();g.promise.then(function(){f._initCommandsPromise=!0});return this._initCommandsPromise=g.promise},registerCommand:function(a,b,c){function f(c){if(!c.isBrowserSupported||c.isBrowserSupported())d._commands[a]||(d._commands[a]={index:d._commandIndex++,id:a,label:b||c.label,command:c})}var d=this;if(c)f(c);else return this._initCommands().then(function(){var b=k[a];b&&f(new b)})},getCommands:function(){return this._initCommands().then(function(){var c=
[],k=this._commands[b.PDF],e;for(e in this._commands)c.push(this._commands[e]);c.sort(function(a,b){return a.index-b.index});return(e=this._getCurrentContext())&&e.geoenrichmentUrl&&k?d(a.hasCapability("FormatInfographics"),function(a){a||(c=c.filter(function(a){return a!==k}));return c}):d(c)}.bind(this))},getCommandById:function(a){return this._commands[a]&&this._commands[a].command},executeCommand:function(a,b,c,d){return this._initCommands().then(function(){c=g.mixin({printMapTaskUrl:this.printMapTaskUrl},
c);return this._commands[a]&&this._commands[a].command&&this._commands[a].command.execute(b,c||{},d)}.bind(this))},executeCommandOnData:function(a,b,c,d){return this._initCommands().then(function(){c=g.mixin({printMapTaskUrl:this.printMapTaskUrl},c);return this._commands[a]&&this._commands[a].command&&this._commands[a].command.executeOnData(this,b,c||{},d)}.bind(this))}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/_SerializationSupport":function(){define("require dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ./supportClasses/areas/AnalysisAreaJsonUtil ./supportClasses/areas/AnalysisAreaUtil ./supportClasses/PortalManager ../core/infographics/InfographicTypes ../core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil esri/dijit/geoenrichment/ReportPlayer/countryConfig esri/dijit/geoenrichment/utils/UrlUtil esri/dijit/geoenrichment/ReportPlayer/_devConfig".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p){function q(){var a=new e;l("./supportClasses/attachments/AttachmentsStoreSerializer ./supportClasses/GEUtil ../core/supportClasses/templateJsonUtils/TemplateJsonSerializer ../core/supportClasses/templateJsonUtils/TemplateJsonAnalyzer ../core/infographics/utils/InfographicJsonUtil ../core/conversion/portalToEditorUtils/variables/PlayerVariableProvider ../core/infographics/InfographicTypes ./commands/mapToImage/MapToURLUtil esri/dijit/geoenrichment/utils/ProjectionUtil".split(" "),
function(b,c,f,d,e,g,n,h,m){t=b;r=c;u=f;y=g;k=n;v=h;w=m;a.resolve()});return a.promise}var t,r,u,y,v,w;return h(null,{reportDataToJson:function(a,c){var e=this;c=c||{};var h=!1;f.processTemplateFieldInfos(a.templateJson,function(a){a.isInfographic&&a.infographicJson.type===k.ATTACHMENTS&&(h=!0)});return q().then(function(){return d(null,function(){return d(a.attachmentsStore&&t.getAttachmentsStoreJson(a.attachmentsStore,{numAreas:a.analysisAreas.length,saveImages:h}),function(f){var d=g.mixin({},
a.config);!1!==c.forceFixedDataMode&&delete d.geoenrichmentUrl;f={isMultiFeature:a.isMultiFeature,reportTitle:a.reportTitle,templateJson:u.serialize(a.templateJson),reportObject:e._prepareReportObjectJson(a.reportObject),fieldData:a.fieldData,analysisAreas:b.areasToJson(a.analysisAreas),combinedAreasInfo:a.combinedAreasInfo&&b.combinedAreasInfoToJson(a.combinedAreasInfo),reverseAnalysisAreasOnMap:a.reverseAnalysisAreasOnMap,attachmentsStore:f,templateVariableProvider:a.templateVariableProvider&&a.templateVariableProvider.toJson(),
config:d,countryConfig:n.toJson(),mapImageInfos:c.mapImageInfos,loadedMapPortalItems:c.loadedMapPortalItems,customLogo:a.customLogo};p.logData&&(console.log("_SerializationSupport.js \x3d\x3e reportDataJson"),console.log(f));return f})})})},_prepareReportObjectJson:function(a){var b={},c;for(c in a)a[c]&&"object"!==typeof a[c]&&(b[c]=a[c]);return b},reportDataFromJson:function(f){return q().then(function(){var k=f.fieldData;k.featureData&&(k.areaData=k.featureData.map(function(a){return{mainCalculator:{data:a}}}),
delete k.featureData);var e={isMultiFeature:f.isMultiFeature,reportTitle:f.reportTitle,templateJson:u.deserialize(f.templateJson),reportObject:f.reportObject,fieldData:k,analysisAreas:b.areasFromJson(f.analysisAreas),combinedAreasInfo:f.combinedAreasInfo&&b.combinedAreasInfoFromJson(f.combinedAreasInfo)||{},reverseAnalysisAreasOnMap:f.reverseAnalysisAreasOnMap,attachmentsStore:f.attachmentsStore&&t.getAttachmentsStoreFromJson(f.attachmentsStore),templateVariableProvider:f.templateVariableProvider&&
new y(f.templateVariableProvider),config:f.config||{},mapImageInfos:f.mapImageInfos,loadedMapPortalItems:f.loadedMapPortalItems,customLogo:f.customLogo};a.populateCombinedAreasInfo(e.combinedAreasInfo,e.analysisAreas);r.setGeoenrichmentUrl(null);k=!1;e.config.portalUrl&&m.setArcgisUrl(m.getPortalUrl(e.config.portalUrl));e.config.geometryServiceUrl?w.setGeometryServiceUrl(e.config.geometryServiceUrl):k=!0;e.config.printMapTaskUrl?v.setPrintMapTaskUrl(e.config.printMapTaskUrl):k=!0;n.fromJson(f.countryConfig);
return d(k&&c.tryConfigureServicesFromAGOLPublic()).then(function(){return e})})}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/AnalysisAreaJsonUtil":function(){define(["esri/graphic","esri/dijit/PopupTemplate"],function(l,h){function g(b,a){if(!b)return null;b.getLayer()&&(b=new l(b.geometry,b.symbol,b.attributes,b.infoTemplate));b=b.toJson();a&&delete b.infoTemplate;return b}function e(b){if(!b)return null;if(b instanceof l)return b;var a=b.infoTemplate&&new h(b.infoTemplate);
delete b.infoTemplate;b=new l(b);a&&b.setInfoTemplate(a);return b}function d(b){var a={},c;for(c in b){var d=b[c];if("string"===typeof d||"number"===typeof d&&!isNaN(d))a[c]=d}return a}return{areasToJson:function(b,a){var c=a&&a.excludeInfoTemplate;return b.map(function(a){var b=d(a);b.feature=g(a.feature,c);b.location=a.location&&g(a.location,c);b.additionalFeatures=a.additionalFeatures&&a.additionalFeatures.map(function(a){return g(a,c)});b.geographies=a.geographies;b.buffer=a.buffer;b.featureServiceQueryInfos=
a.featureServiceQueryInfos;return b})},combinedAreasInfoToJson:function(b){var a=d(b);a.groups=b.groups&&b.groups.map(function(a){var b=d(a);b.indexes=a.indexes.slice();b.location=a.location&&g(a.location);b.additionalFeatures=a.additionalFeatures&&a.additionalFeatures.map(g);return b});return a},areasFromJson:function(b){return b.map(function(a){var b=d(a);b.feature=e(a.feature);b.location=a.location&&e(a.location);b.additionalFeatures=a.additionalFeatures&&a.additionalFeatures.map(e);b.geographies=
a.geographies;b.buffer=a.buffer;b.featureServiceQueryInfos=a.featureServiceQueryInfos;return b})},combinedAreasInfoFromJson:function(b){var a=d(b);a.groups=b.groups&&b.groups.map(function(a){var b=d(a);b.indexes=a.indexes.slice();b.location=a.location&&e(a.location);b.additionalFeatures=a.additionalFeatures&&a.additionalFeatures.map(e);return b});return a}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/PortalManager":function(){define("dojo/Deferred dojo/on esri/dijit/geoenrichment/when esri/arcgis/Portal ../../../utils/requests/UniversalClient ../commands/mapToImage/MapToURLUtil ../../../utils/CacheUtil ../../../utils/ProjectionUtil".split(" "),
function(l,h,g,e,d,b,a,c){return{getPortalInfo:function(b){var c=a.get("PortalManager");if(!c[b]){var d=new e.Portal(b),k=new l;h(d,"load",function(){if(d.user)return c[b]={user:new e.PortalUser({portal:d,credential:{userId:d.user.username,server:d.url,token:"",expires:9999999999999,creationTime:9999999999999,scope:"portal",resources:[d.portalUrl]}}),portal:d},k.resolve(c[b]);c[b]=g(d.signIn(),function(a){k.resolve({user:a,portal:d});return{user:a,portal:d}})});return k.promise}return c[b]},tryConfigureServicesFromAGOLPublic:function(){return d.requestPublicFirst("https://www.arcgis.com/sharing/rest/portals/self",
{},{retryOnAnyError:!1}).then(function(a){if(a=a&&a.helperServices)a.geometry&&c.setGeometryServiceUrl(a.geometry.url),a.printTask&&b.setPrintMapTaskUrl(a.printTask.url)}).otherwise(function(a){console.log(a)})}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/commands/mapToImage/MapToURLUtil":function(){define("require dojo/_base/declare esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all dojo/dom-style esri/dijit/geoenrichment/utils/DataUtil esri/dijit/geoenrichment/utils/ImageInfoUtil esri/dijit/geoenrichment/utils/RegExpUtil esri/dijit/geoenrichment/utils/UrlUtil".split(" "),
function(l,h,g,e,d,b,a,c,k,f){function n(){var b=new g;l("esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate esri/layers/GraphicsLayer ./DotDensityToImageUtil ./LegendToLayerUtil".split(" "),function(c,f,d,e,n,l){p=f;q=d;t=e;r=n;u=l;m=h(c,{returnJson:!1,mapName:null,_execute:function(){this.returnJson&&(this.printGp.submitJob=this.printGp.execute=function(b,c){b="data:application/json;base64,"+a.base64FromJson(b.Web_Map_as_JSON);c([{value:{url:b}}]);return(new g).resolve()});
return this.inherited(arguments)},_getPrintDefinition:function(a,b){var c=this.inherited(arguments);this.returnJson&&this.mapName&&(c.title=this.mapName);console.log(c);return c},_createOperationalLayers:function(a,b){var c=this.inherited(arguments);if(b.__legendLayerId){var f=c.filter(function(a){return a.id===b.__legendLayerId})[0];c.splice(c.indexOf(f),1);c.push(f)}return c},_createFeatureCollection:function(a,b,c,f){var d=this.inherited(arguments);this.returnJson&&d&&("esri.layers.FeatureLayer"===
a.declaredClass||"esri.layers.StreamLayer"===a.declaredClass||"esri.layers.GraphicsLayer"===a.declaredClass)&&d.featureCollection.layers.forEach(function(b){b.layerDefinition.name=a.arcgisProps&&a.arcgisProps.title||a._titleForLegend||a.name||a.id;b.layerDefinition.name=k.decodeXML(b.layerDefinition.name);b.layerDefinition.objectIdField="OBJECTID";b.layerDefinition.fields=[{name:"OBJECTID",type:"esriFieldTypeOID"}];var c={OBJECTID:1},f=/[^\w]/g,d;b.featureSet.features.forEach(function(a,e){a.attributes=
a.attributes||{};a.attributes.OBJECTID=e+1+"";a.attributes.__nameField||(a.attributes.Name=k.decodeXML(a.attributes.Name||b.layerDefinition.name),d="Name");e=a.attributes.__fieldAliases;for(var g in a.attributes)if(0!==g.indexOf("__")){var n=g,h=a.attributes[g];"string"===typeof h&&(h=k.decodeXML(h));var m=e&&e[g];(m=m&&m.replace(f,"_"))&&void 0===a.attributes[m]&&(a.attributes[m]=h,n=m);a.attributes.__nameField===g&&(d=n);c[g]||(c[g]=1,b.layerDefinition.fields.push({name:n,type:"string"===typeof h?
"esriFieldTypeString":"esriFieldTypeDouble"}))}});b.layerDefinition.displayField=d});return d},_convertSvgSymbol:function(a){return a}});b.resolve()});return b.promise}var m,p,q,t,r,u,y,v={setPrintMapTaskUrl:function(a){y=a;f.registerCORS(a)},mapToURL:function(a,b,c,f){var d=v._getUrlForMap(a);if(d)return d;d=n().then(function(){return v._replaceDotDensityLayersWithPictureMarkers(a).then(function(d){return e(b&&u.legendToGraphicsLayer(b,a,c),function(b){b&&a.addLayer(b);return e(v._runPrintTask(a,
c,b,f),function(c){b&&a.removeLayer(b);v._rollbackReplacing(a,d);var f=new g;setTimeout(function(){f.resolve(c.url)},100);return f.promise})})})});v._putUrlToCache(a,d);return d},_replaceDotDensityLayersWithPictureMarkers:function(a){var b=[];for(i=0;i<a.graphicsLayerIds.length;i++)layer=a.getLayer(a.graphicsLayerIds[i]),layer.loaded&&layer.visible&&r.isDotDensity(layer)&&b.push(v._createGraphicsLayerFromDotDensityLayer(i,layer,a));return d(b)},_createGraphicsLayerFromDotDensityLayer:function(a,b,
c){return r.createPictureMarkersFromDotDensityLayer(b,c.extent,c).then(function(f){if(!f)return null;var d=new t;f.map(function(a){d.add(a)});c.addLayer(d,a);b.visible=!1;return{addedLayer:d,hiddenLayer:b}}).otherwise(function(a){console.log(a);return null})},_runPrintTask:function(a,c,f,d){function k(){var k=new m(y);k.returnJson=d&&d.replaceWithJson;k.mapName=d&&d.mapName;var e=new p;e.map=a;var g=new q;g.exportOptions={width:3.125*b.get(c,"width"),height:3.125*b.get(c,"height"),dpi:300};g.format=
"png32";g.showAttribution=!1;g.forceFeatureAttributes=!0;g.__legendLayerId=f&&f.id;e.template=g;return k.execute(e)}return e(k(),function(a){return a},function(a){console.log(a);return e(k(),function(a){return a},function(a){console.log(a);return k()})})},_rollbackReplacing:function(a,b){b.forEach(function(b){b&&b.addedLayer&&a.removeLayer(b.addedLayer);b&&b.hiddenLayer&&(b.hiddenLayer.visible=!0)})},urlToSrc:function(a,b){return b&&b.saveImagesAsDataUrl?c.getRemoteImageDataUrl(a,{sizeLimit:1500}):
a}},w,D=0;v.enableCaching=function(){w={}};v.clearCaching=function(){w=null};v._putUrlToCache=function(a,b){w&&b&&(a.__mapToImageUtilKey=D++,w[a.__mapToImageUtilKey]=b)};v._getUrlForMap=function(a){return w&&w[a.__mapToImageUtilKey]};return v})},"esri/dijit/geoenrichment/utils/ImageInfoUtil":function(){define(["dojo/_base/lang","esri/dijit/geoenrichment/when","./CacheUtil","./ImageUtil","./UrlUtil"],function(l,h,g,e,d){var b=/^data:/i,a={getImageInfo:function(b,d,f){var c=f&&f.sizeLimit||1E5,k=g.get("ImageInfoUtil"),
p=b+(f&&f.crossOrigin||"");k[p]||(k[p]=e.imageFromUrl(b,f).then(function(a){var b=e.imageToDataURL(a),c={dataUrl:b,contentType:e.getContentType(b),width:a.width,height:a.height};setTimeout(function(){k[p]=c});return c}));return h(k[p],function(b){b=l.mixin({},b);d&&(b.filename=d&&d.replace(/\.\w+$/,".png").toLowerCase());return function(b){return h(a._processDataUrl(b,c),function(a){if(a&&a.dataUrl){var c=l.mixin({},b);c.dataUrl=a.dataUrl;c.width*=a.factor;c.height*=a.factor;return h(c)}return h(b)})}(b)})},
ensureDataUrlForRemoveImage:function(c,d){return!c||b.test(c)?c:a.getRemoteImageDataUrl(c,d)},getRemoteImageDataUrl:function(b,k){function c(c,f){return a.getImageInfo(c?l+"?"+b:b,null,{crossOrigin:f}).then(function(b){return h(a._processDataUrl(b,g),function(a){return a&&a.dataUrl||a})})}function e(){console.log("Failed to get data for URL: "+b);return b}if(!b)return b;var g=k&&k.sizeLimit||1E5,l=d.getProxyUrl();return c(!1,"anonymous").otherwise(function(){return c(!1,null)}).otherwise(function(){return l?
c(!0,"anonymous"):e()}).otherwise(function(){return c(!0,null)}).otherwise(e)},_processDataUrl:function(a,b){var c=Math.max(a.width,a.height);if(c<=b)return a.dataUrl;var d=b/c;return h(e.scaleImage(a.dataUrl,{factor:d}),function(a){return{dataUrl:a,factor:d}})}};return a})},"esri/dijit/geoenrichment/utils/ProjectionUtil":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/SpatialReference esri/geometry/jsonUtils esri/dijit/geoenrichment/utils/CoordinateUtil esri/dijit/geoenrichment/utils/PolygonUtil esri/dijit/geoenrichment/utils/UrlUtil esri/dijit/geoenrichment/utils/requests/UniversalClient esri/dijit/geoenrichment/utils/requests/EveryRequest".split(" "),
function(l,h,g,e,d,b,a,c,k){function f(a){return a&&a.spatialReference||a instanceof g&&a||a&&new g(a)||new g(d.WEB_MERCATOR_WKID)}function n(a,b){var c=[];try{for(var f=0;f<a.length;f++)c.push(d.toSpatialReference(a[f],b))}catch(B){console.log(B)}return(new h).resolve(c)}function m(a,c){function f(a){h.push(function(){return p(n,a,g,c)})}var d=a[0],g=e.getJsonType(d),n={outSR:c.wkid||c.toJson(),inSR:d.spatialReference.wkid||d.spatialReference.toJson()},h=[],m=0,l=[];1==a.length?l.push(d):a.forEach(function(a){var c=
b.getNumberOfPoints(a);m+=c;if(1E4<m){var d=[];l.length?(d.push(a),m=c):(l.push(a),m=0);f(l);l=d}else l.push(a)});l.length&&f(l);return k(h,{stopOnError:!0}).then(function(a){for(var b=a[0],c=1;c<a.length;c++)b=b.concat(a[c]);return b},function(a){console.log(a);return[]})}function p(a,b,f,d){a.geometries=q(b);return c.requestPublicFirst({url:r.getGeometryServiceUrl(),urlSuffix:"project"},{content:a}).then(function(a){return t(a.geometries,f,d)})}function q(a){var b=a.map(function(a){a=a.toJson();
delete a.spatialReference;return a});return{geometryType:e.getJsonType(a[0]),geometries:b}}function t(a,b,c){var f=e.getGeometryType(b),d={spatialReference:c.toJson()};return a.map(function(a){return new f(l.mixin(a,d))})}var r={},u;r.setGeometryServiceUrl=function(b){u=b;a.registerCORS(b)};r.getGeometryServiceUrl=function(a){return u};r.getSpatialReference=f;r.projectGeometries=function(a,b){var c=f(b);b=Array.isArray(a)?a:[a];if(!b.length)return(new h).resolve(a);var k={},e=b.slice(),g=0;b=b.filter(function(a,
b){if(a.spatialReference&&a.spatialReference.wkid!==c.wkid)return k[b]=g++,!0});return b.length?(d.testSpatialReferenceWKID(c)&&d.testSpatialReferenceWKID(b[0].spatialReference)?n(b,c):m(b,c)).then(function(b){e.forEach(function(a,c){void 0!==k[c]&&(e[c]=b[k[c]])});return Array.isArray(a)?e:e[0]}):(new h).resolve(a)};r.unionGeometries=function(a){var b=f(a[0].spatialReference);a={sr:b.wkid||b.toJson(),geometries:q(a)};return c.requestPublicFirst({url:r.getGeometryServiceUrl(),urlSuffix:"union"},{content:a}).then(function(a){return t([a.geometry],
a.geometryType,b)[0]})};return r})},"esri/dijit/geoenrichment/utils/PolygonUtil":function(){define([],function(){var l={getNumberOfPoints:function(h){if(!h)return 0;Array.isArray(h)||(h=[h]);var g=0;h.forEach(function(e){g+=l.getGeometryPointCount(e.geometry||e)});return g},getGeometryPointCount:function(h){if(!h)return 0;var g=0,e=h.rings||h.paths;!e&&h.points&&(e=[h.points]);e?e.forEach(function(d){g+=d&&d.length||0}):g+="x"in h?1:2;return g}};return l})},"esri/dijit/geoenrichment/utils/requests/EveryRequest":function(){define(["dojo/_base/declare",
"esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when"],function(l,h,g){var e=l(null,{requests:null,results:null,requestCount:0,chunkSize:0,stopOnError:!1,onProgress:null,index:0,completeCount:0,executeCount:0,isExecuting:!1,dfd:null,constructor:function(d,b,a,c,k){this.requests=d;this.results=b;this.requestCount=this.requests.length;this.chunkSize=Math.max(a,0);this.stopOnError=c;this.onProgress=k},execute:function(){this.isExecuting=!0;for(this.dfd=new h;this.tryStartNextRequest(););
return this.dfd.promise},tryStartNextRequest:function(){if(!this.isExecuting)return!1;if(this.index==this.requestCount&&!this.executeCount)return this.isExecuting=!1,this.dfd.resolve(this.results),!1;if(this.index==this.requestCount||this.executeCount==this.chunkSize)return!1;var d=this.requests[this.index++];this.executeCount++;var b=d.request;"function"===typeof b&&(b=b());var a=this,c=!0;g(b,function(b){a.processResult(b,d.key,b instanceof Error,c)},function(b){a.processResult(b,d.key,!0,c)});
c=!1;return!0},processResult:function(d,b,a,c){if(this.isExecuting)if(a&&this.stopOnError)this.isExecuting=!1,this.onProgress&&this.onProgress(1),this.dfd.reject(d);else if(this.results[b]=d,this.completeCount++,this.executeCount--,this.onProgress&&this.onProgress(this.completeCount/this.requestCount),!c)for(;this.tryStartNextRequest(););}});return function(d,b){var a=!1,c=10,k=null;"boolean"===typeof b?a=b:b&&("number"===typeof b.chunkSize&&(c=b.chunkSize),"boolean"===typeof b.stopOnError&&(a=b.stopOnError),
"function"===typeof b.onProgress&&(k=b.onProgress));var f,g=[];if(Array.isArray(d))f=[],d.forEach(function(a,b){g.push({key:b,request:a})});else for(var h in d)f={},g.push({key:h,request:d[h]});return(new e(g,f,c,a,k)).execute()}})},"esri/dijit/geoenrichment/ReportPlayer/core/infographics/InfographicTypes":function(){define(["dojo/_base/lang"],function(l){var h={STATIC:"static",ATTACHMENTS:"attachments",AREA_DETAILS:"areaDetails",INTERESTING_FACTS:"interestingFacts",LOCATOR_TABLE:"locatorTable",COMPARISON_TABLE:"comparisonTable"},
g={AGE_PYRAMID:"AgePyramid",ONE_VAR:"OneVar",RELATED_VARS:"RelatedVariables",TAPESTRY:"Tapestry",PRIZM5:"Prizm5"},e={},d;for(d in g)e[g[d]]=!0;l.mixin(h,g);var b={};for(d in h)b[h[d]]=!0;h.isDynamic=function(a){return e[a]};h.isSupported=function(a){return b[a]};h.isTableLike=function(a){return a===h.AREA_DETAILS||a===h.LOCATOR_TABLE||a===h.COMPARISON_TABLE};h.fixTapestryNameToWidget=function(a){return"TapestryNEW"===a?"Tapestry":a};h.fixTapestryNameToData=function(a){return"Tapestry"===a?"TapestryNEW":
a};h.supportsMultiFeature=function(a){return a===h.COMPARISON_TABLE||a===h.LOCATOR_TABLE||a===h.ATTACHMENTS||a===h.AREA_DETAILS};h.supportsComparison=function(a){return a===h.ONE_VAR||a===h.AGE_PYRAMID||a===h.RELATED_VARS||a===h.COMPARISON_TABLE};h.isDynamicWithFiltering=function(a){return a===h.ONE_VAR||a===h.AGE_PYRAMID||a===h.RELATED_VARS};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil":function(){define(["./_SectionJsonCollector",
"../../../infographics/InfographicTypes"],function(l,h){var g={},e={process:function(d,b,a,c,k){var f=c;c=function(a,b,c){a&&f.apply(this,arguments)};k={processLevel:b,objJson:a,processFunc:c,ignoreComparisonCalculators:k&&k.ignoreComparisonCalculators};d!==b||"field"===d&&"field"===b?"document"===d?e._processTemplateJson(a,k):"section"===d?e._processSectionJson(a,k):"table"===d?e._processTableJson(a,k,null):"tableRow"===d?e._processTableDataObj(a,k,null):"field"===d&&e._processFieldInfo(a,k,null):
c(a)},_processTemplateJson:function(d,b){d.sectionsTables?d.sectionsTables.forEach(function(a){e._processTableJson(a,b)}):l.collectSectionJsons(d,{saveParentInfo:!1,processFieldInfoFunc:function(a){"field"===b.processLevel&&b.processFunc(a)}}).forEach(function(a){e._processSectionJson(a,b)})},_processSectionJson:function(d,b){"section"===b.processLevel&&b.processFunc(d);d.stack&&d.stack.forEach(function(a){"sectionElement"===b.processLevel&&b.processFunc(a);"table"===a.id&&e._processTableJson(a,b)})},
_processTableJson:function(d,b,a){"table"===b.processLevel&&b.processFunc(d);d.data.data.forEach(function(c){"tableRow"===b.processLevel&&b.processFunc(c,a);e._processTableDataObj(c,b,a)});d.backgroundSectionJson&&e._processSectionJson(d.backgroundSectionJson,b);d.foregroundSectionJson&&e._processSectionJson(d.foregroundSectionJson,b);d.backgroundFloatingTablesSectionJson&&e._processSectionJson(d.backgroundFloatingTablesSectionJson,b);d.foregroundFloatingTablesSectionJson&&e._processSectionJson(d.foregroundFloatingTablesSectionJson,
b)},_processTableDataObj:function(d,b,a){if(d.fieldInfos)for(var c in d.fieldInfos)e._processFieldInfo(d.fieldInfos[c],b,a,"tableCell")},_processFieldInfo:function(d,b,a,c){if(d){"field"!==b.processLevel||b.skipVariables&&(d.hasVariable||d.script)||b.processFunc(d,a,c);d.triggerJson&&d.triggerJson.fieldInfo&&d.templateName!==d.triggerJson.fieldInfo.templateName&&e._processFieldInfo(d.triggerJson.fieldInfo,b,d,"trigger");d.dataDrillingPanelInfo&&e._processSectionJson(d.dataDrillingPanelInfo.sectionJson,
b);d.tooltipInfo&&d.tooltipInfo.fieldInfo&&e._processFieldInfo(d.tooltipInfo.fieldInfo,b,d,"fieldTooltip");d.linkFieldInfo&&e._processFieldInfo(d.linkFieldInfo,b,d,"linkFieldInfo");if(d.isRichText)for(var k in d.richTextJson.fieldInfos)e._processFieldInfo(d.richTextJson.fieldInfos[k],b,d,"richTextPart");d.isInfographic&&e._processInfographicFieldInfo(d,b);d.isChart&&e._processChartFieldInfo(d,b);d.isReportSection&&d.sectionJson&&e._processSectionJson(d.sectionJson,b)}},_processInfographicFieldInfo:function(d,
b){var a=d.infographicJson;switch(a.type){case h.STATIC:a.header&&e._processTableJson(a.header,b,d);a.variableTables&&a.variableTables.forEach(function(a){a.variable&&e._processFieldInfo(a.variable.fieldInfo,b,d,"staticInfographicVariable");a.description&&a.description.fieldInfo&&e._processFieldInfo(a.description.fieldInfo,b,d,"staticInfographicDescription")});if(a.dataDrilling)for(var c in a.dataDrilling){var k=a.dataDrilling[c];k&&k.sectionJson&&e._processSectionJson(k.sectionJson,b)}break;case h.AGE_PYRAMID:case h.TAPESTRY:case h.PRIZM5:case h.RELATED_VARS:case h.ONE_VAR:!b.ignoreComparisonCalculators&&
a.fieldInfos&&a.fieldInfos.forEach(function(a){e._processFieldInfo(a,b,d,"dynamicInfographicVariable")});break;case h.AREA_DETAILS:a.titleSectionJson&&e._processSectionJson(a.titleSectionJson,b,d);a.attributesSectionJson&&e._processSectionJson(a.attributesSectionJson,b,d);a.notesSectionJson&&e._processSectionJson(a.notesSectionJson,b,d);break;case h.LOCATOR_TABLE:a.titleSectionJson&&e._processSectionJson(a.titleSectionJson,b);e._processSectionJson(a.headerSectionJson,b);e._processSectionJson(a.dataSectionJson,
b);a.summarySectionJson&&e._processSectionJson(a.summarySectionJson,b);a.summaryFooterSectionJson&&e._processSectionJson(a.summaryFooterSectionJson,b);break;case h.COMPARISON_TABLE:a.titleSectionJson&&e._processSectionJson(a.titleSectionJson,b),b.ignoreComparisonCalculators||e._processSectionJson(a.dataSectionJson,b)}},_processChartFieldInfo:function(d,b){var a=d.chartJson.visualProperties;a.chartIcons&&a.chartIcons.forEach(function(a){e._processFieldInfo(a,b,d,"chartIcon")});a.floatingIcons&&a.floatingIcons.forEach(function(a){e._processTableJson(a,
b,d,"floatingIcon")});a.floatingTexts&&a.floatingTexts.forEach(function(a){e._processTableJson(a,b,d,"floatingText")});b.ignoreComparisonCalculators&&d.chartJson.comparisonInfo&&(b=Object.assign({},b),b.skipVariables=!0);a.tooltip&&a.tooltip.fieldInfo&&e._processFieldInfo(a.tooltip.fieldInfo,b,d,"chartTooltip");d.chartJson.dataDrillingPanelInfo&&e._processSectionJson(d.chartJson.dataDrillingPanelInfo.sectionJson,b);d.chartJson.seriesItems.forEach(function(a){a.points.forEach(function(a){e._processFieldInfo(a.fieldInfo,
b,d,"chartPointField");a.iconFieldInfo&&e._processFieldInfo(a.iconFieldInfo,b,d,"chartPointIcon");a.captionFieldInfo&&e._processFieldInfo(a.captionFieldInfo,b,d,"chartPointCaption")})})}};g.DOCUMENT="document";g.SECTION="section";g.TABLE="table";g.SECTION_ELEMENT="sectionElement";g.TABLE_ROW="tableRow";g.FIELD="field";g.process=e.process;g.processTemplateFieldInfos=function(d,b,a){e.process("document","field",d,b,a)};g.processSectionFieldInfos=function(d,b,a){e.process("section","field",d,b,a)};g.processSectionElements=
function(d,b){e.process("document","sectionElement",d,b)};g.processTableFieldInfos=function(d,b,a){e.process("table","field",d,b,a)};g.processChartFieldInfos=function(d,b){d.seriesItems.forEach(function(a){a.points.forEach(function(a){a.fieldInfo&&b(a.fieldInfo,"series")})});var a=d.visualProperties.tooltip;if(a&&a.fieldInfo&&a.fieldInfo.isRichText)for(var c in a.fieldInfo.richTextJson.fieldInfos)b(a.fieldInfo.richTextJson.fieldInfos[c],"tooltip");d.dataDrillingPanelInfo&&g.processSectionFieldInfos(d.dataDrillingPanelInfo.sectionJson,
function(a){b(a,"dataDrilling")})};g.processDataDrillingPanelInfos=function(d,b){g.processTemplateFieldInfos(d,function(a){if(a.isInfographic&&a.infographicJson.dataDrilling)for(var c in a.infographicJson.dataDrilling){var d=a.infographicJson.dataDrilling[c];d&&b(d)}else a.isChart&&a.chartJson.dataDrillingPanelInfo?b(a.chartJson.dataDrillingPanelInfo):a.dataDrillingPanelInfo&&b(a.dataDrillingPanelInfo)})};g.hasMultiFeatureChart=function(d){var b=!1;g.processTemplateFieldInfos(d,function(a){a.isChart&&
(b=b||a.chartJson&&!!a.chartJson.isMultiFeatureChart)});return b};g.hasComparisonInfographicTable=function(d){var b=!1;g.processTemplateFieldInfos(d,function(a){a.isInfographic&&(b=b||a.infographicJson&&a.infographicJson.type===h.COMPARISON_TABLE)});return b};g.isGraphicReport=function(d){return!!d.sectionsTables};g.hasDynamicColumns=function(d){return g._checkTableAttributes(d,function(b){return 0<b.dynamicColumns})};g.hasDynamicRows=function(d){return g._checkTableAttributes(d,function(b){return 0<
b.dynamicRows})};g._checkTableAttributes=function(d,b){var a;g.isGraphicReport(d)?g.processTemplateFieldInfos(d,function(c){c.isReportSection&&c.sectionJson&&c.sectionJson.stack&&c.sectionJson.stack.some(function(c){if("table"===c.id&&c.attributes&&b(c.attributes))return a=!0})}):a=g.collectSectionJsons(d).some(function(a){return a.stack&&a.stack.some(function(a){return"table"===a.id&&a.attributes&&b(a.attributes)})});return a};g.hasMultiFeatureSections=function(d){return g.isGraphicReport(d)?g.hasMultiFeatureChart(d)||
g.hasDynamicColumns(d)||g.hasComparisonInfographicTable(d):!1};g.calcNumberOfMaps=function(d,b){var a=0;g.collectSectionJsons(d).forEach(function(c){a+=g.calcNumberOfMapsInSectionJson(c,b)});return a};g.calcNumberOfMapsInSectionJson=function(d,b){var a=0;d.stack&&d.stack.forEach(function(c){c.isMap&&(b&&b(c),a++)});g.processSectionFieldInfos(d,function(c){c.isMap&&(b&&b(c.mapJson),a++)});return a};g.calcNumberOfMapsInTableJson=function(d,b){var a=0;g.processTableFieldInfos(d,function(c){c.isReportSection&&
(a+=g.calcNumberOfMapsInSectionJson(c.sectionJson,b))});return a};g.collectSectionJsons=l.collectSectionJsons;g.getParentBox=l.getParentBox;g.setParentBox=l.setParentBox;g.getParentStyle=l.getParentStyle;return g})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/query/_SectionJsonCollector":function(){define(["dojo/_base/lang","esri/dijit/geoenrichment/utils/MathUtil","esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridDataUtil","../../tableJson/TableJsonUtil"],
function(l,h,g,e){var d={},b={provideParentInfo:function(b,c,d,e,g,h){a.collectStatistics(c);var f;a:{switch(g){case "floating":f=c.style.left+h.left;break a;case "page":f=a.calcX(c,d,e)+h.left;break a}f=void 0}a:{switch(g){case "floating":g=c.style.top+h.top;break a;case "page":g=a.calcY(c,d,e)+h.top;break a}g=void 0}b._parentBox={x:f,y:g,w:a.calcFullWidth(c,d,e),h:a.calcFullHeight(c,d,e)};c=e.field;d.style.fields=d.style.fields||{};d=(d.style.fields[c]=d.style.fields[c]||{}).backgroundColor;b._parentStyle=
{backgroundColor:d}},sanitize:function(b){a.sanitize(b)}},a={collectStatistics:function(b){if(!b._measureInfo){var c={},d={},k;b.data.columns.forEach(function(a){k&&(d[k.field]=a);k=a;c[a.field]=a});var e={},g={},h={},l={},u={},y={};b.data.data.forEach(function(c,f){b.data.columns.forEach(function(b,d){var k=u[d]||0,n=y[f]||0,m=a._getDataHeight(c,b.field);b=a._getFieldWidth(c,b);k+=m;n+=b;u[d]=k;y[f]=n;m=d+"_"+f;g[m]=k;e[m]=n;h[m]=e[d-1+"_"+f]||0;l[m]=g[d+"_"+(f-1)]||0})});b._measureInfo={xPositions:h,
yPositions:l,columnsHash:c,nextColumnHash:d}}},calcX:function(a,b,c){c=a.data.columns.indexOf(c);b=a.data.data.indexOf(b);return a._measureInfo.xPositions[c+"_"+b]||0},calcY:function(a,b,c){c=a.data.columns.indexOf(c);b=a.data.data.indexOf(b);return a._measureInfo.yPositions[c+"_"+b]||0},calcFullWidth:function(b,c,d){d=d.field;var f=a._getFieldWidth(c,b._measureInfo.columnsHash[d]),k=c.columnSpans&&c.columnSpans[d]||1;if(1<k)for(var e,g=0;g<k-1;g++)e=b._measureInfo.nextColumnHash[e?e.field:d],f+=
a._getFieldWidth(c,e);return f},_getFieldWidth:function(a,b){a.style.fields=a.style.fields||{};return(a.style.fields[b.field]=a.style.fields[b.field]||{}).width||b.style.width},calcFullHeight:function(b,c,d){d=d.field;var f=b.data.data.indexOf(c),k=a._getDataHeight(c,d);c=c.rowSpans&&c.rowSpans[d]||1;if(1<c)for(var e=f+1,g=0;g<c-1;g++)f=b.data.data[e++],k+=a._getDataHeight(f,d);return k},_getDataHeight:function(a,b){a.style.fields=a.style.fields||{};return(a.style.fields[b]=a.style.fields[b]||{}).height||
a.style.height},sanitize:function(a){delete a._measureInfo}},c={getIntersectingTableJsonsBehind:function(a,b,c,d,l){function f(a){var d=a.data.data[0].fieldInfos[a.data.columns[0].field];return g.isTextLikeCell(d)||g.isShapeCell(d)||g.isImageCell(d)?h.checkRectsIntersect([c,{x:a.style.left+b.left,y:a.style.top+b.top,w:e.getTableWidth(a),h:e.getTableHeight(a)}]):!1}function k(a){return h.checkRectsIntersect([c,{x:a.style.left+b.left,y:a.style.top+b.top,w:a.style.width,h:a.style.height}])}var n=[],
m=[];a.backgroundFloatingTablesSectionJson&&a.backgroundFloatingTablesSectionJson.stack.forEach(function(a,b){if(-1===d||l||d!==b)if("table"===a.id&&f(a)||"img"===a.id&&k(a))-1===d||l||d>b?n.push(a):m.push(a)});a.foregroundFloatingTablesSectionJson&&a.foregroundFloatingTablesSectionJson.stack.forEach(function(a,b){if(l&&d===b)return!0;if("table"===a.id&&f(a)||"img"===a.id&&k(a))l&&d>b?n.push(a):m.push(a)});return{elementJsonsBehind:n,elementJsonsAbove:m}}};d.collectSectionJsons=function(a,b){b=b||
{};var c=[];if(!a)return[];if(a.sections)return a.sections;if(!a.sectionsTables)return[];b.processSectionJson=b.processSectionJson||function(){};a.sectionsTables.forEach(function(f,k){var e={addBackground:function(){!1!==b.backgroundForeground&&f.backgroundSectionJson&&f.backgroundSectionJson.stack&&c.push(f.backgroundSectionJson)},addBackgroundTables:function(e){var g=[];!1!==b.floatingTables&&f.backgroundFloatingTablesSectionJson&&f.backgroundFloatingTablesSectionJson.stack.forEach(function(c,k){"table"===
c.id&&d._processTableJson(c,g,"floating",a.documentOptions,b,f,k,!1)});e&&g.reverse();g.forEach(function(a){b.processSectionJson(a,{pageIndex:k,source:"foreground",floatingIndex:a.__floatingIndex});delete a.__floatingIndex});c=c.concat(g)},addInGridSections:function(){var e=[];d._processTableJson(f,e,"page",a.documentOptions,b,f);e.forEach(function(a){b.processSectionJson(a,{pageIndex:k,source:"grid",index:a.__inGridIndex});delete a.__inGridIndex});c=c.concat(e)},addForegroundTables:function(e){var g=
[];!1!==b.floatingTables&&f.foregroundFloatingTablesSectionJson&&f.foregroundFloatingTablesSectionJson.stack.forEach(function(c,k){"table"===c.id&&d._processTableJson(c,g,"floating",a.documentOptions,b,f,k,!0)});e&&g.reverse();g.forEach(function(a){b.processSectionJson(a,{pageIndex:k,source:"foreground",floatingIndex:a.__floatingIndex});delete a.__floatingIndex});c=c.concat(g)},addForeground:function(){!1!==b.backgroundForeground&&f.foregroundSectionJson&&f.foregroundSectionJson.stack&&c.push(f.foregroundSectionJson)}};
b.topFirst?(e.addForeground(),e.addForegroundTables(!0),e.addInGridSections(),e.addBackgroundTables(!0),e.addBackground()):(e.addBackground(),e.addBackgroundTables(),e.addInGridSections(),e.addForegroundTables(),e.addForeground())});return c};d._processTableJson=function(a,d,e,g,h,q,t,r){a.data.data.forEach(function(f,k){f.fieldInfos&&a.data.columns.forEach(function(n,m){var p=f.fieldInfos[n.field];if(p&&p.sectionJson&&p.sectionJson.stack){h.processFieldInfoFunc&&h.processFieldInfoFunc(p);(!1!==h.saveParentInfo||
h.populateWithFloatingElementsBehind)&&b.provideParentInfo(p.sectionJson,a,f,n,e,g);if(h.populateWithFloatingElementsBehind){n=function(a){a=l.clone(a);a.isContextFloatingElement=!0;a.style.left=a.style.left+g.left-u._parentBox.x;if("table"===a.id)a.style.top=a.style.top+g.top-u._parentBox.y;else if("img"===a.id||"map"===a.id)a.style.top=a.style.top+g.top-u._parentBox.y;return a};var u=l.clone(p.sectionJson),v;"page"===e?v=c.getIntersectingTableJsonsBehind(q,g,u._parentBox,-1,void 0):"floating"===
e&&(v=c.getIntersectingTableJsonsBehind(q,g,u._parentBox,t,r));p=v.elementJsonsBehind.map(n);v=v.elementJsonsAbove.map(n);u.stack=p.concat(u.stack);u.stack=u.stack.concat(v);d.push(u)}else d.push(p.sectionJson);v=d[d.length-1];"page"===e?v.__inGridIndex=k*a.data.columns.length+m:v.__floatingIndex=t}})});b.sanitize(a)};d.getParentBox=function(a){return a&&a._parentBox};d.setParentBox=function(a,b){a._parentBox=b};d.getParentStyle=function(a){return a&&a._parentStyle};return d})},"esri/dijit/geoenrichment/utils/MathUtil":function(){define([],
function(){function l(b){return Array.isArray(b)?b:[b.x,b.y]}function h(b){return Array.isArray(b)?b:[b.x,b.y,b.x+b.w,b.y+b.h]}function g(b){return Array.isArray(b)?{x:b[0],y:b[1],w:b[2]-b[0],h:b[3]-b[1]}:b}function e(b){return[[b[0],b[1]],[b[2],b[1]],[b[2],b[3]],[b[0],b[3]],[b[0]+(b[2]-b[0])/2,b[1]+(b[3]-b[1])/2]]}var d={rotatePointAroundPoint:function(b,a,c){c=d.degToRad(c);var k=l(b),f=l(a);a=Math.cos(c)*(f[0]-k[0])-Math.sin(c)*(f[1]-k[1])+k[0];c=Math.sin(c)*(f[0]-k[0])+Math.cos(c)*(f[1]-k[1])+
k[1];return Array.isArray(b)?[a,c]:{x:a,y:c}},degToRad:function(b){return b*Math.PI/180},radToDeg:function(b){return 180*b/Math.PI},cosDeg:function(b){return Math.cos(d.degToRad(b))},sinDeg:function(b){return Math.sin(d.degToRad(b))},angleTo180_180Range:function(b){b=(b+180)%360;0>b&&(b=360+b);return b-180},angleTo0_360Range:function(b){b%=360;0>b&&(b=360+b);return b},calcVectorLength:function(b){var a=b[0]-b[2];b=b[1]-b[3];return Math.sqrt(a*a+b*b)},addPointToVector:function(b,a){a=l(a);b=b.slice();
b[0]+=a[0];b[1]+=a[1];b[2]+=a[0];b[3]+=a[1];return b},subtractPointFromVector:function(b,a){a=l(a);b=b.slice();b[0]-=a[0];b[1]-=a[1];b[2]-=a[0];b[3]-=a[1];return b},putVectorToOrigin:function(b){return d.subtractPointFromVector(b,[b[0],b[1]])},normalizeVector:function(b){b=d.putVectorToOrigin(b);var a=d.calcVectorLength(b);b[2]/=a;b[3]/=a;return b},calcDotProduct:function(b,a){b=d.putVectorToOrigin(b);a=d.putVectorToOrigin(a);return b[2]*a[2]+b[3]*a[3]},calcAngleBetweenVectors:function(b,a){b=d.normalizeVector(b);
a=d.normalizeVector(a);return Math.acos(d.calcDotProduct(b,a))},addLengthToVector:function(b,a){var c=d.calcVectorLength(b),k=[b[0],b[1]];b=d.normalizeVector(b);b[2]*=c+a;b[3]*=c+a;return d.addPointToVector(b,k)},rotateVectorAroundPoint:function(b,a,c){a=l(a);var k=d.rotatePointAroundPoint(a,[b[0],b[1]],c);b=d.rotatePointAroundPoint(a,[b[2],b[3]],c);return[k[0],k[1],b[0],b[1]]},toLineABC:function(b){var a=b[3]-b[1],c=b[0]-b[2];return[a,c,-a*b[0]-c*b[1]]},intersect2Lines:function(b,a){var c=d.toLineABC(b),
k=d.toLineABC(a);a=c[0];b=c[1];var c=c[2],f=k[0],e=k[1],k=k[2],g=a*e-f*b;return 0===g?null:[(k*b-c*e)/g,(f*c-a*k)/g]},intersectLineWithRect:function(b,a){function c(c,f){(c=d.intersect2Lines(b,[c[0],c[1],f[0],f[1]]))&&d.isPointInRect(a,c)&&l.push(c)}var k=e(a),f=k[0],g=k[1],h=k[2],k=k[3],l=[];c(f,g);c(g,h);c(h,k);c(k,f);if(2!==l.length)return null;f=[l[0][0],l[0][1],l[1][0],l[1][1]];return d.calcVectorLength(f)?f:null},isPointInRect:function(b,a){b=h(b);a=l(a);var c=b[2]-b[0],d=b[3]-b[1];return!(a[0]<
b[0]||a[0]>b[0]+c||a[1]<b[1]||a[1]>b[1]+d)},isRectInRect:function(b,a){return d.checkRectsIntersect([b,a])&&e(h(b)).every(function(b){return d.isPointInRect(a,b)})},checkRectsIntersect:function(b){b=b.map(h);return b.every(function(a){var c=e(a);return b.every(function(b){return a===b?!0:c.some(function(a){return d.isPointInRect(b,a)})||e(b).some(function(b){return d.isPointInRect(a,b)})})})},getRotatedRectBox:function(b,a){var c=!Array.isArray(b);b=h(b);var k=e(b);b=k[0];var f=k[1],n=k[2],m=k[3],
k=k[4];b=d.rotatePointAroundPoint(k,b,a);f=d.rotatePointAroundPoint(k,f,a);n=d.rotatePointAroundPoint(k,n,a);m=d.rotatePointAroundPoint(k,m,a);b=d.getPointsExtent([b,f,n,m]);return c?g(b):b},uniteRects:function(b){var a=!Array.isArray(b[0]);b=b.map(h);var c=[];b.forEach(function(a){c=c.concat(e(a))});b=d.getPointsExtent(c);return a?g(b):b},getPointsExtent:function(b){var a=!Array.isArray(b[0]),c=Infinity,d=-Infinity,f=Infinity,e=-Infinity;b.forEach(function(a){a=l(a);c=Math.min(c,a[0]);d=Math.max(d,
a[0]);f=Math.min(f,a[1]);e=Math.max(e,a[1])});b=[c,f,d,e];return a?g(b):b}};return d})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridDataUtil":function(){define(["dojo/_base/lang","../../supportClasses/templateJsonUtils/fieldInfo/FieldLibrary","esri/dijit/geoenrichment/utils/FieldUtil","esri/dijit/geoenrichment/utils/ObjectUtil","esri/dijit/geoenrichment/ReportPlayer/countryConfig"],function(l,h,g,e,d){var b={getFieldCellValue:function(a){return a.gridData&&a.gridData[a.column.field]},
setFieldCellContent:function(a,b){a.set("value",b);a.gridData[a.column.field]=b},clearFieldInfo:function(a,c){a.fieldInfos&&delete a.fieldInfos[c];a[c]="";b.setNumericDataValue(void 0,a,c)},getNumericCellValue:function(a){return b.getNumericDataValue(a.gridData,a.column.field)},setNumericCellValue:function(a,c){return b.setNumericDataValue(c,a.gridData,a.column.field)},getNumericDataValue:function(a,b){return a&&b&&a[b+"_numeric"]},setNumericDataValue:function(a,b,d){b[d+"_numeric"]=a},getRenderedValue:function(a,
c,k){var f={parentGrid:a,gridData:c,column:k};a=a._getCellRenderer().getRenderedContent(f);if(a.isUnavailableData)return{};var g;"number"!==typeof a.value||isNaN(a.value)?"string"===typeof a.formattedValue&&(f=e.parsePercentOrCurrency(a.formattedValue,d.getCurrencyFormat()),isNaN(f)||(g=f)):g=a.value;"number"!==typeof g&&(g=b.getNumericDataValue(c,k.field));return{numericValue:g,formattedValue:a.formattedValue}},isEmptyCell:function(a){return!a.get("value")&&!a.gridData[a.column.field]&&!b.getFieldInfo(a)},
hasSpans:function(a){return b.getColumnSpan(a)||b.getRowSpan(a)},getColumnSpan:function(a){return a&&a.gridData&&a.gridData.columnSpans&&a.gridData.columnSpans[a.column.field]},getRowSpan:function(a){return a&&a.gridData&&a.gridData.rowSpans&&a.gridData.rowSpans[a.column.field]},getDataColumnSpan:function(a,b){return a&&a.columnSpans&&a.columnSpans[b]},getDataRowSpan:function(a,b){return a&&a.rowSpans&&a.rowSpans[b]},getFieldInfo:function(a){return a&&a.gridData&&a.column&&a.gridData.fieldInfos&&
a.gridData.fieldInfos[a.column.field]},getGridFirstFieldInfo:function(a){return b.getFieldInfo(a.getFirstCell())},setFieldInfo:function(a,b){a.gridData&&(a.gridData.fieldInfos[a.column.field]=b)},provideFieldInfo:function(a){b.setFieldInfo(a,b.getFieldInfo(a)||{});return b.getFieldInfo(a)},getPreservableSettings:function(a){return{triggerJson:b.getConditionalFormatting(a),dataDrilling:b.getDataDrilling(a),tooltipInfo:b.getTooltipInfo(a)}},setPreservableSettings:function(a,c){b.setConditionalFormatting(a,
c&&c.triggerJson);b.setDataDrilling(a,c&&c.dataDrilling);b.setTooltipInfo(a,c&&c.tooltipInfo)},getCellStyle:function(a,c){if(!a||!a.gridData||!a.column)return null;var d=a.gridData.style&&a.gridData.style.fields&&a.gridData.style.fields[a.column.field];!d&&c&&(d={},b.setCellStyle(a,d));return d},getCellThemeStyle:function(a){return a&&a.gridData&&a.column?a.gridData.themeStyle&&a.gridData.themeStyle.fields[a.column.field]:null},setCellStyle:function(a,b){var c=a.gridData.style=a.gridData.style||{};
c.fields=c.fields||{};c.fields[a.column.field]=b},updateCellStyle:function(a,c){a=b.getCellStyle(a,!0);l.mixin(a,c)},copyFieldStyle:function(a,c,d){a=b.getCellStyle(a);c=b.getCellStyle(c,!0);for(var f in d)void 0!==a[f]&&(c[f]=a[f])},getFieldCellUrl:function(a){if(a.gridData&&a.gridData.urls&&a.column)return a.gridData.urls[a.column.field]},setFieldCellUrl:function(a,b){a.gridData&&a.column&&(a.gridData.urls=a.gridData.urls||{},void 0===b?delete a.gridData.urls[a.column.field]:a.gridData.urls[a.column.field]=
b)},getConditionalFormatting:function(a){return(a=b._toFieldInfo(a))&&a.triggerJson},setConditionalFormatting:function(a,c){var d=b.getFieldInfo(a);d.triggerJson=null;if(c){if(a=b.isVariableLikeFieldCell(a))c.fieldInfo=d;c.fieldInfo===d&&(c.fieldInfo=l.clone(c.fieldInfo),delete c.fieldInfo.triggerJson,a&&(delete c.fieldInfo.tooltipInfo,delete c.fieldInfo.dataDrillingPanelInfo))}d.triggerJson=c},getDataDrilling:function(a){return(a=b.getSourceFieldInfo(a))&&a.dataDrillingPanelInfo},setDataDrilling:function(a,
c){if(a=b.getSourceFieldInfo(a))a.dataDrillingPanelInfo=c},getTooltipInfo:function(a){return(a=b.getSourceFieldInfo(a))&&a.tooltipInfo},setTooltipInfo:function(a,c){if(a=b.getSourceFieldInfo(a))a.tooltipInfo=c},getSourceFieldInfo:function(a){var c=b._toFieldInfo(a);a=b.getConditionalFormatting(a);return c&&c.isImage?a&&a.fieldInfo:c},_toFieldInfo:function(a){return a?a.gridData?b.getFieldInfo(a):"object"===typeof a&&a:null},isReportSectionCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isReportSection)},
isInfographicCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isInfographic)},isChartCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isChart)},isMapCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isMap)},isImageCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isImage)},isImageTriggerCell:function(a){a=b._toFieldInfo(a);return!!(a&&a.isImage&&a.triggerJson)},getImageTriggerFieldInfo:function(a){return(a=b._toFieldInfo(a))&&a.isImage&&a.triggerJson?a.triggerJson.fieldInfo:null},isShapeCell:function(a){a=
b._toFieldInfo(a);return!(!a||!a.isShape)},isEmptyShapeCell:function(a){a=(a=b._toFieldInfo(a))&&a.shapeJson;return!(!a||a.g&&a.g.length)},isPlaceholderShapeCell:function(a){a=(a=b._toFieldInfo(a))&&a.shapeJson;return!(!a||!a.isPlaceholder)},isTextLikeCell:function(a){return!b._toFieldInfo(a)||b.isRichTextCell(a)||b.isVariableLikeFieldCell(a)||b.isSpecialFieldCell(a)},isRichTextCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.isRichText)},isVariableLikeFieldCell:function(a){a=b._toFieldInfo(a);
return!(!a||!a.hasVariable&&!a.script&&"headers.CHART_POINT_VALUE"!==a.name)},isVariableFieldCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.hasVariable)},isScriptFieldCell:function(a){a=b._toFieldInfo(a);return!(!a||!a.script)},isUneditableScript:function(a){a=b._toFieldInfo(a);return!!(a&&a.script&&a.script.isUneditableScript)},isNumericVariableFieldCell:function(a){return(a=b._toFieldInfo(a))?a.hasVariable&&g.isNumericField(a)||a.script&&!a.script.isUneditableScript&&"String"!==a.script.type||
"headers.CHART_POINT_VALUE"===a.name?!0:!1:!1},isCalculatableNumericVariableFieldCell:function(a){return b.isNumericVariableFieldCell(a)},isStringVariableFieldCell:function(a){a=b._toFieldInfo(a);return!(!a||!(a.hasVariable&&"esriFieldTypeString"===a.type||a.script&&"String"===a.script.type))},isSpecialFieldCell:function(a){var c=b._toFieldInfo(a);return c&&("headers.CHART_POINT_VALUE"===c.name||!b.isVariableLikeFieldCell(a)&&h.hasField(c.name))}};return b})},"esri/dijit/geoenrichment/utils/FieldUtil":function(){define([],
function(){function l(d){return("string"===typeof d?d:d&&d.type)||""}var h={isNumericField:function(d){switch(l(d)){case "esriFieldTypeSmallInteger":case "esriFieldTypeInteger":return"i";case "esriFieldTypeSingle":case "esriFieldTypeDouble":return"f"}return!1},isStringField:function(d){return"esriFieldTypeString"==l(d)||!1},isDateField:function(d){return"esriFieldTypeDate"==l(d)||!1}},g=/DISTANCE$/;h.isDistanceField=function(d){return g.test(l(d))};var e=/^(SHAPE__Area|SHAPE__Length)$/i;h.canShowField=
function(d,b){if(!d||!d.name||"esriFieldTypeOID"===d.type)return!1;if("esriFieldTypeDate"===d.type)return"d";var a=h.isNumericField(d)||h.isStringField(d);if("f"===a&&!1===d.editable&&e.test(d.name))return null;void 0===b&&(b=/^(OBJECTID|OID|FID)$/i);return b&&b.test(d.name)?!1:!0===a?"s":a};h.createFieldInfo=function(d){var b=h.canShowField(d);d={fieldName:d.name,label:d.alias||d.name,isEditable:!!d.editable,visible:!!b};switch(b){case "i":d.format={places:0,digitSeparator:!0};break;case "f":d.format=
{digitSeparator:!0};break;case "s":d.stringFieldOption="textbox"}return d};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/tableJson/TableJsonUtil":function(){define(["dojo/_base/lang","../templateJsonUtils/fieldInfo/FieldInfoBuilder","../templateJsonUtils/fieldInfo/FieldLibrary","../../grid/coreUtils/GridDataUtil","esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes"],function(l,h,g,e,d){var b={createTable:function(a){var b=a.numColumns,d=a.numRows,f=a.width,e=
a.widths,g=a.style,p=a.attributes&&a.attributes.fixedColumns,q=a.attributes&&a.attributes.dynamicColumns;if(f)if(e)e=e.map(function(a){return f*Number(a.replace("%",""))/100});else for(var t=f/b,e=[],r=0;r<b;r++)e.push(t);if(e)f||isNaN(Number(e[0]))||(f=0,e.forEach(function(a){f+=a}));else for(t=Number(100/b).toFixed(3)+"%",e=[],r=0;r<b;r++)e.push(t);t=[];for(r=0;r<b;r++)t.push({field:"field"+r,style:{width:e[r]}});for(var e=[],u=!0,y=a.height?a.height/d:a.rowHeight||15.07,v=0;v<d;v++){for(var w=
{style:{height:y,fields:{}},fieldInfos:{}},r=0;r<b;r++){var D="field"+r;!1!==a.useDefaultTheme&&(w.style.fields[D]=l.mixin({horizontalAlign:0===r?"left":"right",overrideStyle:0===v?1<d?!1!==a.useDefaultHeaderTheme?"TableHeader":"Default":void 0:u?"AlternatingRow":"Default"},a.cellParams));q&&r>=p&&0===v&&(w.fieldInfos[D]=h.createFieldInfoFromSpecialFieldName("AREA_DESC"));a.processTableCell&&a.processTableCell(w,D,v,r,a)}e.push(w);u=!u}return{id:"table",attributes:l.mixin({},a.attributes),style:l.mixin({width:f||
772.33},g),data:{columns:t,data:e}}},createSingleCellTable:function(a){a=a||{};var c=b.createTable({numColumns:1,numRows:1,attributes:a.attributes,useDefaultTheme:!1});b.modifyTableJson(c,0,0,a);return c},modifyTableJson:function(a,b,d,f){b=a.data.data[b];d=a.data.columns[d];var c=d.field;f.text&&(b[c]=f.text);f.fieldInfo&&(b.fieldInfos[c]=f.fieldInfo);f.cellStyle&&(b.style.fields[c]=f.cellStyle);f.columnSpan&&(b.columnSpans=b.columnSpans||{},b.columnSpans[c]=f.columnSpan);f.rowSpan&&(b.rowSpans=
b.rowSpans||{},b.rowSpans[c]=f.rowSpan);b.themeStyle=f.themeStyle;f.width&&(a.style.width=f.width,d.style.width=f.width);f.height&&(b.style.height=f.height);void 0!==f.left&&(a.style.left=f.left);void 0!==f.top&&(a.style.top=f.top)},getTableWidth:function(a){return a.style.width},getTableHeight:function(a){var b=0;a.data.data.forEach(function(a){b+=a.style?a.style.height:0});return b},calcTableBox:function(a){return{x:a.style.left||0,y:a.style.top||0,w:b.getTableWidth(a),h:b.getTableHeight(a)}},createDetailsSection:function(a){return{type:d.DETAILS,
stack:[b.createTable(a)]}},createDetailsSectionForFieldInfos:function(a,c){return{type:d.DETAILS,stack:[function(){var d=b.createTable(l.mixin({numColumns:2,numRows:a.length+1},c));d.data.data.forEach(function(b,c){0===c?b.field0=a[0].hasVariable?a[0].fieldCategory:"":(c=a[c-1],b.field0=c.script?c.script.alias:c.hasVariable?c.alias:g.getFieldLabel(c.name)||"",b.fieldInfos.field1=c)});b.provideSpaceAfter(d);return d}()]}},createDetailsSectionForFieldInfoGroups:function(a,c){return{type:d.DETAILS,stack:[function(){var d=
b.createTable(l.mixin({numColumns:a.length+1,numRows:a[0].length+1},c));d.data.data.forEach(function(b,c){d.data.columns.forEach(function(d,f){0!==f&&(0===c?b[d.field]=a[f-1][0].fieldCategory||"":(f=a[f-1][c-1],b.field0=b.field0||(f.script?f.script.alias:f.alias),b.fieldInfos[d.field]=f))})});b.provideSpaceAfter(d);return d}()]}},provideSpaceAfter:function(a,b){a.style.spaceAfter=Math.max(b||0,90-15.07*a.data.data.length)},applyDefaultStyling:function(a){var b=!0;a.data.data.forEach(function(c,d){a.data.columns.forEach(function(a){c.style.fields[a.field].overrideStyle=
0===d?"TableHeader":b?"AlternatingRow":void 0});b=!b})},setTableHeaderStyle:function(a){if(a.style)for(var b in a.style.fields)(a.style.fields[b]=a.style.fields[b]||{}).overrideStyle="TableHeader"},DEFAULT_ROW_HEIGHT:15.07,isEmptyTable:function(a){return a.isGrid?!a.columns||!a.columns.length||!a.store||!a.store.data.length:a.data?!a.data.columns||!a.data.columns.length||!a.data.data||!a.data.data.length:!1},isSingleCelledTable:function(a){return a.isGrid?a.store&&1===a.store.data.length&&a.columns&&
1===a.columns.length:a.data?1===a.data.columns.length&&1===a.data.data.length:!1},isMultiDataTable:function(a){return a.isGrid?1<a.columns.length||2<a.store.data.length:a.data?1<a.data.columns.length||2<a.data.data.length:!1},getTableSubtype:function(a){if(!b.isSingleCelledTable(a))return null;a=b.getFirstFieldInfo(a);return e.isTextLikeCell(a)?"isTextLike":a.isImage?a.triggerJson?"isImage.hasConditionalStyling":"isImage":a.isShape?"isShape":null},getFirstFieldInfo:function(a){return a.isGrid?a.store.data[0].fieldInfos&&
a.store.data[0].fieldInfos[a.columns[0].field]:a.data.data[0].fieldInfos&&a.data.data[0].fieldInfos[a.data.columns[0].field]},tableJsonHasInfographic:function(a){return!!b.getTableJsonInfographic(a)},getTableJsonInfographic:function(a){var b;a.data.data.some(function(a){if(a.fieldInfos)for(var c in a.fieldInfos){var d=a.fieldInfos[c];if(d&&d.isInfographic)return b=d.infographicJson,!0}});return b},getTableJsonFirstFieldInfo:function(a){return a.data.data[0].fieldInfos[a.data.columns[0].field]},tableJsonHasChart:function(a){return a.data.data.some(function(a){if(a.fieldInfos)for(var b in a.fieldInfos){var c=
a.fieldInfos[b];if(c&&c.isChart)return!0}})}};return b})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder":function(){define(["./utils","dojo/i18n!esri/nls/jsapi"],function(l,h){function g(a){Object.keys(a).forEach(function(b){var c=a[b];void 0!==c&&null!==c||delete a[b]})}h=h.geoenrichment.dijit.ReportPlayer.ReportPlayer;var e={NUMBER:"n/",createFieldInfoFromCalculator:function(a,b,d){if(!a)return null;a=(b="function"===typeof a.getDescriptionWithType?
a:null)?b.variable:a;var c=d&&d.format,f=d&&d.autoformatCurrency,e=d&&d.additionalText,k=d&&d.calculatorName,h=d&&d.defaultDistanceUnits;d=d&&d.summaryType;var r=b&&b.getToggleGroup&&b.getToggleGroup();d={alias:b?b.getDescriptionWithType()||b.getAliasWithType():a.description||a.alias,hasVariable:!0,variableID:a.id,fullName:a.fullName,fieldCategory:a.fieldCategory,vintage:a.vintage,type:a.type,statefulName:r?r.value:"n/"+a.fullName,summaryType:d};b=b?b.getCalcType().charAt(0):"n";d.name=l.name.createFieldNameFromSource(a,
b);c?l.format.setFieldInfoFormat(d,c):(d.decimals=a.precision,d.showCurrency=!(!f||"n"!==b||!a.units||"CURRENCY"!==a.units.toUpperCase()),d.showPercent=!d.showCurrency&&("p"===b||"n"===b&&a.units&&"PCT"===a.units.toUpperCase()),d.useThousandsSeparator=!0);a.isWebMap&&(d.isWebMap=!0,d.webMapFieldName=a.fieldName,d.webMapField=a.field,d.webMapId=a.webMapId,d.layerUrl=a.layerUrl,!c&&a.fieldInfo&&a.fieldInfo.format&&(d.decimals=a.fieldInfo.format.places,d.useThousandsSeparator=!1!==a.fieldInfo.format.digitSeparator));
a.customDataCollection&&(d.isCustomDataCollection=!0,d.customDataCollectionId=a.customDataCollection.id,d.customDataCollectionUrl=a.customDataCollection.url,d.customDataCollectionPortalUrl=a.customDataCollection.portalUrl);a.isSiteAttribute&&(d.isSiteAttribute=!0,d.attribute=a.attribute,d.type=a.attribute.type,!c&&0<a.attribute.places&&(d.decimals=a.attribute.places));a.isDataLayerAttribute&&(d.isDataLayerAttribute=!0,d.layerID=a.layerID,d.layerUrl=a.layerUrl,d.layerName=a.layerName,d.attribute=a.attribute,
d.type=a.attribute.type,!c&&0<a.attribute.decimals&&(d.decimals=a.attribute.decimals),"DISTANCE"===a.attribute.name&&(d.units=a.attribute.units||h||"esriMiles"));"string"===typeof e&&(d.additionalText=e);d.usedFields=a.usedFields;d.expressionText=a.expressionText;l.name.provideQualifiedFieldInfoTemplateName(d,k);g(d);return d},fieldInfoToVariable:function(a){if(!a.hasVariable)return null;var b={id:a.variableID,fullName:a.fullName,fieldCategory:a.fieldCategory,vintage:a.vintage,type:a.type,precision:a.decimals,
usedFields:a.usedFields,expressionText:a.expressionText};a.isWebMap&&(b.isWebMap=!0,b.fieldName=a.webMapFieldName,b.field=a.webMapField,b.webMapId=a.webMapId,b.layerUrl=a.layerUrl);a.isSiteAttribute&&(b.isSiteAttribute=!0,b.attribute=a.attribute);return b},createFieldInfoFromScript:function(a,b){var c=b&&b.format,d=b&&b.additionalText;b=b&&b.calculatorName;a=a||{};a.name=a.name||l.name.DEFAULT_SCRIPT_NAME;a.alias=a.alias||h.scriptNameDefault;a.decimals=Number(a.decimals)||0;var e={};e.name=l.name.createFieldNameFromScript(a);
l.name.provideQualifiedFieldInfoTemplateName(e,b);e.script=a;c?l.format.setFieldInfoFormat(e,c):(e.decimals=Number(a.decimals),e.showCurrency=!1,e.showPercent=!1,e.useThousandsSeparator=!0);"string"===typeof d&&(e.additionalText=d);g(e);return e},createFieldInfoFromImage:function(a,b){return{isImage:!0,imageJson:a,triggerJson:b}},createFieldInfoFromMap:function(a){return{isMap:!0,mapJson:a}},createFieldInfoFromShape:function(a){return{isShape:!0,shapeJson:a}},createFieldInfoFromChart:function(a){return{isChart:!0,
chartJson:a}},createFieldInfoFromInfographic:function(a){return{isInfographic:!0,infographicJson:a}},createFieldInfoFromSection:function(a){return{isReportSection:!0,sectionJson:a}},createFieldInfoFromMissingVariable:function(a,b){return{name:a&&a.substr(a.indexOf(".")+1),templateName:a,isMissing:!0,alias:b}},createFieldInfoForUnsupportedContent:function(){return{isUnsupportedContent:!0}}},d=/^\[\w+\]$/,b=/\[\w+\]/;e.createFieldInfoFromLabel=function(a,k){if("string"!==typeof a)return null;a=a.trim();
var c=d.test(a);if(!k||c){if(!c)return null;a=a.replace(/\[|\]/g,"").toUpperCase();return e.createFieldInfoFromSpecialFieldName(l.fields.uiToTemplate(a))}return b.test(a)?l.richText.createFieldInfoFromRenderedXMLString(a):null};e.createFieldInfoFromSpecialFieldName=function(a,b){if("string"!==typeof a)return null;var c;a=l.fields.trimTemplateHeaderName(a);a=a.toUpperCase();"GROUPCOUNT"===a?c={name:l.fields.GROUPCOUNT_FIELD_NAME,alias:l.fields.GROUPCOUNT_FIELD_ALIAS}:"CURRDATE"===a?c={name:l.fields.DATE_FIELD_NAME,
alias:l.fields.DATE_FIELD_ALIAS,format:b||l.fields.DATE_FIELD_DEFAULT_FORMAT}:"SITENOTES"===a?c={name:l.fields.qualifyTemplateHeaderName(l.fields.SITENOTES_FIELD_NAME),alias:l.fields.SITENOTES_FIELD_ALIAS,type:"esriFieldTypeString"}:0===a.indexOf("SITENOTE")&&(c=l.fields.getSiteNoteFieldNameAt(a.replace("SITENOTE","")),c={name:l.fields.qualifyTemplateHeaderName(c),alias:c,type:"esriFieldTypeString"});if(c)return c;var d=l.fields.templateToUIHeader(a);d?(c={name:l.fields.qualifyTemplateHeaderName(a),
alias:d,type:"esriFieldTypeString"},l.fields.isChartAttribute(a)&&(c.isChartAttribute=!0),"CHART_POINT_VALUE"===a&&(c.type="esriFieldTypeDouble",c.decimals=0,c.useThousandsSeparator=!0,b&&l.format.setFieldInfoFormat(c,b))):(b=l.fields.templateToUIReportVar(a))&&(c={name:b,alias:b,type:"esriFieldTypeString"});c&&(c.templateName=c.name);return c};var a=/_P$/i;e.isFieldInfoInPercentState=function(b){return b?b.statefulName&&("p"===b.statefulName.charAt(0)||a.test(b.statefulName))||b.alias&&-1!==b.alias.indexOf("(%)"):
!1};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/utils":function(){define(["esri/dijit/geoenrichment/Deferred","require"],function(l,h){var g={},e;g.init=function(){if(e)return e.promise;e=new l;h("./FieldInfoBuilder ./FieldInfoFormatUtil ./FieldInfoNameUtil ./FieldInfoRenderer ./RichTextJsonUtil ./FieldLibrary".split(" "),function(d,b,a,c,k,f){g.builder=d;g.format=b;g.name=a;g.renderer=c;g.richText=k;g.fields=f;e.resolve()});return e.promise};
g.init();return g})},"esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes":function(){define([],function(){return{PAGE_HEADER:"PageHeader",DETAILS_HEADER:"DetailsHeader",DETAILS:"Details",GROUP:"Group",PAGE_FOOTER:"PageFooter",REPORT_FOOTER:"ReportFooter",DATA_SOURCE:"DataSource",EMPTY:"empty",INFOGRAPHIC_HEADER:"InfographicHeader",INFOGRAPHIC_VARIABLE:"InfographicVariable",INFOGRAPHIC_BACKGROUND:"InfographicBackground",INFOGRAPHIC_FOREGROUND:"InfographicForeground",INFOGRAPHIC_ATTRIBUTES:"InfographicAttributes",
INFOGRAPHIC_NOTES:"InfographicNotes",INFOGRAPHIC_SUMMARY:"InfographicSummary",INFOGRAPHIC_SUMMARY_FOOTER:"InfographicSummaryFooter",TABLE_BACKGROUND:"TableBackground",TABLE_FOREGROUND:"TableForeground",TABLE_BACKGROUND_FLOATING_PANELS:"BackgroundFloatingPanels",TABLE_FOREGROUND_FLOATING_PANELS:"ForegroundFloatingPanels",TABLE_FLOATING_PANELS:"FloatingPanels"}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/_ServerSerializationSupport":function(){define("dojo/_base/declare esri/dijit/geoenrichment/when esri/dijit/geoenrichment/utils/ImageUtil ./supportClasses/ReportDataProcessor ./supportClasses/tasks/parsers/DataXMLParser ./supportClasses/areas/AnalysisAreaUtil ./supportClasses/areas/AnalysisAreaJsonUtil ./supportClasses/areas/AreasPreprocessor ./supportClasses/GEUtil ../core/supportClasses/ReportTemplateTypes ../core/conversion/PortalToEditorConverter ../core/supportClasses/map/WebMapJsonUtil ../core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil ./supportClasses/attachments/AttachmentsStoreSerializer ../core/supportClasses/templateJsonUtils/TemplateJsonSerializer ../core/conversion/portalToEditorUtils/variables/PlayerVariableProvider ../core/conversion/portalToEditorUtils/metadata/MetadataFromDataBuilder ../countryConfig".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q,t,r,u,y){return l(null,{reportDataToServerData:function(a){return null},reportDataFromServerData:function(l,w){function v(a){z.some(function(a){return"metadata.xml"===a.name})||z.push({name:"metadata.xml",data:u.recoverMetadataFromAreaData(H.areaData,a)})}function B(a){l.sites=[];var b={},c=1;H.areaData.forEach(function(a){a=a.headers&&a.headers.data||{};var d=a.SITE_NAME||a.STORE_NAME,f=a.STORE_ID||"unclassified."+c++;"number"!==typeof b[f]&&(b[f]=l.sites.length,
l.sites.push({locationName:d,name:null,shortName:null,description:null,address:a.STORE_ADDR,latitude:a.STORE_LAT,longitude:a.STORE_LONG,areas:[]}));l.sites[b[f]].areas.push({locationName:d,name:a.AREA_DESC?d+" ("+a.AREA_DESC+")":d,shortName:a.AREA_DESC,description:a.AREA_DESC2,address:a.STORE_ADDR,latitude:a.STORE_LAT,longitude:a.STORE_LONG,feature:{attributes:{STORE_ID:a.STORE_ID,AREA_ID:a.AREA_ID}}})});l.sites.forEach(function(a){var b=!1;a.shortName=a.areas.map(function(a){return b=!!a.shortName,
a.shortName}).join(", ");b&&(a.name=a.locationName+" ("+a.shortName+")");var c=a.areas.map(function(a){return a.description});a.description=1<c.length?c[0]===c[1]?c[0]:c.join(", "):c[0]||""});H.reportInfo.sites&&H.reportInfo.sites.forEach(function(b,c){if(c=l.sites[c])c.attributes=b.attributes,c.notes=b.notes,c.images=b.images,c.images&&c.images.forEach(function(b){function c(b){return(b=a[b])&&g.base64DataToDataURL(b,"image/png")}b.url=c(b.url);b.thumbnail=c(b.thumbnail)})})}y.reset();var z=l.reportItem.resources,
C;if(!Array.isArray(z)){var E=z,z=[],A;for(A in E)z.push({name:A,data:E[A]})}z.forEach(function(a){"theme.css"===a.name&&(a.name="theme.css.txt")});var F=z.filter(function(a){return"report.xml"===a.name})[0],G=z.filter(function(a){return"data.xml"===a.name})[0],H;(function(){var a=/.*\.(png|jpg|jpeg)$/i,b=/(.*\.(json)$)|(^maps\/.*\.(png)$)/i,c={},f={};z.forEach(function(d){a.test(d.name)&&(c[d.name]=d.data,"logo.png"===d.name&&(C=g.base64DataToDataURL(d.data,"image/png")));b.test(d.name)&&(-1!==d.data.indexOf("operationalLayers")?
f[d.name]=m.processWebMapJson(d.name,d.data):f[d.name]=d.data)});var e={},k=F.data.match(/<section[^<>]*query=("|').+?("|').*?>/g);k&&k.forEach(function(a){a=a.replace(/.*?query=("|')/,"");a=a.replace(/("|').*/,"");e[a]=1});var h={};H=d.parse(G.data,function(a,b,d){return(a=f[b])?h[d]=a:c[b]||b});v({map:h,locator:e});B(c)})();var J=new r;return h(function(a){var b=F.data.indexOf("\x3csection"),c={isGraphicReport:F.data.indexOf("\x3ctable")<b,isMultiFeature:!1,defaultComparisonZoom:null,type:f.STANDARD,
portalJson:{files:z}};return h(n.provideEditorJson(c,{variableProvider:a}),function(){c.templateJson=t.deserialize(c.templateJson);c.isMultiFeature=p.hasMultiFeatureSections(c.templateJson);delete c.portalJson;return c})}(J),function(d){b.parseSites(l);var f=a.areasFromJson(l.analysisAreas),g=l.combinedAreasInfo&&a.combinedAreasInfoFromJson(l.combinedAreasInfo)||{},n=l.attachmentsProvider&&q.getAttachmentsStoreFromJson(l.attachmentsProvider),m={isMultiFeature:d.isMultiFeature&&1<f.length,reportTitle:null,
templateJson:d.templateJson,reportObject:d,fieldData:{specialTradeAreaCalculatorName:null,runReportTaskIDs:null,metadata:{},areaData:[],errors:[],reportInfo:null},analysisAreas:f,combinedAreasInfo:g,reverseAnalysisAreasOnMap:!0,attachmentsStore:n,templateVariableProvider:J,customLogo:C,config:{}};b.populateCombinedAreasInfo(m.combinedAreasInfo,m.analysisAreas);c.provideAreasIndexes(m);k.setGeoenrichmentUrl(null);w&&w.forEach(function(a){switch(a){case "Maps":k.addCapability("FormatInfographicsMaps");
break;case "ImageUrls":k.addCapability("FormatInfographicsImageUrls")}});return h(e.applyRunReportAndGetDataResults(H,m)).then(function(){return m})})}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ReportDataProcessor":function(){define("esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/Deferred ./tasks/EnrichAreasTask ./tasks/RunReportTask ./data/AreaCalculatorsUtil ./data/VariablesUtil ./CustomReportsManager ./stdGeographies/StdGeographiesModel esri/dijit/geoenrichment/utils/DateUtil ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldLibrary ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil ../../core/supportClasses/templateJsonUtils/query/TemplateJsonQueryUtil ../../core/supportClasses/templateJsonUtils/TemplateJsonAnalyzer ../../core/infographics/utils/InfographicJsonUtil ../../config ../../countryConfig".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q,t,r,u){return{runReportAndGetData:function(a,b){return h([c.getCustomReportByID(a),b]).then(function(b){var c=b[0];b=b[1];return(new d).execute({portalUrl:a.portalUrl,analysisAreas:a.analysisAreas,countryID:a.countryID,hierarchy:a.hierarchy,report:{reportID:c.reportID,portalUrl:c.templateData.getPortalUrl(!0),modified:c.modified,isMultiFeature:c.isMultiFeature},attachmentsStore:b,cacheResult:r.runReportTask.cacheResult}).then(function(a){return{taskIDs:a.taskIDs,
areaData:a.areaData,reportInfo:a.reportInfo}},function(b){a.fieldData.errors.push(b);return(new g).reject(b)})})},runReportFromVariables:function(c){var d={};c.variables.fullNames.forEach(function(a){var b=m.createFieldNameFromSource(a);d[a.substr(a.indexOf(".")+1)]=b});return(new e).enrichAreas({portalUrl:c.portalUrl,analysisAreas:c.analysisAreas,countryID:c.countryID,hierarchy:c.hierarchy,fields:a.convertForEnrich(c.variables),comparisonLevels:c.comparisonLevels||t.getDefaultLevels()}).then(function(a){var f=
c.analysisAreas.map(function(){return{}});b.addEnrichFeatures(a,d,m.DATA_COLLECTIONS_CALCULATOR_NAME,f);return{areaData:f}},function(a){c.fieldData.errors.push(a);return(new g).reject(a)})},applyRunReportAndGetDataResults:function(a,b){if(a&&a.areaData){var c=b.templateJson;b.fieldData.specialTradeAreaCalculatorName=c.metadata&&c.metadata.specialTradeAreaCalculatorName;delete c.metadata;b.fieldData.runReportTaskIDs=a.taskIDs;b.fieldData.areaData=a.areaData;(b.fieldData.reportInfo=a.reportInfo)&&this._populateReportDataFromReportInfo(a.reportInfo,
b);this._reportDataFromAreas(b.analysisAreas,b.fieldData.areaData);this._reportDataFromReport(b.reportObject,b.fieldData,b.combinedAreasInfo);return this._populateReportDataFromAttachmentsStore(b)}},_populateReportDataFromReportInfo:function(a,b){b.reportTitle=b.reportObject.title=b.reportTitle||a.Title||"";a.country&&!u.getCurrentCountry()&&(u.setCountry(a.country),u.setHierarchyID(null));a.stdLevels&&!u.getGeographiesModel()&&u.setGeographiesModel(new k({levels:a.stdLevels}));if(r.updateVariableInfoFromDataXml||
r.isPlayerOnServer){var c=a.variables;p.processTemplateFieldInfos(b.templateJson,function(a){if(a.hasVariable&&a.variableID&&a.templateName){var d=a.templateName.indexOf("."),f=a.templateName.substr(0,d),d=a.templateName.substr(d+1);(f=c[f]&&c[f][d])&&f.alias&&(a.alias=f.alias,a=b.templateVariableProvider.get(a.templateName))&&(a.alias=f.alias,f.vintage&&(a.vintage=f.vintage),f.source&&(a.source=f.source))}})}a=q.collectVariablesStats(b.templateJson);if(a=b.templateVariableProvider.getVariablesDataVintageDescription({usedVariablesCache:a}))b.reportObject.dataVintageDescription=
a},_populateReportDataFromAttachmentsStore:function(a){var c=a.attachmentsStore,d=[];a.analysisAreas.forEach(function(f,e){c.supportsMultipleAreas&&c.setCurrentAnalysisAreaIndex(e);d.push(l(c.getNotes(),function(c){if(c&&c.length){var d={attributes:{}};d.attributes[n.SITENOTES_FIELD_NAME]=c.map(function(a){return a.text}).join("\x3cbr/\x3e\x3cbr/\x3e");c.forEach(function(a,b){d.attributes[n.getSiteNoteFieldNameAt(b+1)]=a.text});(c=a.fieldData.areaData[e])&&b.addFeatureAttributesCalculator(d,c)}}));
d.push(l(c.getAttributes(),function(c){if(!c||!c.length)return null;var d={attributes:{}};c.forEach(function(a){d.attributes[a.name]=a});(c=a.fieldData.areaData[e])&&b.addFeatureAttributesCalculator(d,c)}))});return h(d)},_reportDataFromAreas:function(a,c){a.forEach(function(a,d){if(d=c[d])b.addFeatureAttributesCalculator(a.feature,d),b.addAreaInfoCalculator(a,d)})},_reportDataFromReport:function(a,b,c){var d=b.metadata;a&&!d.Title&&(d.Title=a.title);d.Subtitle=b.reportInfo&&b.reportInfo.Subtitle||
"";d.Source=a.dataVintageDescription||"Esri";d.Date=f.getReportFooterDate();d.Copyright="\u00a9 "+f.getFullYear()+" Esri";d.ProductLabel="";d.ProductUrl="";d.PhoneNumber="";d.TrialUrlText="";a.isMultiFeature&&(d.SITE_NAME=c.locationName||c.name,d.STORE_NAME=c.locationName||c.name,d.AREA_DESC2=c.description||c.name,d.STORE_ADDR=c.address)}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/EnrichAreasTask":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all esri/kernel esri/SpatialReference esri/tasks/FeatureSet esri/geometry/Point ../GEUtil ../areas/AnalysisAreaUtil ../attachments/AttributesUtil ../../../core/supportClasses/map/Projector ../../../countryConfig esri/dijit/geoenrichment/utils/CoordinateUtil".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q){function t(a){return(a=a&&d.id.findCredential(a)||d.id.credentials[0])&&a.token}return l(null,{enrichAreas:function(a){var b={};return g(this._analysisAreasToStudyAreas(a.analysisAreas,a.countryID,a.comparisonLevels),function(c){b.studyAreas=c;a.report?b.analysisVariables=[{itemid:a.report.reportID,url:a.report.portalUrl,token:t(a.portalUrl),outFields:["*"]}]:a.fields&&(b.analysisVariables=a.fields);return this._doRunTask(b,a,"enrich")}.bind(this)).then(this._handleFeatureSetsRequest.bind(this))},
createReport:function(a){var b={f:"bin",format:"xml",reportfields:{}};b.report={itemid:a.report.reportID,url:a.report.portalUrl,token:t(a.portalUrl)};return g(this._analysisAreasToStudyAreas(a.analysisAreas,a.countryID,null,a.getAttributes),function(c){b.studyAreas=c;return this._doRunTask(b,a,"createReport")}.bind(this))},_analysisAreasToStudyAreas:function(a,b,c,d){var f=this;c=c&&c.map(function(a){return{layer:a}});return e(a.map(function(a,k){var g;a.geographies&&a.geographies.length?(g=f._studyAreaFromGeographies(a.geographies,
b,!0),a.feature&&a.feature.attributes&&(g.attributes=h.mixin({},g.attributes,a.feature.attributes))):g={attributes:h.mixin({},a.feature.attributes),geometry:a.feature.geometry.toJson()};c&&(g.comparisonLevels=c);return e([f._getStorePointForArea(a),d&&d(a)]).then(function(a){var b=a[0];a=a[1];g.attributes=g.attributes||{};b&&(g.attributes.STORE_LAT=g.attributes.STORE_LAT||b.STORE_LAT,g.attributes.STORE_LONG=g.attributes.STORE_LONG||b.STORE_LONG);g.attributes.STORE_ID=k+"";a&&a.forEach(function(a){g.attributes[a.name]=
n.formatAttributeValueForStudyArea(a)});return g})}))},_getStorePointForArea:function(a){if(a=a.location&&a.location.geometry||a.buffer&&a.buffer.point){a=a instanceof c?a:new c(a);var d=f.geometryToLatLong(a);return d?d:g(m.projectGeometries(a,new b(q.WGS_84_WKID)),function(a){return f.geometryToLatLong(a)})}},createFeatureForGeographies:function(a,b){return this._createFeaturesForGeographies(a,b,!0).then(function(a){return a[0]})},createFeaturesForGeographies:function(a,b){return this._createFeaturesForGeographies(a,
b,!1)},_createFeaturesForGeographies:function(a,c,d){a={returnGeometry:!0,outSR:c.outSR||new b(q.WEB_MERCATOR_WKID),studyAreas:d?[this._studyAreaFromGeographies(a,c.countryID,!0,c.generalizationLevel)]:a.map(function(a){return this._studyAreaFromGeographies([a],c.countryID,!1,c.generalizationLevel)},this),dataCollections:["GlobalIntersect"]};return this._doRunTask(a,c,"enrich").then(this._handleFeatureSetsRequest.bind(this))},_studyAreaFromGeographies:function(a,b,c,d){var f={sourceCountry:b,layer:null,
ids:null},e=null,k=[],g;a.forEach(function(a){if(!a||!a.id)throw Error("Wrong geography.");var b=a.levelId;if(b)if(!e)e=b;else if(c&&e!==b)throw Error("Geographies have different level IDs.");k.push(a.id);a.sourceCountry&&(f.sourceCountry=a.sourceCountry);a.hierarchy&&(f.hierarchy=a.hierarchy);a.attributes&&(g=h.mixin(g||{},a.attributes))});f.layer=e;f.ids=c?[k.join(",")]:k;f.attributes=g;f.generalizationlevel=d;return f},createFeaturesForBuffer:function(a,c){c=c||{};var d={bufferUnits:a.units,bufferRadii:a.radii||
[a.radius],areaType:a.areaType||"RingBuffer"};"NetworkServiceArea"===d.areaType&&(d.travelMode=a.travelMode,d.networkOptions=a.networkOptions);a=a.point||a.polyline;d={returnGeometry:!0,outSR:c.outSR||a.spatialReference||new b(q.WEB_MERCATOR_WKID),dataCollections:["GlobalIntersect"],studyAreasOptions:d,studyAreas:[{geometry:a.toJson?a.toJson():a}]};return this._doRunTask(d,c,"enrich").then(this._handleFeatureSetsRequest.bind(this))},createFeaturesForBuffers:function(a,b){function c(a){var b=a.point||
a.polyline;return JSON.stringify(b.toJson?b.toJson():b)+";"+a.units+";"+a.areaType+";"+a.travelMode+";"+JSON.stringify(a.networkOptions)}var d={},f=[];a.forEach(function(a){var b=c(a),e=d[b],k=!1;if(e){var g=a.radii||[a.radius];e.radii.some(function(a){return-1!==g.indexOf(a)})&&(e=null,k=!0)}e||(e=h.clone(a),k||(d[b]=e),delete e.radius,e.radii=[],f.push(e));a.radii?e.radii=e.radii.concat(a.radii):e.radii.push(a.radius)});return e(f.map(function(a){return this.createFeaturesForBuffer(a,b)},this)).then(function(a){var b=
[];a.forEach(function(a){b=b.concat(a)});return b})},_doRunTask:function(a,b,c){a=h.mixin({useData:{sourceCountry:b.countryID,hierarchy:b.hierarchy||p.getHierarchyID()},forStorage:!1},a);return k[c](a)},_handleFeatureSetsRequest:function(b){return(new a(b[0])).features}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttributesUtil":function(){define(["dojo/_base/lang","esri/layers/CodedValueDomain","esri/dijit/geoenrichment/utils/DateUtil","esri/dijit/geoenrichment/utils/ObjectUtil"],
function(l,h,g,e){var d={composeAttributesFromFieldInfos:function(b,a){return b&&b.filter(function(a){return a.visible}).map(function(b){var c=b.fieldName,d=b.label,e=b.format&&b.format.places,g=b.format&&b.format.digitSeparator,h=b.format&&b.format.dateFormat,l=a[b.fieldName];b=(b=b.format)&&b.dateFormat?"esriFieldTypeDate":b&&void 0!==b.places?0<b.places?"esriFieldTypeDouble":"esriFieldTypeInteger":"esriFieldTypeString";return{name:c,alias:d,places:e,digitSeparator:g,dateFormat:h,value:l,type:b,
domain:null,length:void 0}})},formatAttributeValue:function(b,a){a=a||{};var c=a.hasOwnProperty("unavailableDataValue")?a.unavailableDataValue:"";if(!b||null===b.value||void 0===b.value)return c;if(!a.skipFormattedValue&&b.formattedValue&&b.formattedValue!==c)return b.formattedValue;var d=b.domain&&"codedValue"===b.domain.type?new h(b.domain):null;d?(a=d.getName(b.value))||(a=b.value+""):"esriFieldTypeString"===b.type?a=b.value:"esriFieldTypeDate"===b.type?a=g.formatDateShort(b.value):(a=a.format,
a=e.formatNumber(b.value,{places:a&&void 0!==a.decimals?a.decimals:b.places,noSeparator:a&&void 0!==a.useThousandsSeparator?!a.useThousandsSeparator:!1===b.digitSeparator,preserveTrailingZeroes:!0}));return null===a||void 0===a?c:a},formatAttributeValueForStudyArea:function(b){var a;b&&null!==b.value&&void 0!==b.value||(a=!0);a||(a=b.domain&&"codedValue"===b.domain.type||"esriFieldTypeDate"===b.type);return a?d.formatAttributeValue(b):b.value},getAttributeTypeForStudyArea:function(b){return"esriFieldTypeDate"===
b.type?"esriFieldTypeString":b.type},attributeToJson:function(b){return{name:b.name,alias:b.alias,type:b.type,value:b.value,domain:b.domain&&(b.domain.toJson?b.domain.toJson():l.clone(b.domain)),places:b.places,digitSeparator:b.digitSeparator,dateFormat:b.dateFormat,length:b.length}},attributeFromJson:function(b){return{name:b.name,alias:b.alias,type:b.type,value:b.value,domain:b.domain,places:b.places,digitSeparator:b.digitSeparator,dateFormat:b.dateFormat,length:b.length}}};return d})},"esri/dijit/geoenrichment/utils/DateUtil":function(){define(["dojo/date/locale",
"esri/moment"],function(l,h){var g={formatDate:function(e,d){return(e=g.objectToDate(e))?l.format(e,d):""},formatMoment:function(e,d){return(e=g.objectToTime(e))?h(e).format(d):""},formatDateShort:function(e){return g.formatMoment(e,"L")},formatDateTimeShort:function(e){return g.formatMoment(e,"L LT")},formatLiveTime:function(e){var d=g.formatMoment(e,"l, LT").replace(/\d\d\d\d/,function(b){return b.substr(2)});return d?d+" "+g.formatDate(e,{datePattern:"ZZZZ",selector:"date"}):""},formatTypicalTime:function(e){return g.formatMoment(e,
"ddd LT")},parseDateShort:function(e){return(e=+h(e,"L"))?new Date(e):null},getReportFooterDate:function(e){return l.format(e||new Date,{datePattern:"MMMM d, yyyy",selector:"date"})},getFullYear:function(){return(new Date).getFullYear()},objectToTime:function(e){if(!e)return null;e="string"===typeof e?new Date(e):e;return e.getTime?e.getTime():Number(e)||null},objectToDate:function(e){return e?e.getTime?e:new Date(e):null}};return g})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/Projector":function(){define(["dojo/_base/declare",
"esri/dijit/geoenrichment/Deferred","esri/dijit/geoenrichment/when","esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/utils/ProjectionUtil"],function(l,h,g,e,d){function b(a,b){return d.projectGeometries(a,b)}l=l(null,{_pendingInfos:null,_isBusy:!1,constructor:function(){this._pendingInfos=[]},addForProjection:function(a,b){if(this._isBusy)throw Error("Can't interrupt the current projection process.");a=a&&a.geometry||a;var c=new h;this._pendingInfos.push({geom:a,mapOrSR:b,dfd:c,index:this._pendingInfos.length});
return c.promise},project:function(){function a(a){var c=f[a];return g(b(c.geoms,c.mapOrSR),function(a){a.forEach(function(a,b){b=c.indexMap[b];m[b]=a;k[b].resolve(a)})})}var c=this;if(this._isBusy)throw Error("Can't interrupt the current projection process.");this._isBusy=!0;var k=[],f={};this._pendingInfos.forEach(function(a){k.push(a.dfd);var b=a.geom.type+";"+a.geom.spatialReference.wkid+";"+d.getSpatialReference(a.mapOrSR).wkid,b=f[b]=f[b]||{geoms:[],indexMap:{},mapOrSR:a.mapOrSR};b.geoms.push(a.geom);
b.indexMap[b.geoms.length-1]=a.index});this._pendingInfos.length=0;var h=[],m=[],l;for(l in f)h.push(a(l));return e(h).then(function(){c._isBusy=!1;return m})}});l.needProject=function(a,b){a=a&&a.geometry||a;return a.spatialReference&&a.spatialReference.wkid!==d.getSpatialReference(b).wkid};l.projectGeometries=b;return l})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/RunReportTask":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ./parsers/DataXMLParser ./EnrichAreasTask ../areas/AnalysisAreaJsonUtil esri/dijit/geoenrichment/utils/ArrayUtil esri/dijit/geoenrichment/utils/CacheUtil esri/dijit/geoenrichment/ReportPlayer/config esri/dijit/geoenrichment/ReportPlayer/_devConfig".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m){var p={_getCache:function(){return f.get("CreateReportResultCache")},_buildKey:function(a){return[a.countryID,a.hierarchy,JSON.stringify(c.areasToJson(a.analysisAreas,{excludeInfoTemplate:!0})),a.report.reportID,a.report.portalUrl,a.report.modified].join("_")},getCopy:function(a){a=this._buildKey(a);return(a=this._getCache()[a])&&h.clone(a)},copyAndPut:function(a,b){a=this._buildKey(a);this._getCache()[a]=b&&h.clone(b)},getResults:function(){var a=[],b;for(b in this._getCache())a.push(this._getCache()[b]);
return a}},q={execute:function(c){var f=c.cacheResult&&p.getCopy(c);if(f)return d(f);var f=k.splitArrayToBunches(c.analysisAreas,10),l;return g(f.map(function(f){function k(){var k=h.mixin({},c,{analysisAreas:f});k.getAttributes=function(a){if(!c.attachmentsStore)return null;if(!c.attachmentsStore.supportsMultipleAreas&&l)return l;c.attachmentsStore.supportsMultipleAreas&&c.attachmentsStore.setCurrentAnalysisAreaIndex(c.analysisAreas.indexOf(a));return d(c.attachmentsStore.getAttributes(),function(a){l=
l||a;return a})};return(new a).createReport(k).then(function(a){var c=a&&a.taskID;a=a&&a.result;try{m.emulateErrors.createReportError&&(a={error:{message:"Error test: something crashed on the server!"}});var d;a&&"object"===typeof a&&(d=a.error);if(!d&&"string"===typeof a&&-1!==a.indexOf("{"))try{var f=JSON.parse(a);d=f&&f.error}catch(A){}if(d)if(n.runReportTask.ignoreErrors)a=[];else return(new e).reject(d);var k=b.parse(a);return{taskID:c,areaData:k.areaData,reportInfo:k.reportInfo,originalXML:a,
error:d}}catch(A){return(new e).reject(A)}})}return d(k(),function(a){return!a||a.error?n.runReportTask.secondAttempt?k():a:a},function(a){return n.runReportTask.secondAttempt?k():(new e).reject(a)})})).then(function(a){var b={taskIDs:[],areaData:[],reportInfo:null,originalXMLs:[],errors:[]};a.forEach(function(a){b.taskIDs.push(a.taskID);b.originalXMLs.push(a.originalXML);a.error&&b.errors.push(a.error);b.areaData=b.areaData.concat(a.areaData);b.reportInfo=a.reportInfo});c.cacheResult&&!b.errors.length&&
p.copyAndPut(c,b);return b})}};l=l(null,{execute:function(a){console.log("Creating a new report...");return q.execute(a)}});l.CreateReportResultCache=p;return l})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/parsers/DataXMLParser":function(){define("esri/units esri/dijit/geoenrichment/utils/FieldUtil esri/dijit/geoenrichment/utils/JsonXmlConverter ../../data/AreaDataUtil ../../../../core/supportClasses/DocumentOptions ./AttrUtil esri/dijit/geoenrichment/ReportPlayer/config esri/dijit/geoenrichment/ReportPlayer/_devConfig".split(" "),
function(l,h,g,e,d,b,a,c){function k(a){return a.innerHTML?a.innerHTML:a.tags&&a.tags.length&&a.tags[0].text||""}function f(a){var b={Title:null,Subtitle:null,country:null,hierarchyId:null,exportSettings:null};a.tags&&a.tags.forEach(function(a){"ReportTitle"===a.name&&(b.Title=k(a));"ReportTitle2"===a.name&&(b.Subtitle=k(a));if("CurrencyFormat"===a.name){a=k(a);var c=a.split(";")[0].replace("0","").trim();b.country={id:null,currencySymbol:c,currencyFormat:a}}else if("ReportLayout"===a.name){var f=
b.exportSettings={};a.tags&&a.tags.forEach(function(a){if("Options"===a.name&&a.attributes)f.addHeader=!!a.attributes.header,f.addDataSource=!!a.attributes.dataSource,f.addFooter=!!a.attributes.footer;else if("Page"===a.name&&a.attributes){f.pageSettings={};var b=a.attributes;if(b.width&&b.height&&b.units){a=Number(b.width);var c=Number(b.height);if(b=b.units===l.MILLIMETERS?"mm":b.units===l.CENTIMETERS?"cm":b.units===l.INCHES?"in":b.units===l.POINTS?"pt":null)f.pageSettings.pagesize=d.combineCustomSizeString(a,
c,b)}else b.size&&b.orientation&&(f.pageSettings.pagesize=b.size.toLowerCase(),f.pageSettings.orientation=b.orientation.toLowerCase())}})}});b.exportSettings&&b.Subtitle&&(b.exportSettings.reportSubtitle=b.Subtitle);return b}function n(a){function b(a){a.tags&&a.tags.forEach(function(a,b){b=a.attributes&&a.attributes.STORE_ID||b+"";var c=f[b];c||(c={attributes:null,notes:null,images:null},f[b]=c,d.sites.push(c));a.tags&&a.tags.forEach(function(a){"Attributes"===a.name&&a.tags&&(c.attributes=a.tags.map(function(a){return{name:a.attributes.Name,
alias:a.attributes.Alias,type:a.attributes.Type,value:h.isNumericField(a.attributes.Type)?Number(a.attributes.Value):a.attributes.Value}}));"Notes"===a.name&&a.tags&&(c.notes=a.tags&&a.tags.map(function(a){return{text:a.attributes.Text}}));"Images"===a.name&&a.tags&&(c.images=a.tags&&a.tags.map(function(a){return{url:a.attributes.Source,thumbnail:a.attributes.Thumbnail,description:a.attributes.Description,imageViewType:null}}))})})}function c(a){var b;d.stdLevels=a.tags&&a.tags.map(function(a,c){b=
b||a.attributes.Id.substr(0,a.attributes.Id.indexOf("."));return{id:a.attributes.Id,name:a.attributes.Caption,isWholeCountry:a.attributes.IsWholeCountry||0===c}});"US"===b&&(d.countrId="US");"CAN"===b&&(d.countrId="CA")}var d={sites:[],stdLevels:null,countrId:null},f={};a.tags&&a.tags.forEach(function(a){"StudyAreas"===a.name?b(a):"StandardGeographyLevels"===a.name&&c(a)});return d}function m(d,f){function g(d){if(d=function(d){var e={},g,h,p;d.tags.forEach(function(a){var b=k(a),n=b,m=l[d.name][a.name];
"string"===(m&&m.type)?b=String(b):(b=Number(b),isNaN(b)&&(b=n),c.emulateErrors.createReportNaN&&(b=NaN),c.emulateErrors.createReportNull&&(b=null));f&&(b=f(a.name,b,d.name));void 0===e[a.name]&&(e[a.name]=b);"AREA_ID"===a.name&&(g=b);"IDFNDFIELD"===a.name&&(h=b);"STORE_ID"===a.name&&(p=b)});g=g||h;if(!g&&!p)return null;var q;!g&&p&&(q=Number(p));g&&void 0===n[g]&&(n[g]=m++);b.cleanUpAttrs(e,a.isPlayerOnServer?{STORE_ID:1,AREA_ID:1}:null);return{name:d.name,attrs:e,areaIndex:void 0!==q?q:n[g]}}(d)){var g=
h[d.areaIndex]=h[d.areaIndex]||{};g[d.name]?g[d.name].comparisonLevels.push(d.attrs):g[d.name]=e.createCalculator(d.attrs)}}var h=[],n={},m=0,l;d.tags[0].tags.forEach(function(a){"xs:schema"===a.name?l=p.parseSchema(a):g(a)});return{areaData:h,schemaParseResult:l}}var p={parseSchema:function(a){var b={};a.tags.forEach(function(a){"xs:element"===a.name&&a.attributes&&"ReportData"===a.attributes.name&&g.queryJson(a,"xs:element").filter(function(a){return!!a.tags}).forEach(function(a){var c=b[a.attributes.name]=
{};g.queryJson(a,"xs:element").forEach(function(a){c[a.attributes.name]={type:"xs:string"===a.attributes.type?"string":"number",alias:a.attributes["msdata:Caption"]||"",vintage:a.attributes["msdata:Vintage"]||"",source:a.attributes["msdata:Source"]||""}})})});return b}};return{parse:function(a,b){return this._parseDataXmlJson(g.parseXml(a,{saveInnerHTML:!0}),b)},_parseDataXmlJson:function(a,b){if(!a||!a.tags||2>a.tags.length)return[];var d,e,k,g;a.tags.forEach(function(a){"ReportInfo"===a.name?d=
f(a):"ReportArea"===a.name?e=n(a):"ReportData"===a.name&&(a=m(a,b),g=a.areaData,k=a.schemaParseResult)});c.logData&&(console.log("DataXMLPareser.js \x3d\x3e areaData:"),console.log(g));e&&(d.country.id=e.countrId,d.sites=e.sites,d.stdLevels=e.stdLevels);d.variables=k;return{reportInfo:d,areaData:g}}}})},"esri/dijit/geoenrichment/utils/JsonXmlConverter":function(){define(["dojo/_base/declare","./RegExpUtil"],function(l,h){function g(b,d,e,g){return c(e,g)+"\x3c"+b+(d?a(d):"")+"\x3e"+(g?"\n":"")}function e(a,
b,d){return c(b,d)+"\x3c/"+a+"\x3e"+(d?"\n":"")}function d(b,d,e,g){return c(e,g)+"\x3c"+b+(d?a(d):"")+" /\x3e"+(g?"\n":"")}function b(a,b,d){a=h.encodeXML(a,!1);return c(b,d)+a+(d?"\n":"")}function a(a){var b="",c;for(c in a){var d=a[c];Array.isArray(d)&&(d=d.join(";"));void 0===d||null===d||""===d||"number"===typeof d&&isNaN(d)||(b+=" "+c+'\x3d"'+h.encodeXML(d,!0)+'"')}return b}function c(a,b){if(!b)return"";b="";for(var c=0;c<a;c++)b+="     ";return b}return l(null,{parseJson:function(a,c){function f(a,
c){a.text||"#text"===a.name?h+=b(a.text,c,k):a.name&&(a.tags&&a.tags.length?(h+=g(a.name,a.attributes,c,k),a.tags&&a.tags.forEach(function(a){f(a,c+1)}),h+=e(a.name,c,k)):h+=d(a.name,a.attributes,c,k))}var k=c&&c.prettify,h="";c&&c.addDocumentOptions&&(h+='\x3c?xml version\x3d"1.0" encoding\x3d"utf-8"?\x3e');f(a,0);return h=decodeURIComponent(encodeURIComponent(h).replace("%19",""))},parseXml:function(a,b){function c(a,e){a.name=e.nodeName;b.saveInnerHTML&&(a.innerHTML=e.innerHTML);if(e.attributes&&
e.attributes.length){a.attributes={};for(var k=0;k<e.attributes.length;k++){var g=e.attributes[k],n=g.value;if(!0===n||"true"===n)n=!0;else if(!1===n||"false"===n)n=!1;else if(d&&n){var m=Number(n);isNaN(m)||(n=m)}a.attributes[g.nodeName]=n}}if(e.childNodes&&e.childNodes.length)for(a.tags=[],k=0;k<e.childNodes.length;k++){if(n=g=e.childNodes[k],"#text"!==n.nodeName||(f?n.nodeValue.trim():n.nodeValue))n={},a.tags.push(n),c(n,g)}else"#text"===e.nodeName&&(delete a.name,a.text=h.decodeXML(e.nodeValue))}
b=b||{};var d=b.parseNumbers,f=b.ignoreWhiteSpacedTextNodes,f=void 0===f?!0:f,e={},k;a=(new DOMParser).parseFromString(a,"text/xml").childNodes;for(var g=0;g<a.length;g++)if(1===a[g].nodeType){k=a[g];break}k&&c(e,k);return e},queryTopJson:function(a,b){return this.queryJson(a,b,!0)},queryJson:function(a,b,c){function d(a,e){a.tags&&a.tags.forEach(function(a){(b.test?b.test(a.name):a.name===b)&&f.push(a);c&&0===e||d(a,e+1)})}var f=[];d(a,0);return f},traverseJson:function(a,b){function c(a){d||(!0===
b(a)?d=!0:a.tags&&a.tags.forEach(c))}var d=!1;c(a)},getInnerHTML:function(a){return a.innerHTML?a.innerHTML.trim():this.parseJson(a).replace(/^<[^<]*>/,"").replace(/<\/[^<]*>$/,"").trim()},_IS_RICH_RE:/<.+>.*<\/.+>|<br\s*\/>|<\/br>/,_UNRICH_RE:/<.*?>/g,isRichText:function(a){return(a=String(a))&&this._IS_RICH_RE.test(a)},unrichHTML:function(a){if(!a)return"";a=h.decodeXML(String(a).trim()).replace(this._UNRICH_RE,"");0===a.indexOf("\x3c")&&-1!==a.indexOf("\x3e")&&(a="");return a}})()})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions":function(){define(["dojo/_base/lang",
"esri/dijit/geoenrichment/utils/PageUnitsConverter","../themes/ThemeLibrary"],function(l,h,g){var e={},d={a:[[841,1189],[594,841],[420,594],[297,420],[210,297],[148,210],[105,148],[74,105],[52,74],[37,52],[26,37]],b:[[1E3,1414],[707,1E3],[500,707],[353,500],[250,353],[176,250],[125,176],[88,125],[62,88],[44,62],[31,44]],c:[[917,1297],[648,917],[458,648],[324,458],[229,324],[162,229],[114,162],[81,114],[57,81],[40,57],[28,40]],letter:[216,279],legal:[216,356],tabloid:[279,432],ledger:[432,279]};e.PAPER_SIZES=
d;var b={};"a3 a4 a5 b4 b5 c4 c5 letter legal tabloid ledger".split(" ").forEach(function(a){var c;c=2===a.length?d[a[0]][a[1]]:d[a];b[a]={portrait:{w:h.mmToIn(c[0]),h:h.mmToIn(c[1])},landscape:{w:h.mmToIn(c[1]),h:h.mmToIn(c[0])}}});e.SIZE_TYPE_TO_DIM_HASH=b;e.hasStandardSize=function(a){return b[a]};e.getSupportedPageSizes=function(){var a=[],b;for(b in d)1===b.length?d[b].forEach(function(c,d){a.push(b+d)}):a.push(b);return a};e.getPageDim=function(a,c,d){b[a]?a=b[a][c||"portrait"]:(a=a.split("x"),
a={w:h.ptToIn(Number(a[0])),h:h.ptToIn(Number(a[1]))});d&&(a=l.clone(a),h.roundNDigitsObj(a,d.places));return a};e.getPageBox=function(a){if(!a)return null;var b=e.getPageDim(a.pagesize,a.orientation),d=h.inToPx(b.w),b=h.inToPx(b.h);return{w:d,h:b,contentW:d-(a.left||0)-(a.right||0),contentH:b-(a.top||0)-(a.bottom||0)}};e.combineCustomSizeString=function(a,b,d){return h.convert(a,d,"pt",5)+"x"+h.convert(b,d,"pt",5)};e.getDefaultDocumentOptions=function(a){return l.mixin({pagesize:"letter",orientation:"portrait",
left:21.07,right:22.6,top:19.2,bottom:9.6,align:"left",lineSpacing:1.493,fontSize:10,fontFamily:g.DEFAULT_FONT_FAMILY_CLASSIC},a)};e.getDefaultDocumentOptionsGraphicReport=function(a){return l.mixin({pagesize:"letter",orientation:"landscape",left:21.07,right:22.6,top:19.2,bottom:9.6,align:"left",lineSpacing:1.493,fontSize:10,fontFamily:g.DEFAULT_FONT_FAMILY_GRAPHIC},a)};e.getClosestStandrdSizes=function(a,c){function d(a){var b=a.w/f.w;a=a.h/f.h;return Math.max(1-(1<b?1/b:b),1-(1<a?1/a:a))}c=void 0===
c?.4:c;var f=e.getPageDim(a.pagesize,a.orientation);a=[];for(var g in b){var h=b[g];a.push({pagesize:g,orientation:"portrait",score:d(h.portrait)});a.push({pagesize:g,orientation:"landscape",score:d(h.landscape)})}a=a.filter(function(a){return a.score<=c});a.sort(function(a,b){return a.score-b.score});return a};e.tryGetStandardPageSize=function(a,b){function c(a){var c="portrait"===b?1:0;return a["portrait"===b?0:1]===g&&a[c]===m}if(e.SIZE_TYPE_TO_DIM_HASH[a])return a;var d=a.split("x"),g=h.convert(Number(d[0]),
"pt","mm",0),m=h.convert(Number(d[1]),"pt","mm",0),l,q;for(q in e.PAPER_SIZES)if(d=e.PAPER_SIZES[q],1===q.length){if(d.some(function(a,b){if(c(a))return l=q+b,!0}))break}else if(c(d)){l=q;break}return l||a};return e})},"esri/dijit/geoenrichment/utils/PageUnitsConverter":function(){define(["dojo/_base/lang"],function(l){function h(d,b,a){a&&(d=l.mixin({},d));for(var c in d){var e=d[c];null!==e&&""!==e&&"boolean"!=typeof e&&("object"==typeof e?d[c]=h(e,b,a):(e=Number(e),isNaN(e)||(d[c]=b(e))))}return d}
var g={},e="px pt mm cm in twip".split(" ");e.forEach(function(d){e.forEach(function(b){if(d!==b){var a=d+"To"+b.charAt(0).toUpperCase()+b.substr(1);g[a]=function(a,e){return g.convert(a,d,b,void 0!==e?e:5)}}})});g.convert=function(d,b,a,c){d=Number(d)||0;switch(b){case "in":d*=72;break;case "px":d*=.75;break;case "mm":d=d/25.4*72;break;case "cm":d=d/2.54*72;break;case "twip":d/=20}switch(a){case "in":d/=72;break;case "px":d/=.75;break;case "mm":d=d/72*25.4;break;case "cm":d=d/72*2.54;break;case "twip":d=
Math.round(20*d)}void 0!==c&&(d=g.roundNDigits(d,c));return d};g.pxToPtObj=function(d,b){return h(d,g.pxToPt,!b)};g.ptToPxObj=function(d,b){return h(d,g.ptToPx,!b)};g.roundNDigits=function(d,b){return Number(Number(d).toFixed(b))};g.roundNDigitsObj=function(d,b){for(var a in d){var c=d[a];"object"==typeof c?g.roundNDigitsObj(c,b):d[a]=g.roundNDigits(c,b)}};return g})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/parsers/AttrUtil":function(){define([],function(){var l={},
h="ID OBJECTID AREA_ID STORE_ID HasData aggregationMethod sourceCountry radiusIndex".split(" ");l.cleanUpAttrs=function(g,e){g&&h.forEach(function(d){e&&e[d]||delete g[d]})};return l})},"esri/dijit/geoenrichment/utils/ArrayUtil":function(){define(["dojo/_base/array"],function(l){var h={},g={}.toString();h.arraysEqual=function(e,d){if(!e&&!d)return!0;if(!e||!d||e.length!==d.length)return!1;for(var b=0;b<e.length;b++)if(e[b]!==d[b])return!1;return!0};h.composeIdentityFunction=function(e,d){var b="function"===
typeof e?e:e?function(a){return a[e]}:function(a){return a};return function(a){return(a=b(a))&&a.toString?a.toString():d&&void 0===a?a:String(a)}};h.removeDuplicates=function(e,d){var b=[],a={};d=h.composeIdentityFunction(d,!0);l.forEach(e,function(c,e){var f=d(c);f===g&&(void 0===c["__ArrayUtil.js_uniqueKey__"]&&(c["__ArrayUtil.js_uniqueKey__"]="__ArrayUtil.js_uniqueKey__"+e),f=c["__ArrayUtil.js_uniqueKey__"]);void 0===f||f in a||(a[f]=c,b.push(c))});return b};h.splitArrayToBunches=function(e,d){d=
d||100;for(var b=[],a,c=0,k=e.length;c<k;c++)a&&a.length!==d||(a=[],b.push(a)),a.push(e[c]);return b};return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/data/AreaCalculatorsUtil":function(){define(["./AreaDataUtil","../../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil","../tasks/parsers/FeatureSetParser"],function(l,h,g){return{addFeatureAttributesCalculator:function(e,d,b){b=b||h.AREA_ATTRIBUTES_CALCULATOR_NAME;for(var a in e.attributes)l.setAreaDataObjectValue(a,
e.attributes[a],d,b)},addAreaInfoCalculator:function(e,d,b){b=b||h.AREA_ATTRIBUTES_CALCULATOR_NAME;l.setAreaDataObjectValue("SITE_NAME",e.locationName||e.name,d,b);l.setAreaDataObjectValue("STORE_NAME",e.locationName||e.name,d,b);l.setAreaDataObjectValue("AREA_DESC",e.shortName||e.name,d,b);l.setAreaDataObjectValue("AREA_DESC2",e.description||e.name,d,b);l.setAreaDataObjectValue("AREA_DESC3",e.description||e.name,d,b);l.setAreaDataObjectValue("STORE_ADDR",e.address||"",d,b);l.setAreaDataObjectValue("STORE_LAT",
e.latitude||"",d,b);l.setAreaDataObjectValue("STORE_LONG",e.longitude||"",d,b)},addEnrichFeatures:function(e,d,b,a){var c={},k={},f;for(f in d)c[f.toLowerCase()]=d[f],k[f.toUpperCase()]=d[f];e=g.parse(e,b||h.ENRICHED_DATA_NO_LEVELS,function(a){return d[a]||c[a.toLowerCase()]||k[a.toUpperCase()]});l.mergeAreaData(e,a)}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/tasks/parsers/FeatureSetParser":function(){define(["./AttrUtil"],function(l){var h={ID_FIELDS:["ID","AREA_ID",
"IDFNDFIELD"],KNOWN_ATTRIBUTES:{StdGeographyLevel:1,StdGeographyName:1,StdGeographyID:1},parse:function(g,e,d){if(!g)return[];g=g.features||g;if(!g.length)return[];var b=[],a={},c=0;g.forEach(function(k){var f=k.attributes[h.ID_FIELDS[0]]||k.attributes[h.ID_FIELDS[1]];if(f){void 0===a[f]&&(a[f]=c++);var g={},m;for(m in k.attributes){var p=h.KNOWN_ATTRIBUTES[m]?m:d?d(m):m;p&&(g[p]=k.attributes[m])}l.cleanUpAttrs(g);k={name:e,attrs:g,areaIndex:a[f]}}else k=null;k&&(f=b[k.areaIndex]=b[k.areaIndex]||
{},f[k.name]?f[k.name].comparisonLevels.push(k.attrs):f[k.name]={data:k.attrs,comparisonLevels:[]})});console.log("FeatureSetPareser.js \x3d\x3e areaData:");console.log(b);return b}};return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/data/VariablesUtil":function(){define(["../dataCollections/DataCollectionsLoader"],function(l){var h={preprocessVariables:function(g,e){var d=h.convertForEnrich(h._splitVariables(g)).filter(function(b){return b.itemid});return l.loadCustomDataVariables(d,
{forceLowerCase:!0,portalUrl:e}).then(function(b){return h._splitVariables(g,b)})},_splitVariables:function(g,e){var d=[],b={};g.forEach(function(a){"string"===typeof a?d.push(a.toLowerCase()):a&&a.outFields&&a.outFields.forEach(function(c,k){k=a.itemid+"."+c;k=k.toLowerCase();d.push(k);b[k]={itemid:a.itemid,url:a.url,token:a.token,variable:e?e.fullNameToVariableCache[k]:{id:c}}})});return{fullNames:d,customDataMapping:b}},convertForEnrich:function(g){var e={},d=[];g.fullNames.forEach(function(b){var a=
g.customDataMapping[b];a?(b=e[a.itemid],b||(b={itemid:a.itemid,url:a.url,token:a.token,outFields:[]},b.url||delete b.url,b.token||delete b.token),b.outFields.push(a.variable.id),e[b.itemid]||(e[b.itemid]=b,d.push(b))):d.push(b)});return d}};return h})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/dataCollections/DataCollectionsLoader":function(){define("esri/dijit/geoenrichment/promise/all ../GEUtil ../ReportTemplateData esri/dijit/geoenrichment/utils/CacheUtil esri/dijit/geoenrichment/utils/JsonXmlConverter esri/dijit/geoenrichment/utils/UrlUtil".split(" "),
function(l,h,g,e,d,b){return{canLoad:function(){return h.canMakeRequests()},loadVariables:function(a){var b=e.get("DataCollectionsLoader"),d="*"===a.outFields,f=d?["*"]:a.outFields,g=a.countryID+";"+a.hierarchy+";"+f.join(";")+";"+!!a.forceLowerCase;b[g]||(d||(f=f.slice(),-1===f.indexOf("id")&&f.push("id")),b[g]=h.getDataCollections(a.countryID,a.hierarchy,{f:"json",outFields:d?"*":JSON.stringify(f),suppressNullValues:!0,AddDerivativeVariables:"all"}).then(function(b){var c={dataCollections:b,idToVariableCache:{},
fullNameToVariableCache:{}};b.forEach(function(b){b.data.forEach(function(e){function k(b){return a.forceLowerCase?b.toLowerCase():b}function g(a){if(d)return Object.keys(a).length;var b=0;f.forEach(function(c){void 0!==a[c]&&b++});return b}var h=c.idToVariableCache[k(e.id)];if(!h||g(e)>g(h))c.idToVariableCache[k(e.id)]=e;c.fullNameToVariableCache[k(b.dataCollectionID+"."+e.id)]=e})});return c}));return b[g]},loadCustomDataVariables:function(a,c){c=c||{};var e={idToVariableCache:{},fullNameToVariableCache:{}};
return l(a.map(function(a){var f=b.combineMulti([a.url||c.portalUrl,"sharing/rest/content/items",a.itemid,"resources/metadata.xml"]);return g.loadResource(f,a.token||b.getToken(c.portalUrl)).then(function(b){var f=d.parseXml(b.data);b=[];var k=d.queryJson(f,"Fields")[0];k&&(b=b.concat(d.queryJson(k,"Field")));(f=d.queryJson(f,"CalculatedFields")[0])&&(b=b.concat(d.queryJson(f,"Script")));b.forEach(function(b){function d(a){return c.forceLowerCase?a.toLowerCase():a}b=b.attributes;b={id:b.Name,fullName:a.itemid+
"."+b.Name,alias:b.Alias,description:b.Alias,type:"esriFieldType"+b.Type,precision:b.Precision?Number(b.Precision):void 0,vintage:b.Vintage};e.idToVariableCache[d(b.id)]=b;e.fullNameToVariableCache[d(b.fullName)]=b})})})).then(function(){return e})}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/ReportTemplateData":function(){define("dojo/_base/declare dojo/_base/lang dojo/request/xhr esri/dijit/geoenrichment/promise/all esri/kernel esri/request esri/urlUtils esri/dijit/geoenrichment/utils/DataUtil esri/dijit/geoenrichment/utils/PortalUtil esri/dijit/geoenrichment/utils/UrlUtil esri/dijit/geoenrichment/utils/requests/FileContent esri/dijit/geoenrichment/utils/requests/UniversalClient".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m){function p(b,d){var f=b.substr(b.lastIndexOf("/")+1),e=a.getProxyRule(b);return g(e&&e.proxyUrl?e.proxyUrl+"?"+b:b,{method:"POST",handleAs:"arraybuffer",data:"token\x3d"+d,headers:{"X-Requested-With":null,"Content-Type":"application/x-www-form-urlencoded; charset\x3dutf-8"}}).then(function(a){var b=!/\.xml$|\.txt$|\.json$/i.test(f);return{name:f,data:b?c.base64FromByteSource(a):decodeURIComponent(escape(c.binaryStringFromByteSource(a)))}})}l=l(null,{id:null,_portalUrl:null,
_baseUrl:null,constructor:function(a,b){this.id=a.id;this._portalUrl=b;this._baseUrl=f.combine(this._portalUrl,"sharing/rest")},getFiles:function(){var a=this;return this._getResources().then(function(b){var c=[];b.map(function(b){b=b.resource;"thumbnail.png"!==b&&c.push(a.getFileByName(b))});return e(c)})},getFileByName:function(a){return p(this.getItemResourceUrl(a,!1),this._getToken())},getItemResourceUrl:function(a,b){a=this._baseUrl+"/"+this._contentItemPath(this.id+"/resources/"+a);return b?
f.addQueryPart(a,"token\x3d"+this._getToken()):a},updateFile:function(a,b){var c=this;return m.request({url:this._baseUrl,urlSuffix:"content/items/"+this.id}).then(function(d){var f=n.fromFileData(a,b);return m.request({url:c._baseUrl,urlSuffix:"content/users/"+d.owner+"/"+d.ownerFolder+"/items/"+c.id+"/updateResources"},{content:{file:f,filename:a}})})},_contentItemPath:function(a){return"content/items/"+a},_getToken:function(){var a=d.id.findCredential(this._portalUrl)||d.id.credentials[0];return a&&
a.token},_getResources:function(){var a=this;return k.query(function(c){return b({url:a._baseUrl+"/"+a._contentItemPath(a.id+"/resources"),content:h.mixin({f:"json",token:a._getToken()},c),handleAs:"json"},{usePost:!0})},null,"resources").then(function(a){return a.resources})},getPortalUrl:function(a){return a?/[^:]+:\/\/(.+)$/i.exec(this._portalUrl)[1]:this._portalUrl}});l.loadResource=p;return l})},"esri/dijit/geoenrichment/utils/PortalUtil":function(){define(["dojo/_base/lang","esri/kernel","esri/request",
"./requests/EveryRequest"],function(l,h,g,e){var d={query:function(b,a,c,d){a=a||{};c=c||"results";d=d||100;var f="number"===typeof a.num?a.num:-1,k=a.num=0>f||a.num>d?d:a.num;a.start=a.start||1;return b(a).then(function(d){var g=d[c],h=d.total-a.start+1;0<=f&&h>f&&(h=f);h-=k;if(0>=h)return d;a.num=k;for(var n=[];0<h;)a.start+=k,n.push(b.bind(null,l.mixin({},a))),h-=k;return e(n,{stopOnError:!0}).then(function(a){a.forEach(function(a){Array.prototype.push.apply(g,a[c])});return d})})},queryCommon:function(b,
a){return d.query(function(c){var d=h.id.findCredential(b)||h.id.credentials[0];return g({url:b,content:l.mixin({f:"json",token:d?d.token:void 0},a,c),handleAs:"json"},{usePost:!0})}).then(function(a){return a.results})}};return d})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/CustomReportsManager":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when ./PortalManager ./ReportTemplateData ./StandardGraphicReportTemplates esri/dijit/geoenrichment/utils/CacheUtil esri/dijit/geoenrichment/utils/PortalUtil esri/dijit/geoenrichment/utils/PortalQueryUtil esri/dijit/geoenrichment/utils/UrlUtil ../../config ../../countryConfig".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m){var p={TEMPLATE_TYPE:"Report Template",PLAYER_STANDARD_INFOGRAPHIC_TYPEKEYWORD:"esriReportPlayerStandardInfographic",GALLERY_INFOGRAPHIC_TYPEKEYWORD:"esriWebGalleryInfographicReport",MOBILE_INFOGRAPHIC_TYPEKEYWORD:"esriMobileFactsInfographicReport",GALLERY_INFOGRAPHIC_USER:"esri_reports",resetCache:function(){a.set("CustomReportsManager",{})},_getCache:function(){return a.get("CustomReportsManager")},getCustomReports:function(a){var b=this,d=f.getPortalUrl(a.portalUrl);
return g(e.getPortalInfo(d),function(e){var g=e.user.username,g={q:k.combineQueryString({type:"Report Template",typeKeywords:a.typeKeywords,owner:!a.publicOnly&&g}),sortField:"modified",sortOrder:"desc"};return c.queryCommon(f.combine(d,"sharing/rest/search"),g).then(function(c){c=c.map(function(c){return b.prepareCustomReportFromItem(c,e.portal.url,a)});return b._getCountryReports(c,a.countryID)})})},_getCountryReports:function(a,b){return a&&("*"===b?a:a.filter(function(a){return!a.countries||a.countries.split(",").some(function(a){return b===
a.trim()})}))},prepareCustomReportFromItem:function(a,b,c){function f(a){return"string"===typeof a?"true"===a:!!a}var e=l.mixin({},a.properties||a.details);e.isGraphicReport=f(e.isGraphicReport);e.isMultiFeature=f(e.isMultiFeature);e.reportID=a.id;b={title:a.title,templateData:b&&new d(a,b),modified:a.modified instanceof Date?a.modified.getTime():a.modified};c&&c.attachItemProperty&&(b[c.attachItemProperty]=a);l.mixin(b,e);return b},getCustomReportByID:function(a){var b=this,c=this._getCache()[a.reportID];
if(c)return c;c=f.getPortalUrl(a.portalUrl);return this._getCache()[a.reportID]=g(e.getPortalInfo(c),function(c){return c.user.getItem(a.reportID).then(function(d){return d&&b.prepareCustomReportFromItem(d,c.portal.url,a)})}).otherwise(function(c){delete b._getCache()[a.reportID];return a.ignoreError?null:(new h).reject(c)})},tryFindReportIdByAlias:function(a){var c=this,d=b.aliasToID(a.countryID,a.reportID);if(!d)return null;var e=f.getPortalUrl(a.portalUrl);return g(this.getCustomReportByID({reportID:d,
portalUrl:e,ignoreError:!0,attachItemProperty:a.attachItemProperty}),function(b){return b?b&&(a.returnObject?b:b.reportID):g(c.getCustomReports({portalUrl:e,countryID:a.countryID,typeKeywords:"esriReportPlayerStandardInfographic",publicOnly:!0,attachItemProperty:a.attachItemProperty}),function(b){function c(a){a=a.split(".");return Number((Number(a[0])+Number(a[1])/100).toFixed(2))}var d=c(n.jsapiVersion),f,e,k=-Infinity,g=Infinity;b.forEach(function(b){if(b.playerAlias===a.reportID){var h=c(b.jsapiVersion);
d>=h&&h>k&&(k=h,f=b);d<h&&h<g&&(g=h,e=b)}});b=f||e;a.strictVersionCheck&&b&&b.jsapiVersion!==n.jsapiVersion&&(b=null);return b&&(a.returnObject?b:b.reportID)})})},itemUpdated:function(a){delete this._getCache()[a]},getFakeCustomReportByContext:function(a){return{title:"Generic template",type:"esriReportTemplateStandard",coverage:a.countryID,countries:a.countryID,hierarchy:a.hierarchy||m.getHierarchyID(),isGraphicReport:!0,isMultiFeature:!1,reportID:null}}};p.resetCache();return p})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/StandardGraphicReportTemplates":function(){define(["dojo/_base/lang",
"../../config","dojo/i18n!esri/nls/jsapi"],function(l,h,g){function e(){return a?a:a={"3.25":{"US.census":[{id:"e2a6868f979f4e37896b631581ae4918",alias:"demographic-summary"},{id:"88420f4a98bb45cbacacbad67e23266e",alias:"key-facts"},{id:"efb6bee0a80d4801887ec4cf73aa67fc",alias:"marketing-profile"},{id:"12867e4a89d5461fbbe3b9c6c181993a",alias:"at-risk-population"},{id:"6637be1fbddf4e948fbd09ce6a7a7888",alias:"portrait-property-flyer"},{id:"02c1124e916847249aa91b9ce48c2552",alias:"skyscraper"},{id:"3afd4c5089584b089af5b0037d74a9d1",
alias:"transportation-to-work"},{id:"a696eae378974ed5a63510fa70bed011",alias:"health-care"},{id:"c931fc6ebdb440189a8bc6bd34115807",alias:"executive-summary-call-outs"},{id:"96096c8afa4847dea936942b1f89acb5",alias:"tapestry-profile"},{id:"7a20b92b48cc4e63bf7ba956295de948",alias:"nearby-restaurants"}],"CA.census":[{id:"6c467040a8a64c33972045cf091bca5b",alias:"key-facts"}],"*.census":[{id:"11c4cec3c0d34c4aa51cd8877e2db4ef",alias:"key-facts"}]},"3.26":{"US.census":[{id:"a5161c2ca50d44429daf2bf9dbe73eb5",
alias:"demographic-summary"},{id:"693269bfbf6c4851901a3c9c56550294",alias:"key-facts"},{id:"aceee34210e748ba95cb9cae21e196b9",alias:"marketing-profile"},{id:"a7936c5ce77c4d698140db21ab1a7858",alias:"at-risk-population"},{id:"8d42e32b12154bc580af89483c208d56",alias:"portrait-property-flyer"},{id:"7be44b15e29847a383906aac5699cf00",alias:"skyscraper"},{id:"537230b385fb45d9a8d6e59265e36fbf",alias:"transportation-to-work"},{id:"89c6ff4d96de4acaa024b7a408f186b0",alias:"health-care"},{id:"0fa71e0a74294e7b8265e4cd507c7d17",
alias:"executive-summary-call-outs"},{id:"f2754d21223a491798dbc0ef2c71858f",alias:"tapestry-profile"},{id:"866e6a839ee348dfae5a8ee9bdafbfc0",alias:"nearby-restaurants"},{id:"f808dfceddd149ff85a9d8825d4e5a5f",alias:"multi-ring-comparison"}],"CA.census":[{id:"f982018306a34cc58756ce0ed78c6b0c",alias:"key-facts"},{id:"c47fa8d040364abe80d288bb606da576",alias:"multi-ring-comparison"}],"*.census":[{id:"3813621424fc4443af1dcecab65be89c",alias:"key-facts"},{id:"dd1fa81faaf94541831cae16788393ab",alias:"multi-ring-comparison"}]},
"3.27":{"US.census":[{id:"3c6959a7c7c4450f9bdcc7063c9023d5",alias:"demographic-summary"},{id:"4cc0a5e007d946d5909524fcf80bc666",alias:"key-facts"},{id:"fb9b9a501c974540a52ab6d1027a8bcc",alias:"marketing-profile"},{id:"b0f05d5926d6444da40d6bf0c5c9846e",alias:"at-risk-population"},{id:"5cf609b26ce24633a2edc58d7ebeb3fd",alias:"portrait-property-flyer"},{id:"686d7af60bcb410db051ec8465889231",alias:"skyscraper"},{id:"a79a099ab7be4c34a9b0b28831b1aa9c",alias:"transportation-to-work"},{id:"6f64bb63647246dcb5d268fc301614f6",
alias:"health-care"},{id:"99e919a7e9fd4fa2b55779f0dc118da8",alias:"executive-summary-call-outs"},{id:"f32b961757f347e2976ba011ee20cb13",alias:"tapestry-profile"},{id:"a266260cc3ec46c1b66c86f263feb8e4",alias:"nearby-restaurants"},{id:"dab290529fd44063a2d83e03a8dc49eb",alias:"multi-ring-comparison"},{id:"1499719e83754c81ae1477223c0dde39",alias:"property-details"},{id:"9c441f80f80348c8b5b747e2cf2a2ccd",alias:"employment-overview"},{id:"bb59cd9292ec47a0928900c5fb9c17b8",alias:"office-market-profile"},
{id:"6f75892c4a5f4f5ba3d0edb4d8a0b13b",alias:"health-care-and-insurance"},{id:"a7524b019e1f482493e43f32ab9568a0",alias:"demographic-profile"},{id:"45d528a3865547bb89792d4517db2e7a",alias:"commute-profile"},{id:"acf5c12b54b64550ad7f582c9c97ed28",alias:"target-market-summary"},{id:"489d923d29d44c2681171a590fb37742",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"91d1e8c9d0ea482b9947dfe4bdfbe0ba",alias:"key-facts"},{id:"e05eb227df9b4ceba0ace202b1d0c1e2",alias:"multi-ring-comparison"}],"NL.NLD_4orange":[{id:"77e9461032b24e47b6c6b643cf02381f",
alias:"housing-profile"},{id:"b80fd38e5f43448da530521832e0dfba",alias:"insurance-profile"},{id:"d36520d68d8e449c9f300be0e800f698",alias:"media-profile"},{id:"bad567fdf36e48e9a5108b66c96bf0ae",alias:"personicx-segmentation"},{id:"5726fe6cad4c491a863eff64e538231c",alias:"spending-profile"}],"JP.EsriJapan":[{id:"e4bd37bb10c74798a3600ca7484846ac",alias:"base-demographic-profile"},{id:"a5d7db5138644a9e95d9af1b40b31bb9",alias:"demographic-comparison-profile"},{id:"205b45f626f84650a1ca948be4f97411",alias:"future-population-profile"},
{id:"ee12a9d9a2e04fb6b93628f075719bc9",alias:"population-households-profile"},{id:"3f857a2a8d14488abfcec383197e5a0b",alias:"consumer-spending-profile"},{id:"77369125467c4c9a8f3b9a628eda3347",alias:"base-demographic-profile-ja"},{id:"08abfdb8b8174846bd3723f094a88d86",alias:"demographic-comparison-profile-ja"},{id:"e5db2ced023d4c53a0ef9fe231d7fd15",alias:"future-population-profile-ja"},{id:"4c55f8ddb53345298e59bccfeb45e489",alias:"population-households-profile-ja"},{id:"24c8ef9a8c5d45c78791a84445eed29d",
alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"7aa819f9816a494ab28ab7604553f488",alias:"base-demographic-profile"},{id:"710051b492c3481a83e01bd6bf3dd3bf",alias:"household-profile"}],"ES.ESP_AIS":[{id:"3d046bf33ce04b598afd391a0dd195c9",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"d8b9f282034d47db808175fef56a15e2",alias:"at-risk-population"},{id:"eab5646a29324a6282db3b8ca47bf2b3",alias:"commute-profile"},{id:"ed6b5a0736aa4e04862a1a4307c608cc",alias:"demographic-summary"},
{id:"a4c64a9006544751ad18ce75a401112e",alias:"health-care-and-insurance"},{id:"96d00aefd766428394d6ee6698a56591",alias:"coronavirus-impact-planning"}],"*.census":[{id:"365d52e6bac147a68a12eee229eb9b6b",alias:"key-facts"},{id:"0f7d2ba850fa40579cae1342001d80d7",alias:"multi-ring-comparison"}]},"3.28":{"US.census":[{id:"45cb423066194f5f98c6f4ff81124db3",alias:"demographic-summary"},{id:"98d5848a944b4787b2ca038256c7878d",alias:"key-facts"},{id:"879849b937ec4eb0bef31ff2861251f2",alias:"marketing-profile"},
{id:"456d7a22adc8439a93d4164ed3846243",alias:"at-risk-population"},{id:"c7e01c953c7e4b70a46ca6408c3ed000",alias:"portrait-property-flyer"},{id:"34330a47546f412d9d09632347da11d3",alias:"skyscraper"},{id:"d349b23334454274ab2a7a20a0a9a55d",alias:"transportation-to-work"},{id:"02086fe6b92b4ff5a9a7a8d172540fc9",alias:"health-care"},{id:"5d8b51e2b27b4832b193d9932bc6f862",alias:"executive-summary-call-outs"},{id:"1b07c48d4b58423990023b43150d7e99",alias:"tapestry-profile"},{id:"c21dd81cd9064649a4bb454530f12790",
alias:"nearby-restaurants"},{id:"4d8c102ca7324d09931cfe65ab3a1168",alias:"multi-area-comparison"},{id:"9ed3b5dba02d4b46a3e063c8405fd0cc",alias:"property-details"},{id:"db0606e41ee7485f88122069e74a9b6b",alias:"employment-overview"},{id:"2a43c204c1dd4a758087372d7d7d786b",alias:"office-market-profile"},{id:"f59a3621583d44bbafa14035c2ae3947",alias:"health-care-and-insurance"},{id:"ad58f06a480c4b16aadcff789f543cca",alias:"demographic-profile"},{id:"bd7390ab31dc485489733d22475db0ed",alias:"commute-profile"},
{id:"38eab30d7e6840da869fee264ca9fc40",alias:"target-market-summary"},{id:"03b420681f6a466fb14e254669583244",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"6c0a945e91d44640a08776e5bed1b297",alias:"key-facts"},{id:"7464708f379b463c8eec8aed1315989f",alias:"multi-area-comparison"},{id:"425150e63a5346659721bfc0be94511b",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"e602295128e34ea2b2b50a1aa04253bf",alias:"housing-profile"},{id:"3d0f7e63256b43a59fcf037502380685",alias:"insurance-profile"},{id:"fbc685a8837945eb82cde447acfda982",
alias:"media-profile"},{id:"da063bf765e341708fad9eeec07b09c7",alias:"personicx-segmentation"},{id:"5003049227804e5cba6ad3bfdbf2dba7",alias:"spending-profile"}],"JP.EsriJapan":[{id:"bd9685651f484488ba24c2838a6a9000",alias:"base-demographic-profile"},{id:"f36b1cc0b9d84ea4b4db1742e875ff80",alias:"demographic-comparison-profile"},{id:"99a48ec44af94af290ab0e6d691a31c7",alias:"future-population-profile"},{id:"b29af5c2e6754f61ba38ad3128668095",alias:"population-households-profile"},{id:"d568dd78527c462e83eb68cb9ca02f09",
alias:"consumer-spending-profile"},{id:"a29c9143bd044dad9475e6b6ee292e46",alias:"base-demographic-profile-ja"},{id:"3bb56ea4c4bd4a2aaa124e2e3a0fad60",alias:"demographic-comparison-profile-ja"},{id:"28ef1772bd884db5ae8885731318e503",alias:"future-population-profile-ja"},{id:"7896c8adf89e4f47ab6e0acc7759a1cd",alias:"population-households-profile-ja"},{id:"6c28a650baaa40cda26f4fb372b14d0f",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"31cf6eac0339433f8b4b5f8b62e47554",alias:"base-demographic-profile"},
{id:"ccf6bc8472ae4ca8852fec621197fec3",alias:"household-profile"}],"ES.ESP_AIS":[{id:"5b60de05c1694a78b6b6ce8e10a48cd4",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"f1d79448541642648293f4b75d7b595a",alias:"at-risk-population"},{id:"7943a0c2f1ca4cad967bb0bfeb8af3a4",alias:"commute-profile"},{id:"ef0579311aac4d14a771389f23263445",alias:"demographic-summary"},{id:"4edd44657989475493ca92a69e80f08c",alias:"health-care-and-insurance"},{id:"c440f0c671264732b16c39f6326a5987",alias:"coronavirus-impact-planning"}],
"*.census":[{id:"5886dbf41f984a0a8ec4eb4b5e231584",alias:"key-facts"},{id:"41727f86773c4cf2a37fd99446ea83fc",alias:"multi-area-comparison"}]},"3.29":{"US.census":[{id:"368e2bf603fb42c4aa3dac0fce50cdf8",alias:"demographic-summary"},{id:"a32be4a9e51d4affa4cc1ddc812cb629",alias:"key-facts"},{id:"df985e2579004a3292c3d00615d53c39",alias:"marketing-profile"},{id:"8c56287427f84ae8b59142fc5bf1df4c",alias:"at-risk-population"},{id:"d95e40c3c93d480ab4d1d0b0adbbc5d4",alias:"portrait-property-flyer"},{id:"f989f9b820cd44d390187402447051b4",
alias:"skyscraper"},{id:"0d322ac073584079a8cd6a1bda981fe7",alias:"transportation-to-work"},{id:"2b9f186425844ec390584b739ffca026",alias:"health-care"},{id:"3e9ccce6cca64e70be19ed789de5f290",alias:"executive-summary-call-outs"},{id:"2a812da4de404ceba3969472d32c42e7",alias:"tapestry-profile"},{id:"2cc25f7b5f194012b39c90b5f9bdb8d3",alias:"nearby-restaurants"},{id:"72d1e9e4cdf94bf9a2020f8214bef9ca",alias:"multi-area-comparison"},{id:"27034d31ab124b9bbe4e63b7df2a0d90",alias:"property-details"},{id:"4a59e329df06480eaa534513eb15f465",
alias:"employment-overview"},{id:"d4fe343c4d6f4bea840a715f5b033d2d",alias:"office-market-profile"},{id:"cb2224cc9cb24ce288da729f0650ebf0",alias:"health-care-and-insurance"},{id:"484825ed241c49d58eaf718d46772051",alias:"demographic-profile"},{id:"afee0a2eb16e46cc9bc61b5d82133249",alias:"commute-profile"},{id:"1d32fabd95b446e99049aa0a04f5508e",alias:"target-market-summary"},{id:"783847f3f03f402d855985b45a8bf2df",alias:"population-trends"},{id:"83aef26e61ca41da9b269c06cc418d79",alias:"coronavirus-impact-planning"}],
"CA.census":[{id:"73f1c835b1624ff0b29a6a364f7ba6dc",alias:"key-facts"},{id:"84b05aed2d2f478eb6bb1e4749811cf1",alias:"multi-area-comparison"},{id:"ea0737e1e7554c5caf2be381c28369cc",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"3d8cb941742d4fffbaca48c65b4bd5b5",alias:"housing-profile"},{id:"f126395e7bcc494899cfc1a13a34be1f",alias:"insurance-profile"},{id:"8da901e5729e457683f2e4f7081b1bda",alias:"media-profile"},{id:"f9ba90b373a245e1b8fd14a027cf1ba5",alias:"personicx-segmentation"},{id:"81fc53b93a0c4269848ce2ae22ec19e2",
alias:"spending-profile"}],"JP.EsriJapan":[{id:"79b2394ea50d44f3b4c1b4bdabed6cc2",alias:"base-demographic-profile"},{id:"9e824283a8954639ab0c0ac237b9e14d",alias:"demographic-comparison-profile"},{id:"f5812c2f542644368c0ff34eef7b731c",alias:"future-population-profile"},{id:"b51d7dde64c34a9796418c1788a6762d",alias:"population-households-profile"},{id:"48a993403d30431784b7bf47a06e4261",alias:"consumer-spending-profile"},{id:"531c59f55de646d5a78fef6c903a678f",alias:"base-demographic-profile-ja"},{id:"cf553f2090a64662a1f9efa8a355964c",
alias:"demographic-comparison-profile-ja"},{id:"321150c8ac1049fc9cd253cb12c0b0bc",alias:"future-population-profile-ja"},{id:"e0d6dea7667c47b49f159c207fc311e9",alias:"population-households-profile-ja"},{id:"ba5f50bd617e4519a9322ec24b9cd5b1",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"60ec4173caac4f87a831447d5bf7b450",alias:"base-demographic-profile"},{id:"98d3d99aadba47a8ab53b0dcd4eebf22",alias:"household-profile"}],"ES.ESP_AIS":[{id:"3978b02fbc354acca14d4e959fa5b531",alias:"base-demographic-profile"}],
"PR.PRI_ACS_2020":[{id:"e2141ddd911c4aadb403db1e858edb51",alias:"at-risk-population"},{id:"78360505668743e0a39ac0d085612dfa",alias:"commute-profile"},{id:"f296deceb6204f85853ac85e98ba3552",alias:"demographic-summary"},{id:"8a1c4d55a77c4cf9805cec380727fc5a",alias:"health-care-and-insurance"},{id:"8dd9de996ba0491d82a2ee8f01cd55b0",alias:"coronavirus-impact-planning"}],"*.census":[{id:"5645a1d6023c4d8a9d02943ad57a7ab2",alias:"key-facts"},{id:"e29f56b6d67447e08a45d08981db987c",alias:"multi-area-comparison"}]},
"3.30":{"US.census":[{id:"981382ffe90c40bbb60318b1ce338ba4",alias:"demographic-summary"},{id:"f62dec6c9750496796fdc0619c4c107f",alias:"key-facts"},{id:"f737236a8b644f1597a4457862fa169c",alias:"marketing-profile"},{id:"4746caa1254e4d93af121ce74e9aa8d6",alias:"at-risk-population"},{id:"0bcd882dd7a34fd39ace173243534df0",alias:"portrait-property-flyer"},{id:"4a340b8e642945f6bb7a381d07fb26b6",alias:"skyscraper"},{id:"3e2a42b2d03e42cf91e9727f67273ec3",alias:"transportation-to-work"},{id:"c26e9577d48b4499a07b75215c97c394",
alias:"health-care"},{id:"cbc348e601104d0c9bbe971c0297142a",alias:"executive-summary-call-outs"},{id:"d65aaa42b9824864b40eb1a75f2e4cbd",alias:"tapestry-profile"},{id:"d6242e8dd02142bdb98b85f094d5cd9b",alias:"nearby-restaurants"},{id:"aed9e00873fa4010881daaa90e7e8d71",alias:"multi-area-comparison"},{id:"eb0e0df0856e43cdb874f96945c566ac",alias:"property-details"},{id:"e29ebec17c2c4f42a1a929c40163bb90",alias:"employment-overview"},{id:"b84d0f0f5c69461ea52ce2702f7327d6",alias:"office-market-profile"},
{id:"5eba537af36e4490869917ee888bacc4",alias:"health-care-and-insurance"},{id:"afb01a3f91374f65ba4c6be9229f2c15",alias:"demographic-profile"},{id:"8074d1bbbfed4858bb24400a0c7bf224",alias:"commute-profile"},{id:"33621d85b1df4547851c904aaa7d44d2",alias:"target-market-summary"},{id:"440170eaae5240e79abbb0bb7de22b27",alias:"population-trends"},{id:"0576deee38714cc69357de9675ab39ae",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"e054928366604fc7b401dcb4a343cd4c",alias:"key-facts"},{id:"986bc92490234c2697d5771b9771166e",
alias:"multi-area-comparison"},{id:"52233708250449bc84f906d86616cace",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"22a86d0f982d4b10934f32129f2674f9",alias:"housing-profile"},{id:"9811b2babd5f4283822782867476b92c",alias:"insurance-profile"},{id:"59957cc0524344449fc6035053bb6c4a",alias:"media-profile"},{id:"2511035fed0140b8a7eb7ec7240e41eb",alias:"personicx-segmentation"},{id:"defc390648e543508be22704f1db659c",alias:"spending-profile"}],"JP.EsriJapan":[{id:"91a180442f614c4d96fb40e33aa30948",alias:"base-demographic-profile"},
{id:"e7415b6c9ff74922850851eac65ddbc6",alias:"demographic-comparison-profile"},{id:"12e9eb63e4834d3681e15196bfc64642",alias:"future-population-profile"},{id:"291cc1bc2cee455483c96f50e5916f1d",alias:"population-households-profile"},{id:"217c72b7d0534ebc81658c71917c3e15",alias:"consumer-spending-profile"},{id:"48d5baf8e5574abda8fd776219fa0eb6",alias:"base-demographic-profile-ja"},{id:"01a7a0cbacf948b3b715e4f6c55aa5f2",alias:"demographic-comparison-profile-ja"},{id:"0317412d6fb541c9b4067923e314cad3",
alias:"future-population-profile-ja"},{id:"0c826ce1e2de415aa2f7af3e615b1fe8",alias:"population-households-profile-ja"},{id:"201211e23758432db4a841dae8ba9428",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"ec6477ce41fa464fb38a360cad0d3da3",alias:"base-demographic-profile"},{id:"e53b2c145f544efaa7d7b4e802c3d747",alias:"household-profile"}],"ES.ESP_AIS":[{id:"4483924cb42043ec85486c58e61a99ef",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"7e3b955c4d904624b4cea5d015e693a0",alias:"at-risk-population"},
{id:"8927492627124fd0845de8c0dc02bd3f",alias:"commute-profile"},{id:"a308a300f3b4482ea57b4ea4a54ea5ef",alias:"demographic-summary"},{id:"5800acd3784e4a6d88e3228e1af1164f",alias:"health-care-and-insurance"},{id:"d40e2ba95fec40c6ad68ceddde4e160b",alias:"coronavirus-impact-planning"}],"*.census":[{id:"b9d1ca815d9a4a3ab35196ec299f0917",alias:"key-facts"},{id:"6f6d601c2eef4bd1a87baa2652e7bb0b",alias:"multi-area-comparison"}]},"3.31":{"US.census":[{id:"784d0b69c02c4cac862b89b0e44cd8fb",alias:"demographic-summary"},
{id:"f1bb3a222fab470dbb96a79a51496b2b",alias:"key-facts"},{id:"1780d5b264734757b86e4655d779b213",alias:"at-risk-population"},{id:"8c34121585894e91a50c493c360912f0",alias:"skyscraper"},{id:"1c314d9d06844d44b408caba6099b56b",alias:"executive-summary-call-outs"},{id:"4ee838a250084c9bad84f094895c793c",alias:"tapestry-profile"},{id:"dfba27ac04694513aee257cdd185c8c2",alias:"nearby-restaurants"},{id:"d7cfb836282747199cf0febea42627cc",alias:"multi-area-comparison"},{id:"3a34213116a340a0bbd0d463025444a2",
alias:"property-details"},{id:"b277b8572469425fa54c5506c3dbcdf3",alias:"employment-overview"},{id:"eaf35c41f5714f48a1aa61fcbd6ae05f",alias:"office-market-profile"},{id:"688f86931cc345f796154717dc6d0a15",alias:"health-care-and-insurance"},{id:"cb4edb43a1ae473ca651388b5c3fa54f",alias:"demographic-profile"},{id:"49224c10d4ac4c7ab0f8e016165ce235",alias:"commute-profile"},{id:"db67445e4dfa4b6c8c1e5fd30b229c92",alias:"target-market-summary"},{id:"6c9360bfec9041ddba0f03440cb446ca",alias:"population-trends"},
{id:"2ae07567c78847abacb14773ffe9dede",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"0704defc6960439ea5b9c484af15eb4c",alias:"key-facts"},{id:"ee01fe05db964878bc6fb627e55dc9b1",alias:"multi-area-comparison"},{id:"a426bb6d944a46658640aee2ba480866",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"710037ca0f024ec5abbe4cf9fecad23f",alias:"housing-profile"},{id:"83bc643ea48344c892a8e9636e3677dd",alias:"insurance-profile"},{id:"53f63e3a9e854a8fa5e2c0222df6f848",alias:"media-profile"},{id:"ca9d66bf4bf940918129d0d5c97e0b50",
alias:"personicx-segmentation"},{id:"ab19f90750fd469aa702f961b12eaee8",alias:"spending-profile"}],"JP.EsriJapan":[{id:"7f7c37e8f1fa4ab18b88368c12058eff",alias:"base-demographic-profile"},{id:"25a71f196b7e4db182be346264b442dd",alias:"demographic-comparison-profile"},{id:"e1075eaada7744a59ecabfc445dcd877",alias:"future-population-profile"},{id:"8e2746d993584a7d94d0e66ca6dabdaa",alias:"population-households-profile"},{id:"bc9b91d7ae2c41a5bdece1d322ef6b88",alias:"consumer-spending-profile"},{id:"4f4736d5b2f842faaee83c57417c56b6",
alias:"base-demographic-profile-ja"},{id:"bc400448bf3347619349cb7d4ccb3d87",alias:"demographic-comparison-profile-ja"},{id:"00ad3ad05e384d7ea764b356a950356d",alias:"future-population-profile-ja"},{id:"db94d6af598f48778c4471f9fa0d6e4f",alias:"population-households-profile-ja"},{id:"c5f602a9d6714dd6bd6a2b720eced874",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"b0cd9df36d0747ecac2bc34f055f5583",alias:"base-demographic-profile"},{id:"1751ab1998db4e6fb79f484069605cfd",alias:"household-profile"}],
"ES.ESP_AIS":[{id:"3d17356c9a5549dbaa4096365e7eb703",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"7923818907d248ff8dcd7a5941e89b57",alias:"at-risk-population"},{id:"c0b28d710379405eac4ecb6a64d817b4",alias:"commute-profile"},{id:"4b64ec164a3d4830ae8a4cedf067f55a",alias:"demographic-summary"},{id:"5e47986d4c4644a29a28c92c077919f2",alias:"health-care-and-insurance"},{id:"11c43309216b4d4a8fbd9a03cbcc22ec",alias:"coronavirus-impact-planning"}],"*.census":[{id:"f2d46b136acc46e2a2220388ddc43be0",
alias:"key-facts"},{id:"228155af0095410c961cc82f33cdcf49",alias:"multi-area-comparison"}]},"3.32":{"US.census":[{id:"2ff58abf55554be4b19006c1e607afaa",alias:"demographic-summary"},{id:"a19b321e3adc441886e706bb9704005c",alias:"key-facts"},{id:"f1e3b0c93e1d44e299eb0b752f93b7db",alias:"at-risk-population"},{id:"3bbc96da4ca142c7b80b082b0f986110",alias:"skyscraper"},{id:"1302184a2f584b86943b6c51d40acace",alias:"executive-summary-call-outs"},{id:"58035dcee74b4875bcd951b9174155d1",alias:"tapestry-profile"},
{id:"4da5867dfda046ddb4b82ab01b7cb568",alias:"nearby-restaurants"},{id:"4498b9e35665480cafe3985f788ca61d",alias:"multi-area-comparison"},{id:"83a11d5f38f84e709ff1e24786e963b4",alias:"property-details"},{id:"0a0354d2d0d842d8bd8e05d40545fc5b",alias:"employment-overview"},{id:"400924aa9d5f4bee8b9dd0c0af21dfbb",alias:"office-market-profile"},{id:"0a502ea9be8a43fdb6cd2fb5ff7503bc",alias:"health-care-and-insurance"},{id:"6147ac21718149a69ce15831f12181ed",alias:"demographic-profile"},{id:"4cdaddd947064ca690ebc06eec06ea57",
alias:"commute-profile"},{id:"a8fe08a9c5114260a2a6f7ca436d36f6",alias:"target-market-summary"},{id:"34a17e1fceb646228e94089ec5e0890f",alias:"population-trends"},{id:"eb5d984d78364a6596cd97e0bf7901a5",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"5f6e17f3729145959fb38ed2cd508970",alias:"key-facts"},{id:"c86709cbd72043708e09e4a641adfbd0",alias:"multi-area-comparison"},{id:"bd9e3a17678843d4b1fa0716af91c231",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"470686f333d140c7b516294465eea037",alias:"housing-profile"},
{id:"ab11f2f11ea3439197769a8189451bea",alias:"insurance-profile"},{id:"f0e6736d0f364d4b88ea613746e57c81",alias:"media-profile"},{id:"bfe0814bc0604a8faa48d01b026ef7a5",alias:"personicx-segmentation"},{id:"bd1d4c7be5ad41ae909267b5e9c5f2dc",alias:"spending-profile"}],"JP.EsriJapan":[{id:"b9dcbb9f31fd4be7bd96a2f89ce66a1c",alias:"base-demographic-profile"},{id:"830ddad066c14c0dad27367a1b2ef132",alias:"demographic-comparison-profile"},{id:"7574f89d591f432da6ffdb94dcfdac52",alias:"future-population-profile"},
{id:"ec8785d4c9cb446394e07fa7dd8451fd",alias:"population-households-profile"},{id:"9ac85d73187548b2bb0d0b4a73f88199",alias:"consumer-spending-profile"},{id:"e99eee823684452fbe564fe42dac9535",alias:"base-demographic-profile-ja"},{id:"8598d6a8550d46aebd3fd598ceaefae7",alias:"demographic-comparison-profile-ja"},{id:"fdf81ddffb374e3f898006ffa59e259e",alias:"future-population-profile-ja"},{id:"f2468c2fef314427bd0865b460ef554f",alias:"population-households-profile-ja"},{id:"a96f28fb67024109b7c33161f3c9b308",
alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"40a5ba79d1204e78ac6deaa633ccd59b",alias:"base-demographic-profile"},{id:"2e647098c613476bbd92b1e07331cb86",alias:"household-profile"}],"ES.ESP_AIS":[{id:"7d82cae4b3fc4575bab56ec82f51c368",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"aa65005b75ba4e158afe63baa4bc5fe2",alias:"at-risk-population"},{id:"292a269a813e4d7797baf88a76c11a8c",alias:"commute-profile"},{id:"b1d50628f2484689b9e39d49fc2e16a0",alias:"demographic-summary"},
{id:"64839b7a81be45e287e805afc145652e",alias:"health-care-and-insurance"},{id:"44be3c42b70c4aee840fdeb4656b7922",alias:"coronavirus-impact-planning"}],"*.census":[{id:"ce57630d5cc24759809dd54bc1f82c91",alias:"key-facts"},{id:"c48ee0f58c8645bf8d689eb0db2d2936",alias:"multi-area-comparison"}]},"3.33":{"US.census":[{id:"55689c3ee7c1490e83accae002a8d164",alias:"demographic-summary"},{id:"173e40bebc9d426a8e4680242acafea4",alias:"key-facts"},{id:"218eba57314e476ba16d1d5d40bb0182",alias:"at-risk-population"},
{id:"3d470c82d8664e34b5026675596a7a87",alias:"skyscraper"},{id:"b9381f481f9f417f9647e0a2c8686979",alias:"executive-summary-call-outs"},{id:"d2800b578d1c4dd38ac95ce36882d881",alias:"tapestry-profile"},{id:"d9d8109c537943a78a24d65110291b43",alias:"nearby-restaurants"},{id:"2e835e58629a4f1e8192a729792b638f",alias:"multi-area-comparison"},{id:"6f3c32ed18834a4ea34b200e32ad7c33",alias:"property-details"},{id:"6b1267be3fcb401bbcb49afd221713cf",alias:"employment-overview"},{id:"67e6efc15cb142c2a7cc30a48a59c769",
alias:"office-market-profile"},{id:"9d8b447adc634228b24deb315107c0f0",alias:"health-care-and-insurance"},{id:"e45f96db738140869981b7443b6e2658",alias:"demographic-profile"},{id:"88d896eada3340dc8f8f1a2406bd48f9",alias:"commute-profile"},{id:"61492956f89a43ee86d245fca92858a2",alias:"target-market-summary"},{id:"91de69dede414856892dfdd94d2c4bab",alias:"population-trends"},{id:"ee9c6fdc902e4ea09509e4d1bf1582b5",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"dfb663da790248fe89504c662c42aae3",
alias:"key-facts"},{id:"9873fcafe7194fcf9dffa8bbb8e001a1",alias:"multi-area-comparison"},{id:"4766ad797ef84968be4b4d0d54b98416",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"2212ff30c72143e6bcd9b8f26b01c47f",alias:"housing-profile"},{id:"c5efcef364ac4d8f82a6d54010ff75c7",alias:"insurance-profile"},{id:"e00894c000a94c42aefce551fe4e48c2",alias:"media-profile"},{id:"9d1da1c80e93407cb94589cee43a0f5a",alias:"personicx-segmentation"},{id:"578199262aa646bf8b0713f3f2160af6",alias:"spending-profile"}],"JP.EsriJapan":[{id:"00bd747c0e48477d8df692848560a8a2",
alias:"base-demographic-profile"},{id:"8ac4bd99dd1848dc98967419ab8d299c",alias:"demographic-comparison-profile"},{id:"88f94b5e3b6d414d913957b46e9f8394",alias:"future-population-profile"},{id:"41864cea64f3432a90006eb9a1f97608",alias:"population-households-profile"},{id:"44333ddcda38473d9a24010ed387eda7",alias:"consumer-spending-profile"},{id:"c35ebbeffb3b47fc9bbe3fc6283aaa7b",alias:"base-demographic-profile-ja"},{id:"6c8a565d12954927b83daaad81409a25",alias:"demographic-comparison-profile-ja"},{id:"fcba5d5750514c9c93b2cb5222609d98",
alias:"future-population-profile-ja"},{id:"7ad858351b6b4268b791b6cc24bf4e0f",alias:"population-households-profile-ja"},{id:"7d94fec6df6b4bff9ad14f5b711f18c6",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"571f323738c44d5a8b85d6d1e78d9c52",alias:"base-demographic-profile"},{id:"ef7624e051b6407488d8ad59b7979fc4",alias:"household-profile"}],"ES.ESP_AIS":[{id:"46e9329c7b2042fa84dfc1444f7decc0",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"0cb7ba4d407640ff967829ae7dd39396",alias:"at-risk-population"},
{id:"7598826f28124abf9134801a607d56ce",alias:"commute-profile"},{id:"848c5cc8a4284065a0055b047a106adf",alias:"demographic-summary"},{id:"ecfc8db522004ea6848667e43589efd9",alias:"health-care-and-insurance"},{id:"4685d4c6c51e4ef392bdab89c0af8979",alias:"coronavirus-impact-planning"}],"*.census":[{id:"e4d3d1675d0044089f98a0f85ea16c8b",alias:"key-facts"},{id:"33b6e27f43644811b8a58f15c0832a67",alias:"multi-area-comparison"}]},"3.34":{"US.census":[{id:"13cd4abfa97e43b9a5f9d4ddcb43f492",alias:"demographic-summary"},
{id:"8861429ac06948f79cdcaaadb39d597f",alias:"key-facts"},{id:"1056cbef133f49a18409a192fbdc221a",alias:"at-risk-population"},{id:"25145b3ca4284dcc999c8d05182588cd",alias:"skyscraper"},{id:"7db2109b9f844be48f3e9154e992699f",alias:"executive-summary-call-outs"},{id:"f43c00c7b10241c097fb71fd5acf1ec2",alias:"tapestry-profile"},{id:"5fb04926a70345c18d6e21d9972ea347",alias:"nearby-restaurants"},{id:"fdd0406e7815402cbf70716c68f4f7d6",alias:"multi-area-comparison"},{id:"7b716975146743b3a56762befaca71ad",
alias:"property-details"},{id:"2c0be4fe4d7245e39b4afd9b8eb607a9",alias:"employment-overview"},{id:"c7f42910bc4b49209835e333c6078e71",alias:"office-market-profile"},{id:"7517a7a0409d42748c7ad94f81322bc2",alias:"health-care-and-insurance"},{id:"9919270d8b4846cb86761103def73e76",alias:"demographic-profile"},{id:"0bb0cc183ae145febbf3585518eeaae6",alias:"commute-profile"},{id:"27853eda823e4574b0666d533ba39061",alias:"target-market-summary"},{id:"1df7c5b56b6e431982ef2da037c081c8",alias:"population-trends"},
{id:"aaf4cc69e58f43ea87a0c1e493431dd8",alias:"coronavirus-impact-planning"}],"CA.census":[{id:"3a2fb82b034d48bbb9474f8c158c32a8",alias:"key-facts"},{id:"100f5b4d3cca46b38fd651e39cce97b1",alias:"multi-area-comparison"},{id:"41f7b7cfe9cb490593ace88aa627c6ca",alias:"prizm-profile"}],"NL.NLD_4orange":[{id:"f5b0ec07181f4b58a01ee0ca1df8201a",alias:"housing-profile"},{id:"a5e0b9b228da4ba5baaa5811c57f6552",alias:"insurance-profile"},{id:"5d24250e3cc14b0db3b3f9884462efbf",alias:"media-profile"},{id:"f216c6574ae0453c951e66ee8fb6b20f",
alias:"personicx-segmentation"},{id:"267c816948334e72ab9ed94253790e22",alias:"spending-profile"}],"JP.EsriJapan":[{id:"434e01eacc8e432c8400f5a5aef6f3e4",alias:"base-demographic-profile"},{id:"c44be13f1f8e412288e58048136681d6",alias:"demographic-comparison-profile"},{id:"35c0c12ce88645e7b7cbc0ffe73af85d",alias:"future-population-profile"},{id:"e87fb84cffaa49dba14b104d5b994aa5",alias:"population-households-profile"},{id:"31a4988db08c41d6b9ce755b21ea0b26",alias:"consumer-spending-profile"},{id:"bf9f0203a4c14d03823beadb3f7ac043",
alias:"base-demographic-profile-ja"},{id:"fdbe0d4286ab419981bc80a96b46bdb1",alias:"demographic-comparison-profile-ja"},{id:"7541a90960e345308f73e99e4da5c0a8",alias:"future-population-profile-ja"},{id:"f17ecec5cb8d4baeab7af68e1e9ce683",alias:"population-households-profile-ja"},{id:"ddaf4fb6c09447f6beaf4218139bfa20",alias:"consumer-spending-profile-ja"}],"DE.DEU_Nexiga":[{id:"80c74804e91440f08695ba11456f96af",alias:"base-demographic-profile"},{id:"eb49e7ee98f04e1e914a4ce29bbfc7d3",alias:"household-profile"}],
"ES.ESP_AIS":[{id:"2e82d587530548569ad792556044342b",alias:"base-demographic-profile"}],"PR.PRI_ACS_2020":[{id:"b473aa30469e4e2eabcca3da3f306e94",alias:"at-risk-population"},{id:"4e91594fb4fe4bf3be24380408f1b0c6",alias:"commute-profile"},{id:"321c818398684510ac62e3403ad6628f",alias:"demographic-summary"},{id:"1c3d60191b12460ca9a23dfcbce0c1db",alias:"health-care-and-insurance"},{id:"5e6d78b1c4aa4168b7a3af5751d92261",alias:"coronavirus-impact-planning"}],"*.census":[{id:"530b6aa054664166a7a3ab5f1e82e19b",
alias:"key-facts"},{id:"4b8ddef8e8f0406ea9b0a6c3d062186a",alias:"multi-area-comparison"}]}}}function d(a){a=a||h.jsapiVersion;var b={};a=e()[a];for(var c in a){var d={};a[c].forEach(function(a){d[a.alias]=a.id});var f=c.substr(0,c.indexOf("."));b[f]=d}return b}function b(a,b){b=d(b);return l.mixin({},b["*"],b[a])}g=g.geoenrichment.dijit.ReportPlayer.StandardTemplates;var a,c={"demographic-summary":g.demographicSummary,"key-facts":g.keyFacts,"marketing-profile":g.marketingProfile,"at-risk-population":g.atRiskPopulation,
"portrait-property-flyer":g.portraitPropertyFlyer,skyscraper:g.skyscraper,"transportation-to-work":g.transportationToWork,"health-care":g.healthCare,"executive-summary-call-outs":g.executiveSummaryCallOuts,"tapestry-profile":g.tapestryProfile,"nearby-restaurants":g.nearbyRestaurants,"multi-area-comparison":g.multiAreaComparison,"property-details":g.propertyDetails,"employment-overview":g.employmentOverview,"office-market-profile":g.officeMarketProfile,"health-care-and-insurance":g.healthCareAndInsuranceStatistics,
"demographic-profile":g.demographicProfile,"commute-profile":g.commuteProfile,"target-market-summary":g.targetMarketSummary,"population-trends":g.populationTrends,"coronavirus-impact-planning":g.coronavirusImpactPlanning,"prizm-profile":g.prizmProfile,"housing-profile":g.housingProfile,"insurance-profile":g.insuranceProfile,"media-profile":g.mediaProfile,"personicx-segmentation":g.personicxSegmentation,"spending-profile":g.spendingProfile,"base-demographic-profile":g.baseDemographicProfile,"demographic-comparison-profile":g.demographicComparisonProfile,
"future-population-profile":g.futurePopulationProfile,"population-households-profile":g.populationHouseholdsProfile,"consumer-spending-profile":g.consumerSpendingProfile,"base-demographic-profile-ja":"\u57fa\u672c\u7d71\u8a08\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb","demographic-comparison-profile-ja":"\u4eba\u53e3\u7d71\u8a08\u6bd4\u8f03\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb","future-population-profile-ja":"\u5c06\u6765\u4eba\u53e3\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb","population-households-profile-ja":"\u4eba\u53e3\u30fb\u4e16\u5e2f\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb",
"consumer-spending-profile-ja":"\u6d88\u8cbb\u984d\u30d7\u30ed\u30d5\u30a1\u30a4\u30eb","household-profile":g.householdProfile},k={portalUrl:"http://www.arcgis.com",user:"esri_reports",query:"http://www.arcgis.com/home/search.html?q\x3downer%3Aesri_reports",aliasToID:function(a,c,d){return b(a,d)[c]},aliasToLabel:function(a){return c[a]},getAliases:function(a,c){a=Object.keys(b(a,c));a.sort(function(a,b){return a.localeCompare(b)});return a},getListOptions:function(a,b){return k.getAliases(a,b).map(function(d){return{value:k.aliasToID(a,
d,b),label:c[d]}})},getSupportedCountries:function(a){return Object.keys(d(a)).map(function(a){return"*"===a?"AU":a})},getLibrary:function(){var a=l.clone(e()),b;for(b in a){var c=a[b];c["AU.census"]=c["*.census"];delete c["*.census"]}return a}};return k})},"esri/dijit/geoenrichment/utils/PortalQueryUtil":function(){define([],function(){var l={combineQueryString:function(h){var g="";h.type&&(g+='type:"'+h.type+'"');h.typeKeywords?g=Array.isArray(h.typeKeywords[0])?g+(" typekeywords:("+h.typeKeywords.map(function(e){return l.combineTypeKeywords(e)}).join(" OR ")+
")"):g+(" typekeywords:"+l.combineTypeKeywords(h.typeKeywords,h.typeKeywordsNot)):h.typeKeywordsNot&&(g+=" typekeywords:"+l.combineTypeKeywords(null,h.typeKeywordsNot));h.owner&&(g+=" owner:"+h.owner);h.isShared&&(g+=h.orgId?" ((orgid:"+h.orgId+' AND access:"public") OR access:"shared" OR access:"org")':' (access:"shared" OR access:"org")');h.ownerNot&&(g+=" NOT owner:"+h.ownerNot);return g},combineTypeKeywords:function(h,g){h=h?l._combineArray(h):"";return g?(g=l._combineArray(g," OR "),"("+h+" NOT "+
g+")"):h},_combineArray:function(h,g){var e="string"===typeof h?h:1===h.length?h[0]:null;return e?"("===e.charAt(0)||'"'===e.charAt(0)?e:'"'+e+'"':"("+h.map(function(d){return'"'+d+'"'}).join(g||" ")+")"}};return l})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/TemplateJsonAnalyzer":function(){define(["./query/TemplateJsonQueryUtil"],function(l){return{collectVariablesStats:function(h){var g={};l.processTemplateFieldInfos(h,function(e){e.infographicJson&&e.infographicJson.variables?
e.infographicJson.variables.forEach(function(d){g[d]=1}):e.hasVariable&&(e.usedMapTos?e.usedMapTos.forEach(function(d){g[d]=1}):e.fullName&&(g[e.fullName]=1))});return g},collectMapItemIds:function(h){var g={};l.calcNumberOfMaps(h,function(d){d.webMapId&&(g[d.webMapId]=1);d.defaultBasemapId&&(g[d.defaultBasemapId]=1)});h=[];for(var e in g)h.push(e);return h}}})},"esri/dijit/geoenrichment/ReportPlayer/core/infographics/utils/InfographicJsonUtil":function(){define(["esri/dijit/geoenrichment/config",
"esri/dijit/geoenrichment/utils/ArrayUtil"],function(l,h){var g={getDefaultLevels:function(){var e=l.levels.slice();e.push(l.highestLevel);return e},getLevels:function(e){e=e.levels&&e.levels.length?e.levels:g.getDefaultLevels();return h.removeDuplicates(e)},getSubLevels:function(e){e=g.getLevels(e);e.pop();return e},getHighestLevel:function(e){e=g.getLevels(e);return e[e.length-1]},setLevels:function(e,d){d=h.removeDuplicates(d||[]);e.levels=d.length?d:g.getDefaultLevels()},getDataDrilling:function(e,
d){"string"!==typeof d&&(d=(d=e.variableTables&&e.variableTables[d])&&d.variable.fieldInfo&&d.variable.fieldInfo.templateName);return e.dataDrilling&&e.dataDrilling[d]},setDataDrilling:function(e,d,b){d&&(e.dataDrilling=e.dataDrilling||{},b?e.dataDrilling[d]=b:delete e.dataDrilling[d])},validateDataDrilling:function(e){var d=e.dataDrilling;if(d){var b={};e.variableTables.forEach(function(a){a.variable&&a.variable.fieldInfo&&a.variable.fieldInfo.templateName&&(b[a.variable.fieldInfo.templateName]=
!0)});Object.keys(d).forEach(function(a){b[a]||delete d[a]})}},analyzeVariables:function(e){e=e.fieldInfos?e.fieldInfos.map(function(a){return a.fullName}):e.variables;if(1===e.length&&-1!==e[0].indexOf(".*"))return{dataCollectionID:e[0].substr(0,e[0].indexOf("."))};var d={},b,a;e.forEach(function(c,e){d[c.substr(0,c.indexOf("."))]=1;b=c.substr(c.indexOf(".")+1);a=c});return{dataCollectionID:1===Object.keys(d).length?Object.keys(d)[0]:null,variableID:1===e.length?b:null,fullName:1===e.length?a:null}}};
return g})},"esri/dijit/geoenrichment/config":function(){define(["esri/urlUtils"],function(l){l=l.getProtocolForWebResource();return{portalUrl:l+"//arcgis.com",server:l+"//geoenrich.arcgis.com/arcgis/rest/services/World/GeoenrichmentServer",levels:["Admin3","Admin2"],highestLevel:"Admin1",locatorUrl:l+"//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",addressFormat:"${Address}, ${City}, ${Region} ${Postal}"}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/AreasPreprocessor":function(){define("dojo/_base/lang esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all dojo/string esri/graphic esri/symbols/jsonUtils ./FeatureNameUtil ../tasks/EnrichAreasTask esri/dijit/geoenrichment/utils/GeometryUtil esri/dijit/geoenrichment/ReportPlayer/config dojo/i18n!esri/nls/jsapi".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n){var m={preprocessAreas:function(b,c){c=c||{};b.analysisAreas=b.analysisAreas.filter(function(a){return a.feature&&a.feature.geometry&&"polygon"===a.feature.geometry.type||a.geographies&&a.geographies.length||a.buffer});-1!==c.analysisAreasLimit&&(c.analysisAreasLimit=c.analysisAreasLimit||20,b.analysisAreas.length=Math.min(b.analysisAreas.length,c.analysisAreasLimit));m.provideAreasIndexes(b);b.analysisAreas.forEach(function(a){a.feature&&!a.feature.attributes&&(a.feature.attributes=
{})});b.analysisAreas.forEach(function(b){b.name=b.name||b.shortName;if(!b.name&&b.feature){var c=a.guessFeatureName(b.feature);c&&(b.name=b.shortName=c)}});return h(p.generalize(b.analysisAreas),function(){return g([q.provideGeographyFeatures(b),t.provideBufferFeatures(b)])})},provideAreasIndexes:function(a){var b=a.combinedAreasInfo.groups,c=b&&b.length;a.analysisAreas.forEach(function(a,d){a.index=d;b&&(b.forEach(function(b,c){-1!==b.indexes.indexOf(d)&&(a.isGrouped=!0,a.groupIndex=c)}),"number"!==
typeof a.groupIndex&&(a.isGrouped=!1,a.groupIndex=c++))})},removeGroupInfo:function(a){a.forEach(function(a){delete a.isGrouped;delete a.groupIndex})}},p={generalize:function(a){var b=[],c=[];a.forEach(function(a,d){!a.feature||a.geographies&&a.geographies.length||(b.push(a.feature),c.push(d))});return h(function(a){function b(a){var b=0;a.geometry.rings.forEach(function(a){b+=a.length});return b}var c,e,g=k.needGeneralizeGeometry(a,f.generalization.factor,f.generalization.maxVerticesInAllFeatures,
f.generalization.numVerticesPerFeature),n;g&&(c=!0,e=[],a=a.map(function(a){e.push(b(a));return new d(a.geometry,a.symbol,a.attributes)}),n=k.generalizeGeometry(a,g,f.generalization.numVerticesPerFeature,!0));return h(n,function(){c&&(console.log("Generalize features:"),a.forEach(function(a,c){console.log("#"+c+" "+e[c]+" \x3d\x3e "+b(a))}));return a})}(b),function(b){c.forEach(function(c){a[c].feature=b.shift()})})}},q={provideGeographyFeatures:function(a){return g(a.analysisAreas.map(function(d){if(!d.feature&&
d.geographies&&d.geographies.length)return(new c).createFeatureForGeographies(d.geographies,{countryID:a.countryID,hierarchy:a.hierarchy}).then(function(a){d.feature=a;d.name=d.name||d.feature.attributes.StdGeographyName;d.description=d.description||n.geoenrichment.dijit.ReportPlayer.ReportPlayer.geography;d.address=d.address||d.name;d.geographies[0].attributes&&l.mixin(d.feature.attributes,d.geographies[0].attributes);if(a=d.geographies[0].symbol)a=a.toJson?a:b.fromJson(a),d.feature.setSymbol(a)})}))}},
t={provideBufferFeatures:function(a){var b=this,d=a.analysisAreas.filter(function(a){return!a.feature&&a.buffer}),f=d.map(function(a){return a.buffer});return(new c).createFeaturesForBuffers(f,{countryID:a.countryID}).then(function(a){a.forEach(function(a,c){c=d[c];c.feature=a;b._applyBufferParamsToArea(c)})})},_applyBufferParamsToArea:function(a){var c=a.buffer;if(!a.name){var d=n.geoenrichment.dijit.bufferTitle.pointRing;d[c.units]&&(a.name=e.substitute(d[c.units],{radius:c.radius}))}a.description=
a.description||"Ring";c.attributes&&l.mixin(a.feature.attributes,c.attributes);if(c=c.symbol)c=c.toJson?c:b.fromJson(c),a.feature.setSymbol(c)}};return m})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/areas/FeatureNameUtil":function(){define([],function(){return{_nameScores:[/^name$/i,/^title$/i,/(^name)|(name$)/i,/(^title)|(title$)/i],guessFeatureName:function(l){var h=Object.keys(l.attributes),g;this._nameScores.some(function(e){return h.some(function(d){if(e.test(d))return g=
d,!0})});return l.attributes[g]||""}}})},"esri/dijit/geoenrichment/utils/GeometryUtil":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/geometry/Polygon esri/workers/WorkerClient ./PolygonUtil ./GeometryUtil_base".split(" "),function(l,h,g,e,d,b){function a(a,b,c){var d=new h,f=new e("./mutableWorker",function(){f.importScripts(["../dijit/geoenrichment/utils/GeometryUtil_worker","../dijit/geoenrichment/utils/GeometryUtil_base"]).then(function(){f.postMessage({rings:a,maxAllowableOffset:c}).then(function(a){var c=
a.rings;b.forEach(function(a){for(var b=a.source.length=0;b<a.count;b++)a.source.push(c.shift())});d.resolve();f.terminate()})})},!0);return d.promise}var c=l.mixin({},b);c.calculateMaxAllowableOffset=function(a,b){void 0===b&&(b=1);return a.extent.getWidth()/a.width*b};c.getNumberOfPoints=d.getNumberOfPoints;c.needGeneralizeGeometry=function(a,b,d,e){if(!a||!b)return!1;e=e||(d?d/10:500);d=d||5E3;Array.isArray(a)||(a=[a]);var f=0>b,k=0,g=Math.abs(b)/100,h=0,n=0,m;a.forEach(function(a){a=a.geometry||
a;if(!a.rings||!a.getExtent)return!1;var e=a.getExtent();if(e=e.getWidth()*e.getHeight())e=Math.sqrt(e),a=c.getNumberOfPoints(a),h+=a,n=Math.max(n,a),f&&(k=Math.max(k,e*g)),m||(m=f?h>d:a*b>4*e)});return m&&n>e?k||b:0};c.generalizeGeometry=function(b,d,e,h){if(!b||!d||0>d)return!1;e=e||500;Array.isArray(b)||(b=[b]);var f=[],k=[];b.map(function(a){var b=a.geometry||a;if(b!=a&&b.rings){a.geometry=new g;a.geometry.setSpatialReference(b.spatialReference);var d=a.geometry.rings}d&&b.rings.forEach(function(a){d.push(a.slice())});
c.getNumberOfPoints(b)>e&&(a=d||b.rings,f=f.concat(a),k.push({source:a,count:a.length}))});if(h&&window.Worker)return a(f,k,d);f.forEach(function(a){(new c.RingInfo(a)).generalize(d,.8)})};return c})},"esri/workers/WorkerClient":function(){define("dojo/Evented dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/request ../sniff ../kernel ../urlUtils require".split(" "),function(l,h,g,e,d,b,a,c,k){var f=window.Blob||window.webkitBlob||window.mozBlob,n=window.URL||window.webkitURL||window.mozURL;
l=h([l],{declaredClass:"esri.workers.WorkerClient",worker:null,returnDeferreds:!1,_queue:null,constructor:function(a,c,d){this._isIE=b("ie");this.returnDeferreds=!!d;this._queue={};this._acceptMessage=e.hitch(this,this._acceptMessage);this._errorMessage=e.hitch(this,this._errorMessage);a&&this.setWorker(a,e.hitch(this,function(a){this.worker=a;c(a)}))},setWorker:function(a,b){if(a instanceof Array){var d=a;a=d.shift()}var k=this._getUrl(a),k=c.normalize(k);a=!c.hasSameOrigin(k,location.href);var g;
if(!1===k)return console.log("Can not resolve worker path"),!1;this.worker&&(g=this.worker,g.removeEventListener("message",this._acceptMessage,!1),g.removeEventListener("error",this._errorMessage,!1),g.terminate(),g=null);if(a){a=this._getUrl("./mutableWorker",!0);try{this._getRemoteText(a,e.hitch(this,function(a){a=n.createObjectURL(new f([a],{type:"text/javascript"}));b(this._createWorker(a,k))}))}catch(u){try{a=c.getProxyUrl(a).path+"?"+encodeURI(a),this._useProxy=!0,b(this._createWorker(a,d))}catch(y){return console.log("Can not create worker"),
!1}}}else setTimeout(e.hitch(this,function(){b(this._createWorker(k,d))}),0)},_createWorker:function(a,b){a=new Worker(a);a.addEventListener("message",this._acceptMessage,!1);a.addEventListener("error",this._errorMessage,!1);this.worker=a;b&&this.importScripts(b);return a},postMessage:function(a,b){if(a instanceof Array||"object"!=typeof a)a={data:a};var c=Math.floor(64E9*Math.random()).toString(36);a.msgId=c;c=this._queue[c]=new g;this.worker?(b?this.worker.postMessage(a,b):this.worker.postMessage(a),
this.emit("start-message",{target:this,message:a})):c.reject({message:"No worker was set."});return this.returnDeferreds?c:c.promise||c},terminate:function(){var a=Object.keys(this._queue);this.worker&&this.worker.terminate();for(var b=a.length-1;0<=b;b--)this._queue[a[b]].cancel("terminated"),delete this._queue[a[b]]},addWorkerCallback:function(a,b){var c=this._getUrl(a,!0);!1===c?(b=new g,b.reject({message:"Could not load text from "+a})):(b=this.postMessage({action:"add-callback",url:c,cbName:b||
"main"}),b.then(e.hitch(this,function(a){a.target=this;this.emit("callback-added",a)})));return b},importScripts:function(a){Array.isArray(a)||(a=[a]);a=a.map(function(a){a=this._getUrl(a,!0);this._useProxy&&!c.hasSameOrigin(a,location.href)&&(a=c.getProxyUrl(a).path+"?"+encodeURI(a));return a},this);a=this.postMessage({action:"import-script",url:a});a.then(e.hitch(this,function(a){a.target=this;this.emit("scripts-imported",a)}));return a},_acceptMessage:function(a){var b=a.data,c=b.msgId;if(b.status&&
"debug"==b.status)console[b.showAs||"debug"](b);else if(c&&c in this._queue){var d=this._queue[c];"progress"==b.status?d.progress(a.data):("error"==b.status?d.reject(a.data):d.resolve(a.data),delete this._queue[c])}this.emit("message",{message:a.data,event:a,target:this})},_errorMessage:function(a){this.onerror||this.onError?this.onerror?this.onerror(a):this.onError(a):console.log("Worker Error: "+a.message+"\nIn "+a.filename+" on "+a.lineno)},_getUrl:function(a,b){if(!a)return console.error("can not resolve empty path"),
!1;a.match(/\.js$/)||(a+=".js");a=k.toUrl(a);return b?c.getAbsoluteUrl(a):a},_getRemoteText:function(a,b){(a=this._getUrl(a))&&d.get(a,{sync:!1,handleAs:"text",headers:{"X-Requested-With":"","Content-Type":"text/plain"}}).then(function(a){b(a)})},_startBlobWorker:function(){var a=this._xdSource;a||(a=this._getUrl("./mutableWorker"),a=new f(["if(!self._mutable){importScripts('"+a+"');}"],{type:"text/javascript"}),a=this._xdSource=n.createObjectURL(a));try{return new Worker(a)}catch(p){return console.log(p.message),
!1}}});b("extend-esri")&&e.setObject("workers.WorkerClient",l,a);return l})},"esri/dijit/geoenrichment/utils/GeometryUtil_base":function(){(function(l){function h(a,b){var c=a.length;if(3>c)return 0;b||(b=a[0]);var d=b[0];b=b[1];for(var e=a[c-1],c=e[0]-d,k=e[1]-b,g=0,h=0,l=a.length;h<l;h++)var e=a[h],u=e[0]-d,e=e[1]-b,g=g+(u*k-c*e),c=u,k=e;return g/2}var g={};g.calculateRingArea=h;g.calculateRingCentroid=function(a,b){var c=a.length;if(!c)return null;b||(b=a[0]);var d=b[0];b=b[1];var e=0,g=0,k=0;
if(2<c)for(var h=a[c-1],c=h[0]-d,l=h[1]-b,u=0,y=a.length;u<y;u++)var h=a[u],v=h[0]-d,h=h[1]-b,w=v*l-c*h,e=e+w,g=g+(c+v)*w,k=k+(l+h)*w,c=v,l=h;0==e?g=k=0:(g/=3*e,k/=3*e);return[d+g,b+k]};g.INTERIOR=1;g.EXTERIOR=-1;g.BOUNDARY=0;g.createRingInfo=function(a,d){return new b(a,d)};g.createSegmentCoordinates=function(b){return new a(null,0,0,b)};var e=function(a){return function(){for(var b in a){var c=a[b];this[b]="function"===typeof c?c.bind(this):c}a.ctr.bind(this).apply(this,arguments)}},d=e({xmin:null,
ymin:null,xmax:null,ymax:null,spatialReference:null,ctr:function(a,b,d,e,g){this.xmin=a;this.ymin=b;this.xmax=d;this.ymax=e;this.spatialReference=g},printOut:function(){console.log([this.xmin,this.xmax,this.ymin,this.ymax].join(" "))}}),b=e({ring:null,origin:null,area:0,clockwise:!1,extent:null,_coords:null,ctr:function(a,b){this.ring=a;this.origin=b;a=this.ring.length-1;if(!(0>a)){if(!a)a++;else if(this.ring[a][0]!=this.ring[0][0]||this.ring[a][1]!=this.ring[0][1])a++,this.ring.push(this.ring[0].slice());
var c=0,e=0;b=!b;this.extent=new d(this.ring[0][0],this.ring[0][1],this.ring[0][0],this.ring[0][1]);for(var g=0;g<a;g++){var k=this.ring[g],l=k[0];b&&(c+=l);l<this.extent.xmin?this.extent.xmin=l:l>this.extent.xmax&&(this.extent.xmax=l);l=k[1];b&&(e+=l);l<this.extent.ymin?this.extent.ymin=l:l>this.extent.ymax&&(this.extent.ymax=l)}b&&(this.origin=[c/a,e/a]);this.area=h(this.ring,this.origin);0>=this.area?this.area=-this.area:this.clockwise=!0}},setDirection:function(a){this.clockwise==!a&&(this.ring.reverse(),
this.clockwise=!this.clockwise,this._coords=null)},testPoint:function(a,b){a=this.getRingCoordinates(b).testPoint(a[0]-this.origin[0],a[1]-this.origin[1]);return this.clockwise?a:-a},generalize:function(a,b,d){function c(c,d,f){v=c;w=d;if(f||z<y)y=a,D=v-l,B=w-l,z=Math.sqrt(D*D+B*B),z>a*b?(D/=z,B/=z):z=0;y*=b}function f(){if(!z)return!0;var a=e.dx,b=e.dy,c=Math.sqrt(a*a+b*b);return c-a*D-b*B>=.9*c}b=b||.75;var e=this.getRingCoordinates(a),g=e.xs,k=e.ys,l=g[0],u=k[0],y,v,w,D,B,z=0,C=g.length-1;c(g[C],
k[C],!0);for(var E=this,A=this.clockwise?function(a){E.ring.splice(a,1)}:function(a){E.ring.splice(-a-1,1)};0<C--&&4<g.length;){var F=g[C],G=k[C];e.setSegment(l,u,F,G)&&e.testPointOnTouch(v,w,y)&&f()?(g.splice(C+1,1),k.splice(C+1,1),A(C+1),c(F,G)):(l=v,u=w,c(F,G,!0))}this._coords=null;d&&(this.area=h(this.ring,this.origin),this.clockwise||(this.area=-this.area))},getRingCoordinates:function(b,d){if(d)return new a(this.ring,d[0],d[1],b,this.extent,this.clockwise);this._coords&&this._coords.eps==b||
(this._coords=new a(this.ring,this.origin[0],this.origin[1],b,this.extent,this.clockwise));return this._coords}});g.RingInfo=b;var a=e({xs:null,ys:null,extent:null,eps:NaN,dx:null,dy:null,_sx:null,_sy:null,ctr:function(a,b,f,e,g,h){this.xs=[];this.ys=[];a||(a=[]);void 0===b&&(b=0);void 0===f&&(f=0);void 0===e&&(e=0);this.eps=Math.max(e,0);g&&(e=this.eps/2,this.extent=new d(g.xmin-b-e,g.ymin-f-e,g.xmax-b+e,g.ymax-f+e));var c=a.length-1;if(!(0>c))for(g=c?a[c][0]==a[0][0]&&a[c][1]==a[0][1]?c:c+1:1,e=
h?1:-1,h=h?0:c;g--;h+=e)c=a[h],this.xs.push(c[0]-b),this.ys.push(c[1]-f)},testPoint:function(a,b){if(!this._pointBelongsToExtent(a,b))return-1;var c=this.xs.length,d=!1;this.dy=this.ys[0]-this.ys[c-1];if(0==this.dy){for(d=c;1<d--&&(this.dy=this.ys[d]-this.ys[d-1],0==this.dy););if(0==this.dy)return 0}for(var d=0<this.dy,e=0,g=this.xs[0],k=this.ys[0],h,l,u=1;u<=c;u++,g=h,k=l)if(l=u==c?0:u,h=this.xs[l],l=this.ys[l],this.setSegment(g,k,h,l)){var y=k-b,v=l-b,w=!1;0>y&&(y=-y,v=-v,w=!0);if(!(y>this.eps&&
v>this.eps)){if(this.testPointOnTouch(a,b,this.eps))return 0;0==y?0!==v&&(0>v&&(d=!d),a<g&&d&&e++):0==v?d=w:0>v&&a<g+this.dx/this.dy*(b-k)&&e++}}return 0!=e%2?1:-1},testPointOnTouch:function(a,b,d){var c=this.findIntersectionDelta(a,b,a-this.dy,b+this.dx);a=this._sx+c*this.dx-a;b=this._sy+c*this.dy-b;return a*a+b*b<=d*d},_pointBelongsToExtent:function(a,b){return a>=this.extent.xmin&&a<=this.extent.xmax&&b>=this.extent.ymin&&b<=this.extent.ymax},setSegment:function(a,b,d,e){this._sx=a;this.dx=d-a;
this._sy=b;this.dy=e-b;return 0!=this.dx||0!=this.dy},findIntersectionDelta:function(a,b,d,e,g){void 0===g&&(g=!0);d-=a;e-=b;var c=this.dy*d-this.dx*e;if(0==c)return 0;var f=a-this._sx,k=b-this._sy,h=k*d-f*e,f=g?0:k*this.dx-f*this.dy;0>c&&(c=-c,h=-h,f=-f);return g||(f=0>f?0:f<c?f/c:1,this.testPointOnTouch(a+f*d,b+f*e,this.eps))?0>=h?0:h<c?h/c:1:-1},addPointOfSegmentAt:function(a){this.xs.push(this._sx+a*this.dx);this.ys.push(this._sy+a*this.dy)}});g.RingCoordinates=a;l.document?define(function(){return g}):
l.GeometryUtil_base=g})(this)},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/ReportTemplateTypes":function(){define([],function(){return{STANDARD:"esriReportTemplateStandard",MULTICOLUMN:"esriReportTemplateMultiColumn",MAP:"esriReportTemplateMapReport",FUSION:"esriReportTemplateFusion"}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/PortalToEditorConverter":function(){define("esri/dijit/geoenrichment/when esri/dijit/geoenrichment/ReportPlayer/config ./portalToEditorUtils/layout/LayoutParser ./portalToEditorUtils/metadata/MetadataParser ./portalToEditorUtils/ImageCollector ./portalToEditorUtils/parsers/Parsers ./portalToEditorUtils/variables/PlayerVariableProvider ../supportClasses/DefaultStyles ../supportClasses/images/ImageDataHolder ../themes/conversion/CssParser esri/dijit/geoenrichment/utils/async/AsyncQueue esri/dijit/geoenrichment/utils/DelayUtil".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m){return{provideEditorJson:function(p,q){function t(){function a(a,b,c){return l(q.preProcessFile&&q.preProcessFile(a,b,r),function(d){if(!1!==d)return l(c&&c(),function(){return q.postProcessFile&&q.postProcessFile(a,b,r)})})}if(u&&u.files&&u.files){var c=q.filesToProcess||["theme.css.txt","metadata.xml","report.xml"],d={"theme.css.txt":function(b){return a(b,"theme.css.txt",function(){r.theme=f.fromCssText(b.data,q)})},"metadata.xml":function(b){return a(b,"metadata.xml",
function(){return e.parseMetadataXML(b,r,q)})},"report.xml":function(c){return a(c,"report.xml",function(){return g.parseReportXML({report:p,parsers:b,file:c,templateJson:r,variableProvider:q.variableProvider,useVariableProviderToCollectOnly:q.useVariableProviderToCollectOnly,tableDefaultStyles:q.tableDefaultStyles,processFileName:v,putImageData:function(a,b){a=v(a);b=b||y[a];k.putImageData(a,b);return b},log:w,queryMetaDataFunc:function(a){return q.queryMetaDataFunc&&q.queryMetaDataFunc(a,r)},postProcessChartJson:function(a,
b){q.postProcessChartJson&&q.postProcessChartJson(r,a,b)},postProcessMapJson:function(a,b){q.postProcessMapJson&&q.postProcessMapJson(r,a,b)},postProcessInfographicJson:function(a,b){q.postProcessInfographicJson&&q.postProcessInfographicJson(r,a,b)},postProcessTableInSection:function(a,b){q.postProcessTableInSection&&q.postProcessTableInSection(r,a,b)}})})},generic:function(b,c){return a(b,c)}},t=new n;c.forEach(function(a){var b=u.files.filter(function(b){return b.name===a})[0],c=b&&(d[a]||d.generic);
c&&t.add(function(){return l(h.isPlayerOnServer?l():m.delay(50)).then(function(){return c(b,a)}).otherwise(function(a){r.metadata.parseErrors.push(a);console.log(a)})})});return t.getPromise()}}q=q||{};q.variableProvider=q.variableProvider||new a;q.tableDefaultStyles=q.tableDefaultStyles||new c;var r={documentOptions:{},metadata:{specialTradeAreaCalculatorName:null,parseErrors:[],mapImageInfosHash:{},comparisonCalculatorsHash:{},locatorCalculatorsHash:{}},theme:null},u=p.portalJson,y={};q.getImageData=
function(a){return y[v(a)]};var v=function(a){return a?a.toLowerCase():""},w=q.log||function(a){};return l(b.initialize(),function(){return l(d.collectImageResources(u,y,v),function(){for(var a in y)k.putImageData(a,y[a]);return l(t(),function(){r.metadata.parseErrors.length||(p.templateJson=r)})})})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/layout/LayoutParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./GraphicReportSectionsParser",
"./ClassicReportSectionsParser"],function(l,h,g){return{parseReportXML:function(e){e.log(e.file.data);var d=l.parseXml(e.file.data);e.parsers.getParser("document").parseDocument(d,e);e.report.isGraphicReport?(e.templateJson.sectionsTables=[],h.parseSectionsGraphic(d,e)):(e.templateJson.sections=[],g.parseSectionsClassic(d,e))}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/layout/GraphicReportSectionsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter"],
function(l){return{parseSectionsGraphic:function(h,g){l.queryTopJson(h,"table").forEach(function(e){try{g.templateJson.sectionsTables.push(g.parsers.getParser("section").parseTable(e,g,{fixTableWidthsForPage:!0}))}catch(d){console.log(d)}})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/layout/ClassicReportSectionsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter"],function(l){return{parseSectionsClassic:function(h,g){l.queryTopJson(h,"section").forEach(function(e){g.templateJson.sections.push(g.parsers.getParser("section").parseSection(e,
g,{fixTableWidthsForPage:!0}))});this._splitSections(g)},_splitSections:function(h){h=h.templateJson;var g=[];h.sections.forEach(function(e){function d(){b={type:e.type,stack:[]};g.push(b)}var b;d();e.stack.forEach(function(a){if("hr"===a.id){var c=!!b.stack.length;b.stack.push(a);c&&d()}else"table"===a.id?(b.stack.some(function(a){return"table"===a.id})&&d(),b.stack.push(a)):"pageBreak"===a.id?(b.stack.length&&d(),b.stack.push(a),d()):b.stack.push(a)})});g=g.filter(function(e){return!!e.stack.length});
h.sections=g}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/MetadataParser":function(){define("esri/dijit/geoenrichment/promise/all esri/dijit/geoenrichment/utils/JsonXmlConverter ./DataCollectionsCalculatorsParser ./ScriptsCalculatorsParser ./LocatorCalculatorsParser ./map/MapCalculatorsParser ./TradeAreaCalculatorsParser".split(" "),function(l,h,g,e,d,b,a){return{parseMetadataXML:function(c,k,f){f.log&&f.log(c.data);var n=h.parseXml(c.data);if(n&&n.tags)return l([a.parseTradeAreaCalculators(n,
k,f),g.parseDataCollectionsCalculators(n,k,f),e.parseScriptsCalculators(n,k,f),d.parseLocatorCalculators(n,k,f)]).then(function(){return b.parseMapCalculators(n,k,f)})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/DataCollectionsCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./VariableScriptCollector","../../../../_devConfig"],function(l,h,g){return{parseDataCollectionsCalculators:function(e,d,b){l.queryJson(e,"DataCollections").forEach(function(a){var c=
l.queryJson(a,"ComparisonLevel");if(g.emulateErrors.metadataParseError)throw Error("Error test: something crashed during the parsing of the metadata!");var e;if(b.variableProvider.isPlayerOnly||c.length)e=h.getObjects(a);c.length&&(a={calculatorName:a.attributes.Name,levels:c.map(function(a){return a.attributes.Name}).filter(function(a){return!b.validateGeographyLevelFunc||b.validateGeographyLevelFunc(a)}),variableObjects:e.variableObjects},d&&(d.metadata.comparisonCalculatorsHash[a.calculatorName]=
a));b.variableProvider.isPlayerOnly&&(e.variableObjects.forEach(function(a){b.variableProvider.addVariable(a)}),e.scriptObjects.forEach(function(a){b.variableProvider.addScriptVariable(a)}))})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/VariableScriptCollector":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","../variables/VariableUtil"],function(l,h){var g={getObjects:function(e,d){d=g._getVariableInfo(e,d);e=g._getScriptObjects(e,
d.fieldNameToVariableCache);return{variables:d.variables,variableObjects:d.variableObjects,scriptObjects:e}},_getVariableInfo:function(e,d){var b=[];l.queryJson(e,d?/^(RawFields|Fields)$/:"Fields").forEach(function(a){b=b.concat(l.queryJson(a,/^(Field|PortalField)$/))});var a=[],c=[],g={};b.forEach(function(b){a.push(b.attributes.MapTo);if(b=h.fieldTagToVariable(b,e.attributes.Name))g[b.fieldName]=b,c.push(b)});return{variables:a,variableObjects:c,fieldNameToVariableCache:g}},_getScriptObjects:function(e,
d){var b=l.queryJson(e,"Scripts"===e.name?"Fields":"CalculatedFields")[0],b=b&&l.queryJson(b,"Script")||[];"Scripts"===e.name&&(b=b.filter(function(a){return!("STORE_ID"===a.attributes.Name||"AREA_ID"===a.attributes.Name)}));return b.map(function(a){var b=h.scriptTagToVariable(a,e.attributes.Name);b.usedFields&&(b.usedMapTos=[],b.usedFields.forEach(function(a){var c=d[a];c?c.usedMapTos?b.usedMapTos=b.usedMapTos.concat(c.usedMapTos):b.usedMapTos.push(c.fullName):console.log("Error parsing used fields for "+
a)}),d[b.fieldName]=b);return b})}};return g})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/variables/VariableUtil":function(){define([],function(){var l={getType:function(h,g){return h?0===h.indexOf("esriFieldType")?h:"esriFieldType"+h:g},fieldTagToVariable:function(h,g){return h.attributes.MapTo&&"AREA_ID"!==h.attributes.Name?{id:h.attributes.MapTo.substr(h.attributes.MapTo.lastIndexOf(".")+1),fullName:h.attributes.MapTo,alias:h.attributes.Alias,fieldName:h.attributes.Name,
precision:Number(h.attributes.Decimals)||0,calculatorName:g,templateName:g+"."+h.attributes.Name,type:l.getType(h.attributes.Type,h.attributes.Decimals?"esriFieldTypeDouble":"esriFieldTypeString"),vintage:null,source:null}:null},scriptTagToVariable:function(h,g){return{id:h.attributes.Name,fullName:g+"."+h.attributes.Name,fieldName:h.attributes.Name,alias:h.attributes.Alias,precision:Number(h.attributes.Decimals)||0,usedFields:h.attributes.usedFields?h.attributes.usedFields.split(","):[],usedMapTos:null,
expressionText:h.tags[0].text,calculatorName:g,templateName:g+"."+h.attributes.Name,type:l.getType(h.attributes.Type,h.attributes.Decimals?"esriFieldTypeDouble":"esriFieldTypeString")}}};return l})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/ScriptsCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./VariableScriptCollector"],function(l,h){return{parseScriptsCalculators:function(g,e,d){l.queryJson(g,"Scripts").forEach(function(b){d.variableProvider.isPlayerOnly&&
(b=h.getObjects(b),b.variableObjects.forEach(function(a){d.variableProvider.addVariable(a)}),b.scriptObjects.forEach(function(a){d.variableProvider.addScriptVariable(a)}))})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/LocatorCalculatorsParser":function(){define(["esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/when","esri/dijit/geoenrichment/utils/JsonXmlConverter","../variables/VariableUtil"],function(l,h,g,e){return{parseLocatorCalculators:function(d,
b,a){d=g.queryJson(d,"Locator");return l(d.map(function(c){var d=[];g.queryJson(c,/^(PointFields|Fields)$/).forEach(function(a){d=d.concat(g.queryJson(a,/^(Field|Direction|Distance)$/))});var f=[];d.forEach(function(a){"Direction"===a.name?a.attributes.MapTo="DIRECTION":"Distance"===a.name&&(a.attributes.MapTo="DISTANCE");(a=e.fieldTagToVariable(a,c.attributes.Name))&&f.push(a)});var l={calculatorName:c.attributes.Name,variableObjects:f,layerID:null,layerUrl:null,layerName:c.attributes.LayerName};
c.attributes.Points&&0===c.attributes.Points.indexOf("std:")?l.layerID=c.attributes.Points.replace("std:",""):l.layerUrl=c.attributes.Layer;b.metadata.locatorCalculatorsHash[c.attributes.Name]=l;a.variableProvider.isPlayerOnly&&f.forEach(function(b){a.variableProvider.addVariable(b)});return h(!a.validateLocatorCalculator||a.validateLocatorCalculator(l.layerID,l.layerUrl),function(a){l.isValid=a})}))}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/map/MapCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter",
"./MetadataToRendererParser","./MapTagsUtil","esri/dijit/geoenrichment/utils/ImageUtil"],function(l,h,g,e){var d={parseMapCalculators:function(b,a,c){l.queryJson(b,"Maps").forEach(function(b){l.queryJson(b,"Map").forEach(function(f){var e=d._parsePortalLayers(f),g=d._parseStudyAreas(f),e={fieldName:f.attributes.Name,width:Number(f.attributes.Width),height:Number(f.attributes.Height),defaultBasemapId:e.defaultBasemapId,webMapId:e.webMapId,additionalLayerInfos:d._parseAdditionalLayers(f,a),pinSymbolJson:d._parseSiteLayerPinSymbol(f,
c),areaSymbolJsons:g.symbolJsons,areaSymbolRamp:g.ramp,mapScale:Number(f.attributes.Scale)||null};a&&(a.metadata.mapImageInfosHash[b.attributes.Name+"."+f.attributes.Name]=e)})})},_parsePortalLayers:function(b){var a;b=l.queryJson(b,"Layer").filter(function(a){return!!a.attributes.PortalItemId});1<b.length&&(a=b.shift());b=b.shift();return{defaultBasemapId:a&&a.attributes.PortalItemId,webMapId:b&&b.attributes.PortalItemId}},_parseAdditionalLayers:function(b,a){var c=[];l.queryJson(b,/^(Layer|LocatorResultsLayer|ComparisonResultsLayer)$/).filter(function(a){return!!a.attributes.ServiceUrl||
"LocatorResultsLayer"===a.name||"ComparisonResultsLayer"===a.name}).forEach(function(b){if(b.attributes.ServiceUrl)c.push({url:b.attributes.ServiceUrl});else if("LocatorResultsLayer"===b.name){var d=b.tags&&b.tags.filter(function(a){return"Renderer"===a.name})[0],e=a.metadata.locatorCalculatorsHash[b.attributes.CalculatorName];e&&e.isValid&&c.push({isLocatorLayer:!0,layerName:b.attributes.LayerName,calculatorName:b.attributes.CalculatorName,calculatorInfo:e,rendererJson:d&&h.parseRendererJson(d)})}else"ComparisonResultsLayer"===
b.name&&((d=(d=b.tags&&b.tags.filter(function(a){return"Renderer"===a.name})[0])&&h.parseRendererJson(d))&&"esriTS"===d.uniqueValueInfos[0].symbol.type?c[c.length-1].labelRendererJson=d:(e=(e=b.tags&&b.tags.filter(function(a){return"LabelingInfo"===a.name})[0])&&h.parseLabelRendererJson(e),c.push({isComparisonLayer:!0,calculatorName:b.attributes.CalculatorName,rendererJson:d,labelRendererJson:e})))});return c.length&&c},_parseSiteLayerPinSymbol:function(b,a){var c;if(b=l.queryJson(b,"SiteLayer")[0])if((b=
l.queryJson(b,"Symbol")[0])&&"Image"===b.attributes.Type)(a=a.getImageData(b.attributes.Name))&&(c={type:"esriPMS",contentType:e.getContentType(a),imageData:e.base64DataFromDataURL(a),url:b.attributes.Url,width:Number(b.attributes.Width),height:Number(b.attributes.Height),angle:Number(b.attributes.Angle)||0,xoffset:Number(b.attributes.XOffset)||0,yoffset:Number(b.attributes.YOffset)||0});else if(b&&"Marker"===b.attributes.Type){c=(c=l.queryJson(b,"Fill")[0])&&l.queryJson(c,"Color")[0];var d=(a=l.queryJson(b,
"Outline")[0])&&l.queryJson(a,"Color")[0];c={type:"esriSMS",style:"esriSMS"+(b.attributes.Style||"Circle"),size:Number(b.attributes.Size),angle:Number(b.attributes.Angle)||0,xoffset:Number(b.attributes.XOffset)||0,yoffset:Number(b.attributes.YOffset)||0,color:g.parseColorTag(c),outline:a&&{type:"esriSLS",color:g.parseColorTag(d),style:"esriSLS"+(a.attributes.Style||"Solid"),width:void 0===a.attributes.Width?0:Number(a.attributes.Width)}}}return c},_parseStudyAreas:function(b){var a=(b=l.queryJson(b,
"StudyAreasLayer")[0])&&l.queryTopJson(b,"SymbolsPalette")[0];b=(a&&l.queryTopJson(a,"Symbol")||[]).map(d._parseAreaSymbol);var c=a&&l.queryTopJson(a,"SymbolRamp")[0],e;c&&(a=l.queryTopJson(c,"First")[0],c=l.queryTopJson(c,"Last")[0],a=a&&l.queryTopJson(a,"Symbol")[0],c=c&&l.queryTopJson(c,"Symbol")[0],a&&c&&(e=[a,c].map(d._parseAreaSymbol)));return{ramp:e,symbolJsons:b}},_parseAreaSymbol:function(b){var a=l.queryJson(b,"Fill")[0],a=a&&l.queryJson(a,"Color")[0],c=(b=l.queryJson(b,"Outline")[0])&&
l.queryJson(b,"Color")[0];return{type:"esriSFS",style:"esriSFSSolid",color:g.parseColorTag(a)||[0,0,0,1],outline:b&&{type:"esriSLS",color:g.parseColorTag(c),style:"esriSLS"+(b.attributes.Style||"Solid"),width:void 0===b.attributes.Width?0:Number(b.attributes.Width)}}}};return d})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/map/MetadataToRendererParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlTypedConverter","esri/dijit/geoenrichment/utils/JsonXmlConverter"],
function(l,h){return{parseRendererJson:function(g){return l.parseXml(h.parseJson(g))},parseLabelRendererJson:function(g){return{type:"uniqueValue",field1:"StdGeographyLevel",uniqueValueInfos:l.parseXml(h.parseJson(g)).map(function(e){return{value:e.where.match(/StdGeographyLevel='(.*?)'/)[1],symbol:e.symbol}})}}}})},"esri/dijit/geoenrichment/utils/JsonXmlTypedConverter":function(){define(["dojo/_base/declare","./RegExpUtil"],function(l,h){return l(null,{parseJson:function(g,e){function d(a,f){if("string"===
typeof a)c+="\x3c"+f+' type\x3d"string"\x3e'+h.encodeXML(a,!1)+"\x3c/"+f+"\x3e";else if("number"===typeof a)c+="\x3c"+f+' type\x3d"number"\x3e'+a+"\x3c/"+f+"\x3e";else if("boolean"===typeof a)c+="\x3c"+f+' type\x3d"boolean"\x3e'+a+"\x3c/"+f+"\x3e";else if(Array.isArray(a))b(a,f);else if(a&&"object"===typeof a){c+="\x3c"+f+' type\x3d"object"\x3e';for(var e in a)d(a[e],e);c+="\x3c/"+f+"\x3e"}}function b(a,b){c+="\x3c"+b+' type\x3d"array"\x3e';a.forEach(function(a){d(a,"item")});c+="\x3c/"+b+"\x3e"}
var a=e&&e.rootName||"root",c="";e&&e.addDocumentOptions&&(c+='\x3c?xml version\x3d"1.0" encoding\x3d"utf-8"?\x3e');d(g,a);return c=decodeURIComponent(encodeURIComponent(c).replace("%19",""))},parseXml:function(g){function e(a){if(!a.attributes)return null;for(var b=0;b<a.attributes.length;b++){var c=a.attributes[b];if("type"===c.name)return c.value}return null}function d(a,c){if(c.childNodes)for(var d=0,f=c.childNodes.length;d<f;d++){var e=c.childNodes[d],g=b(e);void 0!==g&&(a[e.nodeName]=g)}return a}
function b(b){var c=e(b);if(b.nodeName&&c)switch(c){case "string":return b.childNodes[0]?h.decodeXML(b.childNodes[0].nodeValue):"";case "number":return Number(b.childNodes[0].nodeValue);case "boolean":return"true"===b.childNodes[0].nodeValue;case "object":return d({},b);case "array":return a([],b)}}function a(a,c){if(c.childNodes)for(var d=0,f=c.childNodes.length;d<f;d++)a[d]=b(c.childNodes[d]);return a}var c,k;g=(new DOMParser).parseFromString(g,"text/xml").childNodes;for(var f=0;f<g.length;f++)if(1===
g[f].nodeType){k=g[f];break}k&&(g=e(k),"object"===g?d(c={},k):"array"===g&&a(c=[],k));return c}})()})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/map/MapTagsUtil":function(){define([],function(){return{parseColorTag:function(l){if(!l)return null;l=l.attributes;return[Number(l.Red)||0,Number(l.Green)||0,Number(l.Blue)||0,l.Transparency?255*(1-Number(l.Transparency)/100):255]}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/TradeAreaCalculatorsParser":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter",
"./VariableScriptCollector","../../../supportClasses/templateJsonUtils/fieldInfo/FieldLibrary"],function(l,h,g){return{parseTradeAreaCalculators:function(e,d,b){e=l.queryJson(e,"SpecialTradeAreaFields");d.metadata.specialTradeAreaCalculatorName=e[0]&&e[0].attributes&&e[0].attributes.Name;e.forEach(function(a){b.variableProvider.isPlayerOnly&&h.getObjects(a,!0).variableObjects.forEach(function(a){a.alias=a.alias||g.getFieldLabel(a.id);b.variableProvider.addVariable(a)})})}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/ImageCollector":function(){define(["esri/dijit/geoenrichment/when",
"esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/utils/DataUtil","esri/dijit/geoenrichment/utils/ImageUtil","esri/dijit/geoenrichment/utils/ImageInfoUtil"],function(l,h,g,e,d){return{collectImageResources:function(b,a,c){function k(b){return l(d.getImageInfo(a[b],b),null,function(){delete a[b]})}b&&b.files&&b.files.forEach(function(b){var d=g.getContentType(b.name);d&&"image/"===d.substr(0,6)&&(a[c(b.name)]=e.base64DataToDataURL(b.data,d))});b=[];for(var f in a)b.push(k(f));return h(b)}}})},
"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/parsers/Parsers":function(){define(["esri/dijit/geoenrichment/Deferred","require"],function(l,h){var g={},e={},d;g.initialize=function(){if(d)return d.promise;d=new l;h("./DocumentParser ./ChartConverterPtoE ./InfographicConverterPtoE ./SectionParser ./FieldParser ./FilterParser ./SortingParser ../../../supportClasses/templateJsonUtils/fieldInfo/utils".split(" "),function(b,a,c,g,f,h,l,p){e.document=b;e.chart=a;e.infographic=
c;e.section=g;e.field=f;e.filter=h;e.sorting=l;p.init().then(d.resolve)});return d.promise};g.getParser=function(b){return e[b]};return g})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/variables/PlayerVariableProvider":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/string","dojo/i18n!esri/nls/jsapi"],function(l,h,g,e){e=e.geoenrichment.dijit.ReportPlayer.Variables;var d=l(null,{variable:null,constructor:function(b){this.variable=b},calculate:function(b){return 0},
getCalcType:function(){return"n/"},getAliasWithType:function(){return this.variable.alias},getDescriptionWithType:function(){return this.variable.alias},getDecimals:function(){return this.variable.precision||0}});return l(null,{isPlayerOnly:!0,_fieldNameToVariableCache:null,_templateNameToVariableCache:null,constructor:function(b){this._templateNameToVariableCache=b&&b.templateNameToVariableCache||{};this._fieldNameToVariableCache={};for(var a in this._templateNameToVariableCache)b=this._templateNameToVariableCache[a],
this._fieldNameToVariableCache[b.fieldName]=b},get:function(b){return this._templateNameToVariableCache[b]||this._fieldNameToVariableCache[b]},toCalculator:function(b){return(b=this.get(b))&&new d(b)},addVariable:function(b){this._fieldNameToVariableCache[b.fieldName]=b;this._templateNameToVariableCache[b.templateName]=b},addScriptVariable:function(b){this._fieldNameToVariableCache[b.fieldName]=b;this._templateNameToVariableCache[b.templateName]=b},getVariables:function(){return Object.keys(this._fieldNameToVariableCache).map(function(b){return this._fieldNameToVariableCache[b]},
this)},getVariablesDataVintageDescription:function(b){var a={},c={},d={};this.getVariables().forEach(function(a){a.fullName&&(d[a.fullName.toLowerCase()]=a)});for(var f in b.usedVariablesCache)if(b=d[f.toLowerCase()])b.vintage&&(c[b.vintage]=1),b.source&&(a[b.source]=1);if(!Object.keys(a).length&&!Object.keys(c).length)return"";f=[];Object.keys(a).length&&f.push(g.substitute(e.sourcePattern,{source:Object.keys(a).join(", ")}));Object.keys(c).length&&f.push(g.substitute(e.vintagePattern,{vintage:Object.keys(c).join(", ")}));
return f.join(" ")},toJson:function(){return{templateNameToVariableCache:h.clone(this._templateNameToVariableCache)}}})})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DefaultStyles":function(){define(["dojo/_base/declare","dojo/_base/lang","esri/dijit/geoenrichment/utils/ColorUtil"],function(l,h,g){return l(null,{_styles:null,_stylesArray:null,constructor:function(e){this._styles={Default:{color:"#4C4C4C",backgroundColor:"#FFFFFF"}};h.mixin(this._styles,e);this._stylesArray=[];for(var d in this._styles)this._stylesArray.push(d)},
getStyle:function(e){return this._styles[e]},getStylesArray:function(){return this._stylesArray},tryApplyStyle:function(e,d,b){if(d=this.getStyle(d))for(var a in d)b&&void 0!==e[a]||(e[a]=d[a])},findDefaultStyle:function(e){var d,b=this;this.getStylesArray().some(function(a){var c=b.getStyle(a),k;for(k in c){if(!e[k])return!1;if("color"===k||"backgroundColor"===k){if(!g.colorsEqual(e[k],c[k]))return!1}else if(e[k]!==c[k])return!1}d=a;return!0});return d}})})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/images/ImageDataHolder":function(){define(["esri/dijit/geoenrichment/utils/CacheUtil"],
function(l){function h(){return l.get("ImageDataHolder.imageData")}function g(){return l.get("ImageDataHolder.fileNameToOriginal")}return{putImageData:function(e,d){if("string"===typeof e&&d){var b=e.toLowerCase();g()[b]=e;h()[b]=d}else console.error("Invalid image filename or data!")},getImageData:function(e){return"string"!==typeof e?null:h()[e.toLowerCase()]},findFileNameByData:function(e){var d=h(),b;for(b in d)if(e===d[b])return g()[b];return null}}})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/conversion/CssParser":function(){define(["../PageBorderStyles",
"../ThemeUpdateUtil","../../../_devConfig"],function(l,h,g){var e={"font-size":"fontSize","font-family":"fontFamily","font-style":"fontStyle","font-weight":"fontWeight","text-decoration":"textDecoration",color:"color","background-color":"backgroundColor",opacity:"opacity",url:"data","background-position":"position","background-repeat":"repeat","background-size":"scale"},d={colors:1,colors3series:1};return{fromCssText:function(b){function a(a){var b=n;a.split("@").forEach(function(a){b=b[a]=b[a]||
{}});return b}function c(a,b){if(b.borderStyle||b.border)if(a.border={},a.border.style=l.toSupportedValue(b.borderStyle),"string"===typeof b.border){var c=b.border.split(" ");3===c.length&&(a.border.thickness=Number(c[0].replace("px","")),a.border.lineStyle=c[1],a.border.color=c[2])}for(var d in b)if("border"!==d&&"borderStyle"!==d){var c=b[d],f;f=d;var g=c,h=a;"font-size"===f?(h[e[f]]=k(g.replace("px","")),f=!0):"background-repeat"===f?(h[e[f]]=k("repeat"===g),f=!0):"background-size"===f?(h[e[f]]=
k("contain"===g||"cover"===g),h.size="auto"===g?null:g,f=!0):f=!1;f||(a[e[d]||d]=k(c))}}function k(a){if(void 0===a||null===a||"null"===a||"undefined"===a)return"";if("true"===a)return!0;if("false"===a)return!1;if(!0===a)return!0;if(!1===a)return!1;var b=Number(a);return isNaN(b)?a:b}function f(a){if(g.emulateErrors.themeParseError)throw Error("Error test: something crashed during the parsing of the theme!");if("object"===typeof a)for(var b in a){var c=a[b];if(d[b]){var e=[],k=Object.keys(c);if(k.length){var h=
k.every(function(a){return-1!==a.indexOf("_")});k.forEach(function(a,b){e[h?a.split("_")[1]:b]=c[a]})}a[b]=e}else f(c)}}var n={};b=b.replace(/\r?\n|\r/g,"");b=b.replace(/(\w|\d)_(\w|\d)/g,"$1@$2");b=b.replace("data:","dataM");b=b.replace(";base64","Mbase64");var m=function(){var a={};(b.match(/\..*?\}/g)||[]).forEach(function(b){var c=b.substring(1,b.indexOf("{")).trim(),d={};b.substring(b.indexOf("{")+1,b.indexOf("}")).trim().split(";").forEach(function(a){if(a=a.trim()){a=a.split(":");var b=a[1].trim(),
b=b.replace("dataM","data:"),b=b.replace("Mbase64",";base64");d[a[0].trim()]=b}});a[c]=d});return a}(),p;for(p in m)c(a(p),m[p]);delete n.themeMetadata;f(n);h.populateMissingStyles(n);return n}}})},"esri/dijit/geoenrichment/ReportPlayer/core/themes/ThemeUpdateUtil":function(){define(["dojo/_base/lang","esri/dijit/geoenrichment/utils/ObjectUtil","./ThemeLibrary","./ThemeUtil"],function(l,h,g,e){return{populateMissingStyles:function(d){if(d){d.table&&d.table.overrideStyles||(d.table={overrideStyles:l.mixin({},
d.table)});d.icon||(d.icon=l.clone(d.infographic.staticInfographic.icon),d.highlightedIcon=l.clone(d.infographic.staticInfographic.highlightedIcon));d.chart.icon||(d.chart.icon=l.clone(d.infographic.staticInfographic.icon));d.chart.xAxis.lineColor||(d.chart.xAxis.lineColor=d.chart.xAxis.axisStyle.color,d.chart.yAxis.lineColor=d.chart.yAxis.axisStyle.color);var b=e.getThemeColors(d),a=d.chart.colors.slice(),c=d.chart.colors3series&&d.chart.colors3series.slice(),k=g.getDefaultTheme({defaultFontFamilty:d.document.fontFamily,
defaultFontSize:d.document.fontSize});e.applyThemeColorsToTheme({theme:k,colors:b,chartColors:a,colors3series:c});h.populateObject(d,k,!1)}}}})},"esri/dijit/geoenrichment/utils/async/AsyncQueue":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when dijit/Destroyable ../DelayUtil".split(" "),function(l,h,g,e,d,b){var a=l(d,{_lastPromise:null,_isFinished:!1,_isDestroyed:!1,_lastDfd:null,_lastResult:null,constructor:function(a){h.mixin(this,
a)},add:function(a,d){d=d||{};var c=this;if(!this._isDestroyed){this._lastDfd||(this.onStarted(),this._lastDfd=new g);this._isFinished=!1;var k=function(){var f=function(){if(!c._isDestroyed)try{return"function"===typeof a?a():a}catch(t){return(new g).reject(t)}},k=0<=d.delayBefore?function(){return b.delay(f,d.delayBefore)}:f;return(0<=d.delayAfter?function(){return e(k(),function(a){return b.delay(function(){return a},d.delayAfter)})}:k)()};!this._lastPromise||this._lastPromise.isFulfilled()?this._lastPromise=
e(k()):this._lastPromise=e(this._lastPromise).then(k);var h=this._lastPromise;e(h,function(a){h!==c._lastPromise||c._isDestroyed||c._isFinished||h&&!h.isFulfilled()||(c._isFinished=!0,c._lastDfd.resolve(a),c._lastResult=a,c._lastDfd=null,c.onFinished(a))},this._lastDfd.reject);return this.getPromise()}},getPromise:function(){return this._isDestroyed?null:this._lastDfd&&this._lastDfd.promise||this._lastResult},isFinished:function(){return this._isFinished},isDestroyed:function(){return this._isDestroyed},
destroy:function(){this._isDestroyed=!0},onStarted:function(){},onFinished:function(a){}});a.executeFunctions=function(b,d,f){f=f||{};var c=new a,g=[];b.forEach(function(a,b){c.add(function(){return e(a(),function(a){g.push(a);return a})},{delayBefore:0===b?void 0:d})});f.onQueueReady&&f.onQueueReady(c);return e(c.getPromise(),function(a){return f.collectResults?g:a})};a.processArrayInBatches=function(a,b){function c(){if(a.length){for(var f=[],e=0;e<b.batchSize&&a.length;e++)f.push(a.shift());b.processBatch?
b.callback(f):f.forEach(b.callback);setTimeout(c,b.timeout||0)}else d.resolve()}a=a.slice();var d=new g;c();return d.promise};return a})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/map/WebMapJsonUtil":function(){define([],function(){return{processWebMapJson:function(l,h){function g(d,b,a){d=d.featureCollection.layers[0].featureSet.features[0];d.attributes=d.attributes||{};d.attributes[b]=a}var e=JSON.parse(h);e.operationalLayers.forEach(function(d){var b;b=d.featureCollection&&d.featureCollection.layers&&
1===d.featureCollection.layers.length?d.featureCollection.layers[0].id:void 0;"string"===typeof b&&0===b.indexOf("SiteLayer")?(d.isSiteLayer=!0,(b=0===b.indexOf("SiteLayer.")?b.replace("SiteLayer.",""):void 0)&&g(d,"STORE_ID",b)):"string"===typeof b&&0===b.indexOf("StudyAreasLayer.")?(d.isSiteLayer=!0,g(d,"AREA_ID",b.replace("StudyAreasLayer.",""))):"string"===typeof b&&0===b.indexOf("LocatorResultsLayer.")?(d.isLocatorLayer=!0,d.calculatorName=b.replace("LocatorResultsLayer.","")):"string"===typeof b&&
0===b.indexOf("ComparisonResultsLayer.")?(d.isComparisonLayer=!0,d.calculatorName=b.replace("ComparisonResultsLayer.","")):d.isOtherLayer=!0});return{fileName:l,originalString:h,webMapJson:e}}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttachmentsStoreSerializer":function(){define("esri/dijit/geoenrichment/when esri/dijit/geoenrichment/promise/all ./AttributesUtil ./NotesUtil ./CustomAttachmentsStore esri/dijit/geoenrichment/utils/ImageInfoUtil".split(" "),
function(l,h,g,e,d,b){return{getAttachmentsStoreJson:function(a,c){function d(a){if(c.noCache)return a;m=m||{};for(var b in m)if(m[b]===a)return b;b="image_"+n++;m[b]=a;return b}function f(){return h([c.saveImages&&a.getImages(),a.getAttributes(),a.getNotes()]).then(function(a){var c=a[0]||[],f=a[1]||[],k=a[2]||[];return h(c.map(function(a){return h([l(a.getThumbnail(),function(a){return b.ensureDataUrlForRemoveImage(a)}),l(a.getUrl(),function(a){return b.ensureDataUrlForRemoveImage(a)})]).then(function(b){a.__thumbnail=
d(b[0]);a.__url=d(b[1])})})).then(function(){return{images:c.map(function(a){var b=a.__thumbnail,c=a.__url;delete a.__thumbnail;delete a.__url;return{description:a.description,thumbnail:b,url:c,filename:a.filename,imageViewType:a.imageViewType}}),attributes:f.map(function(a){return g.attributeToJson(a)}),notes:k.map(function(a){return e.noteToJson(a)})}})})}if(!a)return null;var n=0,m,p=[],q=[];if(a.supportsMultipleAreas)for(var t=0;t<c.numAreas;t++)a.setCurrentAnalysisAreaIndex(t),q.push(l(f(),function(a){p.push(a)}));
else q.push(l(f(),function(a){p.push(a)}));return h(q).then(function(){return{supportsMultipleAreas:a.supportsMultipleAreas,areaAttachments:p,imageDataCache:m}})},getAttachmentsStoreFromJson:function(a){return a&&new d(a)}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/NotesUtil":function(){define([],function(){return{noteToJson:function(l){return{text:l.text}},noteFromJson:function(l){return{text:l.text}}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/CustomAttachmentsStore":function(){define(["dojo/_base/declare",
"esri/dijit/geoenrichment/when"],function(l,h){var g={fromJson:function(e){function d(b){return e.imageDataCache&&e.imageDataCache[b]||b}e.areaAttachments=e.areaAttachments||e.areaAttachements;delete e.areaAttachements;return{getImagesForAreaAt:function(b){b=e.supportsMultipleAreas?b:0;return(e.areaAttachments[b]&&(e.areaAttachments[b].images||e.areaAttachments[b].attachments)||[]).map(function(a){return{description:a.description,filename:a.filename,imageViewType:a.imageViewType,getThumbnail:function(){return d(a.thumbnail)},
getUrl:function(){return d(a.url)}}})},getAttributesForAreaAt:function(b){b=e.supportsMultipleAreas?b:0;return e.areaAttachments[b]&&e.areaAttachments[b].attributes||[]},getNotesForAreaAt:function(b){b=e.supportsMultipleAreas?b:0;return e.areaAttachments[b]&&e.areaAttachments[b].notes||[]}}}};return l(null,{supportsMultipleAreas:!1,_currentAreaIndex:0,_provider:null,constructor:function(e){(this._provider=e.getAttachmentsForAreaAt||e.getImagesForAreaAt||e.getAttributesForAreaAt||e.getNotesForAreaAt?
e:g.fromJson(e))&&this._provider.getAttachmentsForAreaAt&&(e.getImagesForAreaAt=function(d){return e.getAttachmentsForAreaAt(d)});this.supportsMultipleAreas=e.supportsMultipleAreas},initialize:function(){},getImages:function(){function e(b){b.forEach(function(a){!a.getUrl&&a.getAttachmentUrl&&(a.getUrl=function(){return a.getAttachmentUrl()})})}var d=this._provider.getImagesForAreaAt?this._provider.getImagesForAreaAt(this._currentAreaIndex):[];return d?Array.isArray(d)?(e(d),d):h(d,function(b){e(b);
return b}):d},getAttributes:function(){return this._provider.getAttributesForAreaAt?this._provider.getAttributesForAreaAt(this._currentAreaIndex):[]},getNotes:function(){return this._provider.getNotesForAreaAt?this._provider.getNotesForAreaAt(this._currentAreaIndex):[]},setCurrentAnalysisAreaIndex:function(e){this._currentAreaIndex=e}})})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/TemplateJsonSerializer":function(){define(["./query/TemplateJsonQueryUtil","../images/ImageDataHolder",
"../conditionalStyling/ConditionalStyleUtil"],function(l,h,g){return{serialize:function(e){this._attachImagesToTemplateJson(e);return e},_attachImagesToTemplateJson:function(e){function d(a){var c=h.getImageData(a);c&&(b[a]=c)}var b={};l.processTemplateFieldInfos(e,function(a){a.isImage?(d(a.imageJson.fileName),a.triggerJson&&g.collectImageFileNames(a.triggerJson).forEach(d)):a.isInfographic&&a.infographicJson.variableTables&&a.infographicJson.variableTables.forEach(function(a){a.image&&d(a.image.imageJson.fileName)})});
l.processSectionElements(e,function(a){"img"===a.id&&d(a.fileName)});e.imageData=b},deserialize:function(e){this._takeImagesFromTemplateJson(e);return e},_takeImagesFromTemplateJson:function(e){for(var d in e.imageData)h.putImageData(d,e.imageData[d]);delete e.imageData}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/conditionalStyling/ConditionalStyleUtil":function(){define(["esri/dijit/geoenrichment/utils/PageUnitsConverter"],function(l){var h={},g={FontSize:"fontSize",FontColor:"fontColor",
FontFamily:"fontFamily",ForeColor:"color",BackColor:"backgroundColor"},e={},d;for(d in g)e[g[d]]=d;h.getConditionalStyle=function(a,b){return(a=h.getMatchedCase(a,b))?h.styleFromSetters(a.setters):null};h.getMatchedCase=function(a,b){if(null!==a&&""!==a&&(a=Number(a),b&&!isNaN(a))){var c;b.cases.some(function(b){if(h._checkValueMatchesCase(a,b))return c=b,!0});return c}};h._checkValueMatchesCase=function(a,b){function c(a,b,c){switch(b){case "\x3d":return a===c;case "\x3c":return a<c;case "\x3e":return a>
c;case "\x3c\x3d":return a<=c;case "\x3e\x3d":return a>=c}return!1}return b.compareInfos.length&&b.compareInfos.every(function(b){return c(a,b.operator,Number(b.value))})};h.styleFromSetters=function(a){if(!a)return null;var b={};a.forEach(function(a){g[a.property]&&(b[g[a.property]]=a.value);"IsBold"===a.property&&(b.fontWeight="True"===a.value?"bold":"normal");"IsItalic"===a.property&&(b.fontStyle="True"===a.value?"italic":"normal");"IsUnderlined"===a.property&&(b.textDecoration="True"===a.value?
"underline":"none")});l.ptToPxObj(b);return b};h.settersFromStyle=function(a){var b=[];a=l.pxToPtObj(a,!0);for(var d in a){var f=e[d],g=a[d];!f||"string"!==typeof g&&isNaN(g)||b.push({property:f,value:g});"fontWeight"===d?b.push({property:"IsBold",value:"bold"===g?"True":"False"}):"fontStyle"===d?b.push({property:"IsItalic",value:"italic"===g?"True":"False"}):"textDecoration"===d&&b.push({property:"IsUnderlined",value:"underline"===g?"True":"False"})}return b};h.processImageJsonForTrigger=function(a,
b,d){var c=h.getMatchedCase(b,d);c||d.cases.some(function(a){if("default"===a.compareInfos[0].value)return c=a,!0});c&&(a.fileName=c.setters[0].value)};h.getStatistics=function(a){var b=Infinity,d=-Infinity,f,e,g;a&&a.cases.forEach(function(a){a.compareInfos&&a.compareInfos.forEach(function(a){var c=Number(a.value);isNaN(c)||(c<b&&(b=c,e="\x3c"===a.operator||"\x3c\x3d"===a.operator),c>d&&(d=c,g="\x3e"===a.operator||"\x3e\x3d"===a.operator),f=!0)})});return f&&-1E12<b&&1E12>b&&-1E12<d&&1E12>d?{min:b,
max:d,canFallBelowMin:e,canFallAboveMax:g}:null};var b=/\.png$/i;h.collectImageFileNames=function(a){var c=[];a&&a.cases&&a.cases.forEach(function(a){a.setters&&a.setters.forEach(function(a){"Source"===a.property&&b.test(a.value)&&c.push(a.value)})});return c};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/MetadataFromDataBuilder":function(){define(["esri/dijit/geoenrichment/utils/JsonXmlConverter","./map/RendererToMetadataConverter"],function(l,h){var g=
{},e={STORE_ID:1,AREA_ID:1,StdGeographyName:1,StdGeographyID:1,StdGeographyLevel:1};g.recoverMetadataFromAreaData=function(d,b){d=d[0];var a={name:"DataCollection",tags:[{name:"Calculators",tags:[]}]},c={},g;for(g in d){var f=d[g].data,n=d[g].comparisonLevels,m=b.map[g],p=!!m,m=p&&"object"===typeof m&&m.webMapJson||null,q=b.locator[g],q={name:p?"Maps":q?"Locator":"DataCollections",attributes:{Name:g},tags:[]};a.tags[0].tags.push(q);var t=[];if(p)for(var r in f){if(!e[r]){var u={name:"Map",attributes:{Name:r},
tags:[{name:"Layers",tags:[]}]};m&&m.operationalLayers.forEach(function(a){if(a.isLocatorLayer){var b={name:"LocatorResultsLayer",attributes:{CalculatorName:a.calculatorName},tags:[h.convertRendererJson(a.featureCollection.layers[0].layerDefinition.drawingInfo.renderer)]};c[a.calculatorName]=a.featureCollection.layers[0].title;u.tags[0].tags.push(b)}a.isComparisonLayer&&(b=a.featureCollection.layers[0].layerDefinition.drawingInfo,a={name:"ComparisonResultsLayer",attributes:{CalculatorName:a.calculatorName},
tags:[h.convertRendererJson(b.renderer)]},b.labelingInfo&&a.tags.push(h.convertLabelingInfo(b.labelingInfo)),u.tags[0].tags.push(a))});t.push(u)}}else for(r in f)t.push({name:"Field",attributes:{Name:r,Alias:r,MapTo:"DC."+r,Type:"number"===typeof f[r]?"Double":"String"}});q.tags.push({name:"Fields",tags:t});if(n&&n.length){var y=[],v={};n.forEach(function(a){a.StdGeographyLevel&&!v[a.StdGeographyLevel]&&(v[a.StdGeographyLevel]=1,y.push(a.StdGeographyLevel))});y.length&&q.tags.push({name:"ComparisonLevels",
tags:y.map(function(a){return{name:"ComparisonLevel",attributes:{Name:a}}})})}}a.tags[0].tags.forEach(function(a){if("Locator"===a.name){var b=c[a.attributes.Name];b&&(a.attributes.LayerName=b)}});return l.parseJson(a)};return g})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/metadata/map/RendererToMetadataConverter":function(){define(["dojo/_base/lang","esri/dijit/geoenrichment/utils/JsonXmlTypedConverter","esri/dijit/geoenrichment/utils/JsonXmlConverter"],function(l,
h,g){var e={convertRendererJson:function(d){switch(d.type){case "simple":"esriPMS"===d.symbol.type&&(d=l.clone(d),delete d.symbol.url)}return g.parseXml(h.parseJson(d,{rootName:"Renderer"}))},convertLabelRendererJson:function(d){d=d.uniqueValueInfos.map(function(b){return{labelExpressionInfo:{expression:"$feature.StdGeographyName"},where:"StdGeographyLevel\x3d'"+b.value+"'",labelPlacement:"esriServerPolygonPlacementAlwaysHorizontal",symbol:b.symbol}});return e.convertLabelingInfo(d)},convertLabelingInfo:function(d){return g.parseXml(h.parseJson(d,
{rootName:"LabelingInfo"}))}};return e})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/TemplateJsonLoader":function(){define("dojo/_base/lang esri/dijit/geoenrichment/Deferred esri/dijit/geoenrichment/when esri/dijit/geoenrichment/utils/CacheUtil ./CustomReportsManager ./GenericTemplateGenerator ./dataCollections/DataCollectionsLoader ../../core/conversion/PortalToEditorConverter ../../core/conversion/portalToEditorUtils/variables/PlayerVariableProvider ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoNameUtil ../../core/conversion/portalToEditorUtils/parsers/_FieldInfoBuilder".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n){var m={_getCache:function(){return e.get("TemplateJsonLoader")},getCachedTemplateJsonPromise:function(a,b){a=a+";"+b.reportID;return(a=this._getCache()[a])&&a.modified===b.modified?a.promise.then(function(a){return{templateJson:l.clone(a.templateJson),templateVariableProvider:a.templateVariableProvider}}):null},putCachedTemplateJsonPromise:function(a,b,c){b=b+";"+c.reportID;this._getCache()[b]={modified:c.modified,promise:a}}};return{getTemplateJsonByID:function(a,
b){var f=this,e=new h;g(d.getCustomReportByID(a),function(d){if(d){var h=b&&m.getCachedTemplateJsonPromise(a.countryID,d);h?h.then(e.resolve,e.reject):(h=f._loadCustomReportData(d).then(function(){var a=new k;return g(c.provideEditorJson(d,{variableProvider:a}),function(){var b=d.templateJson;d.portalJson=null;d.templateJson=null;return{templateJson:b,templateVariableProvider:a}})}),b?(m.putCachedTemplateJsonPromise(h,a.countryID,d),m.getCachedTemplateJsonPromise(a.countryID,d).then(e.resolve,e.reject)):
h.then(e.resolve,e.reject))}else e.reject("Can't find a report")},e.reject);return e.promise},_loadCustomReportData:function(a){a.portalJson=null;return a.templateData.getFiles().then(function(b){a.portalJson={files:b}})},createTemplateJsonFromVariables:function(c){return a.loadVariables({countryID:c.countryID,outFields:["description","precision","type","vintage"],forceLowerCase:!0}).then(function(a){var d=new k,e=a.fullNameToVariableCache;a=c.variables.fullNames.map(function(a){var b=f.createFieldNameFromSource(a),
g=c.variables.customDataMapping[a],g=g?g.variable:e[a];a={id:g.id.toLowerCase(),fullName:a,alias:g.description,fieldName:b,precision:g.precision,calculatorName:f.DATA_COLLECTIONS_CALCULATOR_NAME,templateName:f.DATA_COLLECTIONS_CALCULATOR_NAME+"."+b,type:g.type,vintage:g.vintage};d.addVariable(a);return n.getCalculatorOrScriptFieldInfo(a.templateName,{variableProvider:d})});return{templateJson:b.generateTemplatesFromFieldInfos(a,{comparisonLevels:c.comparisonLevels}),templateVariableProvider:d}})}}})},
"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/GenericTemplateGenerator":function(){define("../../core/supportClasses/templateJsonUtils/BlankTemplateJsonUtil ../../core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder ../../core/supportClasses/tableJson/TableJsonUtil ../../core/sections/sectionUtils/SectionJsonUtil ../../core/infographics/InfographicTypes ../../core/infographics/utils/InfographicJsonUtil".split(" "),function(l,h,g,e,d,b){var a={},c={calcNumRowsColumns:function(a){var b;
b=2>=a?1:6>=a?2:12>=a?3:Math.ceil(a/4);var c;c=1===a?1:4>=a?2:9>=a?3:4;return{numRows:b,numColumns:c,numVarsInLastRow:c-(b*c-a),lastRowCellIndexes:null,lastRowCellWidths:null}}},k={mergeLastRow:function(a,b,c){2===b.numColumns?1===b.numVarsInLastRow&&(g.modifyTableJson(a,b.numRows-1,0,{columnSpan:2}),b.lastRowCellWidths=[2*c]):3===b.numColumns?1===b.numVarsInLastRow?(g.modifyTableJson(a,b.numRows-1,0,{columnSpan:3}),b.lastRowCellWidths=[3*c]):2===b.numVarsInLastRow&&(g.modifyTableJson(a,b.numRows-
1,0,{cellStyle:{width:1.5*c}}),g.modifyTableJson(a,b.numRows-1,1,{columnSpan:2,cellStyle:{width:.5*c}}),b.lastRowCellWidths=[1.5*c,1.5*c]):4===b.numColumns&&(1===b.numVarsInLastRow?(g.modifyTableJson(a,b.numRows-1,0,{columnSpan:4}),b.lastRowCellWidths=[4*c]):2===b.numVarsInLastRow?(g.modifyTableJson(a,b.numRows-1,0,{columnSpan:2}),g.modifyTableJson(a,b.numRows-1,2,{columnSpan:2}),b.lastRowCellIndexes=[0,2],b.lastRowCellWidths=[2*c,2*c]):3===b.numVarsInLastRow&&(g.modifyTableJson(a,b.numRows-1,0,{cellStyle:{width:4*
c/3}}),g.modifyTableJson(a,b.numRows-1,1,{columnSpan:2,cellStyle:{width:2*c/3}}),g.modifyTableJson(a,b.numRows-1,2,{cellStyle:{width:2*c/3}}),g.modifyTableJson(a,b.numRows-1,3,{cellStyle:{width:4*c/3}}),b.lastRowCellIndexes=[0,1,3],b.lastRowCellWidths=[4*c/3,4*c/3,4*c/3]))}},f={insertNextPanel:function(a,b,c){void 0===b.currentRowIndex&&(b.currentRowIndex=0,b.currentColumnIndex=0);var d=b.currentRowIndex===b.numRows-1;a.data.data[b.currentRowIndex].fieldInfos["field"+(d&&b.lastRowCellIndexes?b.lastRowCellIndexes[b.currentColumnIndex]:
b.currentColumnIndex)]=c(d&&b.lastRowCellWidths&&b.lastRowCellWidths[b.currentColumnIndex]);b.currentColumnIndex++;b.currentColumnIndex>b.numColumns-1&&(b.currentColumnIndex=0,b.currentRowIndex++)}};a.generateTemplatesFromFieldInfos=function(b){var d=c.calcNumRowsColumns(b.length),n=l.createBlankTemplate({elementWidth:500,elementHeight:250,layout:{numRows:d.numRows,numColumns:d.numColumns}}),q=n.sectionsTables[0];k.mergeLastRow(q,d,500);b.forEach(function(b){f.insertNextPanel(q,d,function(c){var d=
a._createInfographicJson(b,c||500,250);c=g.createSingleCellTable({width:c||500,height:250,fieldInfo:h.createFieldInfoFromInfographic(d)});return h.createFieldInfoFromSection(e.wrapInDetailsSectionJson(c))})});return n};a._createInfographicJson=function(a,c,f){return{type:d.ONE_VAR,title:a.alias,style:{width:c,height:f},levels:b.getDefaultLevels(),fieldInfos:[a],calcData:{calculatorName:a.templateName.substr(0,a.templateName.indexOf(".")),variables:[a.fullName]}}};return a})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/BlankTemplateJsonUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions",
"./TemplateJsonModificationUtil"],function(l,h){return{createBlankTemplate:function(g){var e={},d=g.documentOptions||l.getDefaultDocumentOptionsGraphicReport();d.pagesize=l.combineCustomSizeString(d.left+d.right+g.layout.numColumns*g.elementWidth,d.top+d.bottom+g.layout.numRows*g.elementHeight,"px");e.documentOptions=d;for(var d={style:{width:g.layout.numColumns*g.elementWidth},data:{columns:[],data:[]}},b=0;b<g.layout.numColumns;b++)d.data.columns.push({field:"field"+b,style:{width:g.elementWidth}});
for(b=0;b<g.layout.numRows;b++)d.data.data.push({style:{height:g.elementHeight},fieldInfos:{}});e.sectionsTables=[d];h.adjustDocumentOptions(e);return e}}})},"esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/TemplateJsonModificationUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions","esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridLayoutCalculator"],function(l,h){var g={},e={getJsonStat:function(b){var a=0,c=
0,e=[];b.sectionsTables.forEach(function(b){var f=0;b.data.columns.forEach(function(a){f+=d.getFieldWidth(b,b.data.data[0],a)});a=Math.max(a,f);var g=0;b.data.data.forEach(function(a){g+=d.getDataHeight(b,a,b.data.columns[0])});c=Math.max(c,g);e.push({totalW:f,totalH:g})});return{tableInfos:e,totalWMax:a,totalHMax:c}}},d={getFieldWidth:function(b,a,c){return h.getFieldWidth({looseResize:!0},a,c)||c.style.width},getDataHeight:function(b,a,c){return h.getDataHeight({looseResize:!0},a,c.field)},getAverageFieldWidth:function(b,
a){var c=0;b.data.data.forEach(function(e){c+=d.getFieldWidth(b,e,a)});return c/b.data.data.length},getAverageDataHeight:function(b,a){var c=0;b.data.columns.forEach(function(e){c+=d.getDataHeight(b,a,e)});return c/b.data.columns.length}};g.adjustDocumentOptions=function(b){if(b.documentOptions){var a=e.getJsonStat(b);a.totalWMax&&a.totalHMax&&!isNaN(a.totalWMax)&&!isNaN(a.totalHMax)&&(b=b.documentOptions,b.pagesize=l.combineCustomSizeString(b.left+b.right+a.totalWMax,b.top+b.bottom+a.totalHMax,"px"),
(a=l.getClosestStandrdSizes(b)[0])&&.001>a.score&&a.orientation===b.orientation&&(b.pagesize=a.pagesize))}};g.JsonStatCollector=e;g.DataUtil=d;return g})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridLayoutCalculator":function(){define("dojo/_base/lang ./gridLayoutCalcUtils/GridLayoutCalculatorQueryUtil ./gridLayoutCalcUtils/GridElementBoxCalculator ./gridLayoutCalcUtils/GridCellNodePlacer ./gridLayoutCalcUtils/rows/GridLayoutRowsCalculator ./gridLayoutCalcUtils/columns/GridLayoutColumnsCalculator ./gridLayoutCalcUtils/GridLayoutSnapper ../../supportClasses/tableJson/TableJsonUtil".split(" "),
function(l,h,g,e,d,b,a,c){var k={};g.calculator=k;k.markAsDirty=h.markAsDirty;k.fieldToColumn=h.fieldToColumn;k.dataIdToData=h.dataIdToData;k.getSpannedColumns=h.getSpannedColumns;k.recalcRows=d.recalcRows;k.recalcColumns=b.recalcColumns;k.recalcColumnsTableJson=b.recalcColumnsTableJson;k.recalcRowsToFitHeight=d.recalcRowsToFitHeight;k.adjustColumnWidth=b.adjustColumnWidth;k.getAffectedCellsForColumnAdjust=b.getAffectedCells;k.adjustRowHeight=d.adjustRowHeight;k.getAffectedCellsForRowAdjust=d.getAffectedCells;
k.recalcGridWidth=b.recalcGridWidth;k.calcFieldWidth=b.calcFieldWidth;k.getFieldWidth=b.getFieldWidth;k.setFieldWidth=b.setFieldWidth;k.calcDataHeight=d.calcDataHeight;k.getDataHeight=d.getDataHeight;k.setDataHeight=d.setDataHeight;k.autoSnapLayout=a.autoSnapLayout;k.positionCells=e.positionCells;k.calcFeatureCount=function(a,b,c){return(a-b)/c};k.calcRingIndexForCell=function(a){var b=a.parentGrid;if(!b)return-1;if(b.getNumDynamicRows())return void 0!==a.gridData.currentFeatureIndex?a.gridData.currentFeatureIndex:
a.gridData.index-b.getNumFixedRows();var c=b.getNumFixedColumns();return a.column.index<c?-1:Math.floor((a.column.index-c)/b.getNumDynamicColumns())};k.trimColumnsForNumberOfFeatures=function(a){for(var b=a.viewModel.dynamicReportInfo.fieldData.areaData.length,c=k.recalcGridWidth(a),d=0,e=0;e<a.getNumFixedColumns();e++)d+=a.columns[e].style.width;c-=d;d=k.calcFeatureCount(a.columns.length,a.getNumFixedColumns(),a.getNumDynamicColumns())-b;if(!(0>d)){for(var f=a.columns.slice(),e=f.length=a.getNumFixedColumns(),
g=[],h=0;a.columns[e];){for(var l=0;l<b;l++){var v=a.columns[e++],h=h+v.style.width;g.push(v)}e+=d}var w=c/h;g.forEach(function(a){a.style.width*=w});a.columns=f.concat(g)}};k.adjustRowsForNumberOfFeatures=function(a){var b=a.viewModel.dynamicReportInfo.fieldData.areaData.length;if(!(1>=b)){var d=a.store.data[a.getNumFixedRows()];d.currentFeatureIndex=0;for(var e=1;e<b;e++){var f=l.clone(d);f.currentFeatureIndex=e;a.store.data.push(f)}c.applyDefaultStyling({data:{data:a.store.data,columns:a.columns}})}};
return k})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridLayoutCalculatorQueryUtil":function(){define([],function(){var l={markAsDirty:function(h){h._fieldToColumnHash=null;h._dataIdToDataHash=null},_calcGridHashes:function(h){h._fieldToColumnHash={};h.columns.forEach(function(g){h._fieldToColumnHash[g.field]=g});h._dataIdToDataHash={};h.store.data.forEach(function(g){h._dataIdToDataHash[g.id]=g})},fieldToColumn:function(h,g){h._fieldToColumnHash||l._calcGridHashes(h);
return h._fieldToColumnHash&&h._fieldToColumnHash[g]},dataIdToData:function(h,g){h._dataIdToDataHash||l._calcGridHashes(h);return h._dataIdToDataHash&&h._dataIdToDataHash[g]},getSpannedColumns:function(h,g,e){var d=[];if(1>e)return[];var b;h.columns.some(function(a){if(b||a.field===g)d.push(a),b=!0;if(d.length===e)return!0});return d},getColumnSpannedFields:function(h,g,e){var d=null,b=g.fieldToRowSpanSourceDataIndex&&g.fieldToRowSpanSourceDataIndex[e];g=void 0!==b?h.store.data[b]:g;g=g.columnSpans&&
g.columnSpans[e];if(1<g)for(d=[],e=l.fieldToColumn(h,e),b=e=h.columns.indexOf(e);b<e+g;b++)d.push(h.columns[b].field);return d},getRowSpannedData:function(h,g,e){var d=null;e=g.fieldToColumnSpanSourceField&&g.fieldToColumnSpanSourceField[e]||e;e=g.rowSpans&&g.rowSpans[e];if(1<e)for(var d=[],b=g=h.store.data.indexOf(g);b<g+e;b++)d.push(h.store.data[b]);return d},getMovableData:function(h,g,e){return(g=g.movableIndexHashVertical&&g.movableIndexHashVertical[e])&&h.store.data[g]},getMovableColumn:function(h,
g,e){return(g=g.movableFieldsHashHorizontal&&g.movableFieldsHashHorizontal[e])&&l.fieldToColumn(h,g)}};return l})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridElementBoxCalculator":function(){define([],function(){function l(g,e,d,b,a){function c(a){return b&&void 0!==b.places?Number(a.toFixed(b.places)):a}if(!e||!d)return null;var k=h.calculator[a?"getFieldWidth":"calcFieldWidth"](g,e,d);a=h.calculator[a?"getDataHeight":"calcDataHeight"](g,e,d);for(var f=0,l=
0,m=h.calculator.fieldToColumn(g,d),p=0;p<m.index;p++)f+=h.calculator.getFieldWidth(g,e,g.columns[p].field);for(p=0;p<e.index;p++)l+=h.calculator.getDataHeight(g,g.store.data[p],d);return{x:c(f),y:c(l),w:c(k),h:c(a)}}var h={calculator:null,calcCellBox:function(g,e){return l(g.parentGrid,g.gridData,g.column.field,e,!1)},calcDataBox:function(g,e,d,b){return l(g,e,d,b,!0)}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridCellNodePlacer":function(){define(["./rows/GridLayoutRowsCalculator",
"./columns/GridLayoutColumnsCalculator"],function(l,h){return{positionCells:function(g){var e={},d={},b={},a={};if(g.store.data.length){g.store.data.forEach(function(c,f){g.columns.forEach(function(k,n){var m=b[n]||0,p=a[f]||0,q=l.getDataHeight(g,c,k.field);k=h.getFieldWidth(g,c,k.field);m+=q;p+=k;d[n+"_"+f]=m;e[n+"_"+f]=p;b[n]=m;a[f]=p})});g.getFieldCells().forEach(function(a){a.domNode.style.left=(e[a.column.index-1+"_"+a.gridData.index]||0)+"px";a.domNode.style.top=(d[a.column.index+"_"+(a.gridData.index-
1)]||0)+"px"});var c=0,k;for(k in b)c=Math.max(c,b[k]);var f=0;for(k in a)f=Math.max(f,a[k]);g.mainNode.style.width=f+"px";g.mainNode.style.height=c+"px";g.domNode.style.width=f+"px";g.domNode.style.height=c+"px";g._width=f;g._height=c}}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/GridLayoutRowsCalculator":function(){define(["./RowsProcessor","./RowsScaler","./RowDataUtil","./RowModifier"],function(l,h,g,e){var d={};d.recalcRows=l.recalcRows;d.recalcRowsToFitHeight=
h.recalcRowsToFitHeight;d.adjustRowHeight=e.adjustRowHeight;d.getAffectedCells=e.getAffectedCells;d.getDataHeight=g.getDataHeight;d.setDataHeight=g.setDataHeight;d.calcDataHeight=g.calcDataHeight;return d})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowsProcessor":function(){define(["dojox/uuid/generateRandomUuid","./RowDataUtil","../GridLayoutCalculatorQueryUtil"],function(l,h,g){function e(b,a){var c=[],d,e=0;a&&Object.keys(a).forEach(function(c){g.fieldToColumn(b,
c)?e++:delete a[c]});e&&b.columns.some(function(b){if(d||a[b.field])c.push(b),d=!0;a[b.field]&&e--;if(!e)return!0});return c}function d(b,a){var c=[],d,e=0;a&&Object.keys(a).forEach(function(c){g.dataIdToData(b,c)?e++:delete a[c]});e&&b.store.data.some(function(b){if(d||a[b.id])c.push(b),d=!0;a[b.id]&&e--;if(!e)return!0});return c}return{recalcRows:function(b){var a={};b.columns.forEach(function(b,c){a[b.field]=c});var c;b.store.data.forEach(function(d,f){d.index=f;d.style=d.style||{};d.style.fields=
d.style.fields||{};void 0===d.id&&(d.id=l());void 0===d.style.height&&(d.style.height=b.layoutDefaults.defaultRowHeight);delete d.excludedIndexHorizontal;delete d.movableFieldsHashHorizontal;delete d.fieldToColumnSpanSourceField;if(d.columnSpans){d.excludedIndexHorizontal={};d.movableFieldsHashHorizontal={};d.fieldToColumnSpanSourceField={};d._columnSpans=d._columnSpans||{};for(c in d.columnSpans){f=d._columnSpans[c];var k={};f=f?e(b,f):g.getSpannedColumns(b,c,d.columnSpans[c]);1<f.length&&(f.forEach(function(b){k[b.field]=
!0;b.field!==c&&(d.excludedIndexHorizontal[a[b.field]]=!0,d.fieldToColumnSpanSourceField[b.field]=c)}),d.movableFieldsHashHorizontal[c]=f[f.length-1].field);d.columnSpans[c]=f.length;d._columnSpans[c]=k}var h=0;Object.keys(d.columnSpans).forEach(function(a){2>d.columnSpans[a]?(delete d.columnSpans[a],delete d._columnSpans[a]):h++});h||(delete d.columnSpans,delete d._columnSpans)}delete d.excludedIndexVertical;delete d.movableIndexHashVertical;delete d.fieldToRowSpanSourceDataIndex;d.fieldInfos=d.fieldInfos||
{}});b.store.data.forEach(function(e,f){if(e.rowSpans)for(c in e._rowSpans=e._rowSpans||{},e.rowSpans){var g=e._rowSpans[c],k={};k[e.id]=!0;var h=a[c],l=e.rowSpans[c];if(g)g=d(b,g);else for(var g=[],n=f;n<f+l;n++)g.push(b.store.data[n]);1<g.length&&(g.forEach(function(a){if(a.id!==e.id){a.excludedIndexVertical=a.excludedIndexVertical||{};a.excludedIndexVertical[h]=!0;a.fieldToRowSpanSourceDataIndex=a.fieldToRowSpanSourceDataIndex||{};a.fieldToRowSpanSourceDataIndex[c]=e.index;var d=e.columnSpans&&
e.columnSpans[c];if(d)for(var f=1;f<d;f++)a.excludedIndexVertical[h+f]=!0,a.fieldToRowSpanSourceDataIndex[b.columns[h+f].field]=e.index}k[a.id]=!0}),e.movableIndexHashVertical=e.movableIndexHashVertical||{},e.movableIndexHashVertical[c]=f+g.length-1);e.rowSpans[c]=g.length;e._rowSpans[c]=k}});b.store.data.forEach(function(a,d){if(a.rowSpans){for(c in a.rowSpans)a.rowSpans[c]=Math.min(a.rowSpans[c],b.store.data.length-d);var e=0;Object.keys(a.rowSpans).forEach(function(b){2>a.rowSpans[b]?(delete a.rowSpans[b],
a._rowSpans&&delete a._rowSpans[b]):e++});e||(delete a.rowSpans,delete a._rowSpans)}});b.store.data.forEach(function(b,c){b.fieldInfos&&Object.keys(b.fieldInfos).forEach(function(c){void 0===a[c]&&delete b.fieldInfos[c]});b.style&&b.style.fields&&Object.keys(b.style.fields).forEach(function(c){void 0===a[c]&&delete b.style.fields[c]})});if(b.looseResize){b.store.data.forEach(function(a){b.columns.some(function(c){h.getDataHeightOwn(b,a,c.field)||h.setDataHeight(b,a,c.field,a.style.height)})});var k=
b.store.data[b.store.data.length-1],f=h.recalcGridHeight(b);b.columns.some(function(a){var c=0;b.store.data.forEach(function(d){c+=h.getDataHeightOwn(b,d,a.field)});var d=f-c;0!==d&&h.setDataHeight(b,k,a.field,h.getDataHeightOwn(b,k,a.field)+d)})}h.recalcGridHeight(b)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowDataUtil":function(){define(["../GridLayoutCalculatorQueryUtil"],function(l){var h={getDataHeight:function(g,e,d){return g.looseResize?h.getDataHeightOwn(g,
e,d)||e.style.height||0:e.style.height||0},getDataHeightOwn:function(g,e,d){if(g.looseResize)return e.style.fields=e.style.fields||{},(e.style.fields[d]=e.style.fields[d]||{}).height},setDataHeight:function(g,e,d,b,a){g.looseResize?(a?l.getColumnSpannedFields(g,e,d)||[d]:[d]).forEach(function(a){e.style.fields=e.style.fields||{};(e.style.fields[a]=e.style.fields[a]||{}).height=b}):e.style.height=b},calcDataHeight:function(g,e,d,b){var a=0,c=e.rowSpans&&e.rowSpans[d];if(1<c)for(var k=e.index;k<e.index+
c;k++)k!==b&&(a+=h.getDataHeight(g,g.store.data[k],d));else a=h.getDataHeight(g,e,d);return a},recalcGridHeight:function(g){g._height=0;var e=g.columns[0].field;g.store.data.forEach(function(d){g._height+=h.getDataHeight(g,d,e)});return g._height}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowsScaler":function(){define(["./RowDataUtil"],function(l){return{recalcRowsToFitHeight:function(h,g){function e(a){a.forEach(function(a){h.columns.some(function(c,
d){if(!h.looseResize&&d)return!0;l.setDataHeight(h,a,c.field,l.getDataHeight(h,a,c.field)*b)})})}var d=l.recalcGridHeight(h),b=g/d;1!==b&&(e(h.store.data),h._getSavedOriginalData()&&e(h._getSavedOriginalData()),l.recalcGridHeight(h))}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/RowModifier":function(){define(["../GridLayoutCalculatorQueryUtil","./RowDataUtil","./_RowModifierLoose","./_RowModifierNormal"],function(l,h,g,e){var d={},b={checkHeightLimit:function(a,
b,c,d){if(a.getMaxHeight()){var e=0;a.store.data.forEach(function(d){d!==b&&(e+=h.getDataHeight(a,d,c))});d=Math.min(a.getMaxHeight()-e,d)}return d}},a={findDataToMove:function(a,b,c,d){var e=l.getMovableData(a,b,c);e&&(a=h.calcDataHeight(a,b,c,e.index),d-=a);return{data:e||b,height:d}}},c={finalResizeGridCells:function(a){a.getFieldCells().forEach(function(b){b.setHeight(h.calcDataHeight(a,b.gridData,b.column.field))})}};d.adjustRowHeight=function(d,f,h,l){l=b.checkHeightLimit(d,f,h,l);f=a.findDataToMove(d,
f,h,l);(d.looseResize?g:e).adjustRowHeight(d,f.data,h,f.height);c.finalResizeGridCells(d)};d.getAffectedCells=function(b,c,d){return b.looseResize?g.getAffectedCells(b,a.findDataToMove(b,c,d).data,d):null};return d})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/_RowModifierLoose":function(){define("dojo/_base/lang dojox/uuid/generateRandomUuid ../GridLayoutCalculatorQueryUtil ../GridElementBoxCalculator ./RowDataUtil ../../GridQueryUtil".split(" "),function(l,
h,g,e,d,b){var a={collectRowBoxes:function(a,b){for(var c=[],d=0;d<a.columns.length;){var e=a.columns[d],f=this._createEmptyBox(),e=g.getColumnSpannedFields(a,b,e.field)||[e.field];f.elements=this._getFieldsElements(a,b,e);this._measureBox(f);var k=c[c.length-1];k&&(k.nextSibling=f,f.prevSibling=k);c.push(f);d+=e.length}return c},_createEmptyBox:function(){return{id:h(),box:null,elements:[],overlappingBoxes:[],overlappingBoxesCache:{},prevSibling:null,nextSibling:null}},_getFieldsElements:function(a,
b,c){var d=[];c.forEach(function(c){c={data:b,dataIndex:b.index,field:c,box:e.calcDataBox(a,b,c,{places:2})};d.push(c)});return d},_measureBox:function(a){var b=0;a.elements.forEach(function(a){b+=a.box.w});a.box={x:a.elements[0].box.x,y:a.elements[0].box.y,h:a.elements[0].box.h,w:b}},mergeBoxesForBottomRow:function(a){var b=this._createEmptyBox();a.forEach(function(a){a.elements.forEach(function(a){b.elements.push({data:null,field:a.field,box:l.clone(a.box)})})});this._measureBox(b);b.box.h=1E6;
return[b]},getBoxAtField:function(a,b){return a.filter(function(a){return a.elements[0].field===b})[0]}},c={buildInfluenceTree:function(b,c,d){function e(a,d){(d?c:b).forEach(function(b){var c;if(c=!b.overlappingBoxesCache[a.id]){c=a.box;var d=b.box;c=!(c.x+.5>=d.x+d.w||c.x+c.w<=d.x+.5)}c&&(a.overlappingBoxes.push(b),a.overlappingBoxesCache[b.id]=!0)});a.overlappingBoxes.forEach(function(a){e(a,!d)})}d=a.getBoxAtField(b,d);e(d,!0);return d}},k={applyForce:function(a,b,c){function e(b,c){var g=b.elements[0];
g.data&&d.setDataHeight(a,g.data,g.field,d.getDataHeight(a,g.data,g.field)+(c?-1:1)*f,!0);b.overlappingBoxes.forEach(function(a){e(a,!c)})}var f=this._checkDelta(a,b,c);e(b,!1)},_checkDelta:function(a,b,c){function d(a,b){0!==f&&(b?0>f||(f=Math.min(f,a.box.h-e),a.prevSibling&&(f=Math.min(f,a.prevSibling.box.y+a.prevSibling.box.h-e-a.box.y)),a.nextSibling&&(f=Math.min(f,a.nextSibling.box.y+a.nextSibling.box.h-e-a.box.y))):0<f||(f=Math.max(f,-(a.box.h-e)),a.prevSibling&&(f=Math.max(f,-(a.box.y+a.box.h-
(a.prevSibling.box.y+e)))),a.nextSibling&&(f=Math.max(f,-(a.box.y+a.box.h-(a.nextSibling.box.y+e))))),a.overlappingBoxes.forEach(function(a){d(a,!b)}))}var e=a.layoutDefaults.rowMinHeight;c=Math.max(c,e);var f=c-b.box.h;d(b,!1);return f}},f={_getInluencedStartBox:function(b,d,e){var f=b.store.data[d.index+1];d=a.collectRowBoxes(b,d);b=f?a.collectRowBoxes(b,f):a.mergeBoxesForBottomRow(d);return c.buildInfluenceTree(d,b,e)},getAffectedCells:function(a,c,d){function e(c){if(c.elements[0].data){var d=
b.querySingleCell(a,{rowIndex:c.elements[0].data.index,columnField:c.elements[0].field,considerSpans:!0});d&&f.push(d)}c.overlappingBoxes.forEach(e)}var f=[];c=this._getInluencedStartBox(a,c,d);e(c);return f},adjustRowCell:function(a,b,c,d){b=this._getInluencedStartBox(a,b,c);k.applyForce(a,b,d)}};return{adjustRowHeight:function(a,b,c,d){f.adjustRowCell(a,b,c,d)},getAffectedCells:function(a,b,c){return f.getAffectedCells(a,b,c)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/GridQueryUtil":function(){define(["dojo/dom-geometry",
"./GridDataUtil","esri/dijit/geoenrichment/utils/ArrayUtil","esri/dijit/geoenrichment/utils/DomUtil","esri/dijit/geoenrichment/utils/MouseUtil"],function(l,h,g,e,d){var b={querySingleCell:function(a,c){c.fieldCell&&(c={rowId:c.fieldCell.rowId,columnId:c.fieldCell.columnId});var d;a.getFieldCells().some(function(a){if(a.parentGrid&&a.column&&a.gridData&&!(a.columnId!==c.columnId&&a.column.index!==c.columnIndex&&a.column.field!==c.columnField||a.rowId!==c.rowId&&a.gridData.index!==c.rowIndex))return d=
a,!0});if(d)return d;if(c.considerSpans){var e=b.queryColumn(a,c),g=b.queryData(a,c);if(!e||!g)return null;var h=e.index,l=g.index;a.store.data.some(function(c){return a.columns.some(function(e){var f=e.index,g=e.index+(c.columnSpans&&c.columnSpans[e.field]||0),k=c.index;e=c.index+(c.rowSpans&&c.rowSpans[e.field]||0);if(f<=h&&g>=h&&k<=l&&e>=l)return d=b.querySingleCell(a,{columnIndex:f,rowIndex:k}),!0})})}return d},queryColumn:function(a,b){var c;a.columns.some(function(a){if(a.id===b.columnId||a.index===
b.columnIndex||a.field===b.columnField)return c=a,!0});return c},queryData:function(a,b){var c;a.store.data.some(function(a){if(a.id===b.rowId||a.index===b.rowIndex)return c=a,!0});return c},queryCells:function(a,c){if(c.fieldCell){var d=[],e=c.rowSpan||1,g=c.columnSpan||1;if(c=b.querySingleCell(a,c))for(var h=c.gridData.index;h<c.gridData.index+e;h++)for(var l=c.column.index;l<c.column.index+g;l++){var q=b.querySingleCell(a,{rowIndex:h,columnIndex:l});q&&d.push(q)}return d}return this.queryCellsInArray(a.getFieldCells(),
c)},queryCellsInArray:function(a,b){var c=[];if(!Object.keys(b).length)return c;a.forEach(function(a,d){if(void 0===b.cellIndex||d===b.cellIndex)if(void 0===b.cellIndexes||-1!==b.cellIndexes.indexOf(d))if(void 0===b.columnId||a.columnId===b.columnId)if(void 0===b.columnIds||-1!==b.columnIds.indexOf(a.columnId))if(void 0===b.columnIndex||a.column.index===b.columnIndex)if(void 0===b.columnIndexes||-1!==b.columnIndexes.indexOf(a.column.index))if(void 0===b.columnField||a.column.field===b.columnField)if(void 0===
b.columnFields||-1!==b.columnFields.indexOf(a.column.field))if(void 0===b.rowId||a.rowId===b.rowId)if(void 0===b.rowIds||-1!==b.rowIds.indexOf(a.rowId))if(void 0===b.rowIndex||a.gridData.index===b.rowIndex)void 0!==b.rowIndexes&&-1===b.rowIndexes.indexOf(a.gridData.index)||c.push(a)});return c},getTitleCell:function(a){var c=b.querySingleCell(a,{rowIndex:0,columnIndex:0});if(c&&!h.getFieldInfo(c)&&(1===a.columns.length||h.getColumnSpan(c)===a.columns.length))return c},isDynamicFieldCell:function(a,
b){return a._dynamicBindings&&a._dynamicBindings[b.column.field]},getDynamicallyBoundColumns:function(a,b){return a._dynamicBindings&&a._dynamicBindings[b.field]},getDynamicallyBoundFieldCells:function(a,c){if(c.column){var d=a._dynamicBindings&&a._dynamicBindings[c.column.field];if(!d)return null;var e=[];d.forEach(function(d){(d=d&&b.querySingleCell(a,{columnId:d.id,rowId:c.rowId}))&&e.push(d)});return e}},getAllBoundCells:function(a,c,d){var e=[],k={};c&&c.forEach(function(c){if((!d||d(c))&&!k[c.uniqueId]){k[c.uniqueId]=
!0;var f=b.getDynamicallyBoundFieldCells(a,c);f?f.forEach(function(a){e.push(a);k[a.uniqueId]=!0}):e.push(c)}});return g.removeDuplicates(e,"uniqueId")},trimDynamicBindings:function(a,c){var d=[],e={};c&&c.forEach(function(c){var f=b.getDynamicallyBoundFieldCells(a,c);f&&f.length?(e[f[0].uniqueId]||d.push(f[0]),f.forEach(function(a){e[a.uniqueId]=!0})):d.push(c)});return d},collectFieldInfos:function(a,c){var d=[];c=c||{};var e=c.fieldCells||a.getFieldCells();c.trimDynamicBinding&&e&&(e=b.trimDynamicBindings(a,
e));e&&e.forEach(function(a){(a=h.getFieldInfo(a))&&d.push(a)});return d},cellHasFloatingTableParent:function(a){function b(a){return a.isSection&&a.isDataDrillingView?!1:a.isFloatingTable?!0:a.parentWidget?b(a.parentWidget):!1}return a&&a.parentGrid?b(a.parentGrid):!1},isMouseOver:function(a){return d.isMouseOverBox(b.getBBox(a))},getOverFieldCell:function(a,b){b=b||{};var c=b.cellFilter||function(){return!0},d;a.getForegroundFloatingCells({topFirst:!0}).some(function(a){if(c(a)&&a.isMouseOver())return d=
a,!0});d||a.getFieldCells().some(function(a){if(c(a)&&a.isMouseOver())return d=a,!0});d||a.getBackgroundFloatingCells({topFirst:!0}).some(function(a){if(c(a)&&a.isMouseOver())return d=a,!0});return d},getBBox:function(a,b){var c=a.isSingleCelledTable()&&a.getFirstCell().getAngle();return"number"===typeof c&&0!==c?a.getFirstCell().getBBox(b):b&&b.noTransformation?e.noTransformPosition(a.domNode):l.position(a.domNode)}};return b})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/rows/_RowModifierNormal":function(){define(["./RowDataUtil"],
function(l){return{adjustRowHeight:function(h,g,e,d){var b=h.layoutDefaults.rowMinHeight;d=Math.max(d,b);var a=d-l.getDataHeight(h,g,e);if(h.keepGridHeightWhenResized){var c=h.store.data[g.index+1];c&&(a=l.getDataHeight(h,c,e)-a,a<b&&(d-=b-a,a=b),l.setDataHeight(h,c,e,a,!0))}l.setDataHeight(h,g,e,d,!0)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/GridLayoutColumnsCalculator":function(){define(["./ColumnDataUtil","./ColumnModifier","./ColumnsProcessor"],
function(l,h,g){var e={};e.recalcColumns=g.recalcColumns;e.recalcColumnsTableJson=g.recalcColumnsTableJson;e.adjustColumnWidth=h.adjustColumnWidth;e.getAffectedCells=h.getAffectedCells;e.getFieldWidth=l.getFieldWidth;e.setFieldWidth=l.setFieldWidth;e.calcFieldWidth=l.calcFieldWidth;e.recalcGridWidth=l.recalcGridWidth;return e})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/ColumnDataUtil":function(){define(["../GridLayoutCalculatorQueryUtil"],function(l){var h=
{getFieldWidth:function(g,e,d){var b="string"===typeof d?l.fieldToColumn(g,d):d;d=b?b.field:"string"===typeof d?d:null;return g.looseResize?h.getFieldWidthOwn(g,e,d)||b&&b.style.width||0:b&&b.style.width||0},getFieldWidthOwn:function(g,e,d){if(g.looseResize)return e.style.fields=e.style.fields||{},(e.style.fields[d]=e.style.fields[d]||{}).width},setFieldWidth:function(g,e,d,b,a){var c="string"===typeof d?l.fieldToColumn(g,d):d,k=c?c.field:"string"===typeof d?d:null;g.looseResize?(a?l.getRowSpannedData(g,
e,k)||[e]:[e]).forEach(function(a){a.style.fields=a.style.fields||{};(a.style.fields[k]=a.style.fields[k]||{}).width=b}):c&&(c.style.width=b)},calcFieldWidth:function(g,e,d,b){var a=0;1<(e.columnSpans&&e.columnSpans[d])?l.getSpannedColumns(g,d,e.columnSpans[d]).forEach(function(c){b!==c.field&&(a+=h.getFieldWidth(g,e,c.field))}):a=h.getFieldWidth(g,e,d);return a},recalcGridWidth:function(g){g._width=0;var e=g.store.data[0];g.columns.forEach(function(d){g._width+=h.getFieldWidth(g,e,d.field)});return g._width},
getAllowedWidth:function(g){return g.fitParentWhenResized?g.getAllowedWidthFromParent():g.getAllowedWidth()}};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/ColumnModifier":function(){define(["../GridLayoutCalculatorQueryUtil","./ColumnDataUtil","./_ColumnModifierNormal","./_ColumnModifierLoose"],function(l,h,g,e){var d={},b={getColumnToChange:function(a,b,c,d){var e=l.getMovableColumn(a,b,c.field);e&&(a=h.calcFieldWidth(a,b,c.field,e.field),d-=
a);return{column:e||c,width:d}}},a={finalResizeGridCells:function(a){a.getFieldCells().forEach(function(b){b.setWidth(h.calcFieldWidth(a,b.gridData,b.column.field))});h.recalcGridWidth(a)}},c={recalcToStick:function(a){var b=a.columns[a.columns.length-1];a.store.data.some(function(c,d){if(!a.looseResize&&d)return!0;var e=0;a.columns.forEach(function(d){d!==b&&(e+=h.getFieldWidth(a,c,d.field))});h.setFieldWidth(a,c,b.field,h.getAllowedWidth(a)-e)})}};d.adjustColumnWidth=function(d,f,h,l){h=b.getColumnToChange(d,
f,h,l);(d.looseResize?e:g).adjustColumnWidth(d,f,h.column,h.width);d.stickToRight&&c.recalcToStick(d);a.finalResizeGridCells(d)};d.getAffectedCells=function(a,c,d){return a.looseResize?e.getAffectedCells(a,c,b.getColumnToChange(a,c,d).column):null};return d})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/_ColumnModifierNormal":function(){define(["./ColumnDataUtil"],function(l){var h={},g={adjustColumnWidth:function(e,d,b,a,c){function k(a,b){return l.setFieldWidth(e,
d,a.field,b,!0)}var f=e.layoutDefaults.columnMinWidth,h=function(){if(!b)return null;var g=l.getFieldWidth(e,d,b.field);void 0!==c&&(a=g+c);a=Math.max(f,a);var k,h=0,m=!1;e.columns.forEach(function(a){h+=l.getFieldWidth(e,d,a.field);m&&!k?k=a:a===b&&(m=!0)});var n=l.getAllowedWidth(e)-(h-g);return isNaN(n)?null:{width:a,widthMemo:g,maxAllowedColumnWidth:n,nextColumn:k}}();if(h){a=h.width;var m=h.widthMemo,p=h.maxAllowedColumnWidth,q=(h=h.nextColumn)&&l.getFieldWidth(e,d,h.field),m=a-m,t=0;e.keepGridWidthWhenResized?
(h&&(m=q-m,m<f&&(a-=f-m,m=f),m<q&&(p+=q-m),k(h,m)),k(b,Math.min(p,a))):(h&&p<a&&q>f?(k(b,a),t=p-a):k(b,Math.min(p,a)),0!==t&&g.adjustColumnWidth(e,d,h,null,t))}}};h.adjustColumnWidth=function(e,d,b,a){g.adjustColumnWidth(e,d,b,a)};return h})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/_ColumnModifierLoose":function(){define("dojo/_base/lang dojox/uuid/generateRandomUuid ../GridLayoutCalculatorQueryUtil ../GridElementBoxCalculator ./ColumnDataUtil ../../GridQueryUtil".split(" "),
function(l,h,g,e,d,b){var a={collectColumnBoxes:function(a,b){for(var c=[],d=0;d<a.store.data.length;){var e=a.store.data[d],f=this._createEmptyBox(),e=g.getRowSpannedData(a,e,b.field)||[e];f.elements=this._getSpannedDataElements(a,b,e);this._measureBox(f);var k=c[c.length-1];k&&(k.nextSibling=f,f.prevSibling=k);c.push(f);d+=e.length}return c},_createEmptyBox:function(){return{id:h(),box:null,elements:[],overlappingBoxes:[],overlappingBoxesCache:{},prevSibling:null,nextSibling:null}},_getSpannedDataElements:function(a,
b,c){var d=[];c.forEach(function(c){c={data:c,dataIndex:c.index,field:b.field,box:e.calcDataBox(a,c,b.field)};d.push(c)});return d},_measureBox:function(a){var b=0;a.elements.forEach(function(a){b+=a.box.h});a.box={x:a.elements[0].box.x,y:a.elements[0].box.y,w:a.elements[0].box.w,h:b}},mergeBoxesForRightColumn:function(a){var b=this._createEmptyBox();a.forEach(function(a){a.elements.forEach(function(a){b.elements.push({data:a.data,field:null,box:l.clone(a.box)})})});this._measureBox(b);b.box.w=1E6;
return[b]},getBoxAtDataIndex:function(a,b){return a.filter(function(a){return a.elements[0].dataIndex===b})[0]}},c={buildInfluenceTree:function(b,c,d){function e(a,d){(d?c:b).forEach(function(b){var c;if(c=!b.overlappingBoxesCache[a.id]){c=a.box;var d=b.box;c=!(c.y+.5>=d.y+d.h||c.y+c.h<=d.y+.5)}c&&(a.overlappingBoxes.push(b),a.overlappingBoxesCache[b.id]=!0)});a.overlappingBoxes.forEach(function(a){e(a,!d)})}d=a.getBoxAtDataIndex(b,d.index);e(d,!0);return d}},k={applyForce:function(a,b,c){function e(b,
c){var g=b.elements[0];g.field&&d.setFieldWidth(a,g.data,g.field,d.getFieldWidth(a,g.data,g.field)+(c?-1:1)*f,!0);b.overlappingBoxes.forEach(function(a){e(a,!c)})}var f=this._checkDelta(a,b,c);e(b,!1)},_checkDelta:function(a,b,c){function e(a,b){0!==g&&(b?0>g||(g=Math.min(g,a.box.w-f),a.prevSibling&&(g=Math.min(g,a.prevSibling.box.x+a.prevSibling.box.w-f-a.box.x)),a.nextSibling&&(g=Math.min(g,a.nextSibling.box.x+a.nextSibling.box.w-f-a.box.x))):0<g||(g=Math.max(g,-(a.box.w-f)),a.prevSibling&&(g=Math.max(g,
-(a.box.x+a.box.w-(a.prevSibling.box.x+f)))),a.nextSibling&&(g=Math.max(g,-(a.box.x+a.box.w-(a.nextSibling.box.x+f))))),a.overlappingBoxes.forEach(function(a){e(a,!b)}))}var f=a.layoutDefaults.columnMinWidth;c=Math.max(c,f);var g=c-b.box.w;if(0<g&&b.elements[0].field===a.columns[a.columns.length-1].field){var k=0;a.columns.forEach(function(c){k+=d.getFieldWidth(a,b.elements[0].data,c.field)});g=Math.min(g,d.getAllowedWidth(a)-k)}e(b,!1);return g}},f={_getInluencedStartBox:function(b,d,e){var f=b.columns[e.index+
1];e=a.collectColumnBoxes(b,e);b=f?a.collectColumnBoxes(b,f):a.mergeBoxesForRightColumn(e);return c.buildInfluenceTree(e,b,d)},getAffectedCells:function(a,c,d){function e(c){if(c.elements[0].data){var d=b.querySingleCell(a,{rowIndex:c.elements[0].data.index,columnField:c.elements[0].field,considerSpans:!0});d&&f.push(d)}c.overlappingBoxes.forEach(e)}var f=[];c=this._getInluencedStartBox(a,c,d);e(c);return f},adjustColumnCell:function(a,b,c,d){b=this._getInluencedStartBox(a,b,c);k.applyForce(a,b,d)}};
return{adjustColumnWidth:function(a,b,c,d){f.adjustColumnCell(a,b,c,d)},getAffectedCells:function(a,b,c){return f.getAffectedCells(a,b,c)}}})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/columns/ColumnsProcessor":function(){define(["dojox/uuid/generateRandomUuid","./ColumnDataUtil"],function(l,h){function g(d){d._dynamicBindings={};if(d.getNumDynamicColumns()){for(var b=d.getNumDynamicColumns(),a=d.getNumFixedColumns(),c=0;c<a;c++)d.columns[c].isFixed=!0;for(var c=
[],e=0;e<b;e++){for(var f=a,g=[];f<d.columns.length;){var h=d.columns[f+e];h.isDynamic=!0;g.push(h);f+=b}c.push(g)}c.forEach(function(a){a.forEach(function(b){d._dynamicBindings[b.field]=a})})}}var e={recalcColumns:function(d,b){var a=b&&b.resetWidth,c=b&&b.columnsToPreserve,e=b&&b.stickToRight,f=b&&b.newWidth,n=b&&b.rightOffsetWeight;b=b&&b._isJson;var m={},p=0;d.columns.every(function(a,b){if(!a.style||!a.style.width||isNaN(a.style.width)||"number"!==typeof a.style.width)return p=0,!1;p+=a.style.width;
m[b]=a.style.width;return!0});var q;q=f?f:e?d.getAllowedWidth():p?Math.min(p,d._width):d._width;q-=0<n?q*n:0;var t=q/d.columns.length,r=q;if(c){var u=c.length*t,y=0;c.forEach(function(a){y+=a.style.width});c.forEach(function(a){a.style.width=u/y*a.style.width/r*100+"%"})}d.columns.forEach(function(b,c,d){b.index=c;b.style=b.style||{};if("number"!==typeof b.style.width||a)if(c===d.length-1)b.style.width=r;else{var e=b.style.width;"string"===typeof e&&-1!==e.indexOf("%")?b.style.width=parseFloat(e.substr(0,
e.length-1))/100*q:b.style.width=t}r-=b.style.width;c===d.length-1&&0>r&&(b.style.width+=r);void 0===b.id&&(b.id=l())});if(d.looseResize){d.columns.some(function(a,b){var c=m[b]?a.style.width/m[b]:void 0;d.store.data.forEach(function(b){var e=h.getFieldWidthOwn(d,b,a.field);e?c&&1!==c&&h.setFieldWidth(d,b,a.field,e*c):h.setFieldWidth(d,b,a.field,a.style.width)})});var v=d.columns[d.columns.length-1].field;d.store.data.forEach(function(a){var b=0;d.columns.some(function(c){b+=h.getFieldWidthOwn(d,
a,c.field)});var c=q-b;0!==c&&h.setFieldWidth(d,a,v,h.getFieldWidthOwn(d,a,v)+c)})}b||(g(d),h.recalcGridWidth(d));return q},recalcColumnsTableJson:function(d){e.recalcColumns(d.data,{resetWidth:!0,newWidth:d.style.width,_isJson:!0})}};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/grid/coreUtils/gridLayoutCalcUtils/GridLayoutSnapper":function(){define(["dojo/_base/lang","./rows/RowDataUtil","./columns/ColumnDataUtil","./GridElementBoxCalculator"],function(l,h,g,e){return{autoSnapLayout:function(d){function b(){var a=
[];d.store.data.forEach(function(b){d.columns.forEach(function(c){a.push(l.mixin({id:b.index+"_"+c.field,data:b,dataIndex:b.index,column:c,field:c.field},e.calcDataBox(d,b,c.field)))})});return a}if(d.looseResize)for(var a=d.store.data.length*d.columns.length,c={},k=0;k<a;k++){var f=b(),n=f[k],m=n.x+n.w,p=n.y+n.h;c[n.id]=!0;f.forEach(function(a){if(!c[a.id]){var b=m-(a.x+a.w);.5>=Math.abs(b)&&g.setFieldWidth(d,a.data,a.field,a.w+b);b=p-(a.y+a.h);.5>=Math.abs(b)&&h.setDataHeight(d,a.data,a.field,a.h+
b)}})}}}})},"esri/dijit/geoenrichment/ReportPlayer/core/sections/sectionUtils/SectionJsonUtil":function(){define(["esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder","esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes","../../supportClasses/tableJson/TableJsonUtil"],function(l,h,g){var e={wrapInDetailsSectionJson:function(d,b){d=Array.isArray(d)?d:[d];var a=d.some(function(a){return"table"===a.id&&a.attributes&&(0<a.attributes.dynamicColumns||
0<a.attributes.dynamicRows)});return{type:b||(a?h.GROUP:h.DETAILS),stack:d}},createSectionJsonFromInfographicJson:function(d,b,a){d=g.createSingleCellTable({width:b,height:a,fieldInfo:l.createFieldInfoFromInfographic(d)});return e.wrapInDetailsSectionJson(d)},getSectionJsonInfographic:function(d){var b;d.stack&&d.stack.some(function(a){b="table"===a.id&&g.getTableJsonInfographic(a);return!!b});return b},getSectionJsonInfographicTable:function(d){var b;d.stack&&d.stack.some(function(a){if("table"===
a.id&&g.getTableJsonInfographic(a))return b=a,!0});return b},calcSectionJsonBox:function(d){var b,a,c,e;function f(d){b=Math.min(b,d.l);a=Math.min(a,d.t);c=Math.max(c,d.l+d.w);e=Math.max(e,d.t+d.h)}a=b=Infinity;e=c=0;d.stack&&d.stack.forEach(function(a){switch(a.id){case "table":var b=0;a.data.data.forEach(function(a){b+=a.style.height});f({l:a.style.left||0,t:a.style.top||0,w:a.style.width,h:b});break;case "img":case "map":f({l:a.style.left||0,t:a.style.top||0,w:a.style.width,h:a.style.height})}});
d=d.style||{};return{x:d.left,y:d.top,w:d.width||b+c,h:d.height||a+e,contentLeft:b,contentTop:a,contentW:c-b,contentH:e-a}}};return e})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/portalToEditorUtils/parsers/_FieldInfoBuilder":function(){define(["../../../supportClasses/templateJsonUtils/fieldInfo/FieldInfoBuilder","dojo/i18n!esri/nls/jsapi"],function(l,h){h=h.geoenrichment.dijit.ReportPlayer.ReportPlayer;return{getCalculatorOrScriptFieldInfo:function(g,e,d){if(!g)return null;if(e.variableProvider.isPlayerOnly&&
!e.useVariableProviderToCollectOnly){var b=e.variableProvider.toCalculator(g);if(!b)return console.log("Can't create a dummy calculator for \x3d\x3e "+g),null;d=d||{};d.calculatorName=b.variable.calculatorName;g=l.createFieldInfoFromCalculator(b,e.variableProvider,d);g.name=b.variable.fieldName;g.templateName=b.variable.templateName;return g}var b=e.queryMetaDataFunc(g),a=g.substr(0,g.indexOf("."));d=d||{};d.calculatorName=a;if(b)return b.isScript?l.createFieldInfoFromScript(b,d):l.createFieldInfoFromCalculator(b,
e.variableProvider,d);d=l.createFieldInfoFromMissingVariable(g);e.variableProvider.isPlayerOnly&&(b=e.variableProvider.toCalculator(g),d.alias=b&&b.variable.alias);d.alias=d.alias?d.alias+" ("+h.missingVariable+")":h.missingVariable;return d}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/DefaultAttachmentsStore":function(){define(["dojo/_base/declare","esri/dijit/geoenrichment/promise/all","esri/dijit/geoenrichment/when","./WebMapAttachmentStore"],function(l,h,
g,e){return l(null,{supportsMultipleAreas:!0,_analysisAreas:null,_currentAreaIndex:-1,_webMapStores:null,constructor:function(d){this._analysisAreas=d},initialize:function(){var d=this;this._webMapStores={};return h(this._analysisAreas.map(function(b,a){if(b=b.feature||b.location||b.additionalFeatures&&b.additionalFeatures[0])return(d._webMapStores[a]=new e(b)).initialize()})).then(function(){return d})},_callStoreMethod:function(d){var b=this._webMapStores[this._currentAreaIndex];return b?g(b[d](),
function(a){return a?a.slice():[]}):[]},getImages:function(){return this._callStoreMethod("getImages")},getAttributes:function(){return this._callStoreMethod("getAttributes")},getNotes:function(){return this._callStoreMethod("getNotes")},setCurrentAnalysisAreaIndex:function(d){this._currentAreaIndex=d}})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/WebMapAttachmentStore":function(){define("dojo/_base/declare dojo/_base/lang esri/dijit/geoenrichment/when esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttributesUtil esri/dijit/geoenrichment/utils/requests/UniversalClient esri/dijit/geoenrichment/utils/CacheUtil esri/dijit/geoenrichment/utils/ImageUtil ./AttachmentsUtil".split(" "),
function(l,h,g,e,d,b,a,c){var k={getThumbnail:function(a){var c=b.get("WebMapAttachmentStore");c[a.url]||(c[a.url]=this._getDataURL(a));return c[a.url]},_getDataURL:function(b){return 0===b.url.indexOf("data:")?b.url:d.request(b.url).then(function(c){return c&&c.Attachment&&a.base64DataToDataURL(c.Attachment,b.contentType)}).otherwise(function(){return null})}};return l(null,{supportsMultipleAreas:!1,_attachmentInfos:null,_feature:null,_fieldInfos:null,_attributes:null,constructor:function(a,b){this._feature=
a;this._attachmentInfos=b},initialize:function(){this._tryGetFieldInfosAndAttributes();return g(this._attachmentInfos||this._tryGetAttachmentInfos()).always(function(){return!!this._attachmentInfos}.bind(this))},_tryGetFieldInfosAndAttributes:function(){var a=this._feature.getLayer();this._fieldInfos=(a=this._feature.infoTemplate||a&&a.infoTemplate)&&a.info.fieldInfos||[];this._attributes=h.mixin({},this._feature.attributes)},_tryGetAttachmentInfos:function(){return g(c.getFeatureAttachmentInfos(this._feature),
function(a){this._attachmentInfos=a}.bind(this))},getImages:function(){return this._attachmentInfos?this._attachmentInfos.map(function(a){return{getThumbnail:function(){return k.getThumbnail(a)},getUrl:function(){return a.url}}}):[]},getAttributes:function(){return e.composeAttributesFromFieldInfos(this._fieldInfos,this._attributes)},getNotes:function(){return[]},setCurrentAnalysisAreaIndex:null})})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/supportClasses/attachments/AttachmentsUtil":function(){define([],
function(){return{getFeatureAttachmentInfos:function(l){var h=l.getLayer();if(h&&h.hasAttachments&&h.queryAttachmentInfos&&h.objectIdField)return h.queryAttachmentInfos(l.attributes[h.objectIdField])}}})},"esri/dijit/geoenrichment/ReportPlayer/dataProvider/commands/supportClasses/LayoutXMLBuilder":function(){define("dojo/_base/lang esri/dijit/geoenrichment/utils/JsonXmlConverter esri/dijit/geoenrichment/ReportPlayer/core/conversion/reportingEngine/converters/DocumentConverter esri/dijit/geoenrichment/ReportPlayer/core/conversion/ConversionUtil esri/dijit/geoenrichment/ReportPlayer/core/supportClasses/DocumentOptions esri/dijit/geoenrichment/ReportPlayer/core/sections/SectionTypes".split(" "),
function(l,h,g,e,d,b){return{buildLayoutXML:function(a){var c=g.buildDocumentTag({addDefaultQuery:!0,report:{templateJson:{documentOptions:l.mixin({},a.documentOptions,{left:0,right:0,top:0,bottom:0})}}}).documentTag,k=d.getPageBox(a.documentOptions),f=e.pxToPt(k.w),n=e.pxToPt(k.h);a.svgStrings.forEach(function(d,e){c.tags.push({name:"section",attributes:{type:b.DETAILS},tags:[{name:"img",attributes:{left:0,top:0,width:f,height:n},tags:[{text:"__svgString__"+e+"__svgString__"}]}]});e<a.svgStrings.length-
1&&c.tags.push({name:"pageBreak"})});var m=h.parseJson(c);a.svgStrings.forEach(function(a,b){m=m.replace("__svgString__"+b+"__svgString__",a)});return m},stitchDocuments:function(a){if(!a||!a.length)return null;var b=a[0],d=b.substr(0,b.indexOf("\x3csection")),e="";a.forEach(function(b,c){e+=b.replace(d,"").replace("\x3c/HTMLextReport\x3e","")+(c<a.length-1?"\x3cpageBreak /\x3e":"")});return d+e+"\x3c/HTMLextReport\x3e"}}})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/reportingEngine/converters/DocumentConverter":function(){define(["../../ConversionUtil",
"../ReportingEnginePageSizeCompatibilityUtil"],function(l,h){var g={buildDocumentTag:function(e){var d=e.report,b=l.pxToPtObj(d.templateJson.documentOptions),a={name:"HTMLextReport",attributes:{version:"10.1",pagesize:h.getReportingEnginePageSize(b.pagesize,b.orientation),orientation:b.orientation,left:b.left,right:b.right,top:b.top,bottom:b.bottom,style:l.composeStyleString(g.buildDocumentStyle(e)),comparisonZoom:d.defaultComparisonZoom||void 0},tags:[]};e.addDefaultQuery&&a.tags.push({name:"queries",
tags:[{name:"query",attributes:{name:"default",table:"headers"}}]});e.report.isGraphicReport||a.tags.push({name:"def",attributes:{align:b.align,lineSpacing:b.lineSpacing}});d.templateJson.tooltipInfo&&(d.templateJson.tooltipInfo.table||d.templateJson.tooltipInfo.chart)&&(e={name:"tooltip",tags:[]},a.tags.push(e),(b=d.templateJson.tooltipInfo.table)&&e.tags.push({name:"table",attributes:{value:b.value||void 0,alias:b.alias||void 0,expression:b.expression||void 0,conditional:b.conditional||void 0}}),
(d=d.templateJson.tooltipInfo.chart)&&e.tags.push({name:"chart",attributes:{title:d.title||void 0,value:d.value||void 0,weight:d.weight||void 0,min:d.min||void 0,max:d.max||void 0,avg:d.avg||void 0,conditional:d.conditional||void 0}}));return{documentTag:a}},buildDocumentStyle:function(e){e=l.pxToPtObj(e.report.templateJson.documentOptions);return{fontSize:e.fontSize,fontFamily:e.fontFamily}}};return g})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/ConversionUtil":function(){define(["dojo/_base/lang",
"esri/dijit/geoenrichment/utils/PageUnitsConverter","esri/dijit/geoenrichment/utils/ColorUtil"],function(l,h,g){var e={};l.mixin(e,h);var d={"font-size":"fontSize","line-height":"lineHeight","font-family":"fontFamily","font-style":"fontStyle","font-weight":"fontWeight","text-decoration":"textDecoration",color:"color","background-color":"backgroundColor"},b={},a;for(a in d)b[d[a]]=a;e.splitTrim=function(a,b,c){a=String(a).split(b).map(function(a){return a.trim()});return c?a.filter(function(a){return!!a}):
a};e.parseStyleString=function(a){var b={};e.splitTrim(a||"",";",!0).forEach(function(a){var c=e.splitTrim(a,":");if(a=d[c[0]])c=c[1],"rgba(0, 0, 0, 0)"===c&&(c="transparent"),b[a]=c});return b};e.composeStyleString=function(a,c){c=c&&c.addPx;var d="",e;for(e in a){var f=b[e];if(f){var k=a[e];k&&("backgroundColor"===e&&(k=g.toCSSColor(k)),d+=f+":"+k+(c&&c[f]?"px;":";"))}}return d};e.removeZeroProperties=function(a){Object.keys(a).forEach(function(b){0===Number(a[b])&&delete a[b]});return a};var c=
{valign:{center:"middle"}},k={valign:{middle:"center"}};e.getPropValuePtoE=function(a,b){return c[a]&&c[a][b]||b};e.getPropValueEtoP=function(a,b){return k[a]&&k[a][b]||b};e.KEY_OPERATOR_RE=/^(!=|>=|<=|<|>|=)/;e.ONE_FIELD_KEY_TEST=/^(default|(<|>|<=|>=|!=|=|)(-?\d+\.\d+|-?\d+))$/;e.KEY_INTERVAL_SEPARATOR=";";return e})},"esri/dijit/geoenrichment/ReportPlayer/core/conversion/reportingEngine/ReportingEnginePageSizeCompatibilityUtil":function(){define(["../../supportClasses/DocumentOptions"],function(l){var h=
{},g={a4:1,letter:1};h.getReportingEnginePageSize=function(e,d){return g[e]?e:(d=l.SIZE_TYPE_TO_DIM_HASH[e]&&l.SIZE_TYPE_TO_DIM_HASH[e][d])?l.combineCustomSizeString(d.w,d.h,"in"):e};return h})},"widgets/BusinessAnalyst/utils/ReportUtil":function(){define("dojo/Deferred dojo/promise/all dojo/when dojo/_base/array esri/request jimu/portalUtils dojo/i18n!../nls/strings".split(" "),function(l,h,g,e,d,b,a){STANDARD_INFOGRAPHIC_TYPEKEYWORD="esriReportPlayerStandardInfographic";return{_ownedCachedCustomReports:null,
_sharedCachedCustomReports:null,_cachedCountryClassicReports:[],_cachedInfographicReports:null,_countryInitDfds:[],getAvailableClassicReports:function(b,d){var c=this,k=[],h=new l,p;d&&e.forEach(d.countryConfig,function(a){b==a.countryID&&(p=a)});p||(p={countryID:b,allowEsriReports:!0,allowAllEsriReports:!0,allowEsriInfographics:!0,allowAllEsriInfographics:!0,allowMyReports:!0,allowMyInfographics:!0,allowSharedReports:!0,allowSharedInfographics:!0,allowAllOrgReports:!0,allowAllOrgInfographics:!0,
defaultInfographicID:"",defaultReportID:"",enabledEsriReports:[],enabledOrgReports:[],enabledEsriInfographics:[],enabledOrgInfographics:[]});var q=null,t=null,r=null;g(this._initReports(b),function(){if(!d||p.allowAllEsriReports||c._hasEnabledReports(c._cachedCountryClassicReports[b],p.enabledEsriReports))q=k.length,k.push({value:"esriReports",label:a.esriReports,children:[]});if(!d||p.allowAllOrgReports&&c._hasReportsForCountry(c._ownedCachedCustomReports,b)||c._hasEnabledReportsForCountry(c._ownedCachedCustomReports,
b,p.enabledOrgReports))t=k.length,k.push({value:"myReports",label:a.myReports,children:[]});if(!d||p.allowAllOrgReports&&c._hasReportsForCountry(c._sharedCachedCustomReports,b)||c._hasEnabledReportsForCountry(c._sharedCachedCustomReports,b,p.enabledOrgReports))r=k.length,k.push({value:"sharedReports",label:a.sharedReports,children:[]});(p.allowAllEsriReports||c._hasEnabledReports(c._cachedCountryClassicReports[b],p.enabledEsriReports))&&c._cachedCountryClassicReports[b]&&0<c._cachedCountryClassicReports[b].length&&
e.forEach(c._cachedCountryClassicReports[b],function(a){(p.allowAllEsriReports||p.enabledEsriReports.includes(a.reportID))&&k[q].children.push(c._formatClassicReportsForDropDown(a))});var f=["esriWebInfographicReport","esriWebSingleInfographic","esriWebBlankInfographic","esriWebHiddenInfographic","esriWebComparisonReport"];(p.allowAllOrgReports&&c._hasReportsForCountry(c._ownedCachedCustomReports,b)||c._hasEnabledReportsForCountry(c._ownedCachedCustomReports,b,p.enabledOrgReports))&&e.forEach(c._ownedCachedCustomReports,
function(a){a.properties.countries.includes(b)&&(p.allowAllOrgReports||p.enabledOrgReports.includes(a.id))&&(a.typeKeywords.some(function(a){return 0<=f.indexOf(a)})||k[t].children.push(c._formatClassicReportsForDropDown(a)))});(p.allowAllOrgReports&&c._hasReportsForCountry(c._sharedCachedCustomReports,b)||c._hasEnabledReportsForCountry(c._sharedCachedCustomReports,b,p.enabledOrgReports))&&e.forEach(c._sharedCachedCustomReports,function(a){a.properties.countries.includes(b)&&(p.allowAllOrgReports||
p.enabledOrgReports.includes(a.id))&&(a.typeKeywords.some(function(a){return 0<=f.indexOf(a)})||k[r].children.push(c._formatClassicReportsForDropDown(a)))});var g=function(a,b){a=a.label.toUpperCase();b=b.label.toUpperCase();var c=0;a>b?c=1:a<b&&(c=-1);return c};0<k.length&&k[0].children.sort(g);1<k.length&&k[1].children.sort(g);2<k.length&&k[2].children.sort(g);h.resolve(k)});return h},_hasEnabledReports:function(a,b){return a&&b?e.some(a,function(a){return b.includes(a.reportID)}):!1},_hasReportsForCountry:function(a,
b){return a&&b?e.some(a,function(a){return a.properties.countries.includes(b)}):!1},_hasEnabledReportsForCountry:function(a,b,d){return a&&b&&d?e.some(a,function(a){return a.properties.countries.includes(b)?d.includes(a.id):!1}):!1},_formatClassicReportsForDropDown:function(a){return a.metadata?{label:a.metadata.title,value:a.reportID,reportType:a.metadata.type}:{label:a.title,value:a.id,reportType:a.properties.type,item:{itemid:a.id,url:portalUrl,token:esri.id.credentials[0].token}}},getAvailableInfographicReports:function(b,
d){var c=this,k=[],h=new l,p;d&&e.forEach(d.countryConfig,function(a){b==a.countryID&&(p=a)});p||(p={countryID:b,allowEsriReports:!0,allowAllEsriReports:!0,allowEsriInfographics:!0,allowAllEsriInfographics:!0,allowMyReports:!0,allowMyInfographics:!0,allowSharedReports:!0,allowSharedInfographics:!0,allowAllOrgReports:!0,allowAllOrgInfographics:!0,defaultInfographicID:"",defaultReportID:"",enabledEsriReports:[],enabledOrgReports:[],enabledEsriInfographics:[],enabledOrgInfographics:[]});var q=null,t=
null,r=null;g(this._initReports(b),function(){if(!d||p.allowAllEsriInfographics||c._hasEnabledInfographics(c._cachedInfographicReports,p.enabledEsriInfographics))q=k.length,k.push({value:"esriReports",label:a.esriInfographics,children:[]});if(!d||p.allowAllOrgInfographics&&0<c._ownedCachedCustomReports.length||c._hasEnabledInfographics(c._ownedCachedCustomReports,p.enabledOrgInfographics))t=k.length,k.push({value:"myReports",label:a.myInfographics,children:[]});if(!d||p.allowAllOrgInfographics&&0<
c._sharedCachedCustomReports.length||c._hasEnabledInfographics(c._sharedCachedCustomReports,p.enabledOrgInfographics))r=k.length,k.push({value:"sharedReports",label:a.sharedInfographics,children:[]});(p.allowAllEsriInfographics||c._hasEnabledInfographics(c._cachedInfographicReports,p.enabledEsriInfographics))&&e.forEach(c._cachedInfographicReports,function(a){a.properties.countries.includes(b)&&(p.allowAllEsriInfographics||p.enabledEsriInfographics.includes(a.id))&&k[q].children.push(c._formatInfographicReportsForDropDown(a))});
(p.allowAllOrgInfographics&&0<c._ownedCachedCustomReports.length||c._hasEnabledInfographics(c._ownedCachedCustomReports,p.enabledOrgInfographics))&&e.forEach(c._ownedCachedCustomReports,function(a){a.properties.countries.includes(b)&&(p.allowAllOrgInfographics||p.enabledOrgInfographics.includes(a.id))&&(a.typeKeywords.includes("esriWebInfographicReport")||c._isOldPortalInfographic(a))&&k[t].children.push(c._formatInfographicReportsForDropDown(a))});(p.allowAllOrgInfographics&&0<c._sharedCachedCustomReports.length||
c._hasEnabledInfographics(c._sharedCachedCustomReports,p.enabledOrgInfographics))&&e.forEach(c._sharedCachedCustomReports,function(a){a.properties.countries.includes(b)&&(p.allowAllOrgInfographics||p.enabledOrgInfographics.includes(a.id))&&(a.typeKeywords.includes("esriWebInfographicReport")||c._isOldPortalInfographic(a))&&k[r].children.push(c._formatInfographicReportsForDropDown(a))});var f=function(a,b){a=a.label.toUpperCase();b=b.label.toUpperCase();var c=0;a>b?c=1:a<b&&(c=-1);return c};0<k.length&&
k[0].children.sort(f);1<k.length&&k[1].children.sort(f);2<k.length&&k[2].children.sort(f);h.resolve(k)});return h},_hasEnabledInfographics:function(a,b){return e.some(a,function(a){return b.includes(a.id)})},_isOldPortalInfographic:function(a){return a.properties&&a.properties.isHidden&&"true"===a.properties.isHidden?!1:a.properties&&a.properties.isGraphicReport&&"true"===a.properties.isGraphicReport?!0:!1},_formatInfographicReportsForDropDown:function(a){return{label:a.title,value:a.id}},_initReports:function(a){var c=
[],f=this;if(this._countryInitDfds[a])return this._countryInitDfds[a];this._countryInitDfds[a]=new l;var g=function(a,b){return d(a).then(function(c){e.forEach(c.results,function(a){b.push(a)});if(-1!=c.nextStart)return a.content.start=c.nextStart,g(a,b)},function(a){alert(a)})};b.getPortal(portalUrl).loadSelfInfo().then(function(b){var e=b&&b.helperServices&&b.helperServices.geoenrichment&&b.helperServices.geoenrichment.url?b.helperServices.geoenrichment.url:"https://geoenrich.arcgis.com/arcgis/rest/services/World/geoenrichmentserver";
f._cachedCountryClassicReports[a]||c.push(d({url:e+"/Geoenrichment/reports/"+a,content:{appID:"webappbuilder",f:"json",langCode:"en-us"}}).then(function(b){f._cachedCountryClassicReports[a]=b.reports},function(a){alert(a)}));f._cachedInfographicReports||(f._cachedInfographicReports=[],c.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:"typekeywords:(esriReportPlayerStandardInfographic jsapiVersion3.34)"}},
f._cachedInfographicReports)));f._ownedCachedCustomReports||(f._ownedCachedCustomReports=[],c.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) owner:'+esri.id.credentials[0].userId}},f._ownedCachedCustomReports)));f._sharedCachedCustomReports||(f._sharedCachedCustomReports=[],c.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",
f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'access:shared type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId}},f._sharedCachedCustomReports)),c.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'access:org type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId}},
f._sharedCachedCustomReports)),b&&b.appInfo&&b.appInfo.orgId&&c.push(g({url:portalUrl+"/sharing/rest/search",content:{appID:"webappbuilder",f:"json",start:1,num:100,sortField:"modified",sortOrder:"desc",q:'access:public type:"Report Template" typekeywords:(esriWebReport NOT esriWebSingleInfographic) NOT owner:'+esri.id.credentials[0].userId+" orgid: "+b.id}},f._sharedCachedCustomReports)));0===c.length?f._countryInitDfds[a].resolve():h(c).then(function(){f._countryInitDfds[a].resolve()})});return this._countryInitDfds[a]}}})},
"widgets/BusinessAnalyst/esriAnalystX/widgets/Selects/FilteringSelectTree":function(){define(["dojo/_base/declare","./FilteringSelect","esri/dijit/geoenrichment/SelectableTree","../../widgets/SelectableTreeGrid/SelectableTreeGrid","xstyle/css!./css/FilteringSelect.css"],function(l,h,g,e){function d(a,b){var c=[];a.forEach(function(a){a.children.forEach(function(a){var d={};d[b.idProperty]=a[b.idProperty];d[b.labelProperty]=a[b.labelProperty];d.__item=a;c.push(d)})});return c}function b(a,b,d){var c=
{};b.forEach(function(a){c[a[d.idProperty]]=a});var e=[];a.forEach(function(a){var b=a.children.filter(function(a){return c[a[d.idProperty]]});if(b.length){var f={};f[d.idProperty]=a[d.idProperty];f[d.labelProperty]=a[d.labelProperty];f.children=b.map(function(a){var b={};b[d.idProperty]=a[d.idProperty];b[d.labelProperty]=a[d.labelProperty];return b});e.push(f)}});return{treeData:e,idsHash:c}}e=l(e,{showRootCheckbox:!1,showCheckboxColumn:!1,enableRowSelection:!0,expandOnNodeClick:!0,baseTree:null,
hostWidget:null,defaultExpand:null,_firstTimeExpand:!0,getLabel:function(a,b){return a[this.labelProperty]},onRowsSelected:function(a,b){a=a&&a[0];b=b&&b[0];a&&!a.children&&(b.setAttribute("item",a[this.idProperty]),this.onChange(b))},createOptions:function(a,c,d){a=b(this.baseTree.data,a,this);this.items=a.idsHash;this.tree.clear();if(this._firstTimeExpand){this._firstTimeExpand=!1;var e;if(this.defaultExpand)e=Object.assign({},this.defaultExpand);else{e={};var g=this;a.treeData.forEach(function(a){e[a[g.idProperty]]=
!0})}this.grid._expanded=e}this.tree.addNodes(a.treeData);this.refresh()},getHighlightedOption:function(){},highlightFirstOption:function(){},highlightLastOption:function(){},clearResultList:function(){this.tree.clear()},onChange:function(a){}});l=l(h,{dropDownClass:e,tree:null,autoComplete:!1,defaultExpand:null,postCreate:function(){this.inherited(arguments);this.tree&&this.setItems(this._getStoreItemsFromTree())},_setTreeAttr:function(a){this.tree=a;this._isCreated&&this.setItems(this._getStoreItemsFromTree());
this.dropDown&&(this.dropDown.baseTree=this.tree)},_getStoreItemsFromTree:function(){return d(this.tree.data,this)},_startSearch:function(a){if(!this.dropDown){var b=this.id+"_popup";this.dropDown=new this.dropDownClass({gridClass:"esriMapsAnalystXSelectableTreeGrid esriMapsAnalystXFilteringSelect_treeGrid",onChange:function(){return this._selectOption.apply(this,arguments)}.bind(this),id:b,dir:this.dir,textDir:this.textDir,tree:new g([],{idProperty:this.idProperty}),idProperty:this.idProperty,labelProperty:this.labelProperty,
baseTree:this.tree,hostWidget:this,defaultExpand:this.defaultExpand})}this.inherited(arguments)},_openResultList:function(){this.inherited(arguments);this.dropDown&&this.dropDown.refresh()},getSelectedItem:function(){var a=this.inherited(arguments);return a&&a.__item}});l.NONE_ID=h.NONE_ID;return l})},"widgets/BusinessAnalyst/esriAnalystX/widgets/Selects/FilteringSelect":function(){define("dojo/_base/declare dojo/store/Memory dojo/query dojo/dom-class dojo/dom-style dojo/dom-geometry dijit/form/FilteringSelect dijit/form/_ComboBoxMenu ../../dijit/tooltips/TooltipUtil dojo/i18n!../../../nls/strings xstyle/css!./css/FilteringSelect.css".split(" "),
function(l,h,g,e,d,b,a,c,k,f){var n=l(h,{filtered:!1,noneItem:null,get:function(a){return"None"==a?this.noneItem:this.inherited(arguments)},query:function(a,b){var c=this.inherited(arguments);this.filtered=c.length!=this.data.length;return c}});h=l(c,{baseClass:"dijitComboBoxMenu",idProperty:"value",postCreate:function(){this.inherited(arguments);k.autoTooltip(this.domNode)},_createMenuItem:function(){var a=this.inherited(arguments);a.className+=" TrimWithEllipses";return a},selectItem:function(a){if(this.items){for(var b=
-1,c=0;c<this.items.length;c++)if(this.items[c][this.idProperty]==a){b=c;break}if(!(0>b))for(a=this.containerNode.children,c=0;c<a.length;c++){var d=a[c];if("none"!=d.style.display&&d.getAttribute("item")==b){this.selectLastNode();this.set("selected",d,!0);break}}}}});l=l(a,{forceWidth:!1,autoWidth:!1,selectOnClick:!0,idProperty:"value",labelProperty:"label",placeHolder:null,dropDownClass:h,options:null,_assignedStore:null,_isCreated:!1,postMixInProperties:function(){this.searchAttr=this.labelAttr=
this.labelProperty;var a={};a[this.idProperty]="None";a[this.labelAttr]=this.placeHolder||f.None;this.set("store",new n({idProperty:this.idProperty,noneItem:a}));this.inherited(arguments)},_startSearch:function(){this.inherited(arguments);this.dropDown.idProperty=this.idProperty;this.dropDown.labelProperty=this.labelProperty},postCreate:function(){this.inherited(arguments);k.autoTooltip(this.domNode);(this.options||this._assignedStore)&&this.setItems(this.options||this._assignedStore.data);e.add(this.domNode,
"esriMapsAnalystXFilteringSelect");this._isCreated=!0},_onFocus:function(){this._updateTrimWithEllipses(!0);this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this._updateTrimWithEllipses(!1)},_updateTrimWithEllipses:function(a){var b=g(".dijitInputInner",this.domNode)[0];if(b)e[a?"remove":"add"](b,"TrimWithEllipses")},_setStoreAttr:function(a){a instanceof n?(this.store=a,this.inherited(arguments)):(this._assignedStore=a,this._isCreated&&this.setItems(this._assignedStore.data))},
_setOptionsAttr:function(a){this.options=a;this._isCreated&&this.setItems(this.options)},setItems:function(a,b){this.store.setData(a);this.closeDropDown();this.dropDown&&this.dropDown.clearResultList();a=this.get("value");b=b||"None";this.set("value",b);b==a&&this.emit("Change");this._updateTrimWithEllipses(this.get("focused"))},_openResultList:function(a,c,e){var f=b.getContentBox(this.domNode).w;d.set(this.dropDown.domNode,"width",f+"px");this.inherited(arguments);this.store.filtered||this.dropDown.selectItem&&
this.dropDown.selectItem(this.get("value"))},_setBlurValue:function(){var a=this.get("displayedValue");"undefined"==typeof this.item&&(this.item=null,this.set("displayedValue",a));this.value!=this._lastValueReported&&this._handleOnChange(this.value,!0);this._refreshState();this.focusNode.removeAttribute("aria-activedescendant")},getSelectedItem:function(){var a=this;return this.store.data.filter(function(b){return b[a.idProperty]==a.get("value")})[0]}});l.NONE_ID="None";return l})},"widgets/BusinessAnalyst/esriAnalystX/dijit/tooltips/TooltipUtil":function(){define("dojo/dom-construct dojo/dom-style dojo/dom-geometry dojo/dom-class dojo/query dojo/on dojox/gfx dojo/sniff dojo/aspect dojox/uuid/generateRandomUuid dijit/Tooltip ../utils/DomUtil ../utils/MouseUtil esri/dijit/geoenrichment/utils/TooltipUtil dojo/domReady!".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q){function t(){z&&(z.isMultilineContainer?w.hideTooltipForNode(z):(clearInterval(z.__autoTooltipInLayoutCheckHandle),delete z.__autoTooltipInLayoutCheckHandle,n.hide(z)),z=null)}function r(a,b){b=b||"";var c=l.create("div",{class:"esriMapsAnalystXValidationTooltip"+b},document.body);!b&&l.create("div",{class:"esriMapsAnalystXValidationTooltipTip"+b},c);l.create("div",{innerHTML:a,class:"esriMapsAnalystXValidationTooltipBody"+b},c);h.set(c,"position","fixed");return c}
function u(a,c){function d(){a&&(document.body.removeChild(a),k.forEach(function(a){a.remove()}),a=k=null)}c=c.textbox||c;var e=g.getMarginBox(a),f=g.position(c);"rtl"===document.dir?h.set(a,{left:f.x-e.w+"px",top:f.y+f.h/2-e.h/2+"px"}):h.set(a,{left:f.x+f.w+"px",top:f.y+f.h/2-e.h/2+"px"});var k=[b(document.body,"mousedown, keydown",d),b(c,"blur",d)];return{remove:d}}function y(a,b,c){function d(){var a=l.create("div",{class:"esriMapsAnalystXClosableTooltipTip"},k);e.add(a,"right"===c?"esriMapsAnalystXClosableTooltipTipRight":
"esriMapsAnalystXClosableTooltipTipLeft")}function g(){m=l.create("div",{class:"esriMapsAnalystXClosableTooltipBody"},k);l.create("div",{innerHTML:a,class:"esriMapsAnalystXClosableTooltipLabel"},m);n=l.create("div",{class:"esriMapsAnalystXClosableTooltipCloseButton esriMapsAnalystXCloseWindow esriMapsAnalystXCloseWindowWhite"},m)}b={class:"esriMapsAnalystXClosableTooltip "+(b||"")};b.id=f();var k=l.create("div",b,document.body),m,n;"right"!==c?(g(),d()):(d(),g());h.set(k,"position","fixed");return{tooltip:k,
body:m,closeButton:n}}function v(a,c,d,e){var f=g.getMarginBox(a.tooltip),k=g.position(c);"rtl"===document.dir&&"right"!==e||"rtl"!==document.dir&&"right"===e?h.set(a.tooltip,{left:k.x+k.w+"px",top:k.y+k.h/2-f.h/2+"px"}):h.set(a.tooltip,{left:k.x-f.w+"px",top:k.y+k.h/2-f.h/2+"px"});var l,n,p,q=function(){l&&clearTimeout(l);n&&clearInterval(n);p&&p.remove();a.tooltip.parentNode===document.body&&document.body.removeChild(a.tooltip)};n=setInterval(function(){m.isNodeInLayout(c)||q();m.isNodeVisible(c)?
m.show(a.tooltip):m.hide(a.tooltip)},300);d&&(l=setTimeout(q,d));p=b(a.closeButton,"click",function(){q()});a.tooltip._removeFunc=q;return a.tooltip}var w={},D={};w.hideTooltipForNode=q.hideTooltipForNode;w.setTooltipToNode=q.setTooltipToNode;w.createTooltip=function(a,c,d){var e={orientation:g.isBodyLtr(document)?"right":"left",offset:{x:15,y:0}};c&&(e.innerHTML=c);d&&(e=Object.assign(e,d));e.id=f();e.toMouseCursor&&(e.mouseEvent=p.getCursorPosition(),delete e.toMouseCursor);c=e.mouseEvent;delete e.mouseEvent;
d=e.htmlFragment;delete e.htmlFragment;var k=e.widget;delete e.widget;var m=e.orientation;delete e.orientation;var n=e.offset;delete e.offset;var q=e.horizontalOffset;delete e.horizontalOffset;var t=l.create("div",e,a?a.container:document.body);d?l.place(d,t):k&&k.placeAt(t);h.set(t,"position","fixed");var r=g.getMarginBox(t),E=function(a,b){var c=a.touches?event.touches[0].clientX:a.clientX;a=a.touches?event.touches[0].clientY:a.clientY;var d,e,f=n.x,g=n.y;"left"===m?0>c-r.w-f&&(d="right"):c+r.w+
f>document.body.clientWidth&&(d="left");a+r.h+g>document.body.clientHeight&&(e="above");d=d||m;h.set(t,{left:b?b+"px":c+("left"===d?-r.w-f:f)+"px",top:a+("above"===e?-r.h-g:g)+"px"});t.style.display=""};c&&E(c,q);e=[];e.push(b(a?a:document.body,a?"mouse-move, mousemove":"mousemove, touchmove",function(a){E(a,q)}));e.push(b(a?a:document.body,a?"mouse-out, mouseout":"mouseout, touchend",function(a){t.style.display="none"}));a={};a.handlers=e;a.tooltip=t;D[t.id]=a;return t};w.removeTooltip=function(a){if(a){a=
"string"===typeof a?a:a.id;var b=D[a];delete D[a];b&&(b.handlers.forEach(function(a){a.remove()}),l.destroy(b.tooltip))}};var B={};w.registerTooltipForSlider=function(a,c,d,e){var m={offsetX:0,offsetY:0,class:"esriMapsAnalystXTooltip"};c&&(m=Object.assign(m,c));m.id=f();var n=l.create("div",m,document.body);n.style.display="none";h.set(n,"position","fixed");var p=!1,q=function(c,d){if(!p){p=!0;n.style.display="";n.innerHTML=d();var e=g.getMarginBox(n),f=g.position(c);h.set(n,{left:f.x+f.w/2-e.w/2+
m.offsetX+"px",top:f.y-e.h-5+m.offsetY+"px"});var l=[];l.push(k.after(a,"onChange",function(){n.innerHTML=d();f=g.position(c);h.set(n,{left:f.x+f.w/2-e.w/2+"px",top:f.y-e.h-5+"px"})}));var q=function(){n.style.display="none";l.forEach(function(a){a.remove()});p=!1},t=!1;l.push(b(c,"mousedown, mouseDown, mouse-down",function(){t=!0;l.push(b(document,"mouseup, mouseUp, mouse-up",function(){q()}))}));l.push(b(c,"mouseout, mouseOut, mouse-out",function(){t||q()}))}};c=[];c.push(b(a.sliderHandle,"mouseover, mouseOver, mouse-over",
function(){e&&a.isSliderDisabled&&a.isSliderDisabled()||q(a.sliderHandle,function(){var b=e?a.get("value")[0]:a.get("value");return d?d(b):b})}));e&&c.push(b(a.sliderHandleMax,"mouseover, mouseOver, mouse-over",function(){a.isSliderDisabled&&a.isSliderDisabled()||q(a.sliderHandleMax,function(){return d?d(a.get("value")[1]):a.get("value")[1]})}));c.push(k.before(a,"destroy",function(){w.unregisterTooltipForSlider(a)}));a.tooltipId=n.id;var t={};t.tooltip=n;t.handlers=c;B[n.id]=t};w.unregisterTooltipForSlider=
function(a){var b=B[a.tooltipId];b&&(b.handlers.forEach(function(a){a.remove()}),l.destroy(b.tooltip));delete B[a.tooltipId];delete a.tooltipId};var z=null;w.autoTooltip=function(a,d,e){"string"===typeof d&&(d=d.split(" ").filter(function(a){return a&&!!a.trim().length}));d=d||[];d.push("TrimWithEllipses");e=e||[];e.push("esriMapsAnalystXInfoIcon");for(var f=0;f<d.length;f++)b(a,"."+d[f]+":mouseover, "+d[f]+":touchstart, ",function(a){this!==z&&this.offsetWidth<this.scrollWidth&&!this.noAutoTooltip&&
(a=getComputedStyle(this).width,a=Number(a.substr(0,a.length-2)),0>a-Math.round(a)&&this.offsetWidth==this.scrollWidth-1||(t(),z=this,a=z.autoTooltip||z.textContent||z.value,z.title&&(a+=" ("+z.title+")"),a&&n.show(a,z,["above","below"]),b.once(z,"mouseout, touchstart, touchout",function(){t()}),z.__autoTooltipInLayoutCheckHandle=setInterval(function(){m.isNodeInLayout(z)||t()},500)))});if(c("touch"))for(f=0;f<e.length;f++)b(a,"."+e[f]+":touchstart ",function(a){this!==z&&(z=this,z.title&&(n.show(z.title,
z,["above","below"]),b.once(z,"touchstart, touchout",function(){n.hide(z);z=null})))})};w.addAutoTooltipsToTabContainer=function(a){d(".tabLabel",a.domNode).forEach(function(a){e.add(a,"TrimWithEllipses")});w.autoTooltip(a)};w.setMultilineText=function(a,b,c,d){c=c||2;b=b.trim();d=d||["above","below"];e.remove(a,"TrimWithEllipses");a.style.overflow="hidden";a.innerHTML="";for(var f=b,g=!1;f;){c--;var k=l.create("div",null,a);k.style.overflow="hidden";k.style.whiteSpace="nowrap";for(var h=f;h;)if(k.textContent=
h,k.offsetWidth<k.scrollWidth-1)h=(h=h.match(/^(.*[^\s]+)\s+[^\s]+$/))&&h[1]||"";else break;!h||!c&&h!==f?(k.textContent=f,f="",k.style.textOverflow="ellipsis",g=!0):f=f.substr(h.length).trim()}g&&w.setTooltipToNode(a,function(){t();z=a;z.isMultilineContainer=!0;return b},{position:d})};w.showErrorTip=function(a,b){return u(r(b),a.domNode||a)};w.showNewStyleErrorTip=function(a,b,c){return u(r(b,"NewStyle"+(c?" esriMapsAnalystXWarningStyle":"")),a.domNode||a)};w.showAlertTooltip=function(a){a&&a.node&&
a.message&&(n.show(a.message,a.node,a.position||["above","below"]),setTimeout(function(){n.hide(a.node)},a.timeout||5E3))};w.showClosableTooltip=function(a){var b=y(a.message,a.tooltipClass,a.position);return v(b,a.component,a.timeout,a.position)};w.removeClosableTooltip=function(a){a&&a._removeFunc&&a._removeFunc()};w.showClosableTooltipOnVerticalBracket=function(c){var d=c.below||c.above,e=g.position(c.above,!0),f=g.position(d,!0),k="rtl"!==document.dir?"start"===c.direction:"end"===c.direction,
n=e.x+e.w*(k?0:1),e=e.y,p=f.y+f.h,q=l.create("div",{class:"esriMapsAnalystFlexibleTooltip_tooltip esriMapsAnalystXNonSelectable"},document.body),t=l.create("div",{class:"esriMapsAnalystFlexibleTooltip_surfaceContainer"},q),f={},n={top:e-2,left:n+(k?-3:3),height:p-e+4,width:10},r;for(r in n)f[r]=n[r]+"px";h.set(q,f);var u=a.createSurface(t,n.width,n.height);u.clear();u.createPolyline([{x:k?n.width:0,y:0},{x:k?0:n.width,y:0},{x:k?0:n.width,y:n.height},{x:k?n.width:0,y:n.height}]).setStroke({color:"#6E6E6E",
width:6});c.component=q;var k=y(c.message,c.tooltipClass,c.position),w=function(){clickHandler&&clickHandler.remove();z&&clearInterval(z);u&&u.clear();l.destroy(t);l.destroy(q)},z=setInterval(function(){m.isNodeInLayout(d)||w();m.isNodeVisible(d)?h.set(q,"visibility","visible"):h.set(q,"visibility","hidden")},300);c.timeout&&setTimeout(w,c.timeout);clickHandler=b(k.closeButton,"click",w);tooltip=v(k,c.component,c.timeout,c.position);var B=tooltip._removeFunc;tooltip._removeFunc=function(){B();w()};
return tooltip};return w})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/DomUtil":function(){define("dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/dom-class dojo/on ../../utils/ObjectUtil esri/dijit/geoenrichment/utils/DomUtil".split(" "),function(l,h,g,e,d,b,a){var c=Object.assign({},a);c.select=function(a){return c.addTag(a,"selected")};c.unselect=function(a){return c.removeTag(a,"selected")};c.floatStart=function(a){return c.addTag(a,"esriMapsAnalystXFloatStart")};c.floatEnd=function(a){return c.addTag(a,
"esriMapsAnalystXFloatEnd")};c.addSpacer=function(a,b){a=l.create("div",{"class":"esriMapsAnalystXSpacer",innerHTML:"\x26nbsp;"},a);if(b)c[b](a);return a};c.getAndUpdateNumber=function(a,c){if(!a)return NaN;var d=a.get&&a.set;void 0===c&&(c=0);var e=b.parseNumber(d?a.get("value"):a.value,c);isNaN(e)||(d?a.set("value",b.formatNumber(e,c)):a.value=b.formatNumber(e,c));return e};c.getAndUpdateString=function(a){if(!a)return null;if(a.get&&a.set){var b=a.get("value").trim();a.set("value",b)}else b=a.value.trim(),
a.value=b;return b};c.getScreenScaleFactor=function(){return c.getTextBox("",{style:"width: 72pt; height: 72pt"}).w/96};c.positionAtCenter=function(a,b){if(a&&b){var c=h.position(a);b=h.position(b);c.w&&c.h&&b.w&&b.h&&g.set(a,{left:(b.w-c.w)/2+"px",top:(b.h-c.h)/2+"px"})}};c.showAroundOverlay=function(a,b){b=b||{};c.removeAroundOverlay(a);var e={w:"width",h:"height",l:"left",t:"top",r:"right",b:"bottom"},f=h.position(a);if(b.viewPortContainer){var k=h.position(b.viewPortContainer),q=f.x,t=f.y;f.x=
Math.max(f.x,k.x);f.w-=f.x-q;f.y=Math.max(f.y,k.y);f.h-=f.y-t;f.w=Math.min(f.w,k.x+k.w-f.x);f.h=Math.min(f.h,k.y+k.h-f.y)}a.__aroundOverlays=(b.placeInNode?[{l:0,t:-f.y,w:f.w,h:f.y},{l:f.w,t:-f.y,w:document.body.clientWidth-(f.x+f.w),h:document.body.clientHeight},{l:0,t:f.h,w:f.w,h:document.body.clientHeight-(f.y+f.h)},{l:-f.x,t:-f.y,w:f.x,h:document.body.clientHeight}]:[{l:f.x,t:0,w:f.w,h:f.y},{w:document.body.clientWidth-(f.x+f.w),r:0,t:0,b:0},{l:f.x,h:document.body.clientHeight-(f.y+f.h),w:f.w,
b:0},{l:0,t:0,w:f.x,b:0}]).map(function(c){var d=l.create("div",{"class":b.overlayClass||"esriMapsAnalystXNodeAroundOverlay"},b.placeInNode?a:document.body),f={position:"absolute"},k;for(k in e)void 0!==c[k]&&(f[e[k]]=Math.round(c[k])+"px");g.set(d,f);return d});f=function(){c.removeAroundOverlay(a)};b.removeOnClick&&(a.__aroundOverlaysRemoveHandle=d.once(document.body,"click",f));a.__aroundOverlaysResizeHandle=d(window,"resize",function(){c.showAroundOverlay(a,b)});var r;a.__aroundOverlaysSetIntervalHandle=
setInterval(function(){if(r){var d=h.position(a);d.x==r.x&&d.y==r.y&&d.w==r.w&&d.h==r.h||c.showAroundOverlay(a,b)}else r=h.position(a)},50);return{remove:f}};c.removeAroundOverlay=function(a){a.__aroundOverlays&&a.__aroundOverlays.forEach(function(a){l.destroy(a)});delete a.__aroundOverlays;a.__aroundOverlaysRemoveHandle&&a.__aroundOverlaysRemoveHandle.remove();delete a.__aroundOverlaysRemoveHandle;a.__aroundOverlaysResizeHandle&&a.__aroundOverlaysResizeHandle.remove();delete a.__aroundOverlaysResizeHandle;
clearInterval(a.__aroundOverlaysSetIntervalHandle);delete a.__aroundOverlaysSetIntervalHandle};c.getDocumentStyleDeclaration=function(a){function b(c){var d;try{d=c.rules||c.cssRules}catch(r){d=null}if(d)for(c=0;c<d.length;c++){var e=d[c];if(e.styleSheet){if(e=b(e.styleSheet))return e}else if(e.selectorText==a)return e.style}}for(var c=0;c<document.styleSheets.length;c++){var d=b(document.styleSheets[c]);if(d)return d}return null};c.getNodeFontFamily=function(a){return(a=g.get(a,"fontFamily")||g.getComputedStyle(a)["font-family"])?
a.replace(/'|"/g,"").split(",")[0]:a};c.getNodeFontSize=function(a){return g.toPixelValue(a,g.get(a,"fontSize"))};c.listenToNodeAdded=function(a,b,d){if(c.isNodeInLayout(a))b();else{a.__listenToNodeAddedHandle&&a.__listenToNodeAddedHandle.remove();var e=setInterval(function(){c.isNodeInLayout(a)&&(a.__listenToNodeAddedHandle&&a.__listenToNodeAddedHandle.remove(),b())},d||100);a.__listenToNodeAddedHandle={remove:function(){clearInterval(e);delete a.__listenToNodeAddedHandle}};return a.__listenToNodeAddedHandle}};
c.isNodeVisible=function(a){return c.isChildOf(a,document.body,function(a){return!e.contains(a,"dijitHidden")&&"hidden"!=g.get(a,"visibility")})};c.enableHyperlink=function(a,b){b?e.replace(a,"esriMapsAnalystXLink","esriMapsAnalystXLinkDisabled"):e.replace(a,"esriMapsAnalystXLinkDisabled","esriMapsAnalystXLink")};return c})},"widgets/BusinessAnalyst/esriAnalystX/utils/ObjectUtil":function(){define(["../../baUtil/ObjectUtil","esri/dijit/geoenrichment/utils/ObjectUtil","esri/dijit/geoenrichment/utils/SortUtil"],
function(l,h,g){var e=Object.assign({},l,h,g);e.getPrototypeOf=function(d){try{return Object.getPrototypeOf?Object.getPrototypeOf(d):d.__proto__||d.constructor&&d.constructor.prototype}catch(b){return null}};e.isJson=function(d){return"object"===typeof d&&e.getPrototypeOf(d)===Object.prototype};e.copyJson=function(d){return void 0===d||null===d?null:JSON.parse(JSON.stringify({object:d})).object};e.convert=function(d,b,a){var c=b||function(){};b=c(d);if("undefined"!==typeof b)return b;if(Array.isArray(d)){var g=
[];d.forEach(function(b){g.push(e.convert(b,c,a))},this);return g}if(!e.isJson(d))return d;b={};for(var f in d){var h=d[f],l=a?c(f):f;"undefined"===typeof l&&(l=f);b[l]=e.convert(h,c,a)}return b};e.getDeepCopy=function(d){return e.convert(d)};e.getRange=function(d,b,a){b="function"===typeof b?b.bind(null==a?null:a):null;var c,e,f;for(f in d)a=d[f],a=Number(null===b?a:b(a,f)),isNaN(a)||(void 0===c?c=e=a:(c=Math.min(c,a),e=Math.max(e,a)));return void 0===c?{}:{min:c,max:e}};e.removeEmptyObjects=function(d){function b(c){c&&
"object"===typeof c&&Object.keys(c).forEach(function(d){var e=c[d];!e||"object"!==typeof e||Array.isArray(e)||Object.keys(e).length?b(e):(a=!0,delete c[d])})}for(var a=!0;a;)a=!1,b(d);return d};e.removeValues=function(d,b){function a(c){c&&"object"===typeof c&&Object.keys(c).forEach(function(d){b(d,c[d])?a(c[d]):delete c[d]})}a(d);return d};e.isEqual=function(d,b){if(null===d||"object"!==typeof d||null===b||"object"!==typeof b)return d===b;if(Object.keys(d).length!==Object.keys(b).length)return!1;
var a={},c;for(c in d)a[c]=!0;for(c in b)if(void 0!==a[c])delete a[c];else return!1;for(c in d)if(!e.isEqual(d[c],b[c]))return!1;return!0};e.getObject=function(d,b){if(!b)return d;b=b.split(".");for(var a=0;a<b.length;a++)d=d&&d[b[a]];return d};e.formatNumber=function(d,b){b="number"===typeof b?{places:b}:b||{};if(null==b.places||0>b.places)b.places=e.getPlaces(d,!0),b.maxPlaces&&b.places>b.maxPlaces&&(b.places=b.maxPlaces);return h.formatNumber(d,b)};e.getPlaces=function(d,b){function a(a,b){var f=
d.indexOf(a,c);if(0>f)return e;a=d.charAt(f+a.length);return!a||0>b.indexOf(a)?e:f-c}d=+d;if(isNaN(d))return-1;d+="";var c=d.indexOf(".")+1,e=c?d.length-c:0;if(2>=e||!b)return e;b=0;if(!+d.substr(0,c-1))for(;"0"===d.charAt(c);)c++,b++,e--;for(var f=e-1;2<=f;f--){var g=Math.min(a("000000000000000".substr(0,f),"01234"),a("999999999999999".substr(0,f),"56789"));if(g!==e){e=g;break}}return e+b};return e})},"widgets/BusinessAnalyst/baUtil/ObjectUtil":function(){define(["require","exports"],function(l,
h){function g(e,d){for(var b=0,a=Object.keys(d);b<a.length;b++){var c=a[b];"object"!==typeof e[c]||null===e[c]||"object"!==typeof d[c]||null===d[c]?e[c]=d[c]:Array.isArray(e[c])?Array.isArray(d[c])?e[c].concat(d[c]):e[c]=d[c]:Array.isArray(d[c])?e[c]=d[c]:g(e[c],d[c])}}return{map:function(e,d,b){void 0!==b&&(d=d.bind(b));if("object"!==typeof e)throw Error("Object or array expected");if(Array.isArray(e)){b=[];for(var a=0,c=e.length;a<c;a++)b.push(d(e[a],a));return b}b={};a=0;for(c=Object.keys(e);a<
c.length;a++){var g=c[a];Object.hasOwnProperty.call(e,g)&&(b[g]=d(e[g],g))}return b},deepAssign:function(e){for(var d=[],b=1;b<arguments.length;b++)d[b-1]=arguments[b];for(b=0;b<d.length;b++)g(e,d[b]);return e}}})},"esri/dijit/geoenrichment/utils/SortUtil":function(){define([],function(){function l(d,b,a,c){d=void 0===d||null===d;return d!=(void 0===b||null===b)?(b=d?-1:1,(void 0===c?a:c)?-b:b):d?0:null}function h(d){var b=/^(.+)\s([1-9]\d*)$/.exec(d);return b?{base:b[1],number:b[2]}:/^[1-9]\d*$/.test(d)?
{base:"",number:+d}:{base:d,number:0}}var g={NEWEST:"newest",OLDEST:"oldest",ALPHABETICAL:"alphabetical",UNALPHABETICAL:"unalphabetical",compareNumeric:function(d,b,a,c){c=l(d,b,a,c);if(null!==c)return c;d=Number(d);b=Number(b);c=d>b?1:d<b?-1:0;return a?-c:c},compareString:function(d,b,a,c){c=l(d,b,a,c);if(null!==c)return c;d=String(d);b=String(b);c=d.localeCompare(b);return a?-c:c}},e=/^(.+)\s([1-9]\d*)(\D*)$/;g.compareNames=function(d,b,a,c){var k=h("string"===typeof d?d.toLowerCase():d),f=h("string"===
typeof b?b.toLowerCase():b),l=null;if(k.base===f.base)l=g.compareNumeric(k.number,f.number,a,c);else{var m=e.exec(k.base);if(m){var p=e.exec(f.base);p&&m[1]===p[1]&&m[3]===p[3]&&(l=g.compareNumeric(m[2],p[2],a,c))}null===l&&(l=g.compareString(k.base,f.base,a,c))}return l||g.compareString(d,b,a,c)};g.compare=function(d,b,a,c){var e=l(d,b,a,c);if(null!==e)return e;e=typeof d;typeof b!=e&&(e="");switch(e){case "number":case "boolean":break;case "object":d=d.valueOf();b=b.valueOf();break;default:return g.compareString(d,
b,a,c)}e=d>b?1:d<b?-1:0;return a?-e:e};return g})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/MouseUtil":function(){define(["dojo/dom-geometry","esri/dijit/geoenrichment/utils/MouseUtil"],function(l,h){var g;h.unitTesting_setCursorOverNode=function(e){e=l.position(e);h.unitTesting_setCursorPosition(e.x+e.w/2,e.y+e.h/2)};h.unitTesting_setCursorPosition=function(e,d){h._latestEvent={clientX:e,pageX:e,clientY:d,pageY:d}};h.unitTesting_lockPosition=function(e){g=e};h.unitTesting_shiftMousePosition=
function(e,d){h.unitTesting_setCursorPosition(h._latestEvent.clientX+(e||0),h._latestEvent.clientY+(d||0))};h._setLatestEvent=function(e){g||(h._latestEvent=e)};return h})},"widgets/BusinessAnalyst/esriAnalystX/widgets/SelectableTreeGrid/SelectableTreeGrid":function(){define("dojo/_base/declare dojo/aspect dojo/Evented dojo/dom-class dojo/dom-construct dojo/dom-style dojo/on dojo/query dijit/Tooltip dijit/_WidgetBase ../../dijit/_TemplatedMixin dgrid/OnDemandGrid dgrid/tree esri/dijit/geoenrichment/utils/KeyboardUtil esri/dijit/geoenrichment/TriStateItem ../../dijit/utils/DgridUtil ../../dijit/utils/DomUtil ../../dijit/utils/MouseUtil ../../dijit/tooltips/TooltipUtil dojo/text!./templates/SelectableTreeGrid.html xstyle/css!./css/SelectableTreeGrid.css".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q,t,r,u,y,v,w){var D=l(null,{_selectedRowInfos:null,_lastSelectedRowInfo:null,_outsideHandler:null,_isSelectionFrozen:!1,keepSelectionOnOutsideClick:!1,_previouslySelectedRowsByNode:null,constructor:function(){this._previouslySelectedRowsByNode=new WeakMap},buildRendering:function z(){this._selectedRowInfos={};this.inherited(z,arguments)},postCreate:function C(){this.inherited(C,arguments);e.add(this.domNode,"esriMapsAnalystXNonSelectable")},_reselectSingleNode:function(a){this.selectSingleRow(this._previouslySelectedRowsByNode.get(a),
a)},selectSingleRow:function(a,b){this.unselectAllRows();this._selectRow(a,b)},_selectRow:function(b,c){e.add(b,this.selectedRowClass);e.add(b,"row-level-"+this._getNodeLevel(c));var d=this.tree.getIdentity(c),f={row:b,node:c,nodeId:d,index:c.parent&&c.parent.children.indexOf(c)};this._lastSelectedRowInfo=this._selectedRowInfos[d]=f;this._previouslySelectedRowsByNode.set(c,b);var g=this;this._outsideHandler=this._outsideHandler||a(document.body,"click",function(){y.isMouseOver(g.domNode)||g._isSelectionFrozen||
g.keepSelectionOnOutsideClick||g.unselectAllRows()})},_unselectRow:function(a,b){delete this._selectedRowInfos[this.tree.getIdentity(b)];e.remove(a,this.selectedRowClass)},unselectAllRows:function(){for(var a in this._selectedRowInfos)e.remove(this._selectedRowInfos[a].row,this.selectedRowClass);this._selectedRowInfos={};this._lastSelectedRowInfo=null;this._outsideHandler&&this._outsideHandler.remove();this._outsideHandler=null},getSelectedRowNodes:function(){return this._getSelectedNodesRows().nodes},
selectRowNodes:function(a){var b=this;a&&a.forEach(function(a){var c=b.grid.row(a);c&&c.element&&b._selectRow(c.element,a)})},freezeRowSelection:function(){this._isSelectionFrozen=!0},unfreezeRowSelection:function(){this._isSelectionFrozen=!1},_getSelectedNodesRows:function(){var a=[],b=[],c=[],d;for(d in this._selectedRowInfos)c.push(this._selectedRowInfos[d]);c.sort(function(a,b){return a.index-b.index});c.forEach(function(c){a.push(c.node);b.push(c.row)});return{nodes:a,rows:b}},_emitSelectedRowsEvent:function(){var a=
this._getSelectedNodesRows();if(a.nodes.length)this.onRowsSelected(a.nodes,a.rows)}});return l([f,n,g,D],{templateString:w,tree:null,grid:null,gridClass:"",highlightSelected:!0,firstColumns:null,additionalColumns:null,showRootCheckbox:!0,showCheckboxColumn:!0,showHeader:!0,labelColumnField:"label",gridParams:null,keepContentUnderScroll:void 0,hideInvisibleExpandoIcons:!1,expandOnNodeClick:!1,checkLimit:0,checkLimitMessage:null,checkLimitMessageTimeout:5E3,handleMultipleCheck:!1,enableRowSelection:!1,
enableMultipleRowSelection:!1,allowSelectionFromManyParents:!1,selectedRowFilter:null,selectedRowClass:"row-selected",enableHeaderLabelToggleClick:!0,defaultExpand:null,fitParentSize:!1,renderAllRows:!1,rowPostProcessor:null,_rootCheckbox:null,_checkboxes:null,_lastCheckedNode:null,updateSelectionCountDiv:function(a,b){},getLabel:function(a,b){return a.label},postCreate:function E(){this.inherited(E,arguments);this._createGrid()},resize:function(){this.grid.resize();this._updateCheckboxState(this._rootCheckbox);
for(var a in this._checkboxes)this._updateCheckboxState(this._checkboxes[a]);this._emitSelectionChanged()},setWidth:function(a){this.grid&&this.grid.domNode&&b.set(this.grid.domNode,"width",a+"px")},setHeight:function(a){this.grid&&this.grid.domNode&&b.set(this.grid.domNode,"height",a+"px")},row:function(a){return this.grid.row(a)},cell:function(a){return this.grid.cell(a)},_labelColumn:null,_createGrid:function(){var b=this;this._checkboxes={};var c={label:this.getLabel(this.tree.root,!0),sortable:!1,
field:this.labelColumnField,renderCell:this._renderLabel.bind(this),renderHeaderCell:this._renderLabelHeader.bind(this,this.tree.root)},d;if(this.additionalColumns&&this.additionalColumns.length&&(d=this.additionalColumns.filter(function(a){return a.field===b.labelColumnField})[0])){for(var f in c)void 0===d[f]&&(d[f]=c[f]);c=d}c.indentWidth=c.indentWidth||16;this._labelColumn=c=this._prepareTreeColumn(c);f=[];this.firstColumns&&(f=f.concat(this.firstColumns));this.showCheckboxColumn&&f.push({label:"",
field:"checkbox",sortable:!1,renderCell:this._renderCheckboxForColumn.bind(this),renderHeaderCell:this._renderCheckboxForColumn.bind(this,this.tree.root)});d||f.push(c);this.additionalColumns&&(f=f.concat(this.additionalColumns));c=["esriMapsAnalystXSelectableTreeGrid"];this.gridClass&&c.push(this.gridClass);this.fitParentSize&&c.push("fitParentSize");c=Object.assign({class:c.join(" "),keepScrollPosition:!0,store:this.tree,columns:f},this.gridParams);this.grid=this._createGridObject(c,this.gridContainer);
this.own(this.grid);this.grid._expanded=this.defaultExpand||this.grid._expanded||{};r.oddEvenFix(this.grid);this.own(a(this.tree,"updated",this._onStoreUpdated.bind(this)));this._addKeepScrollHandlers();this._addGridHandlers();this.renderAllRows&&(this.grid.minRowsPerPage=1E4,this.grid.maxRowsPerPage=10250);this.grid.startup();v.autoTooltip(this.domNode);this.showHeader||e.add(this.domNode,"esriMapsAnalystXGridNoHeader");a(this.grid.domNode,".dgrid-expando-icon:click,.dgrid-content .dgrid-column-labelColumn:dblclick,.dgrid-content .dgrid-column-labelColumn:keydown",
function(a){(a=b.grid.row(a))&&b.onExpandChangedUser(a.data)})},_createGridObject:function(a,b){return new m(a,b)},onRowInserted:function(a,b){},_addGridHandlers:function(){function b(b,c){d.enableRowSelection&&c.parent&&(!d.selectedRowFilter||d.selectedRowFilter(c))&&(e.add(b,"esriMapsAnalystXClickable"),a(b,"click",function(a){setTimeout(function(){if(!d._isSelectionFrozen){if(a.shiftKey&&d.enableMultipleRowSelection){if(d._lastSelectedRowInfo&&d._lastSelectedRowInfo.row.parentNode&&d._lastSelectedRowInfo.node.parent===
c.parent){var e=u.getChildIndex(d._lastSelectedRowInfo.row.parentNode,d._lastSelectedRowInfo.row),f=u.getChildIndex(b.parentNode,b),g=e<=f?d._lastSelectedRowInfo.row:b,e=e<=f?b:d._lastSelectedRowInfo.row,f=g;if(g.id!==e.id){do{g=d.grid.row(f).data;d._selectRow(f,g);if(f.id===e.id)break;f=f.nextSibling}while(f)}}else d.selectSingleRow(b,c);u.stealFocus()}else q.isCtrl(a)&&d.enableMultipleRowSelection?d._lastSelectedRowInfo&&d._lastSelectedRowInfo.row.parentNode&&d._lastSelectedRowInfo.node.parent===
c.parent||d.allowSelectionFromManyParents?d._selectedRowInfos[c.id]?d._unselectRow(b,c):d._selectRow(b,c):d.selectSingleRow(b,c):d.selectSingleRow(b,c);d._emitSelectedRowsEvent()}})}))}var d=this;this.own(h.after(this.grid,"insertRow",function(a){var e=a&&d.grid._rowIdToObject[a.id];if(a){if(e&&d.hideInvisibleExpandoIcons&&(!e.children||!e.children.length)){var f=c(".dgrid-expando-icon",a)[0];f&&(f.style.width="0")}u[e&&!1===e.visible?"hide":"show"](a);b(a,e)}e&&(d._updateRowHighlighting(e,a),d.onRowInserted(a,
e));d.rowPostProcessor&&d.rowPostProcessor(a,e);return a}))},_addKeepScrollHandlers:function(){function a(a){if(!b.grid.contentNode)return a;if(b.fitParentSize){var c=u.hasScrollbars(b.grid.bodyNode);b.grid.headerNode.style[b.isLeftToRight()?"right":"left"]=c.w?"":"0px";b._lastContentWidth=b.grid.contentNode.style.width||b._lastContentWidth||"";b.grid.contentNode.style.width=c.h?b._lastContentWidth:""}else b.keepContentUnderScroll?b.grid.contentNode.style.width=b.grid.headerNode.firstChild.offsetWidth+
"px":!1===b.keepContentUnderScroll&&(b.grid.contentNode.style.width="");return a}var b=this;if(this.fitParentSize||void 0!==this.keepContentUnderScroll)h.before(this.grid,"refresh",function(){b.hideCheckLimitMessage();b._lastCheckedNode=null}),h.after(this.grid,"resize",a),h.after(this.grid,"refresh",a)},_getNodeLevel:function(a){var b=-1;for(a=a&&a.parent;a;)b++,a=a.parent;return b},_prepareTreeColumn:function(a){return this._wrapTreeColumn(p(a))},_wrapTreeColumn:function(a){return a},_onStoreUpdated:function(){this._checkboxes=
{};this._refreshGrid();this._rootCheckbox&&this._updateCheckboxState(this._rootCheckbox);this._emitSelectionChanged()},_emitSelectionChanged:function(a){var b=this.tree.root.selectCount;this.updateSelectionCountDiv(this.selectionCounter,b);this.emit("SelectionChanged",{selected:b,toggledTreeNode:a})},refresh:function(){this._refreshGrid();this.refreshCheckboxes()},_isRefreshSuspended:!1,setRefreshSuspended:function(a){this._isRefreshSuspended=a},_refreshGrid:function(){if(!this._isRefreshSuspended){var a=
this.grid.getScrollPosition();this.grid.refresh();this.grid.scrollTo(a);for(var b in this._selectedRowInfos)this.grid.row(this._selectedRowInfos[b].node).element&&this._selectRow(this.grid.row(this._selectedRowInfos[b].node).element,this._selectedRowInfos[b].node)}},getScrollPosition:function(){return this.grid&&this.grid.getScrollPosition()},setScrollPosition:function(a){return this.grid&&this.grid.scrollTo(a)},_renderCheckbox:function(a){if(!a.leafCount&&a!==this.tree.root||!this.showCheckboxColumn||
!1===a.selectable&&void 0===a.indepSelection)return document.createTextNode("");var b=new t(null,{class:"esriStyleInTable"});b.autoToggle=!1;b.node=a;this._updateCheckboxState(b,a);!1===a.enabled&&b.set("disabled",!0);a===this.tree.root?(this._rootCheckbox=b,u[this.showRootCheckbox?"show":"hide"](b.domNode)):this._checkboxes[this.tree.getIdentity(a)]=b;b.onClick=this._onCheckboxClick.bind(this,a,b);return b},_renderCheckboxForColumn:function(a){return(a=this._renderCheckbox(a))&&a.domNode},refreshCheckboxes:function(){this._rootCheckbox&&
this._updateCheckboxState(this._rootCheckbox);for(var a in this._checkboxes)this._updateCheckboxState(this._checkboxes[a])},clearLastCheckInfo:function(){this._lastCheckedNode=null},_onCheckboxClick:function(a,b,c){c.stopPropagation();this.hideCheckLimitMessage();var d=this.handleMultipleCheck&&("function"!==typeof this.handleMultipleCheck||this.handleMultipleCheck(a));d&&c.shiftKey&&this._tryToggleMultipleNodes(this._lastCheckedNode,a,b||c)?this._lastCheckedNode=a:(this._lastCheckedNode=d?a:null,
this._toggleNodeSelection(a,b||c),this.refreshCheckboxes())},_tryToggleMultipleNodes:function(a,b,c){if(!a||a===b||a.parent!==b.parent)return!1;var d=b.parent.children,e=d.indexOf(a);b=d.indexOf(b);a=e<b?1:-1;for(var f=[],g=[],e=e+a;;e+=a){var h=d[e];((void 0===h.indepSelection?h.selected:h.indepSelection)?f:g).push(h);if(e===b)break}f.forEach(function(a){this._toggleNodeSelection(a,c)},this);g.every(function(a){return this._toggleNodeSelection(a,c)},this);this.refreshCheckboxes();return!0},_toggleNodeSelection:function(a,
b){var c=void 0===a.indepSelection?!a.selected:!a.indepSelection;if(c&&this.checkLimit){var d=this.getSelectedNodes().length,e="function"===typeof this.checkLimit?this.checkLimit(this.tree,d):this.checkLimit;if(d>=e)if(void 0===a.indepSelection&&a.children&&!1!==this.tree.getSelectionState(a))c=!1;else return this.showCheckLimitMessage(b),!1}d=!0;void 0===a.indepSelection?(d=this.tree.changeSelect(a,c,e),!d&&this.showCheckLimitMessage(b)):a.indepSelection=c;this._emitSelectionChanged(a);return d},
_checkLimitHandler:null,showCheckLimitMessage:function(a){if(this.checkLimitMessage){var b=a&&(a.domNode||a.target);b&&(k.show(this.checkLimitMessage,b,["above","below"]),a=function(){b&&k.hide(b);b=null},setTimeout(a,this.checkLimitMessageTimeout),this._checkLimitHandler=a,this.onCheckLimitReached(a))}},hideCheckLimitMessage:function(){this._checkLimitHandler&&this._checkLimitHandler();this._checkLimitHandler=null},onCheckLimitReached:function(a){},_updateCheckboxState:function(a){if(a){var b=this._getNodeSelection(a.node);
a.set("checked",b);this._updateRowHighlighting(a.node,null,b)}},_getNodeSelection:function(a){return void 0!==a.indepSelection?a.indepSelection:this.tree.getSelectionState(a)},_updateRowHighlighting:function(a,b,c){this.highlightSelected&&a&&(c=void 0!==c?c:this._getNodeSelection(a),(b=b||this.grid&&this.row(a).element)&&(!0!==c||void 0===a.indepSelection&&!1===a.selectable?e.remove(b,"selected"):e.add(b,"selected")))},_renderLabel:function(a,b,c){b=this._renderLabelNode(a,c);this._provideLabelClickAction(b,
c,a);return b},_provideLabelClickAction:function(b,c,d){var f=this.expandOnNodeClick&&d.children?d.children.length&&(b=c,function(){this.toggleExpand(d);this.onExpandChangedUser(d)}.bind(this)):!1!==d.enabled&&this.showCheckboxColumn?this._onCheckboxClick.bind(this,d,null):null;f&&(e.add(b,"esriMapsAnalystXClickable"),a(b,"click",function(a){a.stopPropagation();f(a)}))},_renderLabelNode:function(a){return d.create("div",{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(a)})},
_renderLabelHeader:function(b){var c=d.create("div",{class:"esriMapsAnalystXSelectableTreeLabel TrimWithEllipses",innerHTML:this.getLabel(b)||this._labelColumn&&this._labelColumn.label||""});this.enableHeaderLabelToggleClick&&this.showRootCheckbox&&(e.add(c,"esriMapsAnalystXClickable"),a(c,"click",this._onCheckboxClick.bind(this,b,null)));return c},onRowsSelected:function(a,b){},isNodeSelected:function(a){return a&&(a.selected||a.indepSelection)},getSelectedNodes:function(){var a=this.tree.getSelectedNodes(!1),
b=this._getIndepSelectedNodes();return a.concat(b)},_getIndepSelectedNodes:function(){function a(c){c&&(c.indepSelection&&b.push(c),c.children&&c.children.forEach(a))}var b=[];a(this.tree.root);return b},getSelectedState:function(){if(!this.tree)return null;var a={normalSelection:{},indepSelection:{}},b=this.tree.getSelectedNodes(!1);b&&b.forEach(function(b){a.normalSelection[b.id]=!0});(b=this._getIndepSelectedNodes())&&b.forEach(function(b){a.indepSelection[b.id]=!0});return a},setSelectedState:function(a){if(this.tree){this.tree.changeSelect(this.tree.root,
!1);if(a){for(var b in a.normalSelection){var c=this.tree.get(b);c&&this.tree.changeSelect(c,!0)}for(b in a.indepSelection)if(c=this.tree.get(b))c.indepSelection=!0}this.refreshCheckboxes()}},setNodeSelected:function(a,b,c){a&&(void 0!==a.indepSelection?a.indepSelection=b:this.tree.changeSelect(a,b),!1!==c&&this.refreshCheckboxes())},isExpanded:function(a){a="string"===typeof a?a:a[this.tree.idProperty];return this.grid._expanded&&this.grid._expanded[a]},setExpanded:function(a,b,c){a="string"==typeof a?
a:a[this.tree.idProperty];void 0!==a&&(!1!==c?(c=this.grid.row(a))&&c.element&&this.grid.expand(a,b):this.grid._expanded[a]=b)},toggleExpand:function(a){this.setExpanded(a,!this.isExpanded(a))},getExpandedState:function(){return Object.assign({},this.grid._expanded)},setExpandedState:function(a){this.grid._expanded=a||{}},onExpandChangedUser:function(a){},destroy:function(){this.unselectAllRows();this.inherited(arguments)}})})},"widgets/BusinessAnalyst/esriAnalystX/dijit/_TemplatedMixin":function(){define(["dojo/_base/declare",
"dijit/_TemplatedMixin","./_EscapeValueMixin"],function(l,h,g){return l([h,g],{})})},"widgets/BusinessAnalyst/esriAnalystX/dijit/_EscapeValueMixin":function(){define(["dojo/_base/declare"],function(l){return l(null,{_escapeValue:function(h){return h.replace(/"/g,"\x26quot;")}})})},"dgrid/tree":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/Deferred dojo/_base/lang dojo/query dojo/on dojo/aspect ./util/has-css3 ./Grid dojo/has!touch?./util/touch put-selector/put".split(" "),function(l,
h,g,e,d,b,a,c,k,f,n){function m(a,b,c,d){d=this.grid.isRTL?"right":"left";var e=".dgrid-expando-icon";b&&(e+=".ui-icon.ui-icon-triangle-1-"+(c?"se":"e"));a=n("div"+e+"[style\x3dmargin-"+d+": "+a*(this.indentWidth||9)+"px; float: "+d+"]");a.innerHTML="\x26nbsp;";return a}function p(a){var b=this,c=this.style.height;c&&(this.style.display="0px"==c?"none":"block");a&&(n(this,".dgrid-tree-resetting"),setTimeout(function(){n(b,"!dgrid-tree-resetting")}));this.style.height=""}function q(e){var l=e.renderCell||
k.defaultRenderCell,q,t;e||(e={});e.shouldExpand=e.shouldExpand||function(a,b,c){return c};a.after(e,"init",function(){var k=e.grid,l=".dgrid-content .dgrid-column-"+e.id,r=[];k.cleanEmptyObservers=!1;if(!k.store)throw Error("dgrid tree column plugin requires a store to operate.");e.renderExpando||(e.renderExpando=m);r.push(k.on(e.expandOn||".dgrid-expando-icon:click,"+l+":dblclick,"+l+":keydown",function(a){var b=k.row(a);k.store.mayHaveChildren&&!k.store.mayHaveChildren(b.data)||"keydown"==a.type&&
32!=a.keyCode||"dblclick"==a.type&&t&&1<t.count&&b.id==t.id&&-1<a.target.className.indexOf("dgrid-expando-icon")||k.expand(b);-1<a.target.className.indexOf("dgrid-expando-icon")&&(t&&t.id==k.row(a).id?t.count++:t={id:k.row(a).id,count:1})}));c("touch")&&r.push(k.on(f.selector(l,f.dbltap),function(){k.expand(this)}));k._expanded||(k._expanded={});r.push(a.after(k,"insertRow",function(a){var b=this.row(a);e.shouldExpand(b,q,this._expanded[b.id])&&this.expand(a,!0,!0);return a}));r.push(a.before(k,"removeRow",
function(a,b){if(a=a.connected)d("\x3e.dgrid-row",a).forEach(function(a){k.removeRow(a,!0)}),b||n(a,"!")}));e.collapseOnRefresh&&r.push(a.after(k,"cleanup",function(){this._expanded={}}));k._calcRowHeight=function(a){var b=a.connected;return a.offsetHeight+(b?b.offsetHeight:0)};k.expand=function(a,f,h){var l=a.element?a:k.row(a),m=c("transitionend");a=new g;var q=a.promise;a.resolve();a=l.element;a=-1<a.className.indexOf("dgrid-expando-icon")?a:d(".dgrid-expando-icon",a)[0];h=h||!1===e.enableTransitions;
if(a&&a.mayHaveChildren&&(h||f!==!!this._expanded[l.id])){var r=void 0===f?!this._expanded[l.id]:f;n(a,".ui-icon-triangle-1-"+(r?"se":"e")+"!ui-icon-triangle-1-"+(r?"e":"se"));f=l.element;var t=f.connected,u,v,w={originalQuery:this.query};if(!t){var t=w.container=f.connected=n(f,"+div.dgrid-tree-container"),y=function(a){return k.store.getChildren(l.data,a)};e.allowDuplicates&&(w.parentId=l.id);"level"in a&&(y.level=a.level);q=q.then(function(){if(k.renderQuery)return k.renderQuery(y,w);var a=n(t,
"div"),b=k.renderArray(y(w),a,"level"in y?{queryLevel:y.level}:{});g.when(b,function(){n(a,"!")});return b});m?b(t,m,p):p.call(t)}t.hidden=!r;u=t.style;!m||h?(u.display=r?"block":"none",u.height=""):(r?(u.display="block",v=t.scrollHeight,u.height="0px"):(n(t,".dgrid-tree-resetting"),u.height=t.scrollHeight+"px"),setTimeout(function(){n(t,"!dgrid-tree-resetting");u.height=r?v?v+"px":"auto":"0px"}));r?this._expanded[l.id]=!0:delete this._expanded[l.id]}return q};a.after(e,"destroy",function(){h.forEach(r,
function(a){a.remove()});delete k.expand;delete k._calcRowHeight})});e.renderCell=function(a,b,c,d){var f=e.grid,g=Number(d&&d.queryLevel)+1,h=!f.store.mayHaveChildren||f.store.mayHaveChildren(a),k=d.parentId,g=q=isNaN(g)?0:g,f=e.renderExpando(g,h,f._expanded[(k?k+"-":"")+f.store.getIdentity(a)],a);f.level=g;f.mayHaveChildren=h;(a=l.call(e,a,b,c,d))&&a.nodeType?(n(c,f),n(c,a)):c.insertBefore(f,c.firstChild)};return e}q.defaultRenderExpando=m;e.getObject("dgrid.tree",!0);return dgrid.tree=q})},"dgrid/util/has-css3":function(){define(["dojo/has"],
function(l){function h(e,d){e=e.style;var b;if(d in e)return!0;d=d.slice(0,1).toUpperCase()+d.slice(1);for(b=g.length;b--;)if(g[b]+d in e)return g[b];return!1}var g=["ms","O","Moz","Webkit"];l.add("css-transitions",function(e,d,b){return h(b,"transitionProperty")});l.add("css-transforms",function(e,d,b){return h(b,"transform")});l.add("css-transforms3d",function(e,d,b){return h(b,"perspective")});l.add("transitionend",function(){var e=l("css-transitions");return e?!0===e?"transitionend":{ms:"MSTransitionEnd",
O:"oTransitionEnd",Moz:"transitionend",Webkit:"webkitTransitionEnd"}[e]:!1});return l})},"widgets/BusinessAnalyst/esriAnalystX/dijit/utils/DgridUtil":function(){define(["dojo/aspect","dojo/dom-class","dojo/query","../../utils/ArrayUtil"],function(l,h,g,e){function d(a,b,d){if(void 0===d){var e=a._rowIdToObject[b.id];e&&(d=(a=a.store)&&a.isOdd&&a.isOdd(e))}0!==d&&1!==d||h.replace(b,c[d],c[1-d])}function b(a,b,c){var e=a.store;if(e&&e.updateExpand){c=e.updateExpand(b.data,c,!0,a.getSortingFunction());
for(var f in c)b=a.row(e.get(f)),b.element&&d(a,b.element,c[f])}}var a=["ui-icon-triangle-1-e","ui-icon-triangle-1-se"],c=["dgrid-row-even","dgrid-row-odd"];return{createExpando:function(b){h.add(b,"dgrid-expando-icon ui-icon ui-icon-triangle-1-e esriMapsAnalystXClickable");return{expando:b,update:function(c){c=c?1:0;h.replace(b,a[c],a[1-c])}}},oddEvenFix:function(a){a.expand&&(a.getSortingFunction=function(){var a=this.get("sort");return a&&a.length?e.getSorting(a):null},l.after(a,"insertRow",function(b){d(a,
b);return b}),l.before(a,"refresh",function(){var b=a.store;b&&b.updateExpandedNodes&&b.updateExpandedNodes(a._expanded,a.getSortingFunction())}),l.around(a,"expand",function(c){return function(d,e){var f=d.element?d:a.row(d);void 0===e&&(e=!a._expanded[f.id]);!0===e&&b(a,f,!0);var g=c.apply(this,arguments);!1===e&&b(a,f,!1);return g}}),l.around(a,"adjustRowIndices",function(b){return function(){var c=a.store;c&&c.updateExpandedNodes&&c.updateExpand&&c.isOdd||b.apply(this,arguments)}}))},makeContentNeverGoUnderScroll:function(a){function b(){var b=
a.headerNode.firstChild,c=a.contentNode;c&&b&&b.offsetWidth!==c.offsetWidth&&(c.style.width="",b.style.width="",b.style.width=c.offsetWidth+"px")}l.after(a,"resize",b);l.after(a,"refresh",b);l.after(a,"expand",function(a){setTimeout(b,100);setTimeout(b,300);return a})},inlineSortArrow:function(a,b,c){b=e.arrayToObject(e.listToArray(b));l.after(a,"updateSortArrow",function(d,e){if((e=d[0]&&d[0].attribute)&&b[e]){var f=(e=a._sortNode||a._findSortArrowParent(e))&&g(".dgrid-sort-arrow",e)[0];d=d[0].descending;
if(f){f.remove();h.remove(e,"dgrid-sort-down dgrid-sort-up");var k=c?g(c,e)[0]:e.lastChild.append?e.lastChild:e;k.append||(k=e);h.add(k,d?"dgrid-sort-down":"dgrid-sort-up");k.append(f)}}},!0)}}})},"widgets/BusinessAnalyst/esriAnalystX/utils/ArrayUtil":function(){define("require exports ../../baUtil/array dojo/store/util/SimpleQueryEngine ./ObjectUtil esri/dijit/geoenrichment/utils/ArrayUtil".split(" "),function(l,h,g,e,d,b){function a(a,b){a.some(function(c,d){b.func(c,d,b,a);if(b.stop)return!0});
return b}function c(a){var b=a.split(" "),c=b[1];a={};switch(b[0]){case "max":a.result=-Infinity;b=function(a,b,e){e.result=Math.max(e.result,d.getObject(a,c))};break;case "min":a.result=Infinity;b=function(a,b,e){e.result=Math.min(e.result,d.getObject(a,c))};break;case "sum":a.result=0;b=function(a,b,e){e.result+=d.getObject(a,c)};break;case "random":a.result=void 0;b=function(a,b,c,d){c.result=d[Math.round((d.length-1)*Math.random())];c.stop=!0};break;default:throw Error("Unsupported query.");}a.func=
b;return a}var k={getSorting:function(a,b){if(!a)return d.compare;if("function"===typeof a)return a;var c;c=Array.isArray(a)?a:a.sort||[a];var e={};"string"===typeof b&&(b=[b]);Array.isArray(b)?b.forEach(function(a){e[a]=d.compareNames}):b&&(e=b);return function(a,b){for(var f=void 0,g=0;f=c[g];g++){var h=a[f.attribute],k=b[f.attribute];if(h=(e[f.attribute]||(e["*"]?e["*"].bind(null,f.attribute):d.compare))(h,k,!1,!1,a,b))return f.descending?-h:h}return 0}},sort:function(a,b,c){return a.sort(k.getSorting(b,
c))},sortIndices:function(a,b,c){a=g.map(a,function(a,b){return{value:a,index:b}});var d=k.getSorting(b,c);a.sort(function(a,b){return d(a.value,b.value)});return g.map(a,function(a){return a.index})},getQueryEngine:function(a,b){return function(c,d){d&&d.sort&&(d=Object.assign({},d),d.sort=k.getSorting(d.sort,a));return(b||e)(c,d)}},objectToArray:function(a,b){void 0===b&&(b=null);var c=[],d=b?function(c){return a[c]?a[c][b]:void 0}:function(b){return a[b]},e;for(e in a){var f=d(e);"undefined"!==
typeof f&&c.push(f)}return c},arrayToObject:function(a,c){var d={},e=b.composeIdentityFunction(c);g.forEach(a,function(a){d[e(a)]=a});return d},composeIdentityFunction:b.composeIdentityFunction,removeDuplicates:b.removeDuplicates,splitArrayToBunches:b.splitArrayToBunches,contains:function(a,b){return-1!==g.indexOfLoose(a,b)},remove:function(a,b){b=g.indexOfLoose(a,b);-1!==b&&a.splice(b,1);return-1!==b},merge:function(a,b){a=a||[];null!=b&&Array.prototype.push.apply(a,b);return a},listToArray:function(a,
b){if(null==a)return[];void 0===b&&(b=",");a="string"===typeof a?a.split(b):a.slice();for(b=0;b<a.length;b++)"string"===typeof a[b]&&(a[b]=a[b].trim());return a},reorderArray:function(a,b){var c=a.length,d=0,e=Array(c),f={},g={},h;for(h in b){var k=Math.round(h);if(0<=k&&k<c&&!f[k]){var l=Math.round(b[h]);0<=l&&l<c&&!g[l]&&(e[l]=a[k],f[k]=1,g[l]=1,d++)}}d!==c&&(e=e.filter(function(a,b){return g[b]}),a.forEach(function(a,b){!f[b]&&e.push(a)}));return e},mapIndices:function(a,b,c,d){d=null==d?null:
d;if(1===a)c.call(d,0,Math.floor(b/2));else{b=(b-1)/(a-1);for(var e=0;e<a;e++)c.call(d,e,Math.floor(.5+e*b))}},moveElement:function(a,b,c,d){var e=Array.isArray(b)?b:[b];if(-1!==e.indexOf(c))return a.slice();var f=[];a.forEach(function(a){-1===e.indexOf(a)&&(a==c?"before"===d?(e.forEach(function(a){f.push(a)}),f.push(c)):"after"===d&&(f.push(c),e.forEach(function(a){f.push(a)})):f.push(a))});return f},min:function(a,b){var c=a.length;switch(c){case 0:return null;case 1:return a[0];default:for(var d=
a[0],e=b(d),f=0,g=1;g<c;g++){var h=b(a[g]);e>h&&(d=a[g],e=h,f=g)}return{key:f,value:d,comparisonValue:e}}},max:function(a,b){var c=a.length;switch(c){case 0:return null;case 1:return a[0];default:for(var d=a[0],e=b(d),f=0,g=1;g<c;g++){var h=b(a[g]);e<h&&(d=a[g],e=h,f=g)}return{key:f,value:d,comparisonValue:e}}},query:function(b,d){if("object"===typeof d)return a(b,d);if("string"===typeof d)return d=c(d),a(b,d).result},everyEqualProperty:function(a,b){if(2>a.length)return!0;var c;return!a.some(function(a,
d){if(0===d)c=a[b];else if(c!==a[b])return!0})}};return k})},"widgets/BusinessAnalyst/baUtil/array":function(){define(["require","exports"],function(l,h){var g=Array.prototype,e={every:function(d,b,a){return null==d?!0:"string"===typeof d?g.every.call(d.split(""),b,a):g.every.call(d,b,a)},some:function(d,b,a){return null==d?!1:"string"===typeof d?g.some.call(d.split(""),b,a):g.some.call(d,b,a)},forEach:function(d,b,a){if(null!=d)return"string"===typeof d?g.forEach.call(d.split(""),b,a):g.forEach.call(d,
b,a)},map:function(d,b,a){return null==d?[]:"string"===typeof d?g.map.call(d.split(""),b,a):g.map.call(d,b,a)},filter:function(d,b,a){return null==d?[]:"string"===typeof d?g.filter.call(d.split(""),b,a):g.filter.call(d,b,a)},indexOf:function(d,b){return null==d?-1:"string"===typeof d?g.indexOf.call(d.split(""),b):g.indexOf.call(d,b)},indexOfLoose:function(d,b){if(null==d||void 0===d.length)return-1;if("string"===typeof d)return e.indexOfLoose(d.split(""),b);for(var a=0,c=d.length;a<c;a++)if(d[a]==
b)return a;return-1},lastIndexOf:function(d,b){return null==d?-1:"string"===typeof d?g.lastIndexOf.call(d.split(""),b):g.lastIndexOf.call(d,b)},lastIndexOfLoose:function(d,b){if(null==d||void 0===d.length)return-1;if("string"===typeof d)return e.lastIndexOfLoose(d.split(""),b);for(var a=d.length-1;0<=a;a--)if(d[a]==b)return a;return-1}};return e})},"widgets/BusinessAnalyst/SelectPointPolygonPage":function(){define("dojo/_base/declare dojo/_base/html dojo/_base/lang dojo/dom-class dojo/dom-style dojo/on dojo/query dojo/when dijit/_TemplatedMixin dijit/_WidgetBase esri/Color esri/dijit/Search esri/dijit/geoenrichment/_WizardPage esri/geometry/webMercatorUtils esri/graphic esri/InfoTemplate esri/symbols/PictureMarkerSymbol esri/symbols/SimpleFillSymbol esri/symbols/SimpleLineSymbol esri/toolbars/draw jimu/dijit/EditorXssFilter jimu/utils dojo/text!./SelectPointPolygonPage.html ./utils/GeocodeUtil".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q,t,r,u,y,v,w,D,B,z,C){return l([f,k,p],{templateString:z,polygonActive:!1,freehandPolygonActive:!1,postCreate:function(){this.inherited(arguments);var a=this;this.config.firstPageText=D.getInstance().sanitize(this.config.firstPageText);this.config.searchTextBoxOption?(this.search=(new m({map:this.map})).placeAt(this.searchContainer),this.search.activeSource.outFields.push("country"),this.own(b(this.search,"select-result",function(){a._loadSearchResult()}))):(e.remove(this.activatePinButton,
"esriBusinessAnalystButtonSearchPadding"),e.remove(this.activatePolygonButton,"esriBusinessAnalystButtonSearchPadding"),e.remove(this.activateFreehandPolygonButton,"esriBusinessAnalystButtonSearchPadding"));this.config.dropPinOption?this.own(b(this.activatePinButton,"click",function(){a._onActivatePinButtonClick()})):d.set(this.activatePinButton,"display","none");this.config.drawPolygonOption?this.own(b(this.activatePolygonButton,"click",function(){a._onActivatePolygonButtonClick()})):d.set(this.activatePolygonButton,
"display","none");this.config.drawFreehandPolygonOption?this.own(b(this.activateFreehandPolygonButton,"click",function(){a._onActivateFreehandPolygonButtonClick()})):d.set(this.activateFreehandPolygonButton,"display","none")},startup:function(){this.resize();this._started||e.add(this.layoutGrid.domNode,"business-analyst-search-suggestions-overflow")},_loadSearchResult:function(){this.wizard.selectedPoint.geometry=this.search.selectedResult.feature.geometry;this.wizard.selectedPoint.locationName=this.search.selectedResult.name;
var a=q.xyToLngLat(this.search.selectedResult.feature.geometry.x,this.search.selectedResult.feature.geometry.y);this.wizard.selectedPoint.long=a[0].toFixed(5);this.wizard.selectedPoint.lat=a[1].toFixed(5);this.wizard.setSelectedCountry(this.search.selectedResult.feature.attributes.country);this.onNext()},_onActivatePinButtonClick:function(){this._executeHandler?(this._deactivate(),this._deactivatePolygon(),this._deactivateFreehandPolygon()):(this._deactivatePolygon(),this._deactivateFreehandPolygon(),
this._setActive())},_setActive:function(){this._executeHandler||(e.add(this.activatePinButton,"esriBusinessAnalystPressedButton"),this.map.setInfoWindowOnClick(!1),this.map.setMapCursor("default"),this.map.disablePan(),this._executeHandler=b(this.map,"click",this._addPoint.bind(this)))},_deactivate:function(){this._executeHandler&&(e.remove(this.activatePinButton,"esriBusinessAnalystPressedButton"),this.map.setInfoWindowOnClick(!0),this.map.enablePan(),this._executeHandler.remove(),this._executeHandler=
null)},_addPoint:function(a){if(this._executeHandler){this._deactivate();var b=q.xyToLngLat(a.mapPoint.x,a.mapPoint.y),d=this;c(C.reverseGeocode({x:b[0],y:b[1]}),function(c){var e=new u("https://js.arcgis.com/3.28/esri/dijit/Search/images/search-pointer.png",36,36);d.wizard.selectedPoint.pointGraphic=new t(a.mapPoint,e);d.map.graphics.add(d.wizard.selectedPoint.pointGraphic);d.map.centerAndZoom(a.mapPoint,12);d.wizard.selectedPoint.geometry=a.mapPoint;d.wizard.selectedPoint.locationName=c&&c.address&&
c.address.LongLabel?c.address.LongLabel:"";d.wizard.setSelectedCountry(c.address.CountryCode);d.wizard.selectedPoint.long=b[0].toFixed(5);d.wizard.selectedPoint.lat=b[1].toFixed(5);d.onNext()})}},_onActivatePolygonButtonClick:function(){this.polygonActive?(this._deactivatePolygon(),this._deactivate(),this._deactivateFreehandPolygon()):(this._deactivate(),this._deactivateFreehandPolygon(),this._setActivePolygon())},_setActivePolygon:function(){this.polygonActive||(e.add(this.activatePolygonButton,
"esriBusinessAnalystPressedButton"),this.polygonActive=!0,this.toolbar||(this.toolbar=new w(this.map),this.toolbar.on("draw-end",g.hitch(this,this._addPolygon))),this.map.disablePan(),this.map.setInfoWindowOnClick(!1),this.toolbar.activate("polygon"))},_deactivatePolygon:function(){this.polygonActive&&(e.remove(this.activatePolygonButton,"esriBusinessAnalystPressedButton"),this.toolbar&&(this.toolbar.deactivate(),this.map.enablePan(),this.map.setInfoWindowOnClick(!0)),this.polygonActive=!1)},_onActivateFreehandPolygonButtonClick:function(){this.freehandPolygonActive?
(this._deactivateFreehandPolygon(),this._deactivate(),this._deactivatePolygon()):(this._deactivate(),this._deactivatePolygon(),this._setActiveFreehandPolygon())},_setActiveFreehandPolygon:function(){this.freehandPolygonActive||(e.add(this.activateFreehandPolygonButton,"esriBusinessAnalystPressedButton"),this.freehandPolygonActive=!0,this.toolbar||(this.toolbar=new w(this.map),this.toolbar.on("draw-end",g.hitch(this,this._addPolygon))),this.map.disablePan(),this.map.setInfoWindowOnClick(!1),this.toolbar.activate("freehandpolygon"))},
_deactivateFreehandPolygon:function(){this.freehandPolygonActive&&(e.remove(this.activateFreehandPolygonButton,"esriBusinessAnalystPressedButton"),this.toolbar&&(this.toolbar.deactivate(),this.map.enablePan(),this.map.setInfoWindowOnClick(!0)),this.freehandPolygonActive=!1)},_addPolygon:function(a){this._deactivate();this._deactivatePolygon();this._deactivateFreehandPolygon();var b=new y(y.STYLE_SOLID,new v(v.STYLE_SOLID,new n([199,55,36,1]),2),new n([199,55,36,.5]));a=new t(a.geometry,b);a.attributes=
{title:this.nls.customPolygon};b=new r;b.title="${title}";b.content=" ";b.info={};b.info.fieldInfos=[];a.setInfoTemplate(b);this.map.graphics.add(a);this.map.infoWindow.setFeatures([a]);this.map.infoWindow.show(this.map.toScreen(a.geometry.getExtent().getCenter()));this.map.infoWindow.removeActions("addMarker");this.wizard.drawnPolygonGraphic=a},resize:function(){this._resizeContentImg()},_resizeContentImg:function(){var c=document.activeElement;h.empty(this.contentContainer);var d=h.toDom(this.config.firstPageText);
h.place(d,this.contentContainer);this.contentContainer.nodeType&&1===this.contentContainer.nodeType&&((d=a("img",this.contentContainer))&&d.length&&d.forEach(g.hitch(this,function(a){"undefined"!==typeof a.complete&&!1===a.complete?this.own(b(a,"load",g.hitch(this,function(){this._resizeImg(a)}))):this._resizeImg(a)})),d=B.getFocusNodesInDom(this.domNode),d.length&&(B.initFirstFocusNode(this.domNode,d[0]),B.initLastFocusNode(this.domNode,d[d.length-1])),this.isOpen||h.isDescendant(c,this.domNode))&&
(c=B.getFirstFocusNode(this.domNode),B.isAutoFocusFirstNodeWidget(this)&&c.focus(),this.isOpen=!1)},_resizeImg:function(a){var b=h.getContentBox(this.contentContainer),c=h.getContentBox(a);c&&c.w&&c.w>=b.w&&h.setStyle(a,{maxWidth:b.w-20+"px",maxHeight:b.h-40+"px"})}})})},"esri/dijit/Search":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/regexp dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/date/locale dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/normalizeUtils ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n,m,p,q,t,r,u,y,v,w,D,B,z,C,E,A,F,G,H,J,L,I,P,N,S,O,Q,K,M,U,W,V,Y,X){function R(a,b){a&&b&&(a._layer=b,a._sourceLayer=b)}h=h([w,D,B,d],{declaredClass:"esri.dijit.Search",templateString:v,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(a,b){this.css={searchGroup:"searchGroup",searchInput:"searchInput",searchInputGroup:"searchInputGroup",searchBtn:"searchBtn",searchSubmit:"searchSubmit",searchIcon:"searchIcon esri-icon-search",searchButtonText:"searchButtonText",
searchToggle:"searchToggle",searchToggleIcon:"searchIcon esri-icon-down-arrow",searchMenu:"searchMenu",searchMenuHeader:"menuHeader",searchClear:"searchClear",searchClearIcon:"searchIcon esri-icon-close searchClose",searchSpinner:"searchIcon esri-icon-loading-indicator searchSpinner",searchSourceName:"sourceName",suggestionsMenu:"suggestionsMenu",sourcesMenu:"sourcesMenu",activeSource:"active",hasValue:"hasValue",hasButtonMode:"hasButtonMode",hasMultipleSources:"hasMultipleSources",showSuggestions:"showSuggestions",
showSources:"showSources",showNoResults:"showNoResults",searchLoading:"searchLoading",latLonHeader:"searchLatLongHeader",searchMoreResults:"moreResults",searchMoreResultsList:"resultsList",searchMoreResultsHeader:"moreHeader",searchMoreResultsItem:"moreItem",searchMoreResultsListHeader:"popupHeader",searchShowMoreResults:"showMoreResults",searchNoResultsMenu:"noResultsMenu",searchNoResultsBody:"noResultsBody",searchNoResultsHeader:"noResultsHeader",searchNoValueIcon:"noValueIcon esri-icon-notice-triangle",
searchNoValueText:"noValueText",searchNoResultsText:"noResultsText",searchExpandContainer:"searchExpandContainer",searchAnimateContainer:"searchAnimate",searchExpanded:"searchExpanded",searchCollapsed:"searchCollapsed",searchClearFloat:"searchClearFloat"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this._sourceNames=[];this.defaultSource={locator:new W("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),singleLineFieldName:"SingleLine",outFields:["Addr_type",
"Match_addr","StAddr","City"],name:y.widgets.Search.main.esriLocatorName,localSearchOptions:{minScale:3E5,distance:5E4},placeholder:y.widgets.Search.main.placeholder,highlightSymbol:(new L(l.toUrl("./Search/images/search-pointer.png"),36,36)).setOffset(9,18)};this.options={map:null,theme:"arcgisSearch",visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:150,enableSourcesMenu:!0,enableSuggestionsMenu:!0,enableInfoWindow:!0,showInfoWindowOnSelect:!0,
enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,enableLabel:!1,labelSymbol:(new S).setColor(new Y([181,56,46,.9])).setFont(new O("14px",O.STYLE_NORMAL,O.VARIANT_NORMAL,O.WEIGHT_BOLD,"Arial")),labelGraphic:null,infoTemplate:new A(y.widgets.Search.main.searchResult,'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),
searchResults:null,suggestResults:null,selectedResult:null,magicKey:null,selectedFeatureId:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:1,enableSearchingAll:!0};a=g.mixin({},this.options,a);this.set(a);this._updateActiveSource();this._i18n=y;this._defaultSR=new G(4326);this.domNode=b},startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);this._mapLoaded().then(g.hitch(this,this._init))},postCreate:function(){var a=
this;this.inherited(arguments);this._moreResultsId=this.id+"_more_results";this.own(c(this.submitNode,z,g.hitch(this,this._searchButton)));this.own(c(this.sourcesBtnNode,z,g.hitch(this,this._toggleSourcesMenu)));this.own(c(this.inputNode,z,g.hitch(this,this._inputClick)));this.own(c(this.clearNode,z,g.hitch(this,this._clearButton)));this.own(c(this.formNode,"submit",g.hitch(this,function(a){a.preventDefault();this._cancelSuggest();this.search()})));this.own(c(this.inputNode,"keyup",g.hitch(this,function(a){this._inputKey(a)})));
this.own(c(this.sourcesBtnNode,"keyup",g.hitch(this,function(a){this._sourceBtnKey(a)})));this.own(c(this.suggestionsNode,"li:click, li:keyup",function(b){a._suggestionsEvent(b,this)}));this.own(c(this.sourcesNode,"li:click, li:keyup",function(b){a._sourcesEvent(b,this)}));this.own(c(this.inputNode,"input, paste",g.hitch(this,function(){this._suggestDelay()})));this.map&&this.map.infoWindow&&this.map.infoWindow.domNode&&this.enableInfoWindow&&(this.own(c(this.map.infoWindow.domNode,"#"+this._moreResultsId+
"_show:click",g.hitch(this,function(a){this._showMoreResultsClick(a)}))),this.own(c(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_list li a:click",g.hitch(this,function(a){this._moreResultsClick(a)}))),this.own(c(this.map.infoWindow.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",g.hitch(this,function(a){this._switchCoordinatesClick(a)}))));this.value&&this._checkStatus();this._hideMenus();this._updateVisible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);
this._updateButtonMode(this.enableButtonMode);this.toggle(this.expanded)},destroy:function(){this.clear();r.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();p.get(this.inputNode,"value")&&p.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);this.set("magicKey",null);this.set("selectedFeatureId",null);q.remove(this.containerNode,this.css.hasValue);p.set(this.clearNode,
"title","");this._hideMenus();this._closePopup();this._hideLoading();this.emit("clear-search")},show:function(){t.set(this.domNode,"display","block")},hide:function(){t.set(this.domNode,"display","none")},expand:function(){this.enableButtonMode&&(q.add(this.containerNode,this.css.searchExpanded),q.remove(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!0))},collapse:function(){this.enableButtonMode&&(q.remove(this.containerNode,this.css.searchExpanded),q.add(this.containerNode,
this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!1))},toggle:function(a){this.enableButtonMode&&("undefined"===typeof a&&(a=!this.expanded),a?this.expand():this.collapse())},search:function(a){var c=new b;this._mapLoaded().then(g.hitch(this,function(){this._searchDeferred(a).then(g.hitch(this,function(a){var b=a.results;this.set("searchResults",b);0===a.numResults&&(this._noResults(a.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",a);this._selectFirstResult(b,
a.activeSourceIndex);c.resolve(b)}),g.hitch(this,function(a){c.reject(a)}))}));return c.promise},suggest:function(a){var c=new b;this._mapLoaded().then(g.hitch(this,function(){this._suggestDeferred(a).then(g.hitch(this,function(a){if(a){var b=a.results;this.set("suggestResults",b);this._insertSuggestions(b,a.value);this.emit("suggest-results",a);c.resolve(b)}}),g.hitch(this,function(a){c.reject(a)}))}));return c.promise},select:function(a){var b=this._getDefaultSymbol(a),c=this.labelSymbol,d,e=this.sources,
f=this.activeSourceIndex,h=this.enableHighlight,k=this.enableLabel,l=this.autoNavigate,m=this.showInfoWindowOnSelect,T=this.enableInfoWindow,n=this.infoTemplate,p=a.feature?new H(a.feature.toJson()):null,q=p?a.feature._sourceLayer:null;R(p,q);if(f===this._allIndex){var r=this._getSourceIndexOfResult(a);null!==r&&(d=e[r],f=r)}else d=e[f];d&&(d.hasOwnProperty("highlightSymbol")&&(b=d.highlightSymbol),d.hasOwnProperty("labelSymbol")&&(c=d.labelSymbol),d.hasOwnProperty("enableHighlight")&&(h=d.enableHighlight),
d.hasOwnProperty("enableLabel")&&(k=d.enableLabel),d.hasOwnProperty("autoNavigate")&&(l=d.autoNavigate),d.hasOwnProperty("showInfoWindowOnSelect")&&(m=d.showInfoWindowOnSelect),d.hasOwnProperty("enableInfoWindow")&&(T=d.enableInfoWindow),d.hasOwnProperty("infoTemplate")?n=d.infoTemplate:d.featureLayer&&d.featureLayer.infoTemplate&&(n=d.featureLayer.infoTemplate));this._hideMenus();this._hideLoading();if(p){var e=this.highlightGraphic,t=this.graphicsLayer,r=this.labelGraphic,u=g.mixin({},p.attributes,
{searchTheme:this.theme,searchResult:this._searchResultHTML(a),searchMoreResults:this.css.searchMoreResults,searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(a)}),v=null;T&&(v=n);r?(r.setGeometry(p.geometry),r.setAttributes(u),r.setSymbol(c),c&&"textsymbol"===c.type&&r.symbol.setText(a.name)):(r=new H(p.geometry,c,u),R(r,q),c&&"textsymbol"===c.type&&r.symbol.setText(a.name),k&&(t?t.add(r):this.map&&this.map.graphics&&
this.map.graphics.add(r)));e?(e.setGeometry(p.geometry),e.setAttributes(u),e.setInfoTemplate(v),e.setSymbol(b)):(e=new H(p.geometry,b,u,v),R(e,q),h&&(t?t.add(e):this.map&&this.map.graphics&&this.map.graphics.add(e)));e&&e.symbol&&"textsymbol"===e.symbol.type&&e.symbol.setText(a.name);this.map&&this.map.infoWindow&&T&&m&&(this.map.infoWindow.setFeatures([e]),b=this._getPointFromGeometry(e.geometry),this.map.infoWindow.show(b));this.map&&l&&a&&a.hasOwnProperty("extent")&&"function"===typeof this.map.setExtent&&
this.map.setExtent(a.extent,!0);this.set("highlightGraphic",e);this.set("labelGraphic",r)}this.set("selectedResult",a);this.emit("select-result",{result:a,source:d,sourceIndex:f})},focus:function(){C.focus(this.inputNode)},blur:function(){this.inputNode.blur();C.curNode&&C.curNode.blur()},clearGraphics:function(){var a=this.highlightGraphic,b=this.graphicsLayer,c=this.labelGraphic;a&&(b?b.remove(a):this.map&&this.map.graphics&&this.map.graphics.remove(a));c&&(b?b.remove(c):this.map&&this.map.graphics&&
this.map.graphics.remove(c));this.set("labelGraphic",null);this.set("highlightGraphic",null)},_mapLoaded:function(){var a=new b;if(this.map)if(this.map.loaded)a.resolve();else c.once(this.map,"load",g.hitch(this,function(){a.resolve()}));else a.resolve();return a.promise},_init:function(){this._getMapLayers().then(g.hitch(this,function(){this.set("loaded",!0);this.emit("load")}))},_clearButton:function(){this.clear();C.focus(this.inputNode)},_error:function(a){return Error(this.declaredClass+" "+
a)},_searchDeferred:function(a){var c=new b,d=this.value,e=this.activeSourceIndex;a&&a.hasOwnProperty("index")&&(e=a.index);this._showLoading();this._hideMenus();this._closePopup();this.clearGraphics();var f={magicKey:this.magicKey,text:d};a?"string"===typeof a?(f.text=a,a=this._searchQueries(f)):a="object"===typeof a&&a.hasOwnProperty("magicKey")?this._searchQueries(a):"object"===typeof a&&a.hasOwnProperty("geometry")?this._searchQueries({geometry:a}):"object"===typeof a&&a.hasOwnProperty(this._objectIdIdentifier)?
this._searchQueries(a):"object"===typeof a&&"point"===a.type?this._searchQueries({point:a}):a instanceof Array&&2===a.length?this._searchQueries({latlon:a}):this._searchQueries(f):a=this._searchQueries(f);a.always(g.hitch(this,function(a){a=this._formatResults(a,e,d);c.resolve(a)}));return c.promise},_suggestDeferred:function(a){var c=new b;this._deferreds.push(c);a||(a=this.value);var d=this.activeSourceIndex;this._suggestQueries({text:a}).always(g.hitch(this,function(b){var e;if(b)for(var f=0;f<
b.length;f++)b[f]&&(e=!0);e?(b=this._formatResults(b,d,a),c.resolve(b)):c.resolve()}));return c.promise},_getDefaultSymbol:function(a){var b,c,d,e;this.map&&(e=this.map.getBasemap());e||(e="topo");a&&a.feature&&a.feature.geometry&&(d=a.feature.geometry.type);"polyline"===d?d="line":"circle"===d||"extent"===d?d="polygon":"multipoint"===d&&(d="point");if(d){if(a=X.getSchemes({theme:"default",basemap:e,geometryType:d}))c=a.primaryScheme;if(c){c.color&&c.hasOwnProperty("opacity")&&(c.color.a=c.opacity);
b=c;a=c.color;c=c.size;var f;switch(d){case "point":f=new I;f.setColor(a);f.setSize(null!==c?c:b.size);d=new P;d.setColor(b.outline.color);d.setWidth(b.outline.width);f.setOutline(d);break;case "line":f=new P;f.setColor(a);f.setWidth(null!==c?c:b.width);break;case "polygon":f=new N,f.setColor(a),d=new P,d.setColor(b.outline.color),d.setWidth(b.outline.width),f.setOutline(d)}b=f}}return b},_selectFirstResult:function(a,b){if(this.autoSelect&&a){var c;b===this._allIndex?c=this._getFirstResult(a):a[b]&&
a[b][0]&&(c=a[b][0]);c&&this.select(c)}},_getSourceIndexOfResult:function(a){var b=this.searchResults;if(b)for(var c in b)if(b[c]&&b[c].length)for(var d=0;d<b[c].length;d++)if(b[c][d]===a)return parseInt(c,10);return null},_getFirstResult:function(a){if(a)for(var b in a)if(a[b]&&a[b][0])return a[b][0];return!1},_onFocus:function(){this.map&&"function"===typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation();this.emit("focus");this.inherited(arguments)},_onBlur:function(){this._hideMenus();
this.map&&"function"===typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();this.enableButtonMode&&this.loaded&&this.collapse();this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var a=new b;if(this.addLayersFromMap&&this.map){var c=[],d=this.map.graphicsLayerIds;if(d&&d.length){for(var e=0;e<d.length;e++){var f=this.map.getLayer(d[e]);f&&c.push(this._featureLayerLoaded(f))}J(c).always(g.hitch(this,function(b){for(var c,d=this.sources,e=0;e<b.length;e++)b[e]&&
b[e].loaded&&"Feature Layer"===b[e].type&&(d.push({featureLayer:b[e],enableSuggestions:!0}),c=!0);c&&this.set("sources",d);a.resolve()}))}else a.resolve()}else a.resolve();return a.promise},_switchCoordinatesClick:function(a){a.preventDefault();if(a=p.get(a.target,"data-switch-coordinates"))this._cancelSuggest(),this.set("value",a),this.search()},_moreResultsClick:function(a){a.preventDefault();var b=a.target;a=parseInt(p.get(b,"data-source-index"),10);var b=parseInt(p.get(b,"data-index"),10),c=this.searchResults;
c&&c[a]&&(a=c[a][b])&&this.select(a)},_showMoreResultsClick:function(a){a.preventDefault();if(a=m.byId(this._moreResultsId)){q.toggle(a,this.css.searchShowMoreResults);var b=m.byId(this._moreResultsId+"_show");b&&(q.contains(a,this.css.searchShowMoreResults)?p.set(b,"textContent",y.widgets.Search.main.hideMoreResults):p.set(b,"textContent",y.widgets.Search.main.showMoreResults))}},_featureLayerLoaded:function(a){var d=new b;if(a.loaded)d.resolve(a);else if(a.loadError)d.reject(this._error("Layer failed to load."));
else{var e,f;e=c.once(a,"load",g.hitch(this,function(){f.remove();d.resolve(a)}));f=c.once(a,"error",g.hitch(this,function(){e.remove();d.reject(this._error("Layer could not be loaded."))}))}return d.promise},_getObjectSize:function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b},_sourcesEvent:function(b,c){var d=p.get(c,"data-index"),f=k("li",this.sourcesNode);c=e.indexOf(f,c);d!==this._allIndex&&(d=parseInt(d,10));"click"===b.type||b.keyCode===a.ENTER?(this.set("activeSourceIndex",d),
C.focus(this.inputNode),this._hideSourcesMenu()):b.keyCode===a.UP_ARROW?(b.stopPropagation(),b.preventDefault(),b=c-1,0>b?C.focus(this.sourcesBtnNode):C.focus(f[b])):b.keyCode===a.DOWN_ARROW?(b.stopPropagation(),b.preventDefault(),b=c+1,b>=f.length?C.focus(this.sourcesBtnNode):C.focus(f[b])):b.keyCode===a.ESCAPE&&(this._hideSourcesMenu(),C.focus(this.inputNode))},_suggestionsEvent:function(b,c){var d=p.get(c,"data-source-index"),f=parseInt(p.get(c,"data-index"),10),g=k("li",this.suggestionsNode),
h=this.sources;c=e.indexOf(g,c);d!==this._allIndex&&(d=parseInt(d,10));var l;this._clearQueryTimeout();"click"===b.type||b.keyCode===a.ENTER?((g=this.suggestResults)&&g[d]&&g[d][f]&&(l=g[d][f]),l&&(l.index=d,h[d].featureLayer?(d=h[d].featureLayer.objectIdField,l[this._objectIdIdentifier]=l.feature.attributes[d],this.set("value",this._getSuggestionName(l)),this.set("selectedFeatureId",l.feature.attributes[d])):l.magicKey&&l.text&&(this.set("value",l.text),this.set("magicKey",l.magicKey)),this.search(l),
C.focus(this.inputNode))):b.keyCode===a.BACKSPACE||b.keyCode===a.DELETE?C.focus(this.inputNode):b.keyCode===a.UP_ARROW?(b.stopPropagation(),b.preventDefault(),l=c-1,0>l?C.focus(this.inputNode):C.focus(g[l])):b.keyCode===a.DOWN_ARROW?(b.stopPropagation(),b.preventDefault(),l=c+1,l>=g.length?C.focus(this.inputNode):C.focus(g[l])):b.keyCode===a.ESCAPE&&(this._hideMenus(),C.focus(this.inputNode))},_getResultName:function(a){var b;a.hasOwnProperty("name")&&null!==a.name&&(b=a.name.toString());b||(b=y.widgets.Search.main.untitledResult);
return b},_getSuggestionName:function(a){var b;a.hasOwnProperty("name")&&null!==a.name&&(b=a.name.toString());a=a.text||b;a||(a=y.widgets.Search.main.untitledResult);return a},_searchResultHTML:function(a){var b="";if(a.feature&&a.feature.attributes&&a.feature.attributes.Addr_type&&"LatLong"===a.feature.attributes.Addr_type){var c=a.name.split(" "),d,e;2===c.length&&(d=c[0],e=c[1]);e&&d?(a=parseFloat(d),e=parseFloat(e),c=e+", "+a,b+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e',b+='\x3cdiv class\x3d"'+
this.css.latLonHeader+'"\x3e'+y.widgets.Search.main.lonlat+"\x3c/div\x3e",b=b+(a+", "+e)+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),a===e||90<a||-90>a||180<e||-180>e||(b+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+y.widgets.Search.main.reverseLonLatHeader+"\x3c/div\x3e",b=b+('\x3ca data-switch-coordinates\x3d"'+c+'" tabindex\x3d"0" href\x3d"#"\x3e'+c+"\x3c/a\x3e")+"\x3c/div\x3e")):b=a.name}else b=a.name;return b},_moreResultsHTML:function(a){var b="",c="",
d=this.searchResults,e=this.sources,f=0;if(d){var c=c+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),c=c+('\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+y.widgets.Search.main.showMoreResults+"\x3c/a\x3e"),c=c+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsList+'"\x3e'),c=c+('\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e'),g;for(g in d)if(d[g]){var h=d[g].length;if(h){var k=1===h&&d[g][0]===a;if(1<this._getObjectSize(d)&&!k)var l=this._getSourceName(g),
c=c+('\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+l+"\x3c/div\x3e");if(h&&!k){c+="\x3cul\x3e";l=e[g].maxResults||this.maxResults;for(k=0;k<h&&k<l;++k)if(d[g][k]!==a){var m=this._getResultName(d[g][k]),c=c+('\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+k+'" data-source-index\x3d"'+g+'" href\x3d"#"\x3e'+m+"\x3c/a\x3e\x3c/li\x3e");f++}c+="\x3c/ul\x3e"}}}c+="\x3c/div\x3e\x3c/div\x3e"}f&&(b+=c);return b},_validField:function(a,b){return a.getField(b)},_validFields:function(a,b){if(a&&
b&&b.length){for(var c=0;c<b.length;c++)if(!this._validField(a,b[c]))return!1;return!0}return!1},_getCodedName:function(a,b){if(a&&a.length)for(var c=0,d=a.length;c<d;c++){var e=a[c];if(e.code===b)return e.name}},_getCodedValue:function(a,b,c){if(a&&a.length)for(var d=0,e=a.length;d<e;d++){var f=a[d],g=f.name,h=b;c||(g=g.toLowerCase(),h=h.toLowerCase());if(g===h)return f.code}return!1},_whereClause:function(a,b,c,d){var e=null;if(a){var f="";this.reHostedFS.test(b.url)&&this._containsNonLatinCharacter(a)&&
(f="N");if(c&&c.length)for(var g=0,h=c.length;g<h;g++){var k="",l=a.replace(/\'/g,"''"),k=c[g],m=b.getField(k),n=b.getDomain(k);n&&"codedValue"===n.type&&(l=this._getCodedValue(n.codedValues,l,d));!1!==l&&(m=m.type,"esriFieldTypeString"===m||"esriFieldTypeDate"===m?k=d?k+" \x3d "+f+"'"+l+"'":"UPPER("+k+") LIKE "+f+"'%"+l.toUpperCase()+"%'":"esriFieldTypeOID"===m||"esriFieldTypeSmallInteger"===m||"esriFieldTypeInteger"===m||"esriFieldTypeSingle"===m||"esriFieldTypeDouble"===m?(l=parseFloat(l),k=isNaN(l)?
!1:k+" \x3d "+l):k=k+" \x3d "+l,k&&(e=e?e+" or ":"",e+=k))}}return e},_suggest:function(a){a||(a={index:this.activeSourceIndex,text:this.value});var c=new b,d=a.index,f=this.sources[d],h=this.enableSuggestions;f.hasOwnProperty("enableSuggestions")&&(h=f.enableSuggestions);var k=0,l;a.hasOwnProperty("text")&&a.text&&(l=g.trim(a.text),k=a.text.length);a=f.minCharacters||this.minCharacters;if(h&&l&&k>=a&&this._supportsPagination(f)){var m="";f.prefix&&(m+=f.prefix);m+=l;f.suffix&&(m+=f.suffix);var n=
this._defaultSR;this.map&&(n=this.map.spatialReference);h={};f.locator?(f.categories&&(h.categories=f.categories),f.locator.outSpatialReference=n,this.map&&f.localSearchOptions&&f.localSearchOptions.hasOwnProperty("distance")&&f.localSearchOptions.hasOwnProperty("minScale")&&(k=this._getScale(),!f.localSearchOptions.minScale||k&&k<=parseFloat(f.localSearchOptions.minScale))&&(h.location=this.map.extent.getCenter(),h.distance=f.localSearchOptions.distance),h.text=m,f.useMapExtent&&this.map&&this.map.extent&&
(h.searchExtent=this.map.extent),f.searchExtent&&(h.searchExtent=f.searchExtent),h.maxSuggestions=f.maxSuggestions||this.maxSuggestions,f.sourceCountry&&(h.countryCode=f.sourceCountry),f.countryCode&&(h.countryCode=f.countryCode),f.locator.suggestLocations(h).then(g.hitch(this,function(a){c.resolve(a)}),g.hitch(this,function(a){a||(a=this._error("Locator suggestLocations could not be performed."));c.reject(a)}))):f.featureLayer?this._featureLayerLoaded(f.featureLayer).then(g.hitch(this,function(){var a=
this._getDisplayField(f),b=f.searchFields||[a],h=[];f.suggestionTemplate?f.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,function(a,b){h.push(b)}):h=[a];-1===e.indexOf(h,f.featureLayer.objectIdField)&&h.push(f.featureLayer.objectIdField);var a=this._validField(f.featureLayer,a),k=this._validFields(f.featureLayer,h),l=this._validFields(f.featureLayer,b);if(a&&k&&l){a=new V;f.hasOwnProperty("suggestQueryParams")&&g.mixin(a,f.suggestQueryParams);a.outSpatialReference=n;a.returnGeometry=!1;a.num=f.maxSuggestions||
this.maxSuggestions;a.outFields=h;f.useMapExtent&&this.map&&this.map.extent&&(a.geometry=this.map.extent);f.searchExtent&&(a.geometry=f.searchExtent);var p;if(b=this._whereClause(m,f.featureLayer,b,!1))a.where=b,p=!0;p?f.featureLayer.queryFeatures(a,g.hitch(this,function(a){var b;(a=a.features)&&(b=this._hydrateResults(a,d,!0));c.resolve(b)}),g.hitch(this,function(a){a||(a=this._error("FeatureLayer queryFeatures errored with suggestions"));c.reject(a)})):c.resolve()}else c.reject(this._error("Invalid FeatureLayer field"))})):
c.reject(this._error("Invalid source"))}else c.resolve();return c.promise},_supportsPagination:function(a){var b;a.locator?b=!0:a.featureLayer&&a.featureLayer.advancedQueryCapabilities&&a.featureLayer.advancedQueryCapabilities.supportsPagination&&(b=!0);return b},_suggestQueries:function(a){var b=this.sources,c=this.activeSourceIndex,d=[],e;if(c===this._allIndex)for(c=0;c<b.length;c++)e=a,e.index=c,e=this._suggest(e),d.push(e);else a.index=c,e=this._suggest(a),d.push(e);return J(d)},_getPointFromGeometry:function(a){var b;
switch(a.type){case "extent":b=a.getCenter();break;case "multipoint":b=a.getPoint(0);break;case "point":b=a;break;case "polygon":b=a.getCentroid();break;case "polyline":b=a.getPoint(0,0)}return b},_searchQueries:function(a){a.hasOwnProperty("index")||(a.index=this.activeSourceIndex);var b=[],c;if(a.index===this._allIndex)for(var d=this.sources,e=0;e<d.length;e++)c=a,c.index=e,c=this._search(c),b.push(c);else a=this._search(a),b.push(a);return J(b)},_searchButton:function(){this.enableButtonMode&&
!this.expanded?(this.expand(),C.focus(this.inputNode)):(this._cancelSuggest(),this.search())},_search:function(a){a||(a={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});this.selectedFeatureId&&(a.text=null,a[this._objectIdIdentifier]=this.selectedFeatureId);var c,d=new b,e=a.index,f=this.sources[e],h;a.hasOwnProperty("text")&&a.text&&(h=g.trim(a.text));if(f){var k="";f.prefix&&!a.magicKey&&(k+=f.prefix);k+=h;f.suffix&&!a.magicKey&&(k+=f.suffix);var l=
this._defaultSR;this.map&&(l=this.map.spatialReference);if(f.locator)if(a.hasOwnProperty("text")&&h){var m={};f.categories&&(m.categories=f.categories);f.locationType&&(m.locationType=f.locationType);l&&(f.locator.outSpatialReference=l);if(this.map&&f.localSearchOptions&&f.localSearchOptions.hasOwnProperty("distance")&&f.localSearchOptions.hasOwnProperty("minScale")){var n=this._getScale();if(!f.localSearchOptions.minScale||n&&n<=parseFloat(f.localSearchOptions.minScale))m.location=this.map.extent.getCenter(),
m.distance=f.localSearchOptions.distance}m.address={};m.maxLocations=f.maxResults||this.maxResults;f.useMapExtent&&this.map&&this.map.extent&&(m.searchExtent=this.map.extent);f.searchExtent&&(m.searchExtent=f.searchExtent);f.sourceCountry&&(m.countryCode=f.sourceCountry);f.countryCode&&(m.countryCode=f.countryCode);a.magicKey&&(m.magicKey=a.magicKey);f.singleLineFieldName?m.address[f.singleLineFieldName]=k:m.address["Single Line Input"]=k;f.outFields&&(m.outFields=f.outFields);f.locator.addressToLocations(m).then(g.hitch(this,
function(a){a=this._hydrateResults(a,e,!1);d.resolve(a)}),g.hitch(this,function(a){a||(a=this._error("Locator addressToLocations could not be performed"));d.reject(a)}))}else a.geometry?(c=this._getPointFromGeometry(a.geometry.geometry))?this._reverseGeocodePoint(e,c).then(function(a){d.resolve(a)},function(a){d.reject(a)}):d.reject(this._error("Invalid point to reverse geocode")):a.point?this._reverseGeocodePoint(e,a.point).then(function(a){d.resolve(a)},function(a){d.reject(a)}):a.latlon?(m=new Q(a.latlon,
this._defaultSR),this._reverseGeocodePoint(e,m).then(function(a){d.resolve(a)},function(a){d.reject(a)})):a.hasOwnProperty("text")&&!h?d.resolve([]):d.reject(this._error("Invalid query type for Locator"));else f.featureLayer?this._featureLayerLoaded(f.featureLayer).then(g.hitch(this,function(){var b=this._getDisplayField(f),m=f.searchFields||[b],b=this._validField(f.featureLayer,b),n=this._validFields(f.featureLayer,m);if(b&&n){b=new V;f.hasOwnProperty("searchQueryParams")&&g.mixin(b,f.searchQueryParams);
l&&(b.outSpatialReference=l,n=this.map&&this.map.getMaxResolution()||1/U.getUnitValueForSR(l))&&(b.maxAllowableOffset=n);b.returnGeometry=!0;f.outFields&&(b.outFields=f.outFields);var p;a.hasOwnProperty(this._objectIdIdentifier)||(this._supportsPagination(f)&&(b.num=f.maxResults||this.maxResults),f.useMapExtent&&this.map&&this.map.extent&&(b.geometry=this.map.extent),f.searchExtent&&(b.geometry=f.searchExtent),p=f.exactMatch);a.hasOwnProperty("text")&&h?(m=this._whereClause(k,f.featureLayer,m,p))?
(b.where=m,m=!0):m=!1:a.hasOwnProperty(this._objectIdIdentifier)?(b.objectIds=[a[this._objectIdIdentifier]],m=!0):a.geometry?(b.geometry=a.geometry,m=!0):a.point?(b.geometry=a.point,m=!0):a.latlon?(c=new Q(a.latlon,this._defaultSR),b.geometry=c,m=!0):(a.hasOwnProperty("text")&&!h?d.resolve([]):d.reject(this._error("Invalid query type for FeatureLayer")),m=!1);m?f.featureLayer.queryFeatures(b,g.hitch(this,function(a){a=a.features;var b;a&&(b=this._hydrateResults(a,e,!1));d.resolve(b)}),g.hitch(this,
function(a){a||(a=this._error("FeatureLayer queryFeatures could not be performed"));d.reject(a)})):d.resolve()}else d.reject(this._error("Invalid FeatureLayer field"))})):d.reject(this._error("Invalid source"))}else d.reject(this._error("Source is undefined"));return d.promise},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_formatResults:function(a,b,c){c={activeSourceIndex:b,value:c,numResults:0,numErrors:0,errors:null,results:null};var d={},e={};if(a)if(b===this._allIndex)for(b=
0;b<a.length;b++)a[b]&&(a[b]instanceof Error?(d[b]=a[b],c.numErrors++):(e[b]=a[b],c.numResults+=a[b].length));else a[0]&&(a[0]instanceof Error?(d[b]=a[0],c.numErrors++):(e[b]=a[0],c.numResults+=a[0].length));c.numErrors&&(c.errors=d);c.numResults&&(c.results=e);return c},_reverseGeocodePoint:function(a,c){var d=new b,e=this.sources[a];if(c&&e){var f=e.locationToAddressDistance||this.locationToAddressDistance;e.locator.outSpatialReference=this._defaultSR;this.map&&(e.locator.outSpatialReference=this.map.spatialReference);
e.locator.locationToAddress(c,f,g.hitch(this,function(b){b=this._hydrateResults([b],a,!1);d.resolve(b)}),g.hitch(this,function(a){a||(a=this._error("Locator locationToAddress could not be performed"));d.reject(a)}))}else d.reject(this._error("No point or source defined for reverse geocoding"));return d.promise},_cancelDeferreds:function(){if(this._deferreds&&this._deferreds.length)for(var a=0;a<this._deferreds.length;a++)this._deferreds[a].cancel(this.declaredClass+" cancelling request");this._deferreds=
[]},_sourceBtnKey:function(b){if(b){var c=k("li",this.sourcesNode);b.keyCode===a.UP_ARROW?(b.stopPropagation(),b.preventDefault(),this._showSourcesMenu(),(b=c.length)&&C.focus(c[b-1])):b.keyCode===a.DOWN_ARROW&&(b.stopPropagation(),b.preventDefault(),this._showSourcesMenu(),c[0]&&C.focus(c[0]))}},_inputKey:function(b){if(b){var c=k("li",this.suggestionsNode),d=this.suggestResults;if(b.keyCode===a.TAB||b.keyCode===a.ESCAPE)this._cancelSuggest(),this._hideMenus();else if(b.keyCode===a.UP_ARROW)b.stopPropagation(),
b.preventDefault(),this._cancelSuggest(),d&&this._showSuggestionsMenu(),(b=c.length)&&C.focus(c[b-1]);else if(b.keyCode===a.DOWN_ARROW)b.stopPropagation(),b.preventDefault(),this._cancelSuggest(),d&&this._showSuggestionsMenu(),c[0]&&C.focus(c[0]);else{if(b.ctrlKey||b.metaKey||b.keyCode===a.copyKey||b.keyCode===a.LEFT_ARROW||b.keyCode===a.RIGHT_ARROW||b.keyCode===a.ENTER)return b;this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();
this._changeValue();this._queryTimer=setTimeout(g.hitch(this,function(){this.suggest()}),this.suggestionDelay)},_changeValue:function(){this.set("magicKey",null);this.set("selectedFeatureId",null);this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},_getSourceName:function(a){return this._sourceNames[a]},_loadSources:function(a){a=e.filter(a,function(a){return!!a.featureLayer});a=e.map(a,function(a){return this._featureLayerLoaded(a.featureLayer)},
this);return J(a)},_createSourceNameMap:function(a){return this._loadSources(a).then(g.hitch(this,function(){var b=e.map(a,function(a){return a.name||a.featureLayer&&a.featureLayer.name||y.widgets.Search.main.untitledSource});this._preventDuplicateSourceNames(a,b);return b}))},_getDuplicateSourceNameIndexes:function(a){var b={},c=[];e.forEach(a,function(d,e){b.hasOwnProperty(d)?(-1===c.indexOf(b[d])&&c.push(b[d]),c.push(e)):a.lastIndexOf(d)!==e&&(b[d]=e)});return c},_preventDuplicateSourceNames:function(a,
b){if(b&&1<b.length){var c=this._getDuplicateSourceNameIndexes(b);e.forEach(c,function(c){b[c]+=this._getFieldsString(a[c])},this)}},_getFieldsString:function(a){var b="",c=a.featureLayer;if(c){a=a.searchFields||[this._getDisplayField(a)];for(var d=0;d<a.length;d++)var b=0===d?b+": ":b+", ",e=a[d],f=c.getFieldLabel(e),b=b+(f||e)}return b},_splitResult:function(a,b){b=n.escapeString(b);return a.replace(new RegExp("(^|)("+b+")(|$)","ig"),"$1|$2|$3").split("|")},_insertSuggestions:function(a,b){if(this.enableSuggestionsMenu&&
this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();var c,d=this.sources;if(a){c=r.create("div");for(var e in a)if(a[e]&&a[e].length){var f=this._getSourceName(e);1<d.length&&this.activeSourceIndex===this._allIndex&&r.create("div",{className:this.css.searchMenuHeader,textContent:f},c);for(var f=r.create("ul",{role:"menu"},c),g=d[e].maxSuggestions||this.maxSuggestions,h=0;h<a[e].length&&h<g;++h)for(var k=r.create("li",{"data-index":h,"data-source-index":e,role:"menuitem",tabindex:0},
f),l=this._getSuggestionName(a[e][h]),l=this._splitResult(l,b),m=l.length,n=0;n<m;n++){var p=l[n];p.toLowerCase()===b.toLowerCase()?r.create("strong",{textContent:p},k):(p=document.createTextNode(p),r.place(p,k))}}}c?(r.place(c,this.suggestionsNode,"only"),this._showSuggestionsMenu()):(r.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},_insertSources:function(a){if(this.enableSourcesMenu&&a&&1<a.length){var b,c,d=this.activeSourceIndex,e=r.create("ul",{role:"menu"});this.enableSearchingAll&&
(b="",d===this._allIndex&&(b="active"),r.create("li",{"data-index":this._allIndex,role:"menuitem",className:b,tabIndex:0,textContent:y.widgets.Search.main.all},e));for(c=0;c<a.length;c++){b="";c===d&&(b=this.css.activeSource);var f=this._getSourceName(c);r.create("li",{"data-index":c,role:"menuitem",className:b,tabIndex:0,textContent:f},e)}q.add(this.containerNode,this.css.hasMultipleSources);r.place(e,this.sourcesNode,"only")}else q.remove(this.containerNode,this.css.hasMultipleSources),r.empty(this.sourcesNode)},
_showLoading:function(){q.add(this.containerNode,this.css.searchLoading)},_hideLoading:function(){q.remove(this.containerNode,this.css.searchLoading)},_checkStatus:function(){this.value?(q.add(this.containerNode,this.css.hasValue),p.set(this.clearNode,"title",y.widgets.Search.main.clearButtonTitle)):this.clear()},_closePopup:function(){this.enableInfoWindow&&this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_noResults:function(a){var b;a&&(b=g.trim(a));var c=r.create("div",{className:this.css.searchNoResultsBody});
a&&b?(r.create("div",{className:this.css.searchNoResultsHeader,textContent:y.widgets.Search.main.noResults},c),r.create("div",{className:this.css.searchNoResultsText,textContent:E.substitute({value:'"'+a+'"'},y.widgets.Search.main.noResultsFound)},c)):(a=r.create("div",{},c),r.create("span",{"aria-hidden":"true",className:this.css.searchNoValueIcon},a),r.create("span",{className:this.css.searchNoValueText,textContent:y.widgets.Search.main.emptyValue},a));r.place(c,this.noResultsMenuNode,"only")},
_hideMenus:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();this._hideNoResultsMenu()},_hideNoResultsMenu:function(){q.remove(this.containerNode,this.css.showNoResults)},_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();q.add(this.containerNode,this.css.showNoResults)},_hideSourcesMenu:function(){q.remove(this.containerNode,this.css.showSources)},_hideSuggestionsMenu:function(){q.remove(this.containerNode,this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();
this._hideNoResultsMenu();q.add(this.containerNode,this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();this._hideNoResultsMenu();q.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();q.toggle(this.containerNode,this.css.showSources)},_getFirstStringField:function(a){if(a&&(a=a.fields)&&a.length)for(var b=0;b<a.length;b++){var c=a[b];if("esriFieldTypeString"===c.type)return c.name}return""},
_getDisplayField:function(a){return a.displayField||a.featureLayer.displayField||this._getFirstStringField(a.featureLayer)},_validLocation:function(a){return a&&"number"===typeof a.x&&"number"===typeof a.y},_validExtent:function(a){return a&&"number"===typeof a.xmin&&"number"===typeof a.ymin&&"number"===typeof a.xmax&&"number"===typeof a.ymax},_hydrateResult:function(a,b,c){var d={},e=this._defaultSR,f;b=this.sources[b];this.map&&(e=this.map.spatialReference);if(a.hasOwnProperty("text")&&a.hasOwnProperty("magicKey"))return a;
if(a.hasOwnProperty("geometry"))f=new H(a.toJson()),d.feature=f,(f=d.feature.geometry)&&f.setSpatialReference(e);else if(a.hasOwnProperty("location")&&this._validLocation(a.location)){var h=new Q(a.location.x,a.location.y,e);f={};a.hasOwnProperty("attributes")&&(f=a.attributes);a.hasOwnProperty("address")&&"object"===typeof a.address&&g.mixin(f,a.address);a.hasOwnProperty("score")&&(f.score=a.score);d.feature=new H(h,null,f,null)}!d.feature&&c&&(f={},a.hasOwnProperty("attributes")&&(f=a.attributes),
a.hasOwnProperty("score")&&(f.score=a.score),d.feature=new H(null,null,f,null));if(d.feature){if(a.hasOwnProperty("extent")&&this._validExtent(a.extent))d.extent=new K(a.extent),d.extent.setSpatialReference(e);else if(d.feature&&d.feature.geometry)switch(d.feature.geometry.type){case "extent":d.extent=d.feature.geometry;break;case "multipoint":d.extent=M.getDenormalizedExtent(d.feature.geometry);break;case "polygon":d.extent=M.getDenormalizedExtent(d.feature.geometry);break;case "polyline":d.extent=
M.getDenormalizedExtent(d.feature.geometry);break;case "point":this.map?(e=this.zoomScale,b&&b.zoomScale&&(e=b.zoomScale),this._getScale()>e?d.extent=U.getExtentForScale(this.map,e).centerAt(d.feature.geometry):d.extent=this.map.extent.centerAt(d.feature.geometry)):d.extent=new K({xmin:d.feature.geometry.x-.25,ymin:d.feature.geometry.y-.25,xmax:d.feature.geometry.x+.25,ymax:d.feature.geometry.y+.25,spatialReference:this._defaultSR})}else d.extent=null;d.name="";b.featureLayer?b.suggestionTemplate&&
c?d.name=E.substitute(a.attributes,b.suggestionTemplate):b.searchTemplate?d.name=E.substitute(a.attributes,b.searchTemplate):(f=this._getDisplayField(b),c=b.featureLayer.getField(f),e=b.featureLayer.getDomain(f),f&&a.hasOwnProperty("attributes")&&a.attributes.hasOwnProperty(f)&&(a=a.attributes[f],e&&"codedValue"===e.type?d.name=this._getCodedName(e.codedValues,a):c&&"esriFieldTypeDate"===c.type&&!isNaN(a)?d.name=u.format(new Date(a)):d.name=a)):a.address&&b.searchTemplate?d.name=E.substitute(a.address,
b.searchTemplate):a.hasOwnProperty("name")?d.name=a.name:a.hasOwnProperty("attributes")&&"object"===typeof a.attributes&&a.attributes.LongLabel?d.name=a.attributes.LongLabel:a.hasOwnProperty("attributes")&&"object"===typeof a.attributes&&a.attributes.Match_addr?(d.name=a.attributes.Match_addr,a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&a.attributes.StAddr&&a.attributes.City?d.name+=" - "+a.attributes.StAddr+", "+a.attributes.City:a.attributes.Addr_type&&"POI"===a.attributes.Addr_type&&
a.attributes.City&&(d.name+=" - "+a.attributes.City)):a.hasOwnProperty("address")&&"string"===typeof a.address?d.name=a.address:a.hasOwnProperty("address")&&"object"===typeof a.address&&a.address.hasOwnProperty("Address")?a.address.hasOwnProperty("Match_addr")?d.name=a.address.Match_addr:a.address.hasOwnProperty("Address")&&(d.name=a.address.Address):d.feature&&d.feature.geometry&&(d.name=d.feature.geometry.x+","+d.feature.geometry.y);b.featureLayer&&d.feature&&R(d.feature,b.featureLayer);return d}},
_getScale:function(){var a;this.map&&"function"===typeof this.map.getScale&&(a=this.map.getScale());return a},_hydrateResults:function(a,b,c,d){d=[];var e=0;if(a&&a.length)for(e;e<a.length;e++){var f=this._hydrateResult(a[e],b,c);f&&d.push(f)}return d},_containsNonLatinCharacter:function(a){for(var b=0;b<a.length;b++)if(255<a.charCodeAt(b))return!0;return!1},_setPlaceholder:function(a){var b="",c=this.sources[a];a===this._allIndex?b=this.allPlaceholder||y.widgets.Search.main.allPlaceholder:c&&c.placeholder&&
(b=c.placeholder);var d=y.widgets.Search.main.all;c&&(d=this._getSourceName(a));p.set(this.sourceNameNode,"textContent",d);p.set(this.inputNode,"placeholder",b);p.set(this.inputNode,"title",b)},_updateActiveSource:function(){var a=this.sources,b=this.activeSourceIndex,c;a&&a[b]&&(c=a[b]);c?this.set("activeSource",c):this.set("activeSource",null)},_updateVisible:function(){this.visible?this.show():this.hide()},_updateButtonMode:function(a){a?(q.toggle(this.containerNode,this.css.searchExpanded,this.expanded),
q.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),q.add(this.containerNode,this.css.hasButtonMode)):(q.remove(this.containerNode,this.css.searchExpanded),q.remove(this.containerNode,this.css.searchCollapsed),q.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(a){a&&1===a.length||!this.enableSearchingAll?this.set("activeSourceIndex",0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(a){this._set("enableSourcesMenu",
a);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(a){this._set("enableSearchingAll",a);this._created&&(this._setDefaultActiveSourceIndex(this.sources),this._hideMenus(),this._insertSources(this.sources))},_setSourcesAttr:function(a){this._createSourceNameMap(a).then(g.hitch(this,function(b){this._sourceNames=b;this._created&&(this._setDefaultActiveSourceIndex(a),this._hideMenus(),this._insertSources(a))}));this._set("sources",a)},_setAllPlaceholderAttr:function(a){this._set("allPlaceholder",
a);this._created&&this._setPlaceholder(this.activeSourceIndex)},_setActiveSourceIndexAttr:function(a){this._set("activeSourceIndex",a);this._updateActiveSource();this._created&&(this._setPlaceholder(a),this._hideMenus(),this._insertSources(this.sources))},_setMaxLengthAttr:function(a){this._set("maxLength",a);this._created&&p.set(this.inputNode,"maxLength",a)},_setValueAttr:function(a){this.set("magicKey",null);this.set("selectedFeatureId",null);this._set("value",a);this._created&&(p.set(this.inputNode,
"value",a),this._checkStatus())},_setVisibleAttr:function(a){this._set("visible",a);this._created&&this._updateVisible()},_setEnableButtonModeAttr:function(a){this._set("enableButtonMode",a);this._created&&this._updateButtonMode(a)},_setThemeAttr:function(a){this._created&&(q.remove(this.domNode,this.theme),q.add(this.domNode,a));this._set("theme",a)}});f("extend-esri")&&g.setObject("dijit.Search",h,F);return h})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),
function(l,h,g,e,d,b,a,c,k,f,n){l=l(f,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],"suggest-locations-complete":["suggestions"]},constructor:function(a){this._geocodeHandler=h.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=h.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=h.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},
outSpatialReference:null,setOutSpatialReference:function(a){this.outSpatialReference=a},_geocodeHandler:function(a,b,c,d,e){try{var f=a.candidates,g;b=[];var h,k=f.length,l=a.spatialReference,m;for(h=0;h<k;h++){g=f[h];if(m=g.location)m.spatialReference=l;b[h]=new n(g)}this._successHandler([b],"onAddressToLocationsComplete",c,e)}catch(z){this._errorHandler(z,d,e)}},_geocodeAddressesHandler:function(a,b,c,d,e){try{var f=a.locations;b=[];var g,h=f.length,k=a.spatialReference,l;for(g=0;g<h;g++){if(l=
f[g].location)l.spatialReference=k;b[g]=new n(f[g])}this._successHandler([b],"onAddressesToLocationsComplete",c,e)}catch(B){this._errorHandler(B,d,e)}},addressToLocations:function(a,b,f,g,l){var m,n,p,q,r,t,z,C;a.address&&(g=f,f=b,b=a.outFields,l=a.searchExtent,C=a.countryCode,m=a.magicKey,n=a.distance,z=a.categories,a.location&&this.normalization&&(p=a.location.normalize()),q=a.locationType,r=a.maxLocations,t=a.forStorage,a=a.address);l&&(l=l.shiftCentralMeridian());var E=this.outSpatialReference;
a=this._encode(h.mixin({},this._url.query,a,{f:"json",outSR:E&&d.toJson(E.toJson()),outFields:b&&b.join(",")||null,searchExtent:l&&d.toJson(l.toJson()),category:z&&z.join(",")||null,countryCode:C||null,magicKey:m||null,distance:n||null,location:p||null,locationType:q||null,maxLocations:r||null,forStorage:t||null}));var A=this._geocodeHandler,F=this._errorHandler,G=new e(k._dfdCanceller);G._pendingDfd=c({url:this._url.path+"/findAddressCandidates",content:a,callbackParamName:"callback",load:function(a,
b){A(a,b,f,g,G)},error:function(a){F(a,g,G)}});return G},suggestLocations:function(a){var b;b=new e(k._dfdCanceller);a.hasOwnProperty("location")&&this.normalization&&(a.location=a.location.normalize());a.searchExtent&&(a.searchExtent=a.searchExtent.shiftCentralMeridian());a=this._encode(h.mixin({},this._url.query,{f:"json",text:a.text,maxSuggestions:a.maxSuggestions,searchExtent:a.searchExtent&&d.toJson(a.searchExtent.toJson()),category:a.categories&&a.categories.join(",")||null,countryCode:a.countryCode||
null,location:a.location||null,distance:a.distance||null},{f:"json"}));a=c({url:this._url.path+"/suggest",content:a,callbackParamName:"callback"});b._pendingDfd=a;a.then(h.hitch(this,function(a){a=a.suggestions||[];this.onSuggestLocationsComplete(a);b.resolve(a)}),h.hitch(this,function(a){this._errorHandler(a);b.reject(a)}));return b},addressesToLocations:function(a,b,f){var l=this.outSpatialReference,m=[],n=a.categories,p=a.locationType,q=a.countryCode;g.forEach(a.addresses,function(a,b){m.push({attributes:a})});
a=this._encode(h.mixin({},this._url.query,{category:n&&n.join(",")||null,locationType:p||null,sourceCountry:q||null},{addresses:d.toJson({records:m})},{f:"json",outSR:l&&d.toJson(l.toJson())}));var w=this._geocodeAddressesHandler,D=this._errorHandler,B=new e(k._dfdCanceller);B._pendingDfd=c({url:this._url.path+"/geocodeAddresses",content:a,callbackParamName:"callback",load:function(a,c){w(a,c,b,f,B)},error:function(a){D(a,f,B)}});return B},_reverseGeocodeHandler:function(a,b,c,d,e){try{var f=new n({address:a.address,
location:a.location,score:100});this._successHandler([f],"onLocationToAddressComplete",c,e)}catch(y){this._errorHandler(y,d,e)}},locationToAddress:function(a,b,f,g){a&&this.normalization&&(a=a.normalize());var l=this.outSpatialReference;a=this._encode(h.mixin({},this._url.query,{outSR:l&&d.toJson(l.toJson()),location:a&&d.toJson(a.toJson()),distance:b,f:"json"}));var m=this._reverseGeocodeHandler,n=this._errorHandler,p=new e(k._dfdCanceller);p._pendingDfd=c({url:this._url.path+"/reverseGeocode",content:a,
callbackParamName:"callback",load:function(a,b){m(a,b,f,g,p)},error:function(a){n(a,g,p)}});return p},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}});b("extend-esri")&&h.setObject("tasks.Locator",l,a);return l})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(l,h,g,e,d){l=l(null,{declaredClass:"esri.tasks.AddressCandidate",
constructor:function(b){h.mixin(this,b);this.location=new d(this.location)}});g("extend-esri")&&h.setObject("tasks.AddressCandidate",l,e);return l})},"esri/styles/basic":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/has","../kernel","../Color"],function(l,h,g,e,d){function b(a,b){var c;if(a)switch(c={},c.color=new d(a.color),c.opacity=a.opacity||1,b){case "point":c.outline={color:new d(a.outline.color),width:a.outline.width};c.size=a.size;break;case "line":c.width=a.width;break;case "polygon":c.outline=
{color:new d(a.outline.color),width:a.outline.width}}return c}function a(a){if("esriGeometryPoint"===a||"esriGeometryMultipoint"===a)a="point";else if("esriGeometryPolyline"===a)a="line";else if("esriGeometryPolygon"===a||"esriGeometryMultiPatch"===a)a="polygon";return a}var c={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector".split(" "),
dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,255,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,.25],width:1},size:8}]},dark:{primary:{color:[255,255,255,1],outline:{color:[92,92,92,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},
{color:[26,26,26,1],outline:{color:[178,178,178,.25],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,77,77,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[255,255,255,1],width:2}]},dark:{primary:{color:[255,255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,139,79,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},secondary:[{color:[128,128,128,1],outline:{color:[255,255,255,.25],width:1},
opacity:.8},{color:[255,255,255,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]},dark:{primary:{color:[227,139,79,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},secondary:[{color:[178,178,178,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},{color:[26,26,26,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]}}}},k={};(function(){var a,b,d,e,f,g,h,l;for(a in c)for(e in b=c[a],d=b.basemapGroups,f=k[a]={basemaps:[].concat(d.light).concat(d.dark),point:{},line:{},polygon:{}},
d)for(g=d[e],h=0;h<g.length;h++)l=g[h],b.pointSchemes&&(f.point[l]=b.pointSchemes[e]),b.lineSchemes&&(f.line[l]=b.lineSchemes[e]),b.polygonSchemes&&(f.polygon[l]=b.polygonSchemes[e])})();var f={getAvailableThemes:function(a){var b=[],d,e,f;for(d in c)e=c[d],f=k[d],a&&-1===l.indexOf(f.basemaps,a)||b.push({name:e.name,label:e.label,description:e.description,basemaps:f.basemaps.slice(0)});return b},getSchemes:function(c){var d=c.theme,e=c.basemap,f=a(c.geometryType);c=k[d];var g;(c=(c=c&&c[f])&&c[e])&&
(g={primaryScheme:b(c.primary,f),secondarySchemes:l.map(c.secondary,function(a){return b(a,f)})});return g},cloneScheme:function(a){var b;a&&(b=h.mixin({},a),b.color&&(b.color=new d(b.color)),b.outline&&(b.outline={color:b.outline.color&&new d(b.outline.color),width:b.outline.width}));return b}};g("extend-esri")&&h.setObject("styles.basic",f,e);return f})},"jimu/dijit/EditorXssFilter":function(){define("dojo/_base/declare dojo/_base/array dijit/_WidgetBase dojo/_base/lang dojo/Evented libs/arcgis-html-sanitizer/arcgis-html-sanitizer".split(" "),
function(l,h,g,e,d,b){var a=null,c=l([g,d],{baseClass:"jimu-editor-xss-filter",declaredClass:"jimu.dijit.EditorXssFilter",sanitizer:null,xss:null,whiteList:{},graphicsWhiteList:{},postCreate:function(){this.whiteList=this._getWhiteList();this.sanitizer=new b({whiteList:this.whiteList,safeAttrValue:e.hitch(this,function(a,b,c,d){return"style"===b?this.xss.friendlyAttrValue(c).replace(/\"/g,"'"):"img"===a&&"src"===b?this.xss.escapeAttrValue(c):this.xss.safeAttrValue(a,b,c,d)}),onTag:e.hitch(this,function(a,
b,c){if(c.isWhite&&this._isInWhiteList(a,this.graphicsWhiteList))return b}),onIgnoreTagAttr:e.hitch(this,function(a,b,c,d){if("data-"===b.substr(0,5))return b+'\x3d"'+this.xss.escapeAttrValue(c)+'"'}),onIgnoreTag:e.hitch(this,function(a,b,c){if("o:"===a.substr(0,2)||"!--[if"===a||"!--[endif]--"===a)return b})},!0);this.xss=this.sanitizer.xss},sanitize:function(a){return this.sanitizer.sanitize(a)},_getWhiteList:function(){var a="title height width class style font-family id align text-align".split(" "),
b={div:a,h1:a,h2:a,h3:a,h4:a,h5:a,h6:a,span:a,p:a,s:a,strong:a,em:a,u:a,ol:a,ul:a,li:a,a:["href","target"].concat(a),img:["src","alt","border"].concat(a),blockquote:a,font:["face","size","color"].concat(a),pre:a,code:a,b:a,i:a,wbr:a,video:"autoplay controls loop muted poster preload".split(" ").concat(a),audio:["autoplay","controls","loop","muted","preload"].concat(a),source:["media","src","type"].concat(a),table:["cellpadding","cellspacing","border"].concat(a),tbody:[].concat(a),tr:["valign"].concat(a),
td:["valign","colspan","rowspan","nowrap"].concat(a),th:["valign","colspan","rowspan","nowrap"].concat(a),hr:a,html:a,title:a,link:["rel","href"],style:["type"].concat(a),body:a};this.graphicsWhiteList={animate:[],animateMotion:[],animateTransform:[],circle:[],clipPath:[],"color-profile":[],defs:[],desc:[],discard:[],ellipse:[],feBlend:[],feColorMatrix:[],feComponentTransfer:[],feComposite:[],feConvolveMatrix:[],feDiffuseLighting:[],feDisplacementMap:[],feDistantLight:[],feDropShadow:[],feFlood:[],
feFuncA:[],feFuncB:[],feFuncG:[],feFuncR:[],feGaussianBlur:[],feImage:[],feMerge:[],feMergeNode:[],feMorphology:[],feOffset:[],fePointLight:[],feSpecularLighting:[],feSpotLight:[],feTile:[],feTurbulence:[],filter:[],foreignObject:[],g:[],hatch:[],hatchpath:[],line:[],linearGradient:[],marker:[],mask:[],mesh:[],meshgradient:[],meshpatch:[],meshrow:[],metadata:[],mpath:[],path:[],pattern:[],polygon:[],polyline:[],radialGradient:[],rect:[],set:[],solidcolor:[],stop:[],svg:[],switch:[],symbol:[],text:[],
textPath:[],title:[],tspan:[],use:[],view:[],object:[],canvas:a};return this._extendObjectOfArrays([b,{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],
em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align",
"valign"],tt:[],u:[],ul:[],video:"autoplay controls loop preload src height width".split(" ")},this.graphicsWhiteList])},_extendObjectOfArrays:function(a){var b={};h.forEach(a,function(a){var c=Object.keys(a);h.forEach(c,function(c){Array.isArray(a[c])&&Array.isArray(b[c])?b[c]=b[c].concat(a[c]):b[c]=a[c]},this)},this);return b},_isInWhiteList:function(a,b){b=Object.keys(b);var c=!1;h.forEach(b,function(b){a===b&&(c=!0)},this);return c}});c.getInstance=function(){null===a&&(a=new c);return a};return c})},
"widgets/BusinessAnalyst/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:esri/dijit/geoenrichment/templates/_WizardPage.html":'\x3cdiv style\x3d"width: 100%; height: 100%;"\x3e\r\n    \x3cdiv data-dojo-type\x3d"esri/dijit/geoenrichment/Grid" data-dojo-attach-point\x3d"layoutGrid"  class\x3d"Grid"\x3e\r\n        ${content}\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/BusinessAnalyst/CreateBuffersPage.html":'\x3cdiv\x3e\r\n\t\x3cdiv\x3e${nls.addRingsDtWt}\x3c/div\x3e\r\n\t\x3cbr\x3e\r\n    \x3cdiv style\x3d"width: 350 px; height: 110px"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"ringDtWtTabContainer" style\x3d"width: 100%; height: 110px;"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"ringsContentPane" title\x3d"${nls.rings}" style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t${nls.radius}\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 1" data-dojo-attach-point\x3d"ringsBufferRadii1"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 3" data-dojo-attach-point\x3d"ringsBufferRadii2"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 5" data-dojo-attach-point\x3d"ringsBufferRadii3"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"ringsBufferUnits"\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriMiles" selected\x3d"selected"\x3e${nls.miles}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"ringValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont" style\x3d"position: absolute; right: 0px; top: 94px;"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"driveTimeContentPane" title\x3d"${nls.driveTime}" style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t${nls.time}\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 5" data-dojo-attach-point\x3d"driveTimeBufferRadii1"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 10" data-dojo-attach-point\x3d"driveTimeBufferRadii2"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 15" data-dojo-attach-point\x3d"driveTimeBufferRadii3"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"driveTimeBufferUnits"\x3e\r\n\t\t\t\t\t\x3coption value\x3d"Minutes" selected\x3d"selected"\x3e${nls.minutes}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriMiles"\x3e${nls.miles}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"driveTimeValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont" style\x3d"position: absolute; right: 0px; top: 94px;"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"walkTimeContentPane" title\x3d"${nls.walkTime}" style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t${nls.time}\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 5" data-dojo-attach-point\x3d"walkTimeBufferRadii1"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 10" data-dojo-attach-point\x3d"walkTimeBufferRadii2"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-type\x3d"dijit/form/TextBox" style\x3d"width: 42px;" data-dojo-props\x3d"value: 15" data-dojo-attach-point\x3d"walkTimeBufferRadii3"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"walkTimeBufferUnits"\x3e\r\n\t\t\t\t\t\x3coption value\x3d"Minutes" selected\x3d"selected"\x3e${nls.minutes}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriMiles"\x3e${nls.miles}\x3c/option\x3e\r\n\t\t\t\t\t\x3coption value\x3d"esriKilometers"\x3e${nls.km}\x3c/option\x3e\r\n\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"walkTimeValidationErrorMessage" class\x3d"validationErrorMessage hidden"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont" style\x3d"position: absolute; right: 0px; top: 94px;"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv style\x3d"margin-top: 10px;" class\x3d"jimu-btn jimu-btn-vacation"  data-dojo-attach-point\x3d"backBtn" data-dojo-attach-event\x3d"onclick:backOnClick"\x3e${nls.back}\x3c/div\x3e\r\n\t\x3cdiv style\x3d"margin-top: 10px;" class\x3d"jimu-btn"  data-dojo-attach-point\x3d"createBufferBtn" data-dojo-attach-event\x3d"onclick:applyBuffer"\x3e${nls.apply}\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/ErrorPage.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noPermissionsErrorDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"servicesErrorDiv"\r\n\x3c/div\x3e\r\n',"url:esri/dijit/geoenrichment/templates/OnDemandSelect.html":'\x3cdiv class\x3d"esriGEOnDemandSelect"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"openButton" class\x3d"onDemandSelect_openButton"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"arrow" class\x3d"onDemandSelect_arrow"\x3e\x26nbsp;\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"selectedLabel" class\x3d"onDemandSelect_selectedLabel TrimWithEllipses"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"selectedItemHolder" class\x3d"onDemandSelect_selectedItem TrimWithEllipses"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/geoenrichment/ReportPlayer/templates/ComparisonSettings.html":'\x3cdiv class\x3d"esriGEReportPlayerToolbar_comparisonSettings esriGENonSelectable"\x3e\r\n    \x3cdiv class\x3d"esriGERow20" data-dojo-attach-point\x3d"showBackgroundImageBlock"\x3e\r\n        ${nls.comparisonSettings}\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv class\x3d"esriGESpaceBefore20"\x3e\r\n        \x3cdiv class\x3d"esriGERow20" data-dojo-attach-point\x3d"showBackgroundImageBlock"\x3e\r\n            \x3clabel data-dojo-attach-point\x3d"showBackgroundImageLabel"\x3e\x26nbsp;${nls.showBackgroundImage}\x3c/label\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"esriGERow20"\x3e\r\n            \x3cdiv class\x3d"dijitInline"\x3e\r\n                \x3clabel data-dojo-attach-point\x3d"splitPanelsLabel"\x3e\x26nbsp;${nls.splitPanels}\x3c/label\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceBeforeBig esriGEInfoIcon" data-dojo-attach-point\x3d"splitPanelsInfoIcon"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"esriGERow20"\x3e\r\n            \x3cdiv class\x3d"dijitInline"\x3e${nls.zoomPanels}\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceBeforeBig esriGEInfoIcon" data-dojo-attach-point\x3d"zoomPanelsInfoIcon"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"esriGERow20 esriGESpaceBefore20" data-dojo-attach-point\x3d"zoomBlock"\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceAfterBig comparisonSettings_zoomOutButton esriGEIcon16" data-dojo-attach-point\x3d"zoomOutButton"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceAfterBig comparisonSettings_zoomLabel" data-dojo-attach-point\x3d"zoomLabel"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceAfterBig comparisonSettings_zoomInButton esriGEIcon16" data-dojo-attach-point\x3d"zoomInButton"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGELink comparisonSettings_resetLink" data-dojo-attach-point\x3d"resetButton"\x3e${nls.reset}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"esriGERow20 esriGESpaceBefore20" data-dojo-attach-point\x3d"zoomSplitBlock"\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceAfterBig comparisonSettings_zoomOutButton esriGEIcon16" data-dojo-attach-point\x3d"zoomOutSplitButton"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceAfterBig comparisonSettings_zoomLabel" data-dojo-attach-point\x3d"zoomSplitLabel"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGESpaceAfterBig comparisonSettings_zoomInButton esriGEIcon16" data-dojo-attach-point\x3d"zoomInSplitButton"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"dijitInline esriGELink comparisonSettings_resetLink" data-dojo-attach-point\x3d"resetSplitButton"\x3e${nls.reset}\x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/geoenrichment/ReportPlayer/templates/PlayerToolbarHolder.html":'\x3cdiv class\x3d"esriGEPlayerToolbar"\x3e\r\n\r\n    \x3c!--left--\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"infographicsSelectDiv" class\x3d"dijitInline playerToolbar_infographicsSelectDiv"\x3e\x3c/div\x3e\r\n    \r\n    \x3c!--center--\x3e\r\n    \r\n    \x3cdiv data-dojo-attach-point\x3d"areaTitleDiv" class\x3d"dijitInline playerToolbar_areaTitleDiv"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"areaTitleInnerDiv" class\x3d"dijitInline playerToolbar_areaTitleInnerDiv TrimWithEllipses"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"areasSelectDiv" class\x3d"dijitInline playerToolbar_areasSelectDiv"\x3e\x3c/div\x3e\r\n\r\n    \x3c!--right--\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"rightSideControlsBlock" class\x3d"dijitInline playerToolbar_rightSideControlsBlock"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"zoomSelectDiv" class\x3d"dijitInline dijitInline playerToolbar_zoomSelectDiv"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"pageSelectDiv" class\x3d"dijitInline dijitInline playerToolbar_pageSelectDiv"\x3e\x3c/div\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"commandButtonsContainer" class\x3d"dijitInline playerToolbar_commandButtonsContainer"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/geoenrichment/ReportPlayer/templates/ReportPlayer.html":'\x3cdiv class\x3d"esriGEReportPlayer esriGENonSelectable"\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"printBackgroundView" class\x3d"esriGEAbsoluteStretched"\x3e\x3c/div\x3e\r\n\r\n    \x3cdiv data-dojo-attach-point\x3d"normalViewDiv"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"playerToolbarDiv"\x3e\x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"printableDivContainer" class\x3d"reportPalyer_printableDivContainer"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"printableDiv" class\x3d"reportPalyer_printableDiv"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"reportContainerDiv"\x3e\x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv class\x3d"reportPlayer_sidePageNavigator" data-dojo-attach-point\x3d"sidePageNavigator"\x3e\r\n            \x3cdiv class\x3d"reportPlayer_paginationArrowUp" data-dojo-attach-point\x3d"prevPageButton"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"reportPlayer_paginationArrowDown" data-dojo-attach-point\x3d"nextPageButton"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n\r\n        \x3cdiv data-dojo-attach-point\x3d"playerAfterToolbarDiv" class\x3d"reportPlayer_playerAfterToolbarDiv"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/esriAnalystX/widgets/SelectableTreeGrid/templates/SelectableTreeGrid.html":'\x3cdiv class\x3d"esriMapsAnalystXNonSelectable"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"gridContainer"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"selectionCounter" class\x3d"esriMapsAnalystXSelectableTreeCounter"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/BusinessAnalyst/RunReportsPage.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"business-analyst-run-reports-page" style\x3d"width: 350 px; height: 150px"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"runReportTabContainer" style\x3d"width: 100%; height: 155px;"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"infographicsContentPane" title\x3d"${nls.infographics}" style\x3d"overflow-y: hidden"\x3e\r\n\t\t\t\t\x3cdiv style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t\t\x3cdiv style\x3d"height: 40px;" data-dojo-attach-point\x3d"infographicDropDownContainer"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cbr /\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-btn runReportButton jimu-state-disabled" data-dojo-attach-point\x3d"runInfographicBtn" data-dojo-attach-event\x3d"onclick:runInfographic"\x3e${nls.runInfographic}\x3c/div\x3e\r\n\t\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"reportsContentPane" title\x3d"${nls.reports}" style\x3d"overflow-y: hidden"\x3e\r\n\t\t\t\t\x3cdiv style\x3d"margin-top: 15px;"\x3e\r\n\t\t\t\t\t\x3cdiv style\x3d"height: 40px;" data-dojo-attach-point\x3d"reportFilteringSelectDropDownContainer"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cbr /\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-btn runReportButton jimu-state-disabled" data-dojo-attach-point\x3d"runReportBtn" data-dojo-attach-event\x3d"onclick:runReport"\x3e${nls.runReport}\x3c/div\x3e\r\n\t\t\t\t\t\x3ca href\x3d"https://doc.arcgis.com/en/arcgis-online/reference/credits.htm" target\x3d"_blank" class\x3d"esriFloatTrailing esriSmallFont"\x3e${nls.creditInformation}\x3c/a\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cbr\x3e\r\n\t\x3cdiv class\x3d"jimu-btn jimu-btn-vacation" data-dojo-attach-point\x3d"backBtn" data-dojo-attach-event\x3d"onclick:backOnClick"\x3e${nls.back}\x3c/div\x3e\r\n\r\n\t\x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\r\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\r\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\r\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\r\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\r\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\r\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n          \x3c/form\x3e\r\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\r\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/SelectPointPolygonPage.html":'\x3cdiv\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"contentContainer"\x3e\x3c/div\x3e\r\n    \x3cbr\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"searchContainer" class\x3d"esriBusinessAnalystSearchContainer"\x3e\x3c/div\x3e\r\n    \x3cdiv tabindex\x3d"0" role\x3d"button" data-dojo-attach-point\x3d"activatePinButton" title\x3d"${nls.addPoint}" class\x3d"esriBusinessAnalystButton esriBusinessAnalystPinButton esriBusinessAnalystButtonSearchPadding" data-blur-on-click\x3d"true" \x3e\x3c/div\x3e\r\n    \x3cdiv tabindex\x3d"1" role\x3d"button" data-dojo-attach-point\x3d"activatePolygonButton" title\x3d"${nls.addPolygon}" class\x3d"esriBusinessAnalystButton esriBusinessAnalystPolygonButton esriBusinessAnalystButtonSearchPadding" data-blur-on-click\x3d"true" \x3e\x3c/div\x3e\r\n    \x3cdiv tabindex\x3d"2" role\x3d"button" data-dojo-attach-point\x3d"activateFreehandPolygonButton" title\x3d"${nls.addFreehandPolygon}" class\x3d"esriBusinessAnalystButton esriBusinessAnalystFreehandPolygonButton esriBusinessAnalystButtonSearchPadding" data-blur-on-click\x3d"true" \x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/BusinessAnalyst/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"wizardContainer"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/BusinessAnalyst/css/style.css":'.esriBusinessAnalystButton {background: #fff; border: 1px solid #c5c5c5; color: #555; -webkit-border-radius: 3px; -moz-border-radius: 3px; -ms-border-radius: 3px; -o-border-radius: 3px; border-radius: 3px; font-size: 12px; line-height: 12px; -webkit-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.125); -moz-box-shadow: 0 1px 2px rgba(0, 0, 0, 0.125); box-shadow: 0 1px 2px rgba(0, 0, 0, 0.125); -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-user-select: none; -moz-user-select: none; user-select: none; -webkit-transition: all .05s linear; -moz-transition: all .05s linear; -o-transition: all .05s linear; transition: all .05s linear; padding: 5px 10px; text-align: center; text-transform: uppercase; cursor: pointer; letter-spacing: 1px; position: relative; -webkit-font-smoothing: antialiased; width: 34px; height: 34px; background-repeat: no-repeat; background-position: center; margin-left: 1px;}.esriBusinessAnalystPressedButton {box-shadow: inset 0px 1px 1px rgba(0, 0, 0, 0.2);}.esriBusinessAnalystPressedButton,.esriBusinessAnalystPressedButton:hover{background-color: #DDE8F2;}.esriBusinessAnalystButtonSearchPadding {top: 22px;}.esriBusinessAnalystPinButton {float: left; margin-right: 10px; background-image: url("../../../jimu.js/css/images/draw_point.png");}.esriBusinessAnalystPolygonButton {float: left; background-size: 45px 45px; margin-right: 10px; background-image: url("../../../jimu.js/css/images/draw_polygon.png");}.esriBusinessAnalystFreehandPolygonButton {float: left; background-image: url("../../../jimu.js/css/images/draw_freehand_polygon.png");}.esriGETooltip {box-sizing: initial !important;}.esriGEPlayerToolbar.playerThemeDark {background-color: inherit !important;}.runReportButton {display: block; margin-top: 15px; width: max-content;}.jimu-btn.runReportButton.jimu-state-disabled {cursor: default;}.jimu-widget-business-analyst .tabs {font-family: "Avenir Light"; color: #000000; height: 100%;} .jimu-widget-business-analyst .tabs .tab-description {margin: 10px 0;} .jimu-widget-business-analyst .jimu-tab3\x3e.control\x3e.tab{background-color: #fff; border-top: 0; border-left: 0; border-right: 0; border-bottom: 1px solid #dedede; color:#898989; font-family: "Avenir Medium"; font-size: 14px;} .jimu-widget-business-analyst .jimu-tab3 .tab-item-td.jimu-state-active {border-bottom: 3px solid #24b5cc; font-family: "Avenir Heavy"; color: #000000;} .DashboardTheme .jimu-widget-business-analyst .jimu-tab3 .tab-item-td.jimu-state-active {color: #FFFFFF;} .DashboardTheme.light .jimu-widget-business-analyst .jimu-tab3 .tab-item-td.jimu-state-active {color: #000000;} .jimu-widget-business-analyst .tabs .titles {font-weight: bold; font-family: "Avenir Medium"; font-size: 14px; margin: 20px 0 10px 0;} .jimu-widget-business-analyst .tabs .hide{display: none;} .jimu-widget-business-analyst .tabs .indent{margin-left: 20px; margin-top: 10px;} .jimu-widget-business-analyst .tabs .unit-item{margin: 15px 5px 5px 5px; line-height: 18px; height: 18px; vertical-align: middle;} .jimu-widget-business-analyst .tabs .clearFix {*overflow: hidden; *zoom: 1;} .jimu-widget-business-analyst .tabs .clearFix:after {display: table; content: ""; width: 0; clear: both;} .jimu-widget-business-analyst .tabs .view{height: 100%; overflow-y: auto;} .jimu-widget-business-analyst .tabs .jimu-tab3\x3e.jimu-viewstack{padding-bottom: 30px;} .claro .jimu-widget-business-analyst .dijitTextBox, .claro .esriGEReportPlayer .esriGEPlayerToolbar .dijitTextBox {height: 30px;} .claro .jimu-widget-business-analyst .ui-icon {background-image: inherit;} .business-analyst-search-suggestions-overflow {overflow: visible !important;} .claro .jimu-widget-business-analyst .arcgisSearch .searchClear {top: 2px;} .jimu-widget-business-analyst .validationErrorMessage {color: #FF0000; margin-top: 10px;} .jimu-widget-business-analyst .validationErrorMessage.hidden {display: none;} .jimu-widget-business-analyst .invalidValue {outline: 3px solid #FF0000;} .jimu-widget-business-analyst .business-analyst-run-reports-page .dijitTextBox, .esriGEReportPlayer .playerToolbar_infographicsSelectDiv .dijitTextBox {width: 20em;}',
"*now":function(l){l(['dojo/i18n!*preload*widgets/BusinessAnalyst/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define(["dojo/_base/declare","dojo/dom-class","dojo/query","jimu/BaseWidget","./BAWizard"],function(l,h,g,e,d){return l([e],{name:"BusinessAnalyst",baseClass:"jimu-widget-business-analyst",reportDropDown:null,infographicDropDown:null,tradeAreaGraphics:[],selectedPoint:{tradeAreas:[]},postCreate:function(){this.inherited(arguments);this.initializeNewConfigValues();this.baWizard=(new d({appConfig:this.appConfig,map:this.map,nls:this.nls,config:this.config})).placeAt(this.wizardContainer)},startup:function(){this.baWizard.resize();
g(".jimu-widget-business-analyst").parents(".jimu-widget-frame.jimu-container")[0]&&h.add(g(".jimu-widget-business-analyst").parents(".jimu-widget-frame.jimu-container")[0],"business-analyst-search-suggestions-overflow");g(".jimu-widget-business-analyst").parents(".jimu-panel.jimu-on-screen-widget-panel")[0]&&h.add(g(".jimu-widget-business-analyst").parents(".jimu-panel.jimu-on-screen-widget-panel")[0],"business-analyst-search-suggestions-overflow")},resize:function(){this.baWizard&&this.baWizard.resize()},
onClose:function(){this.baWizard._featureUnselected()},onOpen:function(){this.baWizard.refreshPage()},initializeNewConfigValues:function(){"undefined"===typeof this.config.exportInfographicsPrintOption&&(this.config.exportInfographicsPrintOption=!0);"undefined"===typeof this.config.exportInfographicsImageOption&&(this.config.exportInfographicsImageOption=!0);"undefined"===typeof this.config.exportInfographicsPDFOption&&(this.config.exportInfographicsPDFOption=!0);"undefined"===typeof this.config.exportInfographicsDynamicHTMLOption&&
(this.config.exportInfographicsDynamicHTMLOption=!0);"undefined"===typeof this.config.firstPageText&&(this.config.firstPageText="\x3cbr\x3e\x3cdiv\x3e"+this.nls.widgetDescription+"\x3c/div\x3e\x3cbr\x3e\x3cdiv\x3e"+this.nls.selectPointOrPolygon+"\x3c/div\x3e");"undefined"===typeof this.config.searchTextBoxOption&&(this.config.searchTextBoxOption=!0);"undefined"===typeof this.config.dropPinOption&&(this.config.dropPinOption=!0);"undefined"===typeof this.config.drawPolygonOption&&(this.config.drawPolygonOption=
!0);"undefined"===typeof this.config.drawFreehandPolygonOption&&(this.config.drawFreehandPolygonOption=!0)}})});