// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/AddData/search/SearchContext":function(){define(["dojo/_base/declare","dojo/_base/lang"],function(p,h){return p(null,{allowArcGISOnline:!0,arcgisOnlinePortal:null,orgId:null,portal:null,username:null,constructor:function(q){h.mixin(this,q)}})})},"widgets/AddData/search/util":function(){define(["dojo/_base/array","dojo/aspect","dojo/io-query","esri/InfoTemplate","esri/layers/WFSLayer"],function(p,h,q,l,e){return{checkMixedContent:function(e){"string"===typeof window.location.href&&
0===window.location.href.indexOf("https://")&&"string"===typeof e&&0===e.indexOf("http://")&&(e="https:"+e.substring("5"));return e},endsWith:function(e,b){return-1!==e.indexOf(b,e.length-b.length)},escapeForLucene:function(e){return e.replace(/(\+|\-|\&|\!|\(|\)|\{|\}|\[|\]|\^|\"|\~|\*|\?|\:|\\)/g,"\\$1")},findLayersAdded:function(e,b){var r=[],t=[],h=[],l={itemIds:t,layers:h};if(!e)return l;var z="string"===typeof b&&0<b.length;p.forEach(e.layerIds,function(b){r.push(b)});p.forEach(e.graphicsLayerIds,
function(b){r.push(b)});p.forEach(r,function(r){(r=e.getLayer(r))&&"string"===typeof r.xtnItemId&&0<r.xtnItemId.length&&(!z||r.xtnItemId===b)&&(h.push(r),-1===t.indexOf(r.xtnItemId)&&t.push(r.xtnItemId))});return l},loadWFSByUrl:function(q,b,r,t,x,p){var z,w,E,F,C=this.makeOGCRequestInfo(t);t=C.url;var G=new e;z=G.on("error",function(b){z&&z.remove();q.reject(b.error)});G.fromJson(C,function(A){try{if(z&&z.remove(),A&&A.push&&0<A.length){var c=A[0],n={url:t,version:G._version,name:c.name};F=c.name||
c.title;if("string"===typeof n.version&&0<n.version.length&&"string"===typeof n.name&&0<n.name.length){var D=new e({id:x,infoTemplate:new l});"string"===typeof F&&0<F.length&&(D.name=F);w=D.on("error",function(c){w&&w.remove();q.reject(c.error)});E=h.after(D,"_describeFeatureTypeResponse",function(){E&&E.remove();D.fields&&0<D.fields.length&&r._setFeatureLayerInfoTemplate(D)});D.fromJson(n,function(){w&&w.remove();D.xtnAddData=!0;b&&p&&b.addLayer(D);q.resolve(D)})}else q.reject(Error("Error loading WFSLayer, missing version and/or layer"))}else q.reject(Error("Error loading WFSLayer, no layers"))}catch(u){console.warn("Error loading WFSLayer",
t),console.error(u),q.reject(u)}})},makeOGCRequestInfo:function(e){var b={url:e},r=e.indexOf("?");if(-1!==r){b.url=e.substring(0,r);var t;e=e.substring(r+1,e.length);if("string"===typeof e&&0<e.length){var h=q.queryToObject(e),l={};if(h){for(t in h)h.hasOwnProperty(t)&&(e=h[t],r=t.toLowerCase(),"request"!==r&&"service"!==r&&("version"===r?"string"===typeof e&&0<e.length&&(b.version=e):"name"===r?"string"===typeof e&&0<e.length&&(b.name=e):l[t]=e));e=q.objectToQuery(l);"string"===typeof e&&0<e.length&&
(b.url=b.url+"?"+e)}}}return b},setNodeText:function(e,b){e.innerHTML="";b&&e.appendChild(document.createTextNode(b))},setNodeTitle:function(e,b){e.title="";b&&e.setAttribute("title",b)},setNodeHTML:function(e,b){e.innerHTML="";b&&(e.innerHTML=b)}}})},"esri/layers/WFSLayer":function(){define("dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/has dojo/on ../request ../kernel ../graphic ../renderers/jsonUtils ../symbols/jsonUtils ../Color ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../SpatialReference ../geometry/webMercatorUtils ../geometry/Extent ../geometry/Point ../geometry/Multipoint ../geometry/Polyline ../geometry/Polygon ./LabelClass ./GraphicsLayer".split(" "),
function(p,h,q,l,e,w,b,r,t,x,E,z,H,y,F,C,G,A,c,n,D,u,B,I,g){p=p([g],{declaredClass:"esri.layers.WFSLayer",constructor:function(a){this.geometryType=this.describeFeatureTypeUrl=this.getFeatureUrl=this.layerNamespace="";this.fields=[];this.spatialReferences=[];this.fullExtent=null;this.visible=!0;this.renderer=null;this.id="WFSLayer";this._url="";this._version="1.1.0";this._layerName="";this._nsLayerNames={};this._layerDefinedGeometryType="esriGeometryComplex";this._wkid=3857;this._mode="snapshot";
this._maxFeatures=100;this._inverseResponse=this._inverseFilter=!1;this._nsGeometryFieldName=this._getFeatureRequest=this._nsFields="";this._graphicArray=[];this._gmlNS="http://www.opengis.net/gml";this._layerEventHandlers=[];this.customParameters=this._describeFeatureTypeCallback=this._getCapabilitiesCallback=null;this.showLabels=!0;this.labelingInfo=null;a&&(a.id&&(this.id=a.id),this.showLabels=null!==a.showLabels?a.showLabels:!0);this.onError=q.hitch(this,this.onError);this._errorSupport=q.hitch(this,
this._errorSupport);this._parseGml=q.hitch(this,this._parseGml);this._getCapabilities=q.hitch(this,this._getCapabilities);this._getCapabilitiesResponse=q.hitch(this,this._getCapabilitiesResponse);this._describeFeatureTypeResponse=q.hitch(this,this._describeFeatureTypeResponse);this._pointSymbol=new y(y.STYLE_CIRCLE,6,new F(F.STYLE_SOLID,new H([0,255,0]),1),new H([255,0,0]));this._lineSymbol=new F(F.STYLE_SOLID,new H([0,255,0]),3);this._polygonSymbol=new C(C.STYLE_SOLID,new F(F.STYLE_SOLID,new H([255,
0,0]),2),new H([255,255,0,.25]));this.loaded=!1;this._isProjectedOk=!0},initialize:function(a,d){a.id&&(this.id=a.id);a.url&&(this._url=a.url);a.version&&(this._version=a.version);this.customParameters=a.customParameters;this._getCapabilities(d)},selectLayer:function(a,d){this._layerName=a.layerName;this._wkid=a.wkid;this._mode=a.mode;this._maxFeatures=a.maxFeatures;this._inverseResponse=a.swapXY;this._inverseFilter=a.swapXYFilter;this.geometryType=a.geometryType;this._describeFeatureType(d);this.loaded=
!0},toJson:function(){var a={};a.id=this.id;a.url=this._url;a.version=this._version;a.mode="snapshot"===this._mode?0:1;a.name=this._layerName;a.geometryType=this.geometryType;a.wkid=this._wkid;a.maxFeatures=this._maxFeatures;a.swapXY=this._inverseResponse;a.swapXYFilter=this._inverseFilter;a.pointSymbol=this._pointSymbol.toJson();a.lineSymbol=this._lineSymbol.toJson();a.polygonSymbol=this._polygonSymbol.toJson();a.showLabels=this.showLabels;this.labelingInfo&&(a.labelingInfo=l.map(this.labelingInfo,
function(a){return a.toJson()}));this.customParameters&&(a.customParameters=this.customParameters);return a},fromJson:function(a,d){a.id&&(this.id=a.id);a.url&&(this._url=a.url);a.version&&(this._version=a.version);a.mode&&(this._mode=0===a.mode?"snapshot":"onDemand");a.name&&(this._layerName=a.name);a.geometryType&&(this.geometryType=a.geometryType);a.wkid&&(this._wkid=a.wkid);a.maxFeatures&&(this._maxFeatures=a.maxFeatures);a.swapXY&&(this._inverseResponse=a.swapXY);a.swapXYFilter&&(this._inverseFilter=
a.swapXYFilter);a.pointSymbol&&(this._pointSymbol=z.fromJson(a.pointSymbol));a.lineSymbol&&(this._lineSymbol=z.fromJson(a.lineSymbol));a.polygonSymbol&&(this._polygonSymbol=z.fromJson(a.polygonSymbol));this.showLabels=null!=a.showLabels?a.showLabels:!0;a.labelingInfo&&(this.labelingInfo=l.map(a.labelingInfo,function(a){return new I(a)}));this.customParameters=a.customParameters;this._getCapabilities(d);this.loaded=!0},setPointSymbol:function(a){this._pointSymbol=a},setLineSymbol:function(a){this._lineSymbol=
a},setPolygonSymbol:function(a){this._polygonSymbol=a},_setMap:function(a){this._map=a;var d=this.inherited(arguments);this._map&&(this._layerEventHandlers.push(this._map.on("extent-change",q.hitch(this,"refresh"))),this._layerEventHandlers.push(this.on("visibility-change",q.hitch(this,"_visibilityChange"))));this._getFeature();this.refresh();return d},_unsetMap:function(){for(var a=0;a<this._layerEventHandlers.length;a++)e.disconnect(this._layerEventHandlers[a]);this.refresh();this.inherited(arguments)},
refresh:function(a){this.clear();this.redraw();"ondemand"===this._mode.toLowerCase()&&this._fireUpdateStart()},redraw:function(){if(this.visible)for(var a=0;a<this._graphicArray.length;a++){var d=this._graphicArray[a],m=d.geometry,f=null;"point"===m.type?f=this.renderer?this.renderer.getSymbol(d):this._pointSymbol:"multipoint"===m.type?f=this.renderer?this.renderer.getSymbol(d):this._pointSymbol:"polyline"===m.type?f=this.renderer?this.renderer.getSymbol(d):this._lineSymbol:"polygon"===m.type&&(f=
this.renderer?this.renderer.getSymbol(d):this._polygonSymbol);d.setSymbol(f);this.add(d)}},_visibilityChange:function(a){this.visible=a.visible;this.redraw()},onUpdateStart:function(){this._getFeature()},onUpdateEnd:function(){this.clear();this.redraw()},setLabelingInfo:function(a){a?(this.labelingInfo=a,this._fixLabelExpr()):delete this.labelingInfo;this.onLabelingInfoChange()},onLabelingInfoChange:function(){},_fixLabelExpr:function(){var a=/\[([^\[\]]+)\]/ig,d,m=this,f=function(a,d){a=m._getField(d,
!0);return"["+(a&&a.name||d)+"]"};l.forEach(this.labelingInfo,function(k){if(d=k.labelExpression)k.labelExpression=d.replace(a,f)})},_getField:function(a,d){var m=this.fields;if(!m||0===m.length)return null;var f;d&&(a=a.toLowerCase());l.some(m,function(k){var m=!1;(m=d?k&&k.name.toLowerCase()===a?!0:!1:k&&k.name===a?!0:!1)&&(f=k);return m});return f},setCustomParameters:function(a){this.customParameters=a;this._getFeature();this.refresh()},_getCapabilities:function(a){this._getCapabilitiesCallback=
a;a=q.trim(this._url);if(""===a)this.onError("WFSLayer: url is invalid");else if("1.0.0"!==this._version&&"1.1.0"!==this._version&&"2.0.0"!==this._version)this.onError("WFSLayer: version is invalid");else if(""!==a){var d=a.indexOf("?"),d=this._checkForUrlInUrl(a,d),d="?"===a.charAt(a.length-1)?"":-1===d?"?":"\x26";a=a+d+"service\x3dWFS\x26request\x3dGetCapabilities\x26version\x3d"+this._version;a=this._appendCustomParameters(a);r({url:a,handleAs:"text",headers:{"Content-Type":null}},{usePost:!1}).then(this._getCapabilitiesResponse,
this._errorSupport)}},_errorSupport:function(a){this.onError(a)},_getCapabilitiesResponse:function(a){var d,m,f,k,c,g=new DOMParser;try{var v=g.parseFromString(a,"text/xml"),n=this._readExceptionReport(v,a);if(n)this.onError("WFSLayer: getCapabilities - returns exception: "+n);else{var b=v.documentElement.attributes.getNamedItem("version");if(b){this._version=b.value;var u="2.0.0"===this._version?"http://www.opengis.net/wfs/2.0":"http://www.opengis.net/wfs",A;if("2.0.0"===this._version)for(d=v.getElementsByTagNameNS("http://www.opengis.net/ows/1.1",
"Operation"),m=0;m<d.length;m++)(k=d[m].attributes.getNamedItem("name"))&&"DescribeFeatureType"===k.value&&(A=d[m].getElementsByTagNameNS("http://www.opengis.net/ows/1.1","Get"),this.describeFeatureTypeUrl=A[0].attributes.getNamedItem("xlink:href").value),k&&"GetFeature"===k.value&&(c=d[m].getElementsByTagNameNS("http://www.opengis.net/ows/1.1","Post"),this.getFeatureUrl=c[0].attributes.getNamedItem("xlink:href").value);else if("1.1.0"===this._version)for(d=v.getElementsByTagNameNS("http://www.opengis.net/ows",
"Operation"),m=0;m<d.length;m++)(k=d[m].attributes.getNamedItem("name"))&&"DescribeFeatureType"===k.value&&(A=d[m].getElementsByTagNameNS("http://www.opengis.net/ows","Get"),this.describeFeatureTypeUrl=A[0].attributes.getNamedItem("xlink:href").value),k&&"GetFeature"===k.value&&(c=d[m].getElementsByTagNameNS("http://www.opengis.net/ows","Post"))&&c.length&&(this.getFeatureUrl=c[0].attributes.getNamedItem("xlink:href").value);else if("1.0.0"===this._version){var B=v.getElementsByTagNameNS(u,"DescribeFeatureType");
if(!B||!B.length){this.onError("WFSLayer: getCapabilities - no describeFeatureType info");return}A=B[0].getElementsByTagNameNS(u,"Get");this.describeFeatureTypeUrl=A[0].attributes.getNamedItem("onlineResource").value;var D=v.getElementsByTagNameNS(u,"GetFeature");if(!D||!D.length){this.onError("WFSLayer: getCapabilities - no GetFeature info");return}(c=D[0].getElementsByTagNameNS(u,"Post"))&&c.length&&(this.getFeatureUrl=c[0].attributes.getNamedItem("onlineResource").value)}this._nsLayerNames={};
a=[];var e=v.getElementsByTagNameNS(u,"FeatureTypeList");for(m=0;m<e.length;m++){var I=e[m].getElementsByTagNameNS(u,"FeatureType");for(f=0;f<I.length;f++){var r=I[f],t=r.getElementsByTagNameNS(u,"Name")[0],h=t.textContent,l=h.indexOf(":"),q=h.substring(0,l),z=h.substring(l+1),p=t.lookupNamespaceURI(q);null===p&&(p=t.lookupNamespaceURI(null));this._nsLayerNames[z]={prefix:q,namespace:p};var x=r.getElementsByTagNameNS(u,"Title"),E=0<x.length?x[0].textContent:"";""===E&&(E=z);this.spatialReferences=
this._readFactoryCodes(this._version,r);var C=this._readDefaultBBOX(this._version,r);a.push({name:z,title:E,spatialReferences:this.spatialReferences,extent:C})}}this._describeFeatureType();var y=this._getCapabilitiesCallback;y&&y(a)}else this.onError("WFSLayer: getCapabilities - document not recognized.")}}catch(S){this.onError("WFSLayer: getCapabilities - parsing error")}},_readFactoryCodes:function(a,d){var m,f=[];if("2.0.0"===a||"1.1.0"===a){a=d.getElementsByTagNameNS("*","DefaultSRS");this._addCodeList(f,
a[0]);a=d.getElementsByTagNameNS("*","DefaultCRS");this._addCodeList(f,a[0]);a=d.getElementsByTagNameNS("*","OtherSRS");for(m=0;m<a.length;m++)this._addCodeList(f,a[m]);a=d.getElementsByTagNameNS("*","OtherCRS");for(m=0;m<a.length;m++)this._addCodeList(f,a[m])}else"1.0.0"===a&&(a=d.getElementsByTagNameNS("*","SRS"),this._addCodeList(f,a[0]));for(d=!1;0<f.length;){4326===f[0]&&(d=!0);break}d||f.push(4326);return f},_addCodeList:function(a,d){d&&(d=d.textContent.match(/\d+/g),0<d.length&&(d=parseInt(d[d.length-
1],10),84===d&&(d=4326),a.push(d)))},_readDefaultBBOX:function(a,d){var m,f,k,c;if("2.0.0"===a||"1.1.0"===a){m=d.getElementsByTagNameNS("*","WGS84BoundingBox");if(!m[0]||!m[0].attributes)return[];f=m[0].getElementsByTagNameNS("*","LowerCorner");c=m[0].getElementsByTagNameNS("*","UpperCorner");if(0>=f.length||0>=c.length)return[];k=f[0].textContent;m=k.indexOf(" ");f=k.substring(0,m);k=k.substring(m+1);m=c[0].textContent;a=m.indexOf(" ");c=m.substring(0,a);m=m.substring(a+1)}else if("1.0.0"===a){m=
d.getElementsByTagNameNS("*","LatLongBoundingBox");if(!m[0]||!m[0].attributes)return[];f=m[0].attributes.getNamedItem("minx").value;k=m[0].attributes.getNamedItem("miny").value;c=m[0].attributes.getNamedItem("maxx").value;m=m[0].attributes.getNamedItem("maxy").value}f=parseFloat(f,10);k=parseFloat(k,10);c=parseFloat(c,10);m=parseFloat(m,10);return[f,k,c,m]},_describeFeatureType:function(a){if(""!==this._layerName)if(""===this.describeFeatureTypeUrl)this.onError("WFSLayer: invalid describeFeatureType url");
else if(""===this._wkid)this.onError("WFSLayer: invalid wkid");else if("snapshot"!==this._mode&&"onDemand"!==this._mode)this.onError("WFSLayer: invalid mode");else if(""===this._maxFeatures||0>this._maxFeatures||1E6<this._maxFeatures)this.onError("WFSLayer: invalid maxFeatures");else if(this._describeFeatureTypeCallback=a,a=q.trim(this.describeFeatureTypeUrl),""!==a){var d=a.indexOf("?"),d=this._checkForUrlInUrl(a,d),m="?"===a.charAt(a.length-1)?"":-1===d?"?":"\x26",f=this._nsLayerNames[this._layerName];
if(void 0===f)this.onError("WFSLayer: invalid layerName");else d=f.prefix,f=f.namespace,a=a+m+"service\x3dWFS\x26request\x3dDescribeFeatureType\x26version\x3d"+this._version,a+="\x26typeName\x3d",""!==d&&(a+=d+":"),a+=encodeURIComponent(this._layerName),""!==d&&(a+="\x26namespace\x3dxmlns("+d+"\x3d"+encodeURIComponent(f)+")"),a=this._appendCustomParameters(a),r({url:a,handleAs:"text",headers:{"Content-Type":null}},{usePost:!1}).then(this._describeFeatureTypeResponse,this._errorSupport)}},_describeFeatureTypeResponse:function(a){var d;
d=(new DOMParser).parseFromString(a,"text/xml");if(a=this._readExceptionReport(d,a))this.onError("WFSLayer: DescribeFeatureType - returns exception: "+a);else{this.fields=[];a=d.getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema","schema");for(d=0;d<a.length;d++){var m=this._readAllFields(a[d]);null!==m&&(this._layerDefinedGeometryType=m[0],this.fields=m[1])}this.geometryType&&""!==this.geometryType||(this.geometryType=this._layerDefinedGeometryType);for(d=0;d<this.fields.length;d++)a=this.fields[d],
"esriFieldTypeGeometry"===a.type&&(this._nsGeometryFieldName=a.name);this.layerNamespace=this._nsLayerNames[this._layerName].namespace;if(0===this.fields.length)this.onError("WFSLayer: DescribeFeatureType - can't get fields");else this._getFeature(),(d=this._describeFeatureTypeCallback)&&d(this.fields)}},_readAllFields:function(a){for(var d=a.childNodes,m=0;m<d.length;m++){var f=d[m];if("element"===f.localName){var k=f.attributes;if(k.name.value===this._layerName)return(d=k.type)?(f=d.value,d=f.indexOf(":"),
f=f.substring(d+1),this._readFieldsFromGlobalComplextType(a,f)):this._readFieldsFromLocalComplextType(f)}}return null},_readFieldsFromGlobalComplextType:function(a,d){a=a.childNodes;for(var m=0;m<a.length;m++){var f=a[m];if("complexType"===f.localName&&f.attributes.name.value===d)return this._readFieldsFromLocalComplextType(f)}return null},_readFieldsFromLocalComplextType:function(a){for(var d=[],m="esriGeometryComplex",f=a.getElementsByTagNameNS("http://www.w3.org/2001/XMLSchema","element"),k=0;k<
f.length;k++){var c=f[k],g="",v=c.attributes.getNamedItem("name");v&&(g=v.value);if(""!==g){var n=a="",b=c.attributes.getNamedItem("type"),v="unknown";if(null!==b){var n=b.value,u=n.indexOf(":");a=n.substring(0,u);n=n.substring(u+1);v=b.lookupNamespaceURI(a);null===v&&(v=b.lookupNamespaceURI(null))}if(""===n)for(var c=c.childNodes,A=0;A<c.length;A++)if(a=c[A],"simpleType"===a.localName){a=a.childNodes;for(A=0;A<a.length;A++)if(node2=a[A],"restriction"===node2.localName){b=node2.attributes.getNamedItem("base");
n=b.value;u=n.indexOf(":");a=n.substring(0,u);n=n.substring(u+1);break}if(""!==n)break}c="Unknown";switch(n){case "integer":case "nonPositiveInteger":case "negativeInteger":case "long":case "int":case "short":case "byte":case "nonNegativeInteger":case "unsignedLong":case "unsignedInt":case "unsignedShort":case "unsignedByte":case "positiveInteger":c="esriFieldTypeInteger";d.push({name:g,alias:g,type:c,wfsNamespace:v});break;case "float":case "double":case "decimal":c="esriFieldTypeDouble";d.push({name:g,
alias:g,type:c,wfsNamespace:v});break;case "boolean":case "string":case "gYearMonth":case "gYear":case "gMonthDay":case "gDay":case "gMonth":case "anyURI":case "QName":case "NOTATION":case "normalizedString":case "token":case "language":case "IDREFS":case "ENTITIES":case "NMTOKEN":case "NMTOKENS":case "Name":case "NCName":case "ID":case "IDREF":case "ENTITY":c="esriFieldTypeString";d.push({name:g,alias:g,type:c,wfsNamespace:v});break;case "duration":case "dateTime":case "time":case "date":c="esriFieldTypeDate";
d.push({name:g,alias:g,type:c,wfsNamespace:v});break;case "PointPropertyType":case "MultiPointPropertyType":c="esriFieldTypeGeometry";m="esriGeometryPoint";d.push({name:g,alias:g,type:c,wfsNamespace:v});break;case "MultiCurvePropertyType":case "MultiLineStringPropertyType":c="esriFieldTypeGeometry";m="esriGeometryPolyline";d.push({name:g,alias:g,type:c,wfsNamespace:v});break;case "MultiSurfacePropertyType":case "MultiPolygonPropertyType":c="esriFieldTypeGeometry";m="esriGeometryPolygon";d.push({name:g,
alias:g,type:c,wfsNamespace:v});break;case "GeometryPropertyType":case "MultiGeometryPropertyType":c="esriFieldTypeGeometry",m="esriGeometryComplex",d.push({name:g,alias:g,type:c,wfsNamespace:v})}}}return[m,d]},_getFeature:function(){var a;a="\x3c?xml version\x3d'1.0' encoding\x3d'utf-8'?\x3e\n\x3cGetFeature \n xmlns:xsi\x3d'http://www.w3.org/2001/XMLSchema-instance'\n xmlns:gml\x3d'http://www.opengis.net/gml'\n xmlns:ogc\x3d'http://www.opengis.net/ogc'\n xmlns:wfs\x3d'http://www.opengis.net/wfs'\n";
a="2.0.0"===this._version?a+" xmlns\x3d'http://www.opengis.net/wfs/2.0'\n":a+" xmlns\x3d'http://www.opengis.net/wfs'\n";var d=this._nsLayerNames[this._layerName];if(void 0===d)this.onError("WFSLayer: invalid layerName");else{var m=d.prefix,d=d.namespace;if("ondemand"===this._mode.toLowerCase()&&""===this._nsGeometryFieldName)this.onError("WFSLayer: GetFeature - can't use 'onDemand' mode as geometryFieldName is unknown.");else if(a+=" xmlns:"+m+"\x3d'"+d+"'\n",a="2.0.0"===this._version?a+(" version\x3d'"+
this._version+"' service\x3d'WFS' count\x3d'"+this._maxFeatures+"'\x3e\n"):a+(" version\x3d'"+this._version+"' service\x3d'WFS' maxFeatures\x3d'"+this._maxFeatures+"'\x3e\n"),a="2.0.0"===this._version?a+(" \x3cQuery typeNames\x3d'"+m+":"+this._layerName+"' srsName\x3d'EPSG:"+this._wkid+"'\x3e\n"):a+(" \x3cwfs:Query typeName\x3d'"+m+":"+this._layerName+"' srsName\x3d'EPSG:"+this._wkid+"'\x3e\n"),"ondemand"===this._mode.toLowerCase()&&(a=a+"  \x3cogc:Filter xmlns:ogc\x3d'http://www.opengis.net/ogc'\x3e\n   \x3cogc:BBOX\x3e\n"+
("    \x3cogc:PropertyName\x3e"+m+":"+this._nsGeometryFieldName+"\x3c/ogc:PropertyName\x3e\n"),a+="    \x3cgml:Box srsName\x3d'EPSG:"+this._wkid+"'\x3e\n",a=this._inverseFilter?a+"      \x3cgml:coordinates\x3e{ymin},{xmin} {ymax},{xmax}\x3c/gml:coordinates\x3e\n":a+"      \x3cgml:coordinates\x3e{xmin},{ymin} {xmax},{ymax}\x3c/gml:coordinates\x3e\n",a+="    \x3c/gml:Box\x3e\n   \x3c/ogc:BBOX\x3e\n  \x3c/ogc:Filter\x3e\n"),a="2.0.0"===this._version?a+" \x3c/Query\x3e\n":a+" \x3c/wfs:Query\x3e\n",this._getFeatureRequest=
a+"\x3c/GetFeature\x3e\n",""===this.getFeatureUrl)this.onError("WFSLayer: getFeature - server doesn't support POST method.");else if(""!==this._getFeatureRequest&&this._map&&null!==this._map.spatialReference.wkid){a=this._getFeatureRequest;if("ondemand"===this._mode.toLowerCase()){a=this._map.extent.xmin;var m=this._map.extent.ymin,d=this._map.extent.xmax,f=this._map.extent.ymax,k={},c=this._map.spatialReference,g=new G(this._wkid);this._projectFromSRToSR(c,g,a,m,k)&&(a=k.x,m=k.y);this._projectFromSRToSR(c,
g,d,f,k)&&(d=k.x,f=k.y);a=this._getFeatureRequest.replace(/{xmin}/,a).replace(/{ymin}/,m).replace(/{xmax}/,d).replace(/{ymax}/,f)}m=this._appendCustomParameters(this.getFeatureUrl);r({url:m,handleAs:"text",headers:{"Content-Type":"text/xml"},postData:a},{usePost:!0}).then(this._parseGml,this._errorSupport)}}},_parseGml:function(a){if(this._map&&this._map.spatialReference&&this._map.spatialReference.wkid){var d=(new DOMParser).parseFromString(a,"text/xml");if(a=this._readExceptionReport(d,a))this.onError("WFSLayer: GetFeature - returns exception: "+
a);else this._gmlNS="2.0.0"===this._version?"http://www.opengis.net/gml/3.2":"http://www.opengis.net/gml",""===this._wkid&&(this._wkid=this._map.spatialReference.wkid),this._graphicArray=this._readFeatureMembers(d,this._wkid,2,this._nsLayerNames[this._layerName].namespace,this._layerName),this.fullExtent=this._createFullExtent(this._graphicArray),this.onLabelingInfoChange(),"ondemand"===this._mode.toLowerCase()?this._fireUpdateEnd():this.refresh()}},_limit4326:function(a){for(var d=0;d<a.length;d++){var m=
a[d].geometry;4326===m.spatialReference.wkid&&(m.x=this._limit4326X(m.x),m.y=this._limit4326Y(m.y))}},_limit4326X:function(a){180<=a&&(a=179.99);-180>=a&&(a=-179.99);return a},_limit4326Y:function(a){90<=a&&(a=89.99);-90>=a&&(a=-89.99);return a},_createFullExtent:function(a){for(var d=null,m=0;m<a.length;m++){var f=a[m].geometry,k=null;(k="point"===f.geometryType?new c(f.x,f.y,f.x,f.y,f.spatialReference):f.getExtent())&&(d=null===d?k:d.union(k))}return d},_readExceptionReport:function(a,d){return 0<
a.getElementsByTagNameNS("*","ExceptionReport").length||0<a.getElementsByTagNameNS("*","ServiceExceptionReport").length?d:""},_readFeatureMembers:function(a,d,m,f,k){var c,g,v,n;g=this._readWkidFromNode(a);-1!=g&&(d=g);g=this._readSrsDimension(a);0!==g&&(m=g);var b=[];v=a.getElementsByTagNameNS("*","featureMembers");for(g=0;g<v.length;g++)for(c=v[g],n=c.getElementsByTagNameNS(f,k),0===n.length&&(n=c.getElementsByTagNameNS(null,k)),0===n.length&&(n=c.getElementsByTagNameNS("*",k)),c=0;c<n.length;c++)this._readLayer(b,
n[c],d,m);v=a.getElementsByTagNameNS("*","featureMember");for(g=0;g<v.length;g++)for(c=v[g],n=c.getElementsByTagNameNS(f,k),0===n.length&&(n=c.getElementsByTagNameNS(null,k)),0===n.length&&(n=c.getElementsByTagNameNS("*",k)),c=0;c<n.length;c++)this._readLayer(b,n[c],d,m);v=a.getElementsByTagNameNS("*","member");for(g=0;g<v.length;g++)for(c=v[g],n=c.getElementsByTagNameNS(f,k),0===n.length&&(n=c.getElementsByTagNameNS(null,k)),0===n.length&&(n=c.getElementsByTagNameNS("*",k)),c=0;c<n.length;c++)this._readLayer(b,
n[c],d,m);return b},_readLayer:function(a,d,m,f){var k,c;c=this._readSrsDimension(d);0!==c&&(f=c);var g=d.childNodes,v="",n=null;for(d=0;d<g.length;d++)if(k=g[d],1==k.nodeType&&(c=k.localName,"boundedBy"!==c)){k=this._readGeometry(k,m,f);if(!this._isProjectedOk){this._isProjectedOk=!0;console.error("WFSLayer: could not project geometry.");break}if(null!==k&&(n=k,v=c,"point"!==n.geometryType||"esriGeometryPolygon"!==this.geometryType&&"esriGeometryPolyline"!==this.geometryType))break}if(n){m={};for(d=
0;d<g.length;d++)if(k=g[d],c=k.localName,f=k.textContent,c!==v)for(k=0;k<this.fields.length;k++){var b=this.fields[k];b.name==c&&(m[c]="esriFieldTypeDouble"===b.type?parseFloat(f,10):"esriFieldTypeInteger"===b.type?parseInt(f,10):f.trim())}this._convertWFSGeometryToGraphicObjects(a,n,m)}},_convertWFSGeometryToGraphicObjects:function(a,d,m){var f;if("point"===d.geometryType&&("esriGeometryPoint"===this.geometryType||"esriGeometryComplex"===this.geometryType))f=new x,d=new n(d),f.setGeometry(d),f.setAttributes(m),
a.push(f);else if("multipoint"===d.geometryType&&("esriGeometryPoint"===this.geometryType||"esriGeometryComplex"===this.geometryType))f=new x,d=new D(d),f.setGeometry(d),f.setAttributes(m),a.push(f);else if("polyline"===d.geometryType&&("esriGeometryPolyline"===this.geometryType||"esriGeometryComplex"===this.geometryType))f=new x,d=new u(d),f.setGeometry(d),f.setAttributes(m),a.push(f);else if("polygon"===d.geometryType&&("esriGeometryPolygon"===this.geometryType||"esriGeometryComplex"===this.geometryType))f=
new x,d=new B(d),f.setGeometry(d),f.setAttributes(m),a.push(f);else if("multigeometry"===d.geometryType)for(f=0;f<d.length;f++)this._convertWFSGeometryToGraphicObjects(a,d[f],m)},_readGeometry:function(a,d,m){var f,k;f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(m=f);k=a.getElementsByTagNameNS(this._gmlNS,"MultiSurface");if(1<=k.length)for(f=0;f<k.length;)return this._readMultiSurface(k[f],d,m);k=a.getElementsByTagNameNS(this._gmlNS,"MultiCurve");if(1<=k.length){var c=
[];for(f=0;f<k.length;f++){var g=this._readMultiCurve(k[f],d,m);for(a=0;a<g.length;a++)c.push(g[a])}return{geometryType:"polyline",paths:c,spatialReference:{wkid:this._map.spatialReference.wkid}}}k=a.getElementsByTagNameNS(this._gmlNS,"MultiGeometry");for(f=0;f<k.length;)return this._readMultiGeometry(k[f],d,m);k=a.getElementsByTagNameNS(this._gmlNS,"Geometry");for(f=0;f<k.length;)return this._readGeometry(k[f],d,m);k=a.getElementsByTagNameNS(this._gmlNS,"GeometryCollection");for(f=0;f<k.length;)return this._readGeometryCollection(k[f],
d,m);k=a.getElementsByTagNameNS(this._gmlNS,"Surface");for(f=0;f<k.length;)return this._readSurface(k[f],d,m);k=a.getElementsByTagNameNS(this._gmlNS,"Curve");for(f=0;f<k.length;)return this._readCurve(k[f],d,m);k=a.getElementsByTagNameNS(this._gmlNS,"MultiPolygon");for(f=0;f<k.length;)return this._readMultiPolygon(k[f],d,m);k=a.getElementsByTagNameNS(this._gmlNS,"Polygon");for(f=0;f<k.length;)return this._readPolygon(k[f],d,m);k=a.getElementsByTagNameNS(this._gmlNS,"MultiLineString");for(f=0;f<k.length;)return this._readMultiLineString(k[f],
d,m);k=a.getElementsByTagNameNS(this._gmlNS,"LineString");for(f=0;f<k.length;){d=this._readLineString(k[f],d,m);m={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};f=[];for(a=0;a<d.length;a++)f.push(d[a]);m.paths.push(f);return m}k=a.getElementsByTagNameNS(this._gmlNS,"LinearRing");for(f=0;f<k.length;)return this._readLinearRing(k[f],d,m);k=a.getElementsByTagNameNS(this._gmlNS,"Box");if(1<=k.length)for(f=0;f<k.length;)return this._readBox(k[f],d,m);k=a.getElementsByTagNameNS(this._gmlNS,
"Envelope");for(f=0;f<k.length;)return this._readEnvelope(k[f],d,m);k=a.getElementsByTagNameNS(this._gmlNS,"MultiPoint");if(1<=k.length)for(f=0;f<k.length;)return this._readMultiPoint(k[f],d,m);k=a.getElementsByTagNameNS(this._gmlNS,"Point");for(f=0;f<k.length;)return this._readPoint(k[f],d,m);return null},_readGeometryCollection:function(a,d,m){var f,k=this._readWkidFromNode(a);-1!=k&&(d=k);k=this._readSrsDimension(a);0!==k&&(m=k);k=[];k.geometryType="multigeometry";k.spatialReference={wkid:this._map.spatialReference.wkid};
f=a.getElementsByTagNameNS(this._gmlNS,"geometryMember");for(a=0;a<f.length;a++){var c=this._readGeometryMember(f[a],d,m);k.push(c)}return k},_readMultiGeometry:function(a,d,m){var f,k=this._readWkidFromNode(a);-1!=k&&(d=k);k=this._readSrsDimension(a);0!==k&&(m=k);k=[];k.geometryType="multigeometry";k.spatialReference={wkid:this._map.spatialReference.wkid};f=a.getElementsByTagNameNS(this._gmlNS,"geometryMember");for(a=0;a<f.length;a++){var c=this._readGeometryMember(f[a],d,m);k.push(c)}return k},
_readSurface:function(a,d,m){var f,k;f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(m=f);var c=[];c.geometryType="multigeometry";c.spatialReference={wkid:this._map.spatialReference.wkid};k=a.getElementsByTagNameNS(this._gmlNS,"Point");for(f=0;f<k.length;f++)c.push(this._readPoint(k[f],d,m));k=a.getElementsByTagNameNS(this._gmlNS,"patches");for(f=0;f<k.length;f++){a=this._readPatches(k[f],d,m);for(var g=0;g<a.length;g++)c.push(a[g])}return c},_readMultiSurface:function(a,
d,m){var f,k,c;f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(m=f);var g=[];g.geometryType="multigeometry";g.spatialReference={wkid:this._map.spatialReference.wkid};c=a.getElementsByTagNameNS(this._gmlNS,"surfaceMember");for(f=0;f<c.length;f++){var v=this._readSurfaceMember(c[f],d,m);for(k=0;k<v.length;k++)g.push(v[k])}c=a.getElementsByTagNameNS(this._gmlNS,"surfaceMembers");for(f=0;f<c.length;f++)for(a=this._readSurfaceMembers(c[f],d,m),k=0;k<a.length;k++)g.push(a[k]);
return g},_readCurve:function(a,d,m){var f,k=this._readWkidFromNode(a);-1!=k&&(d=k);k=this._readSrsDimension(a);0!==k&&(m=k);k={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};f=a.getElementsByTagNameNS(this._gmlNS,"segments");for(a=0;a<f.length;a++)for(var c=this._readSegments(f[a],d,m),g=0;g<c.length;g++)k.paths.push(c[g]);return k},_readSegments:function(a,d,m){var f,k=this._readWkidFromNode(a);-1!=k&&(d=k);k=this._readSrsDimension(a);0!==k&&(m=k);k=[];
k.geometryType="multigeometry";k.spatialReference={wkid:this._map.spatialReference.wkid};f=a.getElementsByTagNameNS(this._gmlNS,"LineStringSegment");for(a=0;a<f.length;a++){var c=this._readLineStringSegment(f[a],d,m);k.push(c)}return k},_readLineStringSegment:function(a,d,m){var f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(m=f);for(a=a.getElementsByTagNameNS(this._gmlNS,"posList");0<a.length;)return this._readPosList(a[0],d,m)},_readMultiCurve:function(a,d,m){var f,
k,c,g;f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(m=f);var v=[];v.spatialReference={wkid:this._map.spatialReference.wkid};c=a.getElementsByTagNameNS(this._gmlNS,"curveMember");for(f=0;f<c.length;f++)for(g=this._readCurveMember(c[f],d,m),k=0;k<g.length;k++)v.push(g[k]);c=a.getElementsByTagNameNS(this._gmlNS,"curveMembers");for(f=0;f<c.length;f++)for(g=this._readCurveMembers(c[f],d,m),k=0;k<g.length;k++)v.push(g[k]);return v},_readGeometryMember:function(a,d,m){var f,
k;f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(m=f);k=a.getElementsByTagNameNS(this._gmlNS,"Point");for(f=0;f<k.length;)return this._readPoint(k[f],d,m);k=a.getElementsByTagNameNS(this._gmlNS,"LineString");for(f=0;f<k.length;){d=this._readLineString(k[f],d,m);m={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};f=[];for(a=0;a<d.length;a++)f.push(d[a]);m.paths.push(f);return m}k=a.getElementsByTagNameNS(this._gmlNS,"Polygon");
for(f=0;f<k.length;)return this._readPolygon(k[f],d,m);return null},_readSurfaceMember:function(a,d,m){var f,k=this._readWkidFromNode(a);-1!=k&&(d=k);k=this._readSrsDimension(a);0!==k&&(m=k);k=[];k.geometryType="multigeometry";k.spatialReference={wkid:this._map.spatialReference.wkid};f=a.getElementsByTagNameNS(this._gmlNS,"Polygon");for(a=0;a<f.length;a++){var c=this._readPolygon(f[a],d,m);k.push(c)}return k},_readSurfaceMembers:function(a,d,m){var f,k=this._readWkidFromNode(a);-1!=k&&(d=k);k=this._readSrsDimension(a);
0!==k&&(m=k);k=[];k.geometryType="multigeometry";k.spatialReference={wkid:this._map.spatialReference.wkid};f=a.getElementsByTagNameNS(this._gmlNS,"Polygon");for(a=0;a<f.length;a++){var c=this._readPolygon(f[a],d,m);k.push(c)}return k},_readCurveMember:function(a,d,m){var f,k=this._readWkidFromNode(a);-1!=k&&(d=k);k=this._readSrsDimension(a);0!==k&&(m=k);k=[];k.geometryType="multigeometry";k.spatialReference={wkid:this._map.spatialReference.wkid};f=a.getElementsByTagNameNS(this._gmlNS,"LineString");
for(a=0;a<f.length;a++){var c=this._readLineString(f[a],d,m);k.push(c)}return k},_readCurveMembers:function(a,d,m){var f,k=this._readWkidFromNode(a);-1!=k&&(d=k);k=this._readSrsDimension(a);0!==k&&(m=k);k=[];k.geometryType="multigeometry";k.spatialReference={wkid:this._map.spatialReference.wkid};f=a.getElementsByTagNameNS(this._gmlNS,"LineString");for(a=0;a<f.length;a++){var c=this._readLineString(f[a],d,m);k.push(c)}return k},_readBox:function(a,d,m){var f,k,c,g,v,n,b,u=this._readWkidFromNode(a);
-1!=u&&(d=u);u=this._readSrsDimension(a);0!==u&&(m=u);u={geometryType:"polygon",rings:[],spatialReference:{wkid:this._map.spatialReference.wkid}};k=a.getElementsByTagNameNS(this._gmlNS,"coordinates");for(f=0;f<k.length;f++)if(c=this._readCoordinates(k[f],d,m))return 1<=c.length&&(g=n=c[0][0],v=b=c[0][1]),1<=c.length&&(n=c[1][0],b=c[1][1]),u.rings.push([[g,v],[g,b],[n,b],[n,v],[g,v]]),u;k=a.getElementsByTagNameNS(this._gmlNS,"coord");return 2<=k.length?((a=this._readCoord(k[0],d,m))&&1<=a.length&&
(g=n=a[0][0],v=b=a[0][1]),(d=this._readCoord(k[1],d,m))&&1<=d.length&&(n=d[0][0],b=d[0][1]),u.rings.push([[g,v],[g,b],[n,b],[n,v],[g,v]]),u):null},_readEnvelope:function(a,d,c){var f,k,m,g;f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(c=f);k=a.getElementsByTagNameNS(this._gmlNS,"lowerCorner");for(f=0;f<k.length;f++){var v=this._readCoordinates(k[f],d,c);v&&(m=v[0])}k=a.getElementsByTagNameNS(this._gmlNS,"upperCorner");for(f=0;f<k.length;f++)(a=this._readCoordinates(k[f],
d,c))&&(g=a[0]);return m&&g?{geometryType:"polygon",rings:[[[m[0],m[1]],[m[0],g[1]],[g[0],g[1]],[g[0],m[1]],[m[0],m[1]]]],spatialReference:{wkid:this._map.spatialReference.wkid}}:null},_readPolygon:function(a,d,m){var f,k,c;f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(m=f);var g={geometryType:"polygon",rings:[],spatialReference:{wkid:this._map.spatialReference.wkid}};k=a.getElementsByTagNameNS(this._gmlNS,"outerBoundaryIs");for(f=0;f<k.length;f++)c=this._readOuterBoundaryIs(k[f],
d,m),g.rings.push(c);k=a.getElementsByTagNameNS(this._gmlNS,"innerBoundaryIs");for(f=0;f<k.length;f++)c=this._readInnerBoundaryIs(k[f],d,m),g.rings.push(c);k=a.getElementsByTagNameNS(this._gmlNS,"exterior");for(f=0;f<k.length;f++)c=this._readExterior(k[f],d,m),g.rings.push(c);k=a.getElementsByTagNameNS(this._gmlNS,"interior");for(f=0;f<k.length;f++)c=this._readInterior(k[f],d,m),g.rings.push(c);return g},_readPolygonMember:function(a,d,c){var f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);
0!==f&&(c=f);for(a=a.getElementsByTagNameNS(this._gmlNS,"Polygon");0<a.length;)return this._readPolygon(a[0],d,c);return null},_readMultiPolygon:function(a,d,c){var f,k=this._readWkidFromNode(a);-1!=k&&(d=k);k=this._readSrsDimension(a);0!==k&&(c=k);k=[];k.geometryType="multigeometry";k.spatialReference={wkid:this._map.spatialReference.wkid};f=a.getElementsByTagNameNS(this._gmlNS,"polygonMember");for(a=0;a<f.length;a++){var m=this._readPolygonMember(f[a],d,c);k.push(m)}return k},_readOuterBoundaryIs:function(a,
d,c){var f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(c=f);for(a=a.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<a.length;)return this._readLinearRing(a[0],d,c);return null},_readInnerBoundaryIs:function(a,d,c){var f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(c=f);for(a=a.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<a.length;)return this._readLinearRing(a[0],d,c);return null},_readExterior:function(a,d,c){var f=this._readWkidFromNode(a);
-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(c=f);for(a=a.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<a.length;)return this._readLinearRing(a[0],d,c);return null},_readInterior:function(a,d,c){var f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(c=f);for(a=a.getElementsByTagNameNS(this._gmlNS,"LinearRing");0<a.length;)return this._readLinearRing(a[0],d,c);return null},_readPatches:function(a,d,c){var f,k=this._readWkidFromNode(a);-1!=k&&(d=k);k=this._readSrsDimension(a);
0!==k&&(c=k);k=[];k.spatialReference={wkid:this._map.spatialReference.wkid};f=a.getElementsByTagNameNS(this._gmlNS,"PolygonPatch");for(a=0;a<f.length;a++)k.push(this._readPolygon(f[a],d,c));return k},_readLineString:function(a,d,c){var f,k,m,g,v;f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(c=f);var n=[];n.spatialReference={wkid:this._map.spatialReference.wkid};m=a.getElementsByTagNameNS(this._gmlNS,"coordinates");for(f=0;f<m.length;f++)if(g=this._readCoordinates(m[f],
d,c))for(k=0;k<g.length;k++)v=g[k],n.push(v);m=a.getElementsByTagNameNS(this._gmlNS,"coord");for(f=0;f<m.length;f++)if(g=this._readCoord(m[f],d,c))for(k=0;k<g.length;k++)v=g[k],n.push(v);m=a.getElementsByTagNameNS(this._gmlNS,"posList");for(f=0;f<m.length;f++)if(g=this._readPosList(m[f],d,c))for(k=0;k<g.length;k++)v=g[k],n.push(v);return n},_readLineStringMember:function(a,d,c){var f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(c=f);for(a=a.getElementsByTagNameNS(this._gmlNS,
"LineString");0<a.length;)return this._readLineString(a[0],d,c);return null},_readMultiLineString:function(a,d,c){var f,k=this._readWkidFromNode(a);-1!=k&&(d=k);k=this._readSrsDimension(a);0!==k&&(c=k);k={geometryType:"polyline",paths:[],spatialReference:{wkid:this._map.spatialReference.wkid}};f=a.getElementsByTagNameNS(this._gmlNS,"lineStringMember");for(a=0;a<f.length;a++){var m=this._readLineStringMember(f[a],d,c);m&&k.paths.push(m)}return 1<=k.paths.length?k:null},_readPoint:function(a,d,c){var f,
k,m;f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(c=f);k=a.getElementsByTagNameNS(this._gmlNS,"coordinates");for(f=0;f<k.length;f++)if(m=this._readCoordinates(k[f],d,c))return{geometryType:"point",x:m[0][0],y:m[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};k=a.getElementsByTagNameNS(this._gmlNS,"pos");for(f=0;f<k.length;f++)if((m=this._readPos(k[f],d,c))&&0<m.length)return{geometryType:"point",x:m[0][0],y:m[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};
k=a.getElementsByTagNameNS(this._gmlNS,"coord");for(f=0;f<k.length;f++)if(a=this._readCoord(k[f],d,c))return{geometryType:"point",x:a[0][0],y:a[0][1],spatialReference:{wkid:this._map.spatialReference.wkid}};return null},_readPointMember:function(a,d,c){var f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(c=f);for(a=a.getElementsByTagNameNS(this._gmlNS,"Point");0<a.length;)return this._readPoint(a[0],d,c);return null},_readMultiPoint:function(a,d,c){var f,k=this._readWkidFromNode(a);
-1!=k&&(d=k);k=this._readSrsDimension(a);0!==k&&(c=k);k={geometryType:"multipoint",points:[],spatialReference:{wkid:this._map.spatialReference.wkid}};f=a.getElementsByTagNameNS(this._gmlNS,"pointMember");for(a=0;a<f.length;a++){var m=this._readPointMember(f[a],d,c);m&&k.points.push([m.x,m.y])}return 1<=k.points.length?k:null},_readLinearRing:function(a,d,c){var f,k;f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(c=f);k=a.getElementsByTagNameNS(this._gmlNS,"coordinates");
for(f=0;f<k.length;)return this._readCoordinates(k[f],d,c);k=a.getElementsByTagNameNS(this._gmlNS,"posList");for(f=0;f<k.length;)return this._readCoordinates(k[f],d,c);k=a.getElementsByTagNameNS(this._gmlNS,"pos");for(f=0;f<k.length;)return this._readPos(k[f],d,c)},_readCoordinatesBody:function(a,d,c){var f,k=new G(a);d=d.trim();var g,m,v=[];v.spatialReference={wkid:this._map.spatialReference.wkid};a=this._isReverse(a,this.version);if(d)if(2===c){if((d=d.match(/[0123456789.\-\+eE]+/g))&&2<=d.length)for(c=
0;c<d.length;c+=2)g=parseFloat(d[c]),m=parseFloat(d[c+1]),a&&(f=m,m=g,g=f),f={},this._projectFromSRToSR(k,this._map.spatialReference,g,m,f)&&(g=f.x,m=f.y),v.push([g,m])}else if(3===c&&(d=d.match(/[0123456789.\-\+eE]+/g))&&3<=d.length)for(c=0;c<d.length;c+=3)g=parseFloat(d[c]),m=parseFloat(d[c+1]),a&&(f=m,m=g,g=f),f={},this._projectFromSRToSR(k,this._map.spatialReference,g,m,f)&&(g=f.x,m=f.y),v.push([g,m]);return v},_readCoord:function(a,d,c){var f,k,g,m,v=this._readWkidFromNode(a);-1!=v&&(d=v);v=
new G(d);g=this._readSrsDimension(a);0!==g&&(c=g);var n=this._isReverse(d,this.version),b=[];b.spatialReference={wkid:this._map.spatialReference.wkid};g=0;k=a.getElementsByTagNameNS(this._gmlNS,"X");for(f=0;f<k.length;){g=this._readFloat(k[f],d,c);break}m=0;k=a.getElementsByTagNameNS(this._gmlNS,"Y");for(f=0;f<k.length;){m=this._readFloat(k[f],d,c);break}n&&(a=m,m=g,g=a);a={};this._projectFromSRToSR(v,this._map.spatialReference,g,m,a)&&(g=a.x,m=a.y);b.push(n?[m,g]:[g,m]);return b},_readCoordinates:function(a,
d,c){var f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(c=f);return this._readCoordinatesBody(d,a.textContent,c)},_readPos:function(a,d,c){var f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(c=f);return this._readCoordinatesBody(d,a.textContent,c)},_readPosList:function(a,d,c){var f=this._readWkidFromNode(a);-1!=f&&(d=f);f=this._readSrsDimension(a);0!==f&&(c=f);return this._readCoordinatesBody(d,a.textContent,c)},_projectFromSRToSR:function(a,
d,c,f,k){if(A.canProject(a,d))return a=new n(c,f,a),d=A.project(a,d),k.x=d.x,k.y=d.y,!0;k.x=c;k.y=f;return this._isProjectedOk=!1},_readFloat:function(a){return(a=a.textContent)?parseFloat(a):0},_readSrsDimension:function(a){return a.attributes&&(a=a.attributes.getNamedItem("srsDimension"))?parseInt(a.value,10):0},_readWkidFromNode:function(a){return a.attributes&&(a=a.attributes.getNamedItem("srsName"))&&(a=a.value.match(/\d+/g))&&0<a.length?(a=parseInt(a[a.length-1],10),84===a&&(a=4326),parseInt(a,
10)):-1},_isReverse:function(a,d){return this._inverseResponse},_appendCustomParameters:function(a){if(this.customParameters)for(var d in this.customParameters)a+=(-1===a.indexOf("?")?"?":"\x26")+d+"\x3d"+encodeURIComponent(this.customParameters[d]);return a},_checkForUrlInUrl:function(a,d){var c=a.toLowerCase().lastIndexOf("http");-1<d&&c>d&&(-1<a.indexOf("?",c)||-1!==a.indexOf("\x26",c)||(d=-1));return d}});w("extend-esri")&&q.setObject("layers.WFSLayer",p,t);return p})},"widgets/AddData/search/SearchPane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/SearchPane.html dojo/i18n!../nls/strings ./SearchBox ./BBoxOption ./ScopeOptions ./TypeOptions ./SortOptions ./ResultsPane ./Paging ./ResultCount".split(" "),
function(p,h,q,l,e,w,b,r,t,x){return p([w,b,r],{i18n:x,templateString:t,qDefaultFilter:null,qRequiredFilter:null,searchOnStart:!0,searchContext:null,wabWidget:null,_dfd:null,postCreate:function(){this.inherited(arguments);q.forEach(this.getComponents(),function(b){b.searchPane=this},this)},startup:function(){this._started||(this.inherited(arguments),this.bindEvents(),this.searchOnStart&&this.search())},_onFilterPlaceholderChanged:function(){e.contains(this.filterPlaceholder,"opened")?(e.remove(this.filterPlaceholder,
"opened"),e.remove(this.filterWrapper,"show")):(this.filterWrapper.style.top=this.headerNode.clientHeight+"px",e.add(this.filterPlaceholder,"opened"),e.add(this.filterWrapper,"show"))},_onSearchBoxPlaceholderChanged:function(){},bindEvents:function(){this.own(l(this.filterPlaceholder,"click",h.hitch(this,this._onFilterPlaceholderChanged)))},buildQueryParams:function(b){var e=null;"string"===typeof this.qRequiredFilter&&0<this.qRequiredFilter.length&&(e=this.qRequiredFilter);var r={q:e,canSortByRelevance:!1};
q.forEach(this.getComponents(),function(e){e.appendQueryParams(r,b)});delete r.canSortByRelevance;null===r.q&&"string"===typeof this.qDefaultFilter&&0<this.qDefaultFilter.length&&(r.q=this.qDefaultFilter);return r},getComponents:function(){return[this.searchBox,this.bboxOption,this.scopeOptions,this.typeOptions,this.sortOptions,this.resultsPane,this.paging,this.resultCount]},resize:function(){this.contentNode.style.top=this.headerNode.clientHeight+1+"px"},search:function(){var b=this,e={},r=this.buildQueryParams(e);
if(null!==r&&null!==r.q){r&&null===r.sortField&&(r.sortOrder="desc");var t=this.searchContext.portal;e.scopeIsArcGISOnline&&this.searchContext.arcgisOnlinePortal&&(t=this.searchContext.arcgisOnlinePortal);null!==this._dfd&&this._dfd.cancel("Search aborted.",!1);var h=null;this._dfd=h=t.queryItems(r).then(function(e){h.isCanceled()||(e.queryParams||(e.queryParams={start:e.start,num:e.num},e.nextQueryParams||"undefined"===typeof e.nextStart||-1===e.nextStart||(e.nextQueryParams={start:e.nextStart})),
q.forEach(b.getComponents(),function(b){b.processResults(e)}))}).otherwise(function(b){console.warn("searchError",b)})}},_showLayers:function(){this.wabWidget&&this.wabWidget.showLayers()}})})},"widgets/AddData/search/SearchBox":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/keys ./SearchComponent dojo/text!./templates/SearchBox.html dojo/i18n!../nls/strings".split(" "),function(p,h,q,l,e,w,b){return p([e],{i18n:b,templateString:w,postCreate:function(){this.inherited(arguments);
this._checkClearButton();this.own(q(this.searchTextBox,"keyup",h.hitch(this,function(b){this._checkClearButton();b.keyCode===l.ENTER&&this.search()})))},_checkClearButton:function(){},clearButtonClicked:function(){this.searchTextBox.value="";this._checkClearButton();this.search()},searchButtonClicked:function(){this.search()},appendQueryParams:function(b){var e=this.searchTextBox.value;null!==e&&(e=h.trim(e));null!==e&&0<e.length&&(b.canSortByRelevance=!0,e="("+e+")",b.q=null!==b.q&&0<b.q.length?
b.q+(" AND "+e):e)}})})},"widgets/AddData/search/SearchComponent":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin"],function(p,h,q,l){return p([h,q,l],{isSearchComponent:!0,searchPane:null,template:"\x3cdiv\x3e\x3c/div\x3e",postCreate:function(){this.inherited(arguments)},appendQueryParams:function(e,h){},processResults:function(e){},getConfig:function(){return this.searchPane&&this.searchPane.wabWidget&&this.searchPane.wabWidget.config?
this.searchPane.wabWidget.config:{}},getMap:function(){return this.searchPane&&this.searchPane.wabWidget?this.searchPane.wabWidget.map:null},search:function(){this.searchPane&&this.searchPane.search()}})})},"widgets/AddData/search/BBoxOption":function(){define(["dojo/_base/declare","./SearchComponent","dojo/text!./templates/BBoxOption.html","dojo/i18n!../nls/strings","dijit/form/CheckBox"],function(p,h,q,l){return p([h],{i18n:l,templateString:q,postCreate:function(){this.inherited(arguments);this.bboxToggle.set("checked",
!0)},bboxClicked:function(){this.search()},_getBBox:function(){var e;if(e=this.getMap())if(e=e.geographicExtent)return e.xmin+","+e.ymin+","+e.xmax+","+e.ymax;return null},appendQueryParams:function(e){if(this.bboxToggle.get("checked")){var h=this._getBBox();null!==h&&(e.canSortByRelevance=!0,e.bbox=h)}}})})},"widgets/AddData/search/ScopeOptions":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-class ./SearchComponent dojo/text!./templates/ScopeOptions.html dojo/i18n!../nls/strings ./util".split(" "),
function(p,h,q,l,e,w,b,r){return p([e],{i18n:b,templateString:w,curatedFilter:null,postCreate:function(){this.inherited(arguments)},startup:function(){this._started||(this.inherited(arguments),this.initOptions())},hideDropdown:function(){l.remove(this.scopePlaceholder,"opened");l.remove(this.btnGroup,"show")},initOptions:function(){var e=this.searchPane.searchContext,q="string"===typeof e.username&&0<e.username.length,p=this.getConfig().scopeOptions;this.curatedFilter=p.Curated.filter;var z=null,
e=function(e,t){var l=p[e];l&&l.allow?("string"===typeof l.label&&0<h.trim(l.label).length?r.setNodeText(t,h.trim(l.label)):q||"MyOrganization"!==e||r.setNodeText(t,b.search.scopeOptions.anonymousContent),p.defaultScope===e&&(z=t)):t.style.display="none"};e("MyContent",this.MyContentToggle);e("MyOrganization",this.MyOrganizationToggle);e("Curated",this.CuratedToggle);e("ArcGISOnline",this.ArcGISOnlineToggle);z||(p.MyOrganization.allow?z=this.MyOrganizationToggle:p.ArcGISOnline.allow?z=this.ArcGISOnlineToggle:
p.Curated.allow?z=this.CuratedToggle:p.MyContent.allow&&(z=this.MyContentToggle));z&&(l.add(z,"active"),this.scopePlaceholderText.innerHTML=z.innerHTML)},optionClicked:function(b){this.toggleClassName(b);this.hideDropdown();this.search()},scopePlaceholderClicked:function(b){b.preventDefault();l.contains(this.scopePlaceholder,"opened")?this.hideDropdown():this.showDropdown()},showDropdown:function(){l.add(this.scopePlaceholder,"opened");l.add(this.btnGroup,"show")},toggleClassName:function(b){q.forEach(this.btnGroup.children,
function(b){l.remove(b,"active")});l.add(b.target,"active");this.scopePlaceholderText.innerHTML=b.target.innerHTML},appendQueryParams:function(b,e){var h=null;q.some(this.btnGroup.children,function(b){if(l.contains(b,"active"))return h=b.getAttribute("data-option-name"),!0});"undefined"===typeof h&&(h=null);var t=null,p=this.curatedFilter,x=this.searchPane.searchContext,w=x.username,C=x.orgId;"MyContent"===h?"string"===typeof w&&0<w.length&&(t="(owner:"+r.escapeForLucene(w)+")"):"MyOrganization"===
h?"string"===typeof C&&0<C.length&&(t="(orgid:"+r.escapeForLucene(C)+")"):"Curated"===h?"string"===typeof p&&0<p.length&&(t=p):"ArcGISOnline"===h&&x.allowArcGISOnline&&(e.scopeIsArcGISOnline=!0);null!==t&&0<t.length&&(t="("+t+")",b.q=null!==b.q&&0<b.q.length?b.q+(" AND "+t):t)}})})},"widgets/AddData/search/TypeOptions":function(){define("dojo/_base/declare dojo/_base/array dojo/_base/lang dojo/on ./SearchComponent dojo/text!./templates/TypeOptions.html dojo/i18n!../nls/strings esri/layers/VectorTileLayer dijit/TooltipDialog dijit/form/DropDownButton jimu/dijit/CheckBox".split(" "),
function(p,h,q,l,e,w,b,r){return p([e],{i18n:b,templateString:w,postCreate:function(){this.inherited(arguments);r&&r.supported()||(console.warn("AddData: Vector Tile is not supported."),this.vectorTileNode.style.display="none");this.own(l(this.tooltipDialog,"open",q.hitch(this,function(){this.tooltipDialog.domNode.className+=" "+this.searchPane.wabWidget.appConfig.theme.name})));this.own(l(this.mapServiceToggle,"change",q.hitch(this,function(){this.search()})));this.own(l(this.featureServiceToggle,
"change",q.hitch(this,function(){this.search()})));this.own(l(this.imageServiceToggle,"change",q.hitch(this,function(){this.search()})));this.own(l(this.vectorTileServiceToggle,"change",q.hitch(this,function(){this.search()})));this.own(l(this.kmlToggle,"change",q.hitch(this,function(){this.search()})));this.own(l(this.wmsToggle,"change",q.hitch(this,function(){this.search()})));this.own(l(this.wfsToggle,"change",q.hitch(this,function(){this.search()})))},getOptionWidgets:function(){return[this.mapServiceToggle,
this.featureServiceToggle,this.imageServiceToggle,this.vectorTileServiceToggle,this.kmlToggle,this.wmsToggle,this.wfsToggle]},optionClicked:function(){},appendQueryParams:function(b){var e=function(b,e){0<b.length&&(b+=" OR ");return b+e},r="",l="",t=!1;h.forEach(this.getOptionWidgets(),function(b){var h=b.domNode.getAttribute("data-option-q");l=e(l,h);b.getValue()&&(r=e(r,h),t=!0)});t||(r=l);null!==r&&0<r.length&&(r="("+r+")",b.q=null!==b.q&&0<b.q.length?b.q+(" AND "+r):r)}})})},"esri/layers/VectorTileLayer":function(){(function(){var p=
function(){var h;try{h=window.WebGLRenderingContext}catch(t){h=!1}var l;try{for(var e=document.createElement("canvas"),p=["webgl","experimental-webgl","webkit-3d","moz-webgl"],b=null,r=0;r<p.length;++r){try{b=e.getContext(p[r])}catch(t){}if(b)break}l=b}catch(t){l=!1}return h&&l?!0:!1}(),h=["dojo/_base/lang","dojo/has","dojo/Deferred","../sniff","./layer"];p&&h.push("./VectorTileLayerImpl");define(h,function(h,l,e,w,b,r){b=r?r:b.createSubclass({declaredClass:"esri.layers.VectorTileLayer",constructor:function(){var b=
new e;b.reject(Error("esri.layers.VectorTileLayer is not supported"));b.promise.otherwise(h.hitch(this,function(b){this._errorHandler(b)}))}});b.ACCESS_TOKEN=null;b.supported=function(){return p};l("extend-esri")&&h.setObject("layers.VectorTileLayer",b,w);return b})})()},"widgets/AddData/search/SortOptions":function(){define("dojo/_base/declare dojo/on dojo/dom-class ./SearchComponent dojo/text!./templates/SortOptions.html dojo/i18n!../nls/strings dijit/form/Select".split(" "),function(p,h,q,l,e,
w){return p([l],{i18n:w,templateString:e,sortField:null,sortOrder:null,postCreate:function(){this.inherited(arguments);this.updateSortOrderButton();var b=this;this.own(this.sortSelect.on("change",function(){var e=b.sortField=b.sortSelect.get("value");if(""===e)b.sortOrder=null;else if("title"===e||"owner"===e)b.sortOrder="asc";else if("avgrating"===e||"numviews"===e||"modified"===e)b.sortOrder="desc";b.updateSortOrderButton();b.search()}));this.own(h(this.sortSelect.dropDown,"open",function(){var b=
this.domNode.parentElement;b&&q.add(b,"add-data-widget-popup")}))},sortOrderClicked:function(){"asc"===this.sortOrder?(this.sortOrder="desc",this.updateSortOrderButton(),this.search()):"desc"===this.sortOrder&&(this.sortOrder="asc",this.updateSortOrderButton(),this.search())},updateSortOrderButton:function(){var b=this.sortOrderBtn;b.style.visibility=null!==this.sortField&&0<this.sortField.length?"visible":"hidden";"desc"===this.sortOrder?q.add(b,"descending"):q.remove(b,"descending")},appendQueryParams:function(b){b.sortField=
null;b.sortOrder=null;var e=this.sortField,h=this.sortOrder;null!==e&&0<e.length?(b.sortField=e,null!==h&&0<h.length&&(b.sortOrder=h)):b.canSortByRelevance||(b.sortField="numviews",b.sortOrder="desc")}})})},"widgets/AddData/search/ResultsPane":function(){define("dojo/_base/declare dojo/_base/array ./SearchComponent dojo/text!./templates/ResultsPane.html dojo/i18n!../nls/strings ./ItemCard ./util".split(" "),function(p,h,q,l,e,w,b){return p([q],{i18n:e,templateString:l,postCreate:function(){this.inherited(arguments)},
addItem:function(b){b.placeAt(this.itemsNode)},destroyItems:function(){this.noMatchNode.style.display="none";this.noMatchNode.innerHTML="";this.destroyDescendants(!1)},showNoMatch:function(){b.setNodeText(this.noMatchNode,e.search.resultsPane.noMatch);this.noMatchNode.style.display="block"},processResults:function(e){this.destroyItems();var r=e.results;if(r&&0<r.length){var l=b.findLayersAdded(this.getMap(),null).itemIds;h.forEach(e.results,function(b){this.addItem(new w({item:b,canRemove:-1!==l.indexOf(b.id),
resultsPane:this}))},this)}else this.showNoMatch()}})})},"widgets/AddData/search/ItemCard":function(){define("dojo/_base/declare dojo/_base/array dojo/date/locale dojo/dom-class dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemCard.html dojo/i18n!../nls/strings ./util ./LayerLoader".split(" "),function(p,h,q,l,e,w,b,r,t,x,E){return p([e,w,b],{i18n:t,templateString:r,canRemove:!1,item:null,resultsPane:null,_dfd:null,postCreate:function(){this.inherited(arguments)},
startup:function(){this._started||(this.inherited(arguments),this.render())},addClicked:function(){var b=this,e=this.addButton;if(!l.contains(e,"disabled"))if(l.add(e,"disabled"),this.canRemove){var r=this.resultsPane.getMap();x.setNodeText(b.messageNode,t.search.item.messages.removing);var p=x.findLayersAdded(r,this.item.id).layers;h.forEach(p,function(b){r.removeLayer(b)});this.canRemove=!1;x.setNodeText(b.messageNode,"");x.setNodeText(this.addButton,t.search.item.actions.add);l.remove(e,"disabled")}else x.setNodeText(b.messageNode,
t.search.item.messages.adding),(new E).addItem(this.item,this.resultsPane.getMap()).then(function(h){h?(b.canRemove=!0,x.setNodeText(b.messageNode,""),x.setNodeText(b.addButton,t.search.item.actions.remove)):x.setNodeText(b.messageNode,t.search.item.messages.addFailed);l.remove(e,"disabled")}).otherwise(function(h){console.warn("Add layer failed.");console.warn(h);x.setNodeText(b.messageNode,t.search.item.messages.addFailed);l.remove(e,"disabled");h&&"string"===typeof h.message&&0<h.message.length&&
console.log("")})},detailsClicked:function(){var b=this.item,b=x.checkMixedContent(b.portalUrl)+"/home/item.html?id\x3d"+encodeURIComponent(b.id);window.open(b)},formatDate:function(b){"number"===typeof b&&(b=new Date(b));return q.format(b,{selector:"date",datePattern:t.search.item.dateFormat})},render:function(){x.setNodeText(this.titleNode,this.item.title);x.setNodeTitle(this.titleNode,this.item.title);this._renderThumbnail();this._renderTypeOwnerDate();this.canRemove&&x.setNodeText(this.addButton,
t.search.item.actions.remove)},_renderThumbnail:function(){var b=this.thumbnailNode,e=this.item.thumbnailUrl;b.innerHTML="";var e=x.checkMixedContent(e),h=document.createElement("IMG");h.src=e||"widgets/AddData/images/placeholder_120x80.png";b.appendChild(h)},_renderTypeOwnerDate:function(){var b,e=this.item;b=t.search.item.types[e.type];if("undefined"===typeof b||null===b)b=e.type;b=t.search.item.typeByOwnerPattern.replace("{type}",b);b=b.replace("{owner}",e.owner);x.setNodeText(this.typeByOwnerNode,
b)}})})},"widgets/AddData/search/LayerLoader":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/promise/all dojo/Deferred dojo/json dojo/i18n!../nls/strings ./util esri/lang esri/request esri/arcgis/utils esri/layers/ArcGISDynamicMapServiceLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISTiledMapServiceLayer esri/layers/DynamicLayerInfo esri/layers/FeatureLayer esri/layers/ImageParameters esri/layers/ImageServiceParameters esri/layers/KMLLayer esri/layers/LayerDrawingOptions esri/layers/MosaicRule esri/layers/RasterFunction esri/layers/VectorTileLayer esri/layers/WFSLayer esri/layers/WMSLayer esri/layers/WMSLayerInfo esri/dijit/PopupTemplate esri/InfoTemplate esri/renderers/jsonUtils esri/geometry/Extent esri/SpatialReference jimu/utils".split(" "),
function(p,h,q,l,e,w,b,r,t,x,E,z,H,y,F,C,G,A,c,n,D,u,B,I,g,a,d,m,f,k,J,K){return p(null,{item:null,itemUrl:null,map:null,serviceUrl:null,constructor:function(a){h.mixin(this,a)},addItem:function(a,d){var f=new e;this.map=d;this.item=a;this.itemUrl=this._checkMixedContent(a.itemUrl);this.serviceUrl=this._checkMixedContent(a.url);if("Feature Service"===a.type)return this._addFeatureService();if("Image Service"===a.type)return this._addImageService();if("KML"===a.type)return this._addKML();if("Map Service"===
a.type)return this._addMapService();if("Vector Tile Service"===a.type)return this._addVectorTileService();if("WFS"===a.type)return this._addWFS();if("WMS"===a.type)return this._addWMS();console.warn("Unsupported item type: ",a.type);f.resolve(null);return f},_addFeatureService:function(){var a=this,d=new e,f=this.serviceUrl,c=this.item,k={},g=null,m=[],b=[];a._readItemJsonData().then(function(d){(k=d||{},k.layers)&&0<k.layers.length&&q.forEach(k.layers,function(a){"undefined"!==typeof a.id&&null!==
a.id&&(null===g&&(g=[]),g.push(a.id))});return a._readRestInfo(f)}).then(function(d){if(!d||"string"!==typeof d.type||"Feature Layer"!==d.type&&"Table"!==d.type){var c=[];d&&d.layers&&0<d.layers.length&&q.forEach(d.layers,function(a){c.push(a)});d&&d.tables&&0<d.tables.length&&q.forEach(d.tables,function(a){c.push(a)});0<c.length?q.forEach(c,function(d){var c=!0;null!==g&&0<g.length&&(c=q.some(g,function(a){return a===d.id}));c&&(c=new C(f+"/"+d.id,{id:a._generateLayerId(),outFields:["*"]}),m.push(a._waitForLayer(c)))}):
console.warn("No layers or tables...")}else d=new C(f,{id:a._generateLayerId(),outFields:["*"]}),m.push(a._waitForLayer(d));return l(m)}).then(function(a){q.forEach(a,function(a){b.push(a)});b.reverse();return b}).then(function(){q.forEach(b,function(d){var f=a._processFeatureLayer(d,c,k);d.arcgisProps={title:f.title};d._titleForLegend=f.title;t.isDefined(d.title)||(d.title=f.title);a._addLayer(d)})}).then(function(){d.resolve(b)}).otherwise(function(a){d.reject(a)});return d},_addImageService:function(){var a=
this,d=new e;a._readItemJsonData().then(function(d){return a._newImageServiceLayer(d||{})}).then(function(f){a._addLayer(f);d.resolve(f)}).otherwise(function(a){d.reject(a)});return d},_addKML:function(){var a=this,d=new e;a._newKMLLayer().then(function(f){f&&(f.title=a.item.title);a._addLayer(f);d.resolve(f)}).otherwise(function(a){d.reject(a)});return d},_addMapService:function(){var a=this,d=new e;a._readItemJsonData().then(function(d){return a._newMapServiceLayer(d||{})}).then(function(f){a._addLayer(f);
d.resolve(f)}).otherwise(function(a){d.reject(a)});return d},_addVectorTileService:function(){var a=this,d=new e;a._newVectorTileLayer().then(function(f){a._addLayer(f);d.resolve(f)}).otherwise(function(a){d.reject(a)});return d},_addWFS:function(){var a=this,d=new e;a._readItemJsonData().then(function(d){return a._newWFSLayer(d||{})}).then(function(f){f&&(f.title=a.item.title);a._addLayer(f);d.resolve(f)}).otherwise(function(a){console.log("Error adding WFS",a);d.reject(a)});return d},_addWMS:function(){var a=
this,d=new e;a._readItemJsonData().then(function(d){return a._newWMSLayer(d||{})}).then(function(f){f&&(f.title=a.item.title);a._addLayer(f);d.resolve(f)}).otherwise(function(a){d.reject(a)});return d},_addLayer:function(a){var d=this.item;a&&(a.xtnItemId=d.id,a.xtnAddData=!0,!a.arcgisProps&&d&&(a.arcgisProps={title:d.title},a._titleForLegend=d.title),t.isDefined(a.title)||(a.title=d.title),a._wabProperties={itemLayerInfo:{itemId:d.id,itemUrl:this.itemUrl,portalUrl:d.portalUrl}},this.map.addLayer(a))},
_checkMixedContent:function(a){return r.checkMixedContent(a)},_checkUrl:function(a){return E._checkUrl(a)},_checkVectorTileUrl:function(a,d){var f=new e;if(function(a,d){return-1!==a.indexOf(d,a.length-d.length)}(a,".json"))return d.styleUrl=a,f.resolve(a),f;var c={url:null,content:{},handleAs:"json",callbackParamName:"callback"};this.itemUrl?(c.url=this.itemUrl+"/resources/styles/root.json",x(c,{}).then(function(){d.styleUrl=c.url;f.resolve(c.url)}).otherwise(function(){c.url=a+"/resources/styles/root.json";
x(c,{}).then(function(){d.styleUrl=c.url;f.resolve(c.url)}).otherwise(function(){d.url=a;f.resolve(a)})})):(c.url=a+"/resources/styles/root.json",x(c,{}).then(function(){d.styleUrl=c.url;f.resolve(c.url)}).otherwise(function(){d.url=a;f.resolve(a)}));return f},_generateLayerId:function(){return this._generateLayerIds(1)[0]},_generateLayerIds:function(a){var d,f=[];for(d=0;d<a;d++)f.push(this._generateRandomId());return f},_generateRandomId:function(){var a=null,a="function"===typeof Date.now?Date.now():
(new Date).getTime(),d=(""+Math.random()).replace("0.","r");return(a+""+d).replace(/-/g,"")},_makeFeatureLayerTitle:function(a,d,f){var c,k,g;try{if(d&&f&&d===f||d&&f&&(c=f.indexOf(d),0===c&&(k=f.substring(c+d.length+1),13<=k.length&&(g=/^\d+$/,g.test(k)))))return d}catch(R){}return a.replace("{serviceName}",d).replace("{layerName}",f)},_newImageServiceLayer:function(a){var f=new e,c=this._generateLayerId(),k=this.serviceUrl,g={mapLayerId:c,bandIds:null,format:null,compressionQuality:null,opacity:1,
visibility:!0};t.isDefined(a.visibility)&&!1===a.visibility&&(g.visibility=!1);t.isDefined(a.opacity)&&(g.opacity=a.opacity);t.isDefined(a.minScale)&&!t.isDefined(g.minScale)&&(g.minScale=a.minScale);t.isDefined(a.maxScale)&&!t.isDefined(g.maxScale)&&(g.maxScale=a.maxScale);t.isDefined(a.refreshInterval)&&!t.isDefined(g.refreshInterval)&&(g.refreshInterval=a.refreshInterval);!a.popupInfo||g.popupInfo||g.disablePopup||(g.popupInfo=a.popupInfo);a.renderingRule&&!g.renderingRule&&(g.renderingRule=a.renderingRule,
a.renderingRule.functionName&&(g.renderingRule.rasterFunction=a.renderingRule.functionName));a.bandIds&&!g.bandIds&&(g.bandIds=a.bandIds);a.mosaicRule&&!g.mosaicRule&&(g.mosaicRule=a.mosaicRule);a.format&&!g.format&&(g.format=a.format);t.isDefined(a.compressionQuality)&&!t.isDefined(g.compressionQuality)&&(g.compressionQuality=a.compressionQuality);!a.layerDefinition||!a.layerDefinition.definitionExpression||t.isDefined(g.layerDefinition)&&t.isDefined(g.layerDefinition.definitionExpression)||(g.layerDefinition=
g.layerDefinition||{},g.layerDefinition.definitionExpression=a.layerDefinition.definitionExpression);a=new A;null!==g.bandIds&&(a.bandIds=g.bandIds);null!==g.format&&(a.format=g.format,null!==g.compressionQuality&&(a.compressionQuality=g.compressionQuality));g.renderingRule&&g.renderingRule.rasterFunction&&(c=new u(g.renderingRule),a.renderingRule=c);g.mosaicRule&&(c=new D(g.mosaicRule),a.mosaicRule=c);t.isDefined(g.noData)&&(a.noData=g.noData);t.isDefined(g.noDataInterpretation)&&(a.noDataInterpretation=
g.noDataInterpretation);t.isDefined(g.interpolation)&&(a.interpolation=g.interpolation);a={imageServiceParameters:a,opacity:g.opacity,visible:g.visibility};t.isDefined(g.mapLayerId)&&(a.id=g.mapLayerId);t.isDefined(g.minScale)&&(a.minScale=g.minScale);t.isDefined(g.maxScale)&&(a.maxScale=g.maxScale);t.isDefined(g.refreshInterval)&&(a.refreshInterval=g.refreshInterval);t.isDefined(g.resourceInfo)&&(a.resourceInfo=g.resourceInfo);k=new H(this._checkUrl(k),a);this._waitForLayer(k).then(function(a){g.layerDefinition&&
g.layerDefinition.definitionExpression&&a.setDefinitionExpression(g.layerDefinition.definitionExpression,!0);!g.disablePopup&&g.popupInfo&&a.setInfoTemplate(new d(g.popupInfo));f.resolve(a)},function(a){f.reject(a)});return f},_newInfoTemplate:function(a,f){if(a)try{return new d({description:a.description,title:a.title,showAttachments:a.showAttachments,fieldInfos:a.fieldInfos,mediaInfos:a.mediaInfos})}catch(M){console.error(M)}a=new m;t.isDefined(f)&&a.setTitle(f);return a},_newKMLLayer:function(){var a=
{id:this._generateLayerId()},a=new c(this.serviceUrl,a);return this._waitForLayer(a)},_newMapServiceLayer:function(a){var d=this,f=new e,c=this.serviceUrl,g=this._generateLayerId();x({url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{}).then(function(k){var m=null,m={id:g};if(k.tileInfo)m=new y(c,m);else if(k&&k.supportedImageFormatTypes&&-1!==k.supportedImageFormatTypes.indexOf("PNG32")&&(m.imageParameters=new G,m.imageParameters.format="png32"),m=new z(c,m),a&&a.layers&&0<
a.layers.length){var b=[],e,v=[],u,A=[],B;q.forEach(a.layers,function(d){d.layerDefinition&&d.layerDefinition.definitionExpression&&(b[d.id]=d.layerDefinition.definitionExpression);if(d.layerDefinition&&d.layerDefinition.source){e=null;B=d.layerDefinition.source;if("mapLayer"===B.type){var f=q.filter(k.layers,function(a){return a.id===B.mapLayerId});f.length&&(e=h.mixin(f[0],d))}else e=h.mixin({},d);e&&(e.source=B,delete e.popupInfo,e=new F(e),a.visibleLayers&&(f="string"===typeof a.visibleLayers?
a.visibleLayers.split(","):a.visibleLayers,-1<q.indexOf(f,d.id)?e.defaultVisibility=!0:e.defaultVisibility=!1),v.push(e))}d.layerDefinition&&d.layerDefinition.source&&d.layerDefinition.drawingInfo&&(u=new n(d.layerDefinition.drawingInfo),A[d.id]=u)});0<b.length&&m.setLayerDefinitions(b);0<v.length&&(m.setDynamicLayerInfos(v,!0),0<A.length&&m.setLayerDrawingOptions(A,!0))}d._waitForLayer(m).then(function(c){var g=null;q.forEach(c.layerInfos,function(f){var c=null;a&&q.some(a.layers,function(a){if(f.id===
a.id)return c=a,!0});var k=null;c&&c.popupInfo&&(k=c.popupInfo);k&&(null===g&&(g={}),g[f.id]={infoTemplate:d._newInfoTemplate(k,f.name)})});null===c.infoTemplates&&(g?c.infoTemplates=g:d._setDynamicLayerInfoTemplates(c));f.resolve(c)},function(a){f.reject(a)})},function(a){f.reject(a)});return f},_getVisibleFeatureLayers:function(a,d){if(!a||!d||0===d.length)return[];d=","+d+",";var f=[],c,g=",";for(c=0;c<a.length;c++)if(null!==a[c].subLayerIds){if(-1===d.indexOf(","+a[c].id+",")||-1<g.indexOf(","+
a[c].id+","))g+=a[c].subLayerIds.toString()+","}else-1<d.indexOf(","+a[c].id+",")&&-1===g.indexOf(","+a[c].id+",")&&f.push(a[c].id);return f},_newPopupInfo:function(a,d){if(a&&a.fields){var f={title:a.name,fieldInfos:[],description:null,showAttachments:!0,mediaInfos:[]};"string"===typeof d&&0<d.length&&(f.title=d);q.forEach(a.fields,function(a){var d=K.getDefaultPortalFieldInfo(a);d.visible=!0;d.isEditable=a.editable;f.fieldInfos.push(d)});return f}return null},_newVectorTileLayer:function(){var a=
this,d=new e,f={},c=this.serviceUrl,g=this._generateLayerId();"string"===typeof c&&0<c.length?this._checkVectorTileUrl(c,f).then(function(f){"string"===typeof f&&0<f.length?(f=a._checkMixedContent(f),f=new B(f,{id:g,opacity:1,visible:!0}),a._waitForLayer(f).then(function(a){d.resolve(a)},function(a){d.reject(a)})):d.resolve(null)},function(a){d.reject(a)}):d.resolve(null);return d},_newWFSLayer:function(a){var c=new e;try{var g,k=this._generateLayerId();if(a&&a.wfsInfo&&a.layerDefinition)g={id:k,
mode:a.mode,showLabels:!0,title:a.title,url:this._checkMixedContent(a.url),customParameters:a.wfsInfo.customParameters,maxFeatures:a.wfsInfo.maxFeatures,name:a.wfsInfo.name,swapXY:a.wfsInfo.swapXY,version:a.wfsInfo.version,geometryType:a.layerDefinition.geometryType,labelingInfo:a.layerDefinition.drawingInfo.labelingInfo};else{var m=this.serviceUrl;m?r.loadWFSByUrl(c,map,this,m,k,!1):c.reject(Error("Error adding WFS, no URL"));return c}var b=new I,n=b.on("error",function(a){n&&n.remove();c.reject(a.error)});
b.fromJson(g,function(){try{n&&n.remove();if(a&&a.wfsInfo&&a.layerDefinition){t.isDefined(a.opacity)&&b.setOpacity(a.opacity);t.isDefined(a.visibility)&&b.setVisibility(a.visibility);(a.minScale||a.maxScale)&&b.setScaleRange(a.minScale,a.maxScale);var k=a.layerDefinition.drawingInfo;k&&k.renderer&&(b.renderer=f.fromJson(k.renderer,{geometryType:g.geometryType}));a.popupInfo&&b.setInfoTemplate(new d(a.popupInfo))}c.resolve(b)}catch(N){console.error("Error adding WFS",N),c.reject(ex)}})}catch(L){console.error("Error adding WFS",
L),c.reject(L)}return c},_newWMSLayer:function(d){var f=this,c=this.item,m=!1,b=null,n={id:this._generateLayerId()};if(d){var e=[],u=[];q.forEach(d.layers,function(d){m=!0;u.push(new a({name:d.name,title:d.title,legendURL:d.legendURL,queryable:d.queryable,showPopup:d.showPopup}));e.push(d.name)},this);d.visibleLayers&&(e=d.visibleLayers);n={customLayerParameters:d.customLayerParameters,customParameters:d.customParameters,layerInfos:u,version:d.version,maxWidth:d.maxWidth,maxHeight:d.maxHeight,featureInfoFormat:d.featureInfoFormat,
getFeatureInfoURL:d.featureInfoUrl,getMapURL:d.mapUrl,spatialReferences:d.spatialReferences,title:d.title,copyright:d.copyright,minScale:d.minScale||0,maxScale:d.maxScale||0,format:d.format};c&&c.extent&&(c=new k(c.extent[0][0],c.extent[0][1],c.extent[1][0],c.extent[1][1],new J({wkid:4326})),n.extent=c);d.spatialReferences&&0<d.spatialReferences.length&&(b=d.spatialReferences[0]);n={id:this._generateLayerId(),visibleLayers:e,format:"png",transparent:d.firstLayer?!1:!0,opacity:d.opacity,visible:null!==
d.visibility?d.visibility:!0,resourceInfo:n,refreshInterval:d.refreshInterval}}d=new g(this.serviceUrl,n);d=this._waitForLayer(d);d.then(function(a){m||f._setWMSVisibleLayers(a);b&&a.spatialReference&&(a.spatialReference.wkid=b)});return d},_processFeatureLayer:function(a,c,g){var k=this,m=b.search.featureLayerTitlePattern,n=null;g&&g.layers&&0<g.layers.length?q.some(g.layers,function(g){var b,e,u,A=!1;if(g.id===a.layerId){g.popupInfo&&(b=g.popupInfo,b=w.parse(w.stringify(b)),b=new d(b),a.setInfoTemplate(b),
A=!0);t.isDefined(g.showLabels)&&a.setShowLabels(g.showLabels);t.isDefined(g.refreshInterval)&&a.setRefreshInterval(g.refreshInterval);t.isDefined(g.showLegend)&&console.log("");t.isDefined(g.timeAnimation)&&!1===g.timeAnimation&&console.log("");if(b=g.layerDefinition)b.definitionExpression&&a.setDefinitionExpression(b.definitionExpression),b.displayField&&a.displayField(b.displayField),b.drawingInfo&&(b.drawingInfo.renderer&&(e=w.parse(w.stringify(b.drawingInfo.renderer)),u=f.fromJson(e),e.type&&
"classBreaks"===e.type&&(u.isMaxInclusive=!0),a.setRenderer(u)),t.isDefined(b.drawingInfo.transparency)&&a.setOpacity(1-b.drawingInfo.transparency/100)),t.isDefined(b.minScale)&&a.setMinScale(b.minScale),t.isDefined(b.maxScale)&&a.setMaxScale(b.maxScale),t.isDefined(b.defaultVisibility)&&!1===b.defaultVisibility&&a.setVisibility(!1);A||k._setFeatureLayerInfoTemplate(a,g.popupInfo);n={url:a.url,id:a.id,itemId:c.id,title:k._makeFeatureLayerTitle(m,c.title,a.name)};return!0}}):(n={url:a.url,id:a.id,
itemId:c.id,title:k._makeFeatureLayerTitle(m,c.title,a.name)},k._setFeatureLayerInfoTemplate(a,null,n.title));return n},_readItemJsonData:function(){return x({url:this.itemUrl+"/data",content:{f:"json"},handleAs:"json"},{})},_readRestInfo:function(a){return x({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"},{})},_setDynamicLayerInfoTemplates:function(a){var d=this,f=null,c=[],g=function(c){var g=d._readRestInfo(a.url+"/"+c.id);g.then(function(a){try{var g=d._newPopupInfo(a);
g&&(f[c.id]={infoTemplate:d._newInfoTemplate(g)})}catch(O){console.warn("Error setting popup."),console.error(O)}});return g};null===a.infoTemplates&&q.forEach(a.layerInfos,function(a){null===f&&(f={});a.subLayerIds||c.push(g(a))});0<c.length&&l(c).then(function(){f&&(a.infoTemplates=f)}).otherwise(function(a){console.warn("Error reading sublayers.");console.error(a)})},_setFeatureLayerInfoTemplate:function(a,d,f){d||(d=this._newPopupInfo(a,f));d=this._newInfoTemplate(d,f);a.setInfoTemplate(d)},_setWMSVisibleLayers:function(a){var d=
[];a&&(q.some(a.layerInfos,function(a){if("string"===typeof a.name&&0<a.name.length)if(10>d.length)d.push(a.name);else return!0}),10>=d.length&&a.setVisibleLayers(d))},_waitForLayer:function(a){var d=new e,f=[];if(a.loaded)return d.resolve(a),d;if(a.loadError)return d.reject(a.loadError),d;var c=function(){q.forEach(f,function(a){a.remove()})};f.push(a.on("load",function(a){c();d.resolve(a.layer)}));f.push(a.on("error",function(a){c();a=a.error;try{a.message&&-1!==a.message.indexOf("Unable to complete")?
(console.warn("layerAccessError",a),d.reject(Error(b.search.layerInaccessible))):d.reject(a)}catch(Q){d.reject(a)}}));return d}})})},"esri/layers/ImageServiceParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../lang".split(" "),function(p,h,q,l,e,w){p=p(null,{declaredClass:"esri.layers.ImageServiceParameters",extent:null,width:null,height:null,imageSpatialReference:null,format:null,interpolation:null,compressionQuality:null,bandIds:null,timeExtent:null,
mosaicRule:null,renderingRule:null,renderer:null,noData:null,compressionTolerance:null,adjustAspectRatio:null,lercVersion:null,toJson:function(b){var e=this.bbox||this.extent;b=(e=e&&b&&e._normalize(!0))?e.spatialReference.wkid||q.toJson(e.spatialReference.toJson()):null;var h=this.imageSpatialReference,e={bbox:e?e.xmin+","+e.ymin+","+e.xmax+","+e.ymax:null,bboxSR:b,size:null!==this.width&&null!==this.height?this.width+","+this.height:null,imageSR:h?h.wkid||q.toJson(h.toJson()):b,format:this.format,
interpolation:this.interpolation,compressionQuality:this.compressionQuality,bandIds:this.bandIds?this.bandIds.join(","):null,mosaicRule:this.mosaicRule?q.toJson(this.mosaicRule.toJson()):null,renderingRule:this.renderingRule?q.toJson(this.renderingRule.toJson()):null,renderer:this.renderer?q.toJson(this.renderer.toJson()):null,noData:this.noData,noDataInterpretation:this.noDataInterpretation,compressionTolerance:this.compressionTolerance,adjustAspectRatio:this.adjustAspectRatio,lercVersion:this.lercVersion};
b=this.timeExtent;e.time=b?b.toJson().join(","):null;return w.filter(e,function(b){if(null!==b&&void 0!==b)return!0})}});h.mixin(p,{INTERPOLATION_BILINEAR:"RSP_BilinearInterpolation",INTERPOLATION_CUBICCONVOLUTION:"RSP_CubicConvolution",INTERPOLATION_MAJORITY:"RSP_Majority",INTERPOLATION_NEARESTNEIGHBOR:"RSP_NearestNeighbor",NODATA_MATCH_ALL:"esriNoDataMatchAll",NODATA_MATCH_ANY:"esriNoDataMatchAny"});l("extend-esri")&&h.setObject("layers.ImageServiceParameters",p,e);return p})},"esri/layers/KMLLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/sniff dojo/io-query dojo/dom-construct dojo/dom-style ../kernel ../config ../lang ../request ../urlUtils ../SpatialReference ../geometry/webMercatorUtils ../dijit/PopupTemplate ./layer ./KMLFolder ./KMLGroundOverlay ./MapImageLayer ./FeatureLayer".split(" "),
function(p,h,q,l,e,w,b,r,t,x,E,z,H,y,F,C,G,A,c,n,D,u,B){var I=h([c],{declaredClass:"esri.layers.KMLLayer",serviceUrl:F.getProtocolForWebResource()+"//utility.arcgis.com/sharing/kml",constructor:function(c,a){c||console.log("KMLLayer:constructor - please provide url for the KML file");this._url=F.urlToObject(this.url=c);this._outSR=a&&a.outSR||new C({wkid:4326});this._options=l.mixin({},a);z.defaults.kmlService&&(this.serviceUrl=z.defaults.kmlService);if(c=this.linkInfo=a&&a.linkInfo)this.visible=
!!c.visibility,this._waitingForMap=!!c.viewFormat;(!c||c&&c.visibility&&!this._waitingForMap)&&this._parseKml();this.refresh=l.hitch(this,this.refresh);this.registerConnectEvents("esri.layers.KMLLayer",!0)},getFeature:function(c){if(c){var a=c.type,d=c.id,g;switch(a){case "esriGeometryPoint":case "esriGeometryPolyline":case "esriGeometryPolygon":(c=this["_"+a])&&(g=l.getObject("_mode._featureMap."+d,!1,c));break;case "GroundOverlay":if(c=this._groundLyr){var f=c.getImages(),a=f.length;for(c=0;c<a;c++)if(f[c].id===
d){g=f[c];break}}break;case "ScreenOverlay":break;case "NetworkLink":e.some(this._links,function(a){return a.linkInfo&&a.linkInfo.id===d?(g=a,!0):!1});break;case "Folder":a=(f=this.folders)?f.length:0;for(c=0;c<a;c++)if(f[c].id===d){g=f[c];break}break;default:console.log("KMLLayer:getFeature - unknown feature type")}return g}},getLayers:function(){var c=[];this._groundLyr&&c.push(this._groundLyr);this._fLayers&&(c=c.concat(this._fLayers));this._links&&e.forEach(this._links,function(a){a.declaredClass&&
c.push(a)});return c},setFolderVisibility:function(c,a){c&&(this._fireUpdateStart(),(c.visible=a)&&(a=this._areLocalAncestorsVisible(c)),this._setState(c,a),this._fireUpdateEnd())},_eventMap:{"network-link-error":["error"]},onRefresh:function(){},onOpacityChange:function(){},onNetworkLinkError:function(){},_parseKml:function(c){var a=this;this._fireUpdateStart();this._io=y({url:this.serviceUrl,content:{url:this._url.path+this._getQueryParameters(c),model:"simple",folders:"",refresh:this.loaded?!0:
void 0,outSR:w.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(d){a._io=null;a._initLayer(d)},error:function(d){a._io=null;d=l.mixin(Error(),d);d.message="Unable to load KML: "+(d.message||"");a._fireUpdateEnd(d);a._errorHandler(d)}})},_initLayer:function(c){var a;this.loaded&&(a=[],e.forEach(this.folders,function(d){d.visible&&a.push(d.id)}),this._options.minScale=this.minScale,this._options.maxScale=this.maxScale,this._options.opacity=this.opacity,this._removeInternalLayers());
this.name=c.name;this.description=c.description;this.snippet=c.snippet;this.visibility=c.visibility;this.featureInfos=c.featureInfos;var d,g,f=this.folders=c.folders,k=[],b;if(f)for(g=f.length,d=0;d<g;d++)b=f[d]=new n(f[d]),-1===b.parentFolderId&&k.push(b);var f=this._links=c.networkLinks,h;g=f?f.length:0;for(d=0;d<g;d++)f[d].viewRefreshMode&&-1!==f[d].viewRefreshMode.toLowerCase().indexOf("onregion")||(h=l.mixin({},this._options),h.linkInfo=f[d],h.id&&(h.id=h.id+"_"+d),b=f[d]=new I(f[d].href,h),
b._parentLayer=this,b._parentFolderId=this._getLinkParentId(b.linkInfo.id),b._linkErrorHandle=b.on("error,network-link-error",l.hitch(b,function(a){this._parentLayer.onNetworkLinkError(a.error)})));if((f=c.groundOverlays)&&0<f.length)for(h=l.mixin({},this._options),h.id&&(h.id+="_mapImage"),b=this._groundLyr=new u(h),g=f.length,d=0;d<g;d++)b.addImage(new D(f[d]));(c=l.getObject("featureCollection.layers",!1,c))&&0<c.length&&(this._fLayers=[],e.forEach(c,function(a,d){var c=l.getObject("featureSet.features",
!1,a);c&&0<c.length&&(h=l.mixin({outFields:["*"],infoTemplate:a.popupInfo?new A(a.popupInfo):null,editable:!1},this._options),h.id&&(h.id=h.id+"_"+d),h.webgl=!1,a.layerDefinition.capabilities="Query,Data",a=new B(a,h),a.geometryType&&(this["_"+a.geometryType]=a),this._fLayers.push(a))},this),0===this._fLayers.length&&delete this._fLayers);if(!this.loaded)for(g=k.length,d=0;d<g;d++)b=k[d],this._setState(b,b.visible);this._fireUpdateEnd();this.loaded?(this._addInternalLayers(),e.forEach(this.folders,
function(d){-1<e.indexOf(a,d.id)?this.setFolderVisibility(d,!0):this.setFolderVisibility(d,!1)},this),this.onRefresh()):(this.loaded=!0,this.onLoad(this))},_addInternalLayers:function(){var c=this._map;this._fireUpdateStart();this._links&&e.forEach(this._links,function(a){a.declaredClass&&(c.addLayer(a),a._waitingForMap&&(a._waitingForMap=null,a.visible?a._parseKml(c):a._wMap=c))});var a=c.spatialReference,d=this._outSR,b;if(!a.equals(d))if(a.isWebMercator()&&4326===d.wkid)b=G.geographicToWebMercator;
else if(d.isWebMercator()&&4326===a.wkid)b=G.webMercatorToGeographic;else{console.log("KMLLayer:_setMap - unsupported workflow. Spatial reference of the map and kml layer do not match, and the conversion cannot be done on the client.");return}this._groundLyr&&(b&&e.forEach(this._groundLyr.getImages(),function(a){a.extent=b(a.extent)}),c.addLayer(this._groundLyr));(a=this._fLayers)&&0<a.length&&e.forEach(a,function(a){if(b){var d=a.graphics,f,g,m=d?d.length:0;for(f=0;f<m;f++)(g=d[f].geometry)&&d[f].setGeometry(b(g))}c.addLayer(a)});
this.onVisibilityChange(this.visible)},_removeInternalLayers:function(){var c=this._map;this._links&&e.forEach(this._links,function(a){a.declaredClass&&a._io&&a._io.cancel();a._linkErrorHandle&&(a._linkErrorHandle.remove(),a._linkErrorHandle=null)});c&&e.forEach(this.getLayers(),c.removeLayer,c)},_setState:function(c,a){c=c.featureInfos;var d,g,f,k=c?c.length:0,b=a?"show":"hide";for(f=0;f<k;f++)if(d=c[f],g=this.getFeature(d))if("Folder"===d.type)this._setState(g,a&&g.visible);else if("NetworkLink"===
d.type)this._setInternalVisibility(g,a);else g[b]()},_areLocalAncestorsVisible:function(c){var a=c.parentFolderId;for(c=c.visible;c&&-1!==a;)a=this.getFeature({type:"Folder",id:a}),c=c&&a.visible,a=a.parentFolderId;return c},_setInternalVisibility:function(c,a){var d=c._parentLayer,g=c._parentFolderId;for(a=a&&c.visible;a&&d;)a=a&&d.visible,-1<g&&(a=a&&d._areLocalAncestorsVisible(d.getFeature({type:"Folder",id:g}))),g=d._parentFolderId,d=d._parentLayer;this._setIntState(c,a)},_setIntState:function(c,
a){c&&e.forEach(c.getLayers(),function(d){d.linkInfo?c._setIntState(d,a&&d.visible&&c._areLocalAncestorsVisible(c.getFeature({type:"Folder",id:d._parentFolderId}))):d.setVisibility(a)})},_getLinkParentId:function(c){var a=-1;this.folders&&e.some(this.folders,function(d){return d.networkLinkIds&&-1!==e.indexOf(d.networkLinkIds,c)?(a=d.id,!0):!1});return a},_checkAutoRefresh:function(){var c=this.linkInfo;if(c)if(this.visible){if(this.loaded&&this._map){var a=c.refreshMode,d=c.refreshInterval,b=c.viewRefreshMode,
c=c.viewRefreshTime;a&&-1!==a.toLowerCase().indexOf("oninterval")&&0<d&&(this._stopAutoRefresh(),this._timeoutHandle=setTimeout(this.refresh,1E3*d));b&&-1!==b.toLowerCase().indexOf("onstop")&&0<c&&!this._extChgHandle&&(this._extChgHandle=q.connect(this._map,"onExtentChange",this,this._extentChanged))}}else this._stopAutoRefresh(),q.disconnect(this._extChgHandle),delete this._extChgHandle},_stopAutoRefresh:function(){clearTimeout(this._timeoutHandle);this._timeoutHandle=null},_getQueryParameters:function(c){c=
c||this._map;var a={},d=this.linkInfo,g=c&&c.extent,f;this._url.query&&(l.mixin(a,this._url.query),f=!!this._url.query.token);E.id&&!f&&(f=E.id.findCredential(this._url.path))&&(a.token=f.token);if(d){f=d.viewFormat;var k=d.httpQuery,d=d.viewBoundScale;if(g&&f){var b=g,n=g,e=g.spatialReference;e&&(e.isWebMercator()?b=G.webMercatorToGeographic(g):4326===e.wkid&&(n=G.geographicToWebMercator(g)));g=b.getCenter();n=Math.max(n.getWidth(),n.getHeight());d&&(b=b.expand(d));f=f.replace(/\[bboxWest\]/ig,b.xmin).replace(/\[bboxEast\]/ig,
b.xmax).replace(/\[bboxSouth\]/ig,b.ymin).replace(/\[bboxNorth\]/ig,b.ymax).replace(/\[lookatLon\]/ig,g.x).replace(/\[lookatLat\]/ig,g.y).replace(/\[lookatRange\]/ig,n).replace(/\[lookatTilt\]/ig,0).replace(/\[lookatHeading\]/ig,0).replace(/\[lookatTerrainLon\]/ig,g.x).replace(/\[lookatTerrainLat\]/ig,g.y).replace(/\[lookatTerrainAlt\]/ig,0).replace(/\[cameraLon\]/ig,g.x).replace(/\[cameraLat\]/ig,g.y).replace(/\[cameraAlt\]/ig,n).replace(/\[horizFov\]/ig,60).replace(/\[vertFov\]/ig,60).replace(/\[horizPixels\]/ig,
c.width).replace(/\[vertPixels\]/ig,c.height).replace(/\[terrainEnabled\]/ig,0);l.mixin(a,r.queryToObject(f))}k&&(k=k.replace(/\[clientVersion\]/ig,E.version).replace(/\[kmlVersion\]/ig,2.2).replace(/\[clientName\]/ig,"ArcGIS API for JavaScript").replace(/\[language\]/ig,p.locale),l.mixin(a,r.queryToObject(k)))}c=[];for(var u in a)H.isDefined(a[u])&&c.push(u+"\x3d"+a[u]);return(c=c.join("\x26"))?"?"+c:""},setScaleRange:function(c,a){this.inherited(arguments);e.forEach(this.getLayers(),function(d){d.setScaleRange(c,
a)})},setOpacity:function(c){this.opacity!=c&&(e.forEach(this.getLayers(),function(a){a.setOpacity(c)}),this.opacity=c,this.onOpacityChange(c))},_setMap:function(c,a){this.inherited(arguments);this._map=c;var d=this._div=t.create("div",null,a);x.set(d,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return d},_unsetMap:function(c,a){this._io&&this._io.cancel();this._stopAutoRefresh();q.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();
var d=this._div;d&&(a.removeChild(d),t.destroy(d));this._wMap=this._div=null;this.inherited(arguments)},onVisibilityChange:function(c){this.loaded?(this._fireUpdateStart(),this._setInternalVisibility(this,c),this._checkAutoRefresh(),this._fireUpdateEnd()):this.linkInfo&&c&&(this._waitingForMap||this._parseKml(this._wMap))},refresh:function(){this.loaded&&this._map&&!this._io&&this.visible&&this._parseKml()},getFeatureCollection:function(c){var a,d=[];(c=this.getFeature({type:"Folder",id:c}))&&(a=
e.map(c.featureInfos,function(a){if("esriGeometryPoint"===a.type||"esriGeometryPolyline"===a.type||"esriGeometryPolygon"===a.type)return a.id},this))&&0<a.length&&e.forEach(this._fLayers,function(c){var f,k;f=c.toJson();f.featureSet.features&&0<f.featureSet.features.length&&(k=e.filter(f.featureSet.features,function(d){if(-1!==e.indexOf(a,d.attributes[c.objectIdField]))return d},this));k&&0<k.length&&(f.featureSet.features=k,d.push(f))},this);return d},getFeatureCount:function(c){c=this.getFeature({type:"Folder",
id:c});var a={points:0,polylines:0,polygons:0};c&&e.forEach(c.featureInfos,function(d){"esriGeometryPoint"===d.type&&(a.points+=1);"esriGeometryPolyline"===d.type&&(a.polylines+=1);"esriGeometryPolygon"===d.type&&(a.polygons+=1)});return a},_extentChanged:function(){this._stopAutoRefresh();this._timeoutHandle=setTimeout(this.refresh,1E3*this.linkInfo.viewRefreshTime)}});b("extend-esri")&&l.setObject("layers.KMLLayer",I,E);return I})},"esri/layers/KMLFolder":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../lang"],function(p,h,q,l,e){p=p(null,{declaredClass:"esri.layers.KMLFolder",constructor:function(l){h.mixin(this,l);e.isDefined(this.visibility)&&(this.visible=!!this.visibility)}});q("extend-esri")&&h.setObject("layers.KMLFolder",p,l);return p})},"esri/layers/KMLGroundOverlay":function(){define("dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../lang ./MapImage".split(" "),function(p,h,q,l,e,w){p=p([w],{declaredClass:"esri.layers.KMLGroundOverlay",
constructor:function(b){e.isDefined(this.visibility)&&(this.visible=!!this.visibility)}});q("extend-esri")&&h.setObject("layers.KMLGroundOverlay",p,l);return p})},"esri/layers/WMSLayer":function(){define("require dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff ../config ../graphic ../kernel ../request ../urlUtils ../dijit/PopupTemplate ../SpatialReference ../geometry/Extent ../geometry/Point ./DynamicMapServiceLayer ./WMSLayerInfo dojo/query".split(" "),function(p,
h,q,l,e,w,b,r,t,x,E,z,H,y,F,C,G){q=q([C],{declaredClass:"esri.layers.WMSLayer",_CRS_TO_EPSG:{84:4326,83:4269,27:4267},_REVERSED_LAT_LONG_RANGES:[[4001,4999],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],
[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],_WEB_MERCATOR:[102100,3857,102113,900913],_WORLD_MERCATOR:[3395,54004],allExtents:[],version:null,constructor:function(b,c){var n=E.urlToObject(b);n.query&&(n.query.version||n.query.Version||n.query.VERSION)&&
(this.version=n.query.version||n.query.Version||n.query.VERSION);this.url=b=this._stripParameters(b,"version service request bbox format height width layers srs crs styles transparent bgcolor exceptions time elevation sld wfs".split(" "));this._url=E.urlToObject(b);this._getCapabilitiesURL=b;this._initLayer=l.hitch(this,this._initLayer);this._parseCapabilities=l.hitch(this,this._parseCapabilities);this._getCapabilitiesError=l.hitch(this,this._getCapabilitiesError);c?(this.customParameters=c.customParameters,
this.customLayerParameters=c.customLayerParameters,this.imageFormat=this._getImageFormat(c.format),this.imageTransparency=!1!==c.transparent,this.visibleLayers=c.visibleLayers?c.visibleLayers:[],this.version=c.version||this.version,c.resourceInfo?this._readResourceInfo(c.resourceInfo):this._getCapabilities()):(this.imageFormat="image/png",this.imageTransparency=!0,this.visibleLayers=[],this._getCapabilities());this._blankImageURL=p.toUrl("../images/pixel.png");this.extentProcessor=this._createExtentProcessor(0);
this._createChildLayer()},setVisibleLayers:function(b){this.visibleLayers=(b=this._checkVisibleLayersList(b))?b:[];this.refresh(!0)},setImageFormat:function(b){this.imageFormat=this._getImageFormat(b);this.refresh(!0)},setImageTransparency:function(b){this.imageTransparency=b;this.refresh(!0)},setCustomParameters:function(b,c){this.customParameters=b;this.customLayerParameters=c;this.refresh(!0)},refresh:function(){this._refreshTS=Date.now();this.inherited(arguments);this._childLayer&&this._childLayer.refresh.apply(this._childLayer,
arguments)},getImageUrl:function(b,c,n,e){if(this.visibleLayers&&0!==this.visibleLayers.length){b=this._getImageParams(b,c,n);b=this._mixinCustomLayerParameters(b);c=this.getMapURL;var u;c+=-1===c.indexOf("?")?"?":"";for(u in b)b.hasOwnProperty(u)&&(c+="?"===c.substring(c.length-1,c.length)?"":"\x26",c+=u+"\x3d"+b[u]);c=this.addTimestampToURL(c);e(E.addProxy(c))}else e(this._blankImageURL)},_setMap:function(b,c,n){var e=this.inherited(arguments);b.wrapAround180?this._childLayer&&(this.suspended&&
this._childLayer.suspend(),this._childLayer._setMap(b,e)):this._childLayer=this.extentProcessor=null;return e},_unsetMap:function(b,c){this._childLayer&&this._childLayer._unsetMap(b,this._div);this.inherited(arguments)},onSuspend:function(){this.inherited(arguments);this._childLayer&&this._childLayer.suspend()},onResume:function(){this.inherited(arguments);this._childLayer&&this._childLayer.resume()},_createChildLayer:function(){this._childLayer=new C(null,{extentProcessor:this._createExtentProcessor(1)});
this._childLayer._isChildLayer=!0;this._childLayer.getImageUrl=l.hitch(this,this.getImageUrl);this._childLayer.loaded=!0},_createExtentProcessor:function(b){return l.hitch(this,this._extentProcessor,b)},_extentProcessor:function(b,c){var n=c.extent,e=c.width,u=0;if(n){c=n.getWidth()/e;var B=n.bisect(),n=B.extents,h=n[b];h&&(e=B.marginLeft/c,u=0===b?e:e+n[0].getWidth()/c,e=Math.ceil(h.getWidth()/c),u=Math.ceil(u));n=h}return{extent:n,width:e,marginLeft:u}},_getImageParams:function(b,c,n){var h=b.spatialReference.wkid;
-1===e.indexOf(this.spatialReferences,h)&&b.spatialReference.latestWkid&&(h=b.spatialReference.latestWkid);if(e.some(this._WEB_MERCATOR,function(a){return a==h})){var u=e.filter(this.spatialReferences,function(a){return e.some(this._WEB_MERCATOR,function(d){return d==a})},this);0===u.length&&(u=e.filter(this.spatialReferences,function(a){return e.some(this._WORLD_MERCATOR,function(d){return d==a})},this));h=0<u.length?u[0]:this._WEB_MERCATOR[1]}this.spatialReferences=e.filter(this.spatialReferences,
function(a){return a!==h});this.spatialReferences.unshift(h);var u=b.xmin,B=b.xmax,A=b.ymin;b=b.ymax;var g={SERVICE:"WMS",REQUEST:"GetMap"};g.FORMAT=this.imageFormat;g.TRANSPARENT=this.imageTransparency?"TRUE":"FALSE";g.STYLES="";g.VERSION=this.version;g.LAYERS=this.visibleLayers?this.visibleLayers.toString():null;g.WIDTH=c;g.HEIGHT=n;this.maxWidth<c&&(g.WIDTH=this.maxWidth);this.maxHeight<n&&(g.HEIGHT=this.maxHeight);c=h?h:NaN;isNaN(c)||("1.3.0"==this.version?g.CRS="EPSG:"+c:g.SRS="EPSG:"+c);"1.3.0"==
this.version&&this._useLatLong(c)?g.BBOX=A+","+u+","+b+","+B:g.BBOX=u+","+A+","+B+","+b;return g},_initLayer:function(e,c){this.spatialReference=new H(this.extent.spatialReference);this.initialExtent=new y(this.extent);this.fullExtent=new y(this.extent);this.visibleLayers=this._checkVisibleLayersList(this.visibleLayers);var n=l.hitch(this,function(){this.loaded=!0;this.onLoad(this);var c=this._loadCallback;c&&(delete this._loadCallback,c(this))});w("chrome")?(e=b.defaults.io,c="with-credentials"===
e.useCors?E.canUseXhr(this.getMapURL,!0):-1,(e=-1<c?e.corsEnabledServers[c]:null)&&e.withCredentials?x({url:this.getMapURL,handleAs:"text",content:{SERVICE:"WMS",REQUEST:"GetMap"}}).addBoth(function(){n()}):n()):n()},_readResourceInfo:function(b){b.extent?b.layerInfos?(this.extent=b.extent,this.allExtents[0]=b.extent,this.layerInfos=b.layerInfos,this.description=b.description?b.description:"",this.copyright=b.copyright?b.copyright:"",this.title=b.title?b.title:"",this.getMapURL=b.getMapURL?b.getMapURL:
this._getCapabilitiesURL,this.getFeatureInfoURL=b.getFeatureInfoURL,this.featureInfoFormat=b.featureInfoFormat,this.version=b.version?b.version:"1.3.0",this.maxWidth=b.maxWidth?b.maxWidth:5E3,this.maxHeight=b.maxHeight?b.maxHeight:5E3,this.spatialReferences=b.spatialReferences?b.spatialReferences:[],this.imageFormat=this._getImageFormat(b.format),this.setScaleRange(b.minScale,b.maxScale),this.customLayerParameters=b.customLayerParameters||this.customLayerParameters,this.customParameters=b.customParameters||
this.customParameters,this._initLayer()):this._errorHandler(Error("esri.layers.WMSLayer: unable to find the 'layerInfos' property in resourceInfo")):this._errorHandler(Error("esri.layers.WMSLayer: Unable to find the 'extent' property in resourceInfo."))},_getCapabilities:function(b){var c=this._url.query?this._url.query:{};c.SERVICE="WMS";c.REQUEST="GetCapabilities";this.version&&(c.VERSION=this.version);var c=this._mixinCustomParameters(c),n=this._url.path+"?",e;for(e in c)c.hasOwnProperty(e)&&(n+=
"?"==n.substring(n.length-1,n.length)?"":"\x26",n+=e+"\x3d"+c[e]);x({url:n,handleAs:b||"xml",headers:{"Content-Type":null},load:this._parseCapabilities,error:this._getCapabilitiesError},{usePost:!1})},_parseCapabilities:function(b,c){var n;if(b){if("text"===c.handleAs){try{n=(new DOMParser).parseFromString(b,"application/xml")}catch(d){}n&&!n.getElementsByTagName("parsererror").length||this._errorHandler(Error("GetCapabilities request for "+this._getCapabilitiesURL+" failed. (XML Parse error.)"))}else n=
b;var D=this;this.version=this._getAttributeValue("WMS_Capabilities","version",n,null);this.version||(this.version=this._getAttributeValue("WMT_MS_Capabilities","version",n,"1.3.0"));b=this._getTag("Service",n);this.title=this._getTagValue("Title",b,"");this.title||(this.title=this._getTagValue("Name",b,""));this.copyright=this._getTagValue("AccessConstraints",b,"");this.description=this._getTagValue("Abstract",b,"");this.maxWidth=parseInt(this._getTagValue("MaxWidth",b,5E3),10);this.maxHeight=parseInt(this._getTagValue("MaxHeight",
b,5E3),10);if(b=this._getTag("Layer",n)){var u=this._getLayerInfo(b),B=0,I=null;b=this._getTag("Capability",n);e.forEach(b.childNodes,function(a){"Layer"==a.nodeName&&(0===B?I=a:(1===B&&u.name&&(u.name="",u.subLayers=[],u.subLayers.push(this._getLayerInfo(I))),u.subLayers.push(this._getLayerInfo(a))),B++)},this);if(u&&(this.layerInfos=u.subLayers,this.layerInfos&&0!==this.layerInfos.length||(this.layerInfos=[u]),this.extent=u.extent,this.extent||(u.extent=new y(this.layerInfos[0].extent.toJson()),
this.extent=u.extent),this.allExtents=u.allExtents,this.allExtents&&this.allExtents.length||(u.allExtents=[],e.forEach(this.layerInfos[0].allExtents,function(a,c){a&&(u.allExtents[c]=new y(a.toJson()))}),this.allExtents=u.allExtents),this.spatialReferences=u.spatialReferences,!this.spatialReferences.length&&0<this.layerInfos.length)){var g=function(a){var d;for(d=0;d<a.subLayers.length;d++){var c=a.subLayers[d],b=c.spatialReferences;!b.length&&c.subLayers&&0<c.subLayers.length&&(b=g(c));if(b.length)return b}return[]};
for(b=0;b<this.layerInfos.length&&(c=this.layerInfos[b],this.spatialReferences=this.layerInfos[0].spatialReferences,!this.spatialReferences.length&&c.subLayers&&0<c.subLayers.length&&(this.spatialReferences=g(c)),!this.spatialReferences.length);b++);}b=function(a){return(a=h.query("DCPType",D._getTag(a,n)))&&0<a.length&&(a=h.query("HTTP",a[0]))&&0<a.length&&(a=h.query("Get",a[0]))&&0<a.length&&(a=D._getAttributeValue("OnlineResource","xlink:href",a[0],null))?(a.indexOf("\x26")===a.length-1&&(a=a.substring(0,
a.length-1)),D._stripParameters(a,["service","request"])):null};c=function(a){var c=[];0===h.query("Operation",n).length?e.forEach(h.query("Format",D._getTag(a,n)),function(a){c.push(a.text?a.text:a.textContent)}):(e.forEach(h.query("Operation",n),function(d){d.getAttribute("name")===a&&e.forEach(h.query("Format",d),function(a){c.push(a.text?a.text:a.textContent)})}),c.length||e.forEach(h.query("Format",D._getTag(a,n)),function(a){c.push(a.text?a.text:a.textContent)}));return c};this.getMapURL=b("GetMap")||
this._getCapabilitiesURL;this.getMapFormats=c("GetMap");this.getMapFormats.length&&!e.some(this.getMapFormats,function(a){return-1<a.indexOf(this.imageFormat)},this)&&(this.imageFormat=this.getMapFormats[0]);if(this.getFeatureInfoURL=b("GetFeatureInfo"))this.getFeatureInfoFormats=c("GetFeatureInfo"),-1<e.indexOf(this.getFeatureInfoFormats,"text/html")?this.featureInfoFormat="text/html":-1<e.indexOf(this.getFeatureInfoFormats,"text/plain")&&(this.featureInfoFormat="text/plain");if(!this.featureInfoFormat){var a=
function(c){if(c&&(c.queryable=!1,c.subLayers))for(var d=0;d<c.subLayers.length;d++)a(c.subLayers[d])};a(u)}this._initLayer()}else this._errorHandler(Error("esri.layers.WMSLayer: Response does not contain any layers."))}else"xml"===c.handleAs?this._getCapabilities("text"):this._errorHandler(Error("GetCapabilities request for "+this._getCapabilitiesURL+" failed. (Response is null.)"))},_getCapabilitiesError:function(b){b&&b.message&&(b.message="GetCapabilities request for "+this._getCapabilitiesURL+
" failed. ("+b.message+")");this._errorHandler(b)},_getLayerInfo:function(b){if(!b)return null;var c=new G;c.name="";c.title="";c.description="";c.allExtents=[];c.spatialReferences=[];c.queryable="1"===b.getAttribute("queryable");c.subLayers=[];var n=this._getTag("LatLonBoundingBox",b);n&&(c.allExtents[0]=this._getExtent(n,4326));var h=this._getTag("EX_GeographicBoundingBox",b),u;h&&(u=new y(0,0,0,0,new H({wkid:4326})),u.xmin=parseFloat(this._getTagValue("westBoundLongitude",h,0)),u.ymin=parseFloat(this._getTagValue("southBoundLatitude",
h,0)),u.xmax=parseFloat(this._getTagValue("eastBoundLongitude",h,0)),u.ymax=parseFloat(this._getTagValue("northBoundLatitude",h,0)),c.allExtents[0]=u);n||h||(u=new y(-180,-90,180,90,new H({wkid:4326})),c.allExtents[0]=u);c.extent=c.allExtents[0];var B=-1<e.indexOf(["1.0.0","1.1.0","1.1.1"],this.version)?"SRS":"CRS";e.forEach(b.childNodes,function(b){if("Name"==b.nodeName)c.name=(b.text?b.text:b.textContent)||"";else if("Title"==b.nodeName)c.title=(b.text?b.text:b.textContent)||"";else if("Abstract"==
b.nodeName)c.description=(b.text?b.text:b.textContent)||"";else if("BoundingBox"==b.nodeName){var g=b.getAttribute(B);g&&0===g.indexOf("EPSG:")?(g=parseInt(g.substring(5),10),0===g||isNaN(g)||(b="1.3.0"==this.version?this._getExtent(b,g,this._useLatLong(g)):this._getExtent(b,g),c.allExtents[g]=b,c.extent||(c.extent=b))):g&&0===g.indexOf("CRS:")?(g=parseInt(g.substring(4),10),0===g||isNaN(g)||(this._CRS_TO_EPSG[g]&&(g=this._CRS_TO_EPSG[g]),c.allExtents[g]=this._getExtent(b,g))):(g=parseInt(g,10),0===
g||isNaN(g)||(c.allExtents[g]=this._getExtent(b,g)))}else if(b.nodeName==B)b=(b.text?b.text:b.textContent).split(" "),e.forEach(b,function(a){a=-1<a.indexOf(":")?parseInt(a.split(":")[1],10):parseInt(a,10);0===a||isNaN(a)||(this._CRS_TO_EPSG[a]&&(a=this._CRS_TO_EPSG[a]),-1==e.indexOf(c.spatialReferences,a)&&c.spatialReferences.push(a))},this);else if("Style"!=b.nodeName||c.legendURL)"Layer"===b.nodeName&&c.subLayers.push(this._getLayerInfo(b));else if(b=this._getTag("LegendURL",b))if(b=this._getTag("OnlineResource",
b))c.legendURL=b.getAttribute("xlink:href")},this);c.title=c.title||c.name;return c},_getImageFormat:function(b){switch(b?b.toLowerCase():""){case "jpg":return"image/jpeg";case "bmp":return"image/bmp";case "gif":return"image/gif";case "svg":return"image/svg+xml";default:return"image/png"}},getImageFormat:function(){switch(this.imageFormat?this.imageFormat.toLowerCase():""){case "image/jpeg":return"jpg";case "image/bmp":return"bmp";case "image/gif":return"gif";case "image/svg+xml":return"svg";default:return"png"}},
_getExtent:function(b,c,n){var e;if(b){e=new y;var u=parseFloat(b.getAttribute("minx")),h=parseFloat(b.getAttribute("miny")),r=parseFloat(b.getAttribute("maxx"));b=parseFloat(b.getAttribute("maxy"));n?(e.xmin=isNaN(h)?-1*Number.MAX_VALUE:h,e.ymin=isNaN(u)?-1*Number.MAX_VALUE:u,e.xmax=isNaN(b)?Number.MAX_VALUE:b,e.ymax=isNaN(r)?Number.MAX_VALUE:r):(e.xmin=isNaN(u)?-1*Number.MAX_VALUE:u,e.ymin=isNaN(h)?-1*Number.MAX_VALUE:h,e.xmax=isNaN(r)?Number.MAX_VALUE:r,e.ymax=isNaN(b)?Number.MAX_VALUE:b);e.spatialReference=
new H({wkid:c})}return e},_useLatLong:function(b){var c,n;for(n=0;n<this._REVERSED_LAT_LONG_RANGES.length;n++){var e=this._REVERSED_LAT_LONG_RANGES[n];if(b>=e[0]&&b<=e[1]){c=!0;break}}return c},_getTag:function(b,c){return(b=h.query(b,c))&&0<b.length?b[0]:null},_getTagValue:function(b,c,n){return(b=h.query(b,c))&&0<b.length?b[0].text?b[0].text:b[0].textContent:n},_getAttributeValue:function(b,c,n,e){return(b=h.query(b,n))&&0<b.length?b[0].getAttribute(c):e},_checkVisibleLayersList:function(b){if(b&&
0<b.length&&this.layerInfos&&0<this.layerInfos.length&&"number"==typeof b[0]){var c=[];e.forEach(b,function(b){b<this.layerInfos.length&&c.push(this.layerInfos[b].name)},this);b=c}return b},_stripParameters:function(b,c){b=E.urlToObject(b);var n,h=[];for(n in b.query)b.query.hasOwnProperty(n)&&-1===e.indexOf(c,n.toLowerCase())&&h.push(n+"\x3d"+b.query[n]);return b.path+(h.length?"?"+h.join("\x26"):"")},_getPopupGraphic:function(b,c){var n=this.visibleLayers;if(!n||0===n.length)return null;var h=this._popupGraphic;
h||(h=new z({title:this.title||"",description:'\x3cdiv style\x3d"position:relative;padding-bottom:56.25%;height:0;overflow:hidden;max-width:100%;"\x3e\x3ciframe src\x3d"{QUERY_URL}" width\x3d"250" height\x3d"147" frameborder\x3d"0" marginwidth\x3d"0" marginheight\x3d"0" style\x3d"position:absolute;top:0;left:0;width:100%;height:100%;border:0;background:url(\''+p.toUrl("../dijit/images/loading-throb.gif")+"') transparent center no-repeat;\" onload\x3d\"(event.target || event.srcElement).style.background \x3d 'none';\"\x3e\x3c/iframe\x3e\x3c/div\x3e"}),
h=this._popupGraphic=new r(null,null,{},h),h._layer=this);var u=function(a){var c=[];if(a&&(a.queryable&&a.showPopup&&a.name&&c.push(a.name),a.subLayers))for(var b=0;b<a.subLayers.length;b++){var f=u(a.subLayers[b]);f.length&&(c=c.concat(f))}return c},B=u({subLayers:this.layerInfos}),B=e.filter(B,function(a){return-1<e.indexOf(n,a)});if(B.length){var l=this.getFeatureInfoURL;b=this._getImageParams(b.extent,b.width,b.height);b=this._mixinCustomLayerParameters(b);b.REQUEST="GetFeatureInfo";b.INFO_FORMAT=
this.featureInfoFormat;b.QUERY_LAYERS=B.join();b.FEATURE_COUNT=25;"1.3.0"===this.version?(b.I=Math.round(c.x),b.J=Math.round(c.y)):(b.X=Math.round(c.x),b.Y=Math.round(c.y));var l=l+(-1===l.indexOf("?")?"?":""),g;for(g in b)b.hasOwnProperty(g)&&(l+="?"===l.substring(l.length-1,l.length)?"":"\x26",l+=g+"\x3d"+b[g]);h.attributes.QUERY_URL=l;return h}return null},_mixinCustomParameters:function(b){if(this.customParameters)for(var c in this.customParameters)b[c]=encodeURIComponent(this.customParameters[c]);
return b},_mixinCustomLayerParameters:function(b){if(this.customLayerParameters||this.customParameters){var c=l.clone(this.customParameters||{});l.mixin(c,this.customLayerParameters||{});for(var n in c)"styles"===n.toLowerCase()&&delete b.STYLES,b[n]=encodeURIComponent(c[n])}return b}});w("extend-esri")&&l.setObject("layers.WMSLayer",q,t);return q})},"esri/layers/WMSLayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/has","../kernel"],function(p,h,q,l,e){p=
p(null,{declaredClass:"esri.layers.WMSLayerInfo",name:null,title:null,description:null,extent:null,legendURL:null,subLayers:[],allExtents:[],spatialReferences:[],queryable:!1,showPopup:!1,constructor:function(e){e&&(this.name=e.name,this.title=e.title,this.description=e.description,this.extent=e.extent,this.legendURL=e.legendURL,this.subLayers=e.subLayers?e.subLayers:[],this.allExtents=e.allExtents?e.allExtents:[],this.spatialReferences=e.spatialReferences?e.spatialReferences:[],this.queryable=!!e.queryable,
this.showPopup=!!e.showPopup)},clone:function(){var e={name:this.name,title:this.title,description:this.description,legendURL:this.legendURL},b;this.extent&&(e.extent=this.extent.getExtent());e.subLayers=[];q.forEach(this.subLayers,function(b){e.subLayers.push(b.clone())});e.allExtents=[];for(b in this.allExtents)b=parseInt(b,10),isNaN(b)||(e.allExtents[b]=this.allExtents[b].getExtent());e.spatialReferences=[];q.forEach(this.spatialReferences,function(b){e.spatialReferences.push(b)});e.queryable=
this.queryable;e.showPopup=this.showPopup;return e}});l("extend-esri")&&h.setObject("layers.WMSLayerInfo",p,e);return p})},"widgets/AddData/search/Paging":function(){define("dojo/_base/declare dojo/dom-class ./SearchComponent dojo/text!./templates/Paging.html dojo/i18n!../nls/strings ./util".split(" "),function(p,h,q,l,e,w){return p([q],{i18n:e,templateString:l,hasLess:!1,hasMore:!1,nextStart:-1,numPerPage:null,previousStart:-1,start:1,postCreate:function(){this.inherited(arguments);null===this.numPerPage&&
(this.numPerPage=30);this.enableOrDisable()},startup:function(){if(!this._started){this.inherited(arguments);try{var b=this.getConfig().numPerPage,e=Number(b);"number"!==typeof e||isNaN(e)||(e=Math.floor(e),1<=e&&100>=e&&(this.numPerPage=e))}catch(t){console.warn("Error setting numPerPage:"),console.warn(t)}null===this.numPerPage&&(this.numPerPage=30)}},enableOrDisable:function(){this.hasLess?(h.remove(this.firstButton.parentNode,"disabled"),h.remove(this.previousButton.parentNode,"disabled")):(h.add(this.firstButton.parentNode,
"disabled"),h.add(this.previousButton.parentNode,"disabled"));this.hasMore?h.remove(this.nextButton.parentNode,"disabled"):h.add(this.nextButton.parentNode,"disabled")},firstButtonClicked:function(){this.hasLess&&(this.start=1,this.search())},previousButtonClicked:function(){this.hasLess&&(this.start=this.previousStart,this.search())},nextButtonClicked:function(){this.hasMore&&(this.start=this.nextStart,this.search())},appendQueryParams:function(b){b.start=this.start;b.num=this.numPerPage},processResults:function(b){this.start=
1;var e=this.numPerPage,h=b.total,l=b.queryParams.start;1>l&&(l=1);this.hasLess=!1;this.previousStart=-1;1<l&&(this.hasLess=!0,this.previousStart=l-b.queryParams.num,1>this.previousStart&&(this.previousStart=1));this.hasMore=!1;this.nextStart=-1;b.nextQueryParams&&1<b.nextQueryParams.start&&(this.hasMore=!0,this.nextStart=b.nextQueryParams.start);b="";h>e?(h=1,1<l&&(h=Math.floor(l/e)+1),b=this.i18n.search.paging.pagePattern,b=b.replace("{page}",""+h)):(b=this.i18n.search.paging.pagePattern,b=b.replace("{page}",
"1"));w.setNodeText(this.pageNode,b);this.enableOrDisable()}})})},"widgets/AddData/search/ResultCount":function(){define("dojo/_base/declare dojo/number ./SearchComponent dojo/text!./templates/ResultCount.html dojo/i18n!../nls/strings ./util".split(" "),function(p,h,q,l,e,w){return p([q],{i18n:e,templateString:l,typePlural:e.search.resultCount.itemPlural,typeSingular:e.search.resultCount.itemSingular,postCreate:function(){this.inherited(arguments)},processResults:function(b){b=b.total;var e=this.typePlural;
1===b&&(e=this.typeSingular);var l=this.i18n.search.resultCount.countPattern,l=l.replace("{count}",h.format(b)),l=l.replace("{type}",e);w.setNodeText(this.messageNode,l)}})})},"widgets/AddData/search/AddFromUrlPane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/on dojo/keys dojo/Deferred dojo/promise/all dojo/dom-class dojo/window dijit/Viewport dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/AddFromUrlPane.html dojo/i18n!../nls/strings ./LayerLoader ./util esri/layers/ArcGISDynamicMapServiceLayer esri/layers/ArcGISImageServiceLayer esri/layers/ArcGISTiledMapServiceLayer esri/layers/CSVLayer esri/layers/FeatureLayer esri/layers/GeoRSSLayer esri/layers/ImageParameters esri/layers/KMLLayer esri/layers/StreamLayer esri/layers/VectorTileLayer esri/layers/WMSLayer esri/layers/WMTSLayer esri/InfoTemplate jimu/dijit/Message dijit/form/Select dijit/form/ValidationTextBox".split(" "),
function(p,h,q,l,e,w,b,r,t,x,E,z,H,y,F,C,G,A,c,n,D,u,B,I,g,a,d,m,f,k,J){return p([E,z,H],{i18n:F,templateString:y,wabWidget:null,_dfd:null,postCreate:function(){this.inherited(arguments);this._updateExamples("ArcGIS");this.urlTextBox.set("invalidMessage",F.addFromUrl.invalidURL);var a=this;this.own(l(this.urlTextBox,"keyup",function(c){c.keyCode===e.ENTER?a.addClicked():r.contains(a.addButton,"disabled")||a._setStatus("")}));this.own(l(this.urlTextBox,"focus",function(){try{a.urlTextBox.select()}catch(v){}}));
this.own(l(this.typeSelect,"change",function(c){a._updateExamples(c)}));this.own(l(this.typeSelect.dropDown,"open",function(){var a=this.domNode.parentElement;a&&r.add(a,"add-data-widget-popup")}));this.own(x.on("resize",a.resize()))},destroy:function(){this.inherited(arguments)},addClicked:function(){var a=this,c=!1,d=this.addButton;if(!r.contains(d,"disabled")){var b=this.typeSelect.get("value"),f=h.trim(this.urlTextBox.value);0<f.length&&f&&(c=!0);c&&(r.add(d,"disabled"),a._setStatus(F.search.item.messages.adding),
c=new w,this._handleAdd(c,this.wabWidget.map,b,f),c.then(function(c){c?a._setStatus(""):a._setStatus(F.search.item.messages.addFailed);r.remove(d,"disabled")}).otherwise(function(c){"string"===typeof c&&"Unsupported"===c?(a._setStatus(F.search.item.messages.unsupported),r.remove(d,"disabled")):(console.warn("Add layer failed."),console.warn(c),a._setStatus(F.search.item.messages.addFailed),r.remove(d,"disabled"),c&&"string"===typeof c.message&&0<c.message.length&&(a._setStatus(c.message),console.log("")))}))}},
examplesExpanderClicked:function(){r.toggle(this.examplesNode,"show")},preHide:function(){},resize:function(){var a=t.getBox(this.ownerDocument);a&&"undefined"!==typeof a.w&&(600<a.w?r.add(this.urlTextBox,"url-textbox-wide"):r.remove(this.urlTextBox,"url-textbox-wide"))},_handleAdd:function(e,h,l,r){r=G.checkMixedContent(r);var p=r.toLowerCase(),t=new C,v=t._generateLayerId(),x=this,z=null;"ArcGIS"===l?0<p.indexOf("/featureserver")||0<p.indexOf("/mapserver")?t._readRestInfo(r).then(function(a){if(a&&
"string"===typeof a.type&&("Feature Layer"===a.type||"Table"===a.type))z=new u(r,{id:v,outFields:["*"],infoTemplate:new k}),x._waitThenAdd(e,h,l,t,z);else if(0<p.indexOf("/featureserver")){var c=[];q.forEach(a.layers,function(a){a=new u(r+"/"+a.id,{id:t._generateLayerId(),outFields:["*"],infoTemplate:new k});c.push(t._waitForLayer(a))});q.forEach(a.tables,function(a){a=new u(r+"/"+a.id,{id:t._generateLayerId(),outFields:["*"]});c.push(t._waitForLayer(a))});b(c).then(function(a){var c=[];q.forEach(a,
function(a){c.push(a)});c.reverse();q.forEach(c,function(a){t._setFeatureLayerInfoTemplate(a);a.xtnAddData=!0;h.addLayer(a)});e.resolve(c)}).otherwise(function(a){e.reject(a)})}else if(0<p.indexOf("/mapserver")){if(a.tileInfo)z=new n(r,{id:v});else{var d={id:v};a&&a.supportedImageFormatTypes&&-1!==a.supportedImageFormatTypes.indexOf("PNG32")&&(d.imageParameters=new I,d.imageParameters.format="png32");z=new A(r,d)}x._waitThenAdd(e,h,l,t,z)}}).otherwise(function(a){e.reject(a)}):0<p.indexOf("/imageserver")?
(z=new c(r,{id:v}),this._waitThenAdd(e,h,l,t,z)):0<p.indexOf("/vectortileserver")||0<p.indexOf("/resources/styles/root.json")?d&&d.supported()?t._checkVectorTileUrl(r,{}).then(function(a){z=new d(a,{id:v});x._waitThenAdd(e,h,l,t,z)}).otherwise(function(a){e.reject(a)}):e.reject("Unsupported"):0<p.indexOf("/streamserver")?(z=new a(r,{id:v,purgeOptions:{displayCount:1E4},infoTemplate:new k}),this._waitThenAdd(e,h,l,t,z)):e.reject("Unsupported"):"WMS"===l?(z=new m(r,{id:v}),this._waitThenAdd(e,h,l,t,
z)):"WMTS"===l?z=new f(r,{id:v}):"WFS"===l?G.loadWFSByUrl(e,h,t,r,v,!0):"KML"===l?(z=new g(r,{id:v}),this._waitThenAdd(e,h,l,t,z)):"GeoRSS"===l?(z=new B(r,{id:v}),this._waitThenAdd(e,h,l,t,z)):"CSV"===l&&(z=new D(r,{id:v}),z.setInfoTemplate(t._newInfoTemplate()),this._waitThenAdd(e,h,l,t,z))},_persist:function(){try{var a=this.typeSelect.get("value"),c=h.trim(this.urlTextBox.value);this.wabWidget.xtnAddFromUrlPane={type:a,url:c}}catch(P){}},_restore:function(){try{var a=this.wabWidget.xtnAddFromUrlPane;
a&&"string"===typeof a.type&&0<a.type.length&&this.typeSelect.set("value",a.type);a&&"string"===typeof a.url&&0<a.url.length&&(this.urlTextBox.value=a.url)}catch(v){}},_setStatus:function(a){this.wabWidget&&this.wabWidget._setStatus(a)},_showLayers:function(){this.wabWidget&&this.wabWidget.showLayers()},_updateExamples:function(a){q.forEach(this.examplesNode.children,function(c){var d=c.getAttribute("data-examples-type");"string"===typeof d&&0<d.length&&(c.style.display=d===a?"":"none")})},_waitThenAdd:function(a,
c,d,b,f){b._waitForLayer(f).then(function(f){"WMS"===d?b._setWMSVisibleLayers(f):f&&"esri.layers.ArcGISDynamicMapServiceLayer"===f.declaredClass?b._setDynamicLayerInfoTemplates(f):f&&"esri.layers.FeatureLayer"===f.declaredClass?b._setFeatureLayerInfoTemplate(f):f&&"esri.layers.CSVLayer"===f.declaredClass&&b._setFeatureLayerInfoTemplate(f);f.xtnAddData=!0;if("KML"===d){var k=c.spatialReference,g=f._outSR;k&&g&&(k.equals(g)||k.isWebMercator()&&4326===g.wkid||g.isWebMercator()&&4326===k.wkid)?c.addLayer(f):
new J({titleLabel:F._widgetLabel,message:F.addFromFile.kmlProjectionMismatch})}else c.addLayer(f);a.resolve(f)}).otherwise(function(c){a.reject(c)})}})})},"esri/layers/CSVLayer":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/lang dojo/has ../kernel ../arcgis/csv ./FeatureLayer ../geometry/Extent ../tasks/FeatureSet".split(" "),function(p,h,q,l,e,w,b,r,t){h=h(b,{declaredClass:"esri.layers.CSVLayer",_preventInit:!0,_fieldTypeMap:{Date:"esriFieldTypeDate",Number:"esriFieldTypeDouble",
String:"esriFieldTypeString"},constructor:function(b,e){this.url=b;e=q.mixin({},e);this.columnDelimiter=e.columnDelimiter;this.latitudeFieldName=e.latitudeFieldName;this.longitudeFieldName=e.longitudeFieldName;b=e.layerDefinition;b||(b={fields:e.fields||[],geometryType:"esriGeometryPoint",copyrightText:e.copyright},e.fields&&p.forEach(e.fields,function(b){b.type=this._fieldTypeMap[b.type||"String"];b.alias||(b.alias=b.name)},this));this._buildCsvFcParam={url:this.url,columnDelimiter:this.columnDelimiter,
layerDefinition:b,outFields:e.outFields};this.latitudeFieldName&&this.longitudeFieldName&&(this._buildCsvFcParam.locationInfo={locationType:"coordinates",latitudeFieldName:this.latitudeFieldName,longitudeFieldName:this.longitudeFieldName});this._projectFeatures=q.hitch(this,this._projectFeatures);this._addFeatures=q.hitch(this,this._addFeatures);this._initCSVLayer(e)},refresh:function(){this._fireUpdateStart();this.applyEdits(null,null,this.graphics);this._loadFeatures()},_isWebGLCompatible:function(){return!1},
_setMap:function(b){var e=this.inherited(arguments);this._fireUpdateStart();this._projectFeatures(this._csvFC).then(this._addFeatures).otherwise(this._errorHandler);this._csvFC=null;return e},_initCSVLayer:function(b){var e=this;w.buildCSVFeatureCollection(this._buildCsvFcParam).then(function(h){!e._buildCsvFcParam.locationInfo||e.latitudeFieldName&&e.longitudeFieldName||(e.latitudeFieldName=e._buildCsvFcParam.locationInfo.latitudeFieldName,e.longitudeFieldName=e._buildCsvFcParam.locationInfo.longitudeFieldName);
e._csvFC=h;var l=h.layerDefinition;l.extent=e._getFCExtent(h);b.outFields||(b.outFields=["*"]);b.timeInfo&&(l.timeInfo=b.timeInfo);e._initFeatureLayer({layerDefinition:l},b)}).otherwise(this._errorHandler)},_loadFeatures:function(){w.buildCSVFeatureCollection(this._buildCsvFcParam).then(this._projectFeatures).then(this._addFeatures).otherwise(this._errorHandler)},_projectFeatures:function(b){return w.projectFeatureCollection(b,this._map.spatialReference)},_addFeatures:function(b){b=new t(b.featureSet);
this.applyEdits(b.features,null,null);this._fireUpdateEnd()},_getFCExtent:function(b){var e;if(b&&b.featureSet&&b.featureSet.features){b=b.featureSet.features;var h=b.length;if(1<h){var l=b[0].geometry;e=new r(l.x,l.y,l.x,l.y);for(--h;0<h;h--)l=b[h].geometry,e.xmin=Math.min(e.xmin,l.x),e.ymin=Math.min(e.ymin,l.y),e.xmax=Math.max(e.xmax,l.x),e.ymax=Math.max(e.ymax,l.y);0>=e.getWidth()&&0>=e.getHeight()&&(e=null)}}return e}});l("extend-esri")&&q.setObject("layers.CSVLayer",h,e);return h})},"esri/arcgis/csv":function(){define("dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/sniff dojo/number dojox/data/CsvStore ../kernel ../config ../request ../SpatialReference ../geometry/jsonUtils ../geometry/webMercatorUtils".split(" "),
function(p,h,q,l,e,w,b,r,t,x,E,z){function H(c){var b=0,e="";h.forEach([","," ",";","|","\t"],function(g){var a=c.split(g).length;a>b&&(b=a,e=g)});return e}function y(c,b){if(!c||"[object Date]"!==Object.prototype.toString.call(c)||isNaN(c.getTime()))return!1;c=!0;if(l("chrome")&&/\d+\W*$/.test(b)){if(b.match(/[^0-9a-zA-Z\s]/))return!1;if(b=b.match(/[a-zA-Z]{2,}/)){c=!1;for(var e=0,g=b.length,a=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i;!c&&
e<=g&&!(c=!a.test(b[e]));)e++;c=!c}}return c}function F(b,B,l){var g=b.indexOf("\n"),g=p.trim(b.substr(0,g)),a=B.columnDelimiter;a||(a=H(g));var d=new w({data:b,separator:a});d.fetch({onComplete:function(a,b){b=0;var f={layerDefinition:B.layerDefinition,featureSet:{features:[],geometryType:"esriGeometryPoint"}},g=f.layerDefinition.objectIdField,m=f.layerDefinition.fields;g||h.some(m,function(a){return"esriFieldTypeOID"===a.type?(g=a.name,!0):!1})||(m.push({name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",
editable:!1}),g="__OBJECTID");var u,r,t=d._attributes,D=[],q=[];h.forEach(m,function(a){"esriFieldTypeDate"===a.type?D.push(a.name):"esriFieldTypeDouble"!==a.type&&"esriFieldTypeInteger"!==a.type||q.push(a.name)});B.locationInfo&&"coordinates"===B.locationInfo.locationType?(u=B.locationInfo.latitudeFieldName,r=B.locationInfo.longitudeFieldName):(h.forEach(t,function(a){var d;d=h.indexOf(c,a.toLowerCase());-1!==d&&(u=a);d=h.indexOf(n,a.toLowerCase());-1!==d&&(r=a)}),u&&r&&(B.locationInfo={locationType:"coordinates",
latitudeFieldName:u,longitudeFieldName:r}));if(u&&r){-1===h.indexOf(q,u)&&q.push(u);-1===h.indexOf(q,r)&&q.push(r);var I;p.isArray(B.outFields)&&-1===h.indexOf(B.outFields,"*")&&(I=B.outFields);h.forEach(t,function(a){h.some(m,function(c){return a===c.name})||m.push({name:a,alias:a,type:a===u||a===r?"esriFieldTypeDouble":"esriFieldTypeString"})});var t=0,z=a.length;for(t;t<z;t++){var C=a[t],x=d.getAttributes(C),A={};h.forEach(x,function(a){if(a&&(a===u||a===r||!I||-1<h.indexOf(I,a))){var c=a;0===
a.length&&h.forEach(m,function(c,d){c.name==="attribute_"+(d-1)&&(a="attribute_"+(d-1))});if(-1<h.indexOf(D,a)){var c=d.getValue(C,c),b=new Date(c);A[a]=y(b,c)?b.getTime():null}else-1<h.indexOf(q,a)?(b=e.parse(d.getValue(C,c)),a!==u&&a!==r||!(isNaN(b)||181<Math.abs(b))||(b=parseFloat(d.getValue(C,c))),isNaN(b)?A[a]=null:A[a]=b):A[a]=d.getValue(C,c)}});A[g]=b;b++;var x=A[u],G=A[r];null==G||null==x||isNaN(x)||isNaN(G)||(I&&-1===h.indexOf(I,u)&&delete A[u],I&&-1===h.indexOf(I,r)&&delete A[r],f.featureSet.features.push({geometry:{x:G,
y:x,spatialReference:{wkid:4326}},attributes:A}))}f.layerDefinition.name="csv";l&&l(f)}else setTimeout(function(){console.error("File does not seem to contain fields with point coordinates.")},1),l&&l(null,Error("File does not seem to contain fields with point coordinates."))},onError:function(a){console.error("Error fetching items from CSV store: ",a);l&&l(null,a)}});return!0}function C(c,b,e,g,a,d){0===c.length&&a(null);var n=E.getGeometryType(b),f=[];h.forEach(c,function(a){a=new n(a);a.spatialReference=
e;f.push(a)},this);b=[102113,102100,3857];e.wkid&&4326===e.wkid&&g.wkid&&-1<h.indexOf(b,g.wkid)?(h.forEach(f,function(a){a.xmin?(a.xmin=Math.max(a.xmin,-180),a.xmax=Math.min(a.xmax,180),a.ymin=Math.max(a.ymin,-89.99),a.ymax=Math.min(a.ymax,89.99)):a.rings?h.forEach(a.rings,function(a){h.forEach(a,function(a){a[0]=Math.min(Math.max(a[0],-180),180);a[1]=Math.min(Math.max(a[1],-89.99),89.99)},this)},this):a.paths?h.forEach(a.paths,function(a){h.forEach(a,function(a){a[0]=Math.min(Math.max(a[0],-180),
180);a[1]=Math.min(Math.max(a[1],-89.99),89.99)},this)},this):a.x&&(a.x=Math.min(Math.max(a.x,-180),180),a.y=Math.min(Math.max(a.y,-89.99),89.99))},this),c=[],h.forEach(f,function(a){a=z.geographicToWebMercator(a);102100!==g.wkid&&(a.spatialReference=g);c.push(a.toJson())},this),a(c)):null!==e.wkid&&-1<h.indexOf(b,e.wkid)&&null!==g.wkid&&4326===g.wkid?(c=[],h.forEach(f,function(a){c.push(z.webMercatorToGeographic(a).toJson())},this),a(c)):(b=function(b,f){b&&b.length===c.length?(c=[],h.forEach(b,
function(a){a&&(a.rings&&0<a.rings.length&&0<a.rings[0].length&&0<a.rings[0][0].length&&!isNaN(a.rings[0][0][0])&&!isNaN(a.rings[0][0][1])||a.paths&&0<a.paths.length&&0<a.paths[0].length&&0<a.paths[0][0].length&&!isNaN(a.paths[0][0][0])&&!isNaN(a.paths[0][0][1])||a.xmin&&!isNaN(a.xmin)&&a.ymin&&!isNaN(a.ymin)||a.x&&!isNaN(a.x)&&a.y&&!isNaN(a.y))?c.push(a.toJson()):c.push(null)},this),a(c)):d(b,f)},r.defaults.geometryService?r.defaults.geometryService.project(f,g,p.hitch(this,b),d):a(null))}function G(c,
b){var e=[102113,102100,3857];return c&&b&&c.wkid===b.wkid&&c.wkt===b.wkt||c&&b&&c.wkid&&b.wkid&&-1<h.indexOf(e,c.wkid)&&-1<h.indexOf(e,b.wkid)?!0:!1}function A(c,b,e,g){if(c.featureSet&&0!==c.featureSet.features.length)if(G(e,b))g(c);else{var a,d=function(a){var b=[];h.forEach(c.featureSet.features,function(c,d){a[d]&&(c.geometry=a[d],b.push(c))},this);g(c)},n=function(a,b){console.error("error projecting featureSet ("+c.layerDefinition.name+"). Final try.");g(c)},f=function(f,g){console.error("error projecting featureSet ("+
c.layerDefinition.name+"). Try one more time.");C(a,c.featureSet.geometryType,b,e,p.hitch(this,d),p.hitch(this,n))};c.featureSet.features&&0<c.featureSet.features.length?(a=[],h.forEach(c.featureSet.features,function(b){if(b.geometry.toJson)a.push(b.geometry);else{var d=E.getGeometryType(c.featureSet.geometryType);a.push(new d(b.geometry))}}),b.toJson||(b=new x(b)),e.toJson||(e=new x(e)),C(a,c.featureSet.geometryType,b,e,p.hitch(this,d),p.hitch(this,f))):g(c)}}var c="lat latitude y ycenter latitude83 latdecdeg point-y lat_dd".split(" "),
n="lon lng long longitude x xcenter longitude83 longdecdeg point-x long_dd".split(" "),D={latFieldStrings:c,longFieldStrings:n,buildCSVFeatureCollection:function(c){var b=new q,e=function(a,c){c?b.errback(c):b.callback(a)},g={url:c.url,handleAs:"text",load:function(a){F(a,c,p.hitch(this,e))},error:function(a){b.errback(a);console.error("error: "+a)}};-1<c.url.indexOf("arcgis.com")&&-1<c.url.indexOf("/content/items")&&-1<c.url.indexOf("/data")&&(g.headers={"Content-Type":""});t(g,{usePost:!1});return b},
projectFeatureCollection:function(c,b,e){var g=new q;e||(e=new x({wkid:4326}));A(c,e,b,p.hitch(this,function(a){g.callback(a)}));return g},generateDefaultPopupInfo:function(c){var b={esriFieldTypeDouble:1,esriFieldTypeSingle:1},e={esriFieldTypeInteger:1,esriFieldTypeSmallInteger:1},g={esriFieldTypeDate:1},a=null;c=h.map(c.layerDefinition.fields,p.hitch(this,function(c){"NAME"===c.name.toUpperCase()&&(a=c.name);var d="esriFieldTypeOID"!==c.type&&"esriFieldTypeGlobalID"!==c.type&&"esriFieldTypeGeometry"!==
c.type,f=null;if(d){var k=c.name.toLowerCase();if(-1<",stretched value,fnode_,tnode_,lpoly_,rpoly_,poly_,subclass,subclass_,rings_ok,rings_nok,".indexOf(","+k+",")||-1<k.indexOf("area")||-1<k.indexOf("length")||-1<k.indexOf("shape")||-1<k.indexOf("perimeter")||-1<k.indexOf("objectid")||k.indexOf("_")===k.length-1||k.indexOf("_i")===k.length-2&&1<k.length)d=!1;c.type in e?f={places:0,digitSeparator:!0}:c.type in b?f={places:2,digitSeparator:!0}:c.type in g&&(f={dateFormat:"shortDateShortTime"})}return p.mixin({},
{fieldName:c.name,label:c.alias,isEditable:!0,tooltip:"",visible:d,format:f,stringFieldOption:"textbox"})}));return{title:a?"{"+a+"}":"",fieldInfos:c,description:null,showAttachments:!1,mediaInfos:[]}},_getSeparator:H,_isValidDate:y,_processCsvData:F,_projectGeometries:C,_sameSpatialReference:G,_projectFeatureSet:A};l("extend-esri")&&p.setObject("arcgis.csv",D,b);return D})},"dojox/data/CsvStore":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/xhr dojo/_base/kernel dojo/data/util/filter dojo/data/util/simpleFetch".split(" "),
function(p,h,q,l,e,w){h=h("dojox.data.CsvStore",null,{constructor:function(b){this._attributes=[];this._attributeIndexes={};this._dataArray=[];this._arrayOfAllItems=[];this._loadFinished=!1;b.url&&(this.url=b.url);this._csvData=b.data;b.label?this.label=b.label:""===this.label&&(this.label=void 0);this._storeProp="_csvStore";this._idProp="_csvId";this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0};this._loadInProgress=!1;this._queuedFetches=[];this.identifier=b.identifier;""===this.identifier?
delete this.identifier:this._idMap={};"separator"in b&&(this.separator=b.separator);"urlPreventCache"in b&&(this.urlPreventCache=b.urlPreventCache?!0:!1)},url:"",label:"",identifier:"",separator:",",urlPreventCache:!1,_assertIsItem:function(b){if(!this.isItem(b))throw Error(this.declaredClass+": a function was passed an item argument that was not an item");},_getIndex:function(b){b=this.getIdentity(b);this.identifier&&(b=this._idMap[b]);return b},getValue:function(b,e,h){this._assertIsItem(b);var l=
h;if("string"===typeof e)e=this._attributeIndexes[e],null!=e&&(l=this._dataArray[this._getIndex(b)][e]||h);else throw Error(this.declaredClass+": a function was passed an attribute argument that was not a string");return l},getValues:function(b,e){return(b=this.getValue(b,e))?[b]:[]},getAttributes:function(b){this._assertIsItem(b);var e=[];b=this._dataArray[this._getIndex(b)];for(var h=0;h<b.length;h++)""!==b[h]&&e.push(this._attributes[h]);return e},hasAttribute:function(b,e){this._assertIsItem(b);
if("string"===typeof e)return e=this._attributeIndexes[e],b=this._dataArray[this._getIndex(b)],"undefined"!==typeof e&&e<b.length&&""!==b[e];throw Error(this.declaredClass+": a function was passed an attribute argument that was not a string");},containsValue:function(b,h,l){var r=void 0;"string"===typeof l&&(r=e.patternToRegExp(l,!1));return this._containsValue(b,h,l,r)},_containsValue:function(b,e,h,l){b=this.getValues(b,e);for(e=0;e<b.length;++e){var r=b[e];if("string"===typeof r&&l)return null!==
r.match(l);if(h===r)return!0}return!1},isItem:function(b){if(b&&b[this._storeProp]===this)if(b=b[this._idProp],this.identifier){if(this._dataArray[this._idMap[b]])return!0}else if(0<=b&&b<this._dataArray.length)return!0;return!1},isItemLoaded:function(b){return this.isItem(b)},loadItem:function(b){},getFeatures:function(){return this._features},getLabel:function(b){if(this.label&&this.isItem(b))return this.getValue(b,this.label)},getLabelAttributes:function(b){return this.label?[this.label]:null},
_fetchItems:function(b,h,l){var r=this,p=function(b,l){var p=null;if(b.query){var q,c,p=[],n=b.queryOptions?b.queryOptions.ignoreCase:!1,D={};for(q in b.query)c=b.query[q],"string"===typeof c&&(D[q]=e.patternToRegExp(c,n));for(n=0;n<l.length;++n){var u=!0,B=l[n];for(q in b.query)c=b.query[q],r._containsValue(B,q,c,D[q])||(u=!1);u&&p.push(B)}}else p=l.slice(0,l.length);h(p,b)};if(this._loadFinished)p(b,this._arrayOfAllItems);else if(""!==this.url)if(this._loadInProgress)this._queuedFetches.push({args:b,
filter:p});else{this._loadInProgress=!0;var t=q.get({url:r.url,handleAs:"text",preventCache:r.urlPreventCache});t.addCallback(function(e){try{r._processData(e),p(b,r._arrayOfAllItems),r._handleQueuedFetches()}catch(C){l(C,b)}});t.addErrback(function(e){r._loadInProgress=!1;if(l)l(e,b);else throw e;});var w=null;b.abort&&(w=b.abort);b.abort=function(){var e=t;e&&-1===e.fired&&(e.cancel(),e=null);w&&w.call(b)}}else if(this._csvData)try{this._processData(this._csvData),this._csvData=null,p(b,this._arrayOfAllItems)}catch(F){l(F,
b)}else{var y=Error(this.declaredClass+": No CSV source data was provided as either URL or String data input.");if(l)l(y,b);else throw y;}},close:function(b){},_getArrayOfArraysFromCsvFileContents:function(b){if(p.isString(b)){var e=/^\s+/g,h=/\s+$/g,l=/""/g,q=[],z=this._splitLines(b);for(b=0;b<z.length;++b){var w=z[b];if(0<w.length){for(var w=w.split(this.separator),y=0;y<w.length;){var F=w[y].replace(e,""),C=F.replace(h,""),G=C.charAt(0),A=C.charAt(C.length-1),c=C.charAt(C.length-2),n=C.charAt(C.length-
3);if(2===C.length&&'""'==C)w[y]="";else if('"'==G&&('"'!=A||'"'==A&&'"'==c&&'"'!=n)){if(y+1===w.length)return;w[y]=F+this.separator+w[y+1];w.splice(y+1,1)}else'"'==G&&'"'==A&&(C=C.slice(1,C.length-1),C=C.replace(l,'"')),w[y]=C,y+=1}q.push(w)}}this._attributes=q.shift();for(b=0;b<this._attributes.length;b++)this._attributeIndexes[this._attributes[b]]=b;this._dataArray=q}},_splitLines:function(b){var e=[],h,l="",p=!1;for(h=0;h<b.length;h++){var q=b.charAt(h);switch(q){case '"':p=!p;l+=q;break;case "\r":p?
l+=q:(e.push(l),l="",h<b.length-1&&"\n"==b.charAt(h+1)&&h++);break;case "\n":p?l+=q:(e.push(l),l="");break;default:l+=q}}""!==l&&e.push(l);return e},_processData:function(b){this._getArrayOfArraysFromCsvFileContents(b);this._arrayOfAllItems=[];if(this.identifier&&void 0===this._attributeIndexes[this.identifier])throw Error(this.declaredClass+": Identity specified is not a column header in the data set.");for(b=0;b<this._dataArray.length;b++){var e=b;this.identifier&&(e=this._dataArray[b][this._attributeIndexes[this.identifier]],
this._idMap[e]=b);this._arrayOfAllItems.push(this._createItemFromIdentity(e))}this._loadFinished=!0;this._loadInProgress=!1},_createItemFromIdentity:function(b){var e={};e[this._storeProp]=this;e[this._idProp]=b;return e},getIdentity:function(b){return this.isItem(b)?b[this._idProp]:null},fetchItemByIdentity:function(b){var e,h=b.scope?b.scope:l.global;if(this._loadFinished)e=this._createItemFromIdentity(b.identity),this.isItem(e)||(e=null),b.onItem&&b.onItem.call(h,e);else{var p=this;if(""!==this.url)this._loadInProgress?
this._queuedFetches.push({args:b}):(this._loadInProgress=!0,e=q.get({url:p.url,handleAs:"text"}),e.addCallback(function(e){try{p._processData(e);var l=p._createItemFromIdentity(b.identity);p.isItem(l)||(l=null);b.onItem&&b.onItem.call(h,l);p._handleQueuedFetches()}catch(H){b.onError&&b.onError.call(h,H)}}),e.addErrback(function(e){this._loadInProgress=!1;b.onError&&b.onError.call(h,e)}));else if(this._csvData)try{p._processData(p._csvData),p._csvData=null,e=p._createItemFromIdentity(b.identity),p.isItem(e)||
(e=null),b.onItem&&b.onItem.call(h,e)}catch(E){b.onError&&b.onError.call(h,E)}}},getIdentityAttributes:function(b){return this.identifier?[this.identifier]:null},_handleQueuedFetches:function(){if(0<this._queuedFetches.length){for(var b=0;b<this._queuedFetches.length;b++){var e=this._queuedFetches[b],h=e.filter,l=e.args;h?h(l,this._arrayOfAllItems):this.fetchItemByIdentity(e.args)}this._queuedFetches=[]}}});p.extend(h,w);return h})},"esri/layers/GeoRSSLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has ../kernel ../config ../request ../urlUtils ./ServiceGeneratedFeatureCollection".split(" "),
function(p,h,q,l,e,w,b,r,t){p=p([t],{declaredClass:"esri.layers.GeoRSSLayer",serviceUrl:r.getProtocolForWebResource()+"//utility.arcgis.com/sharing/rss",constructor:function(b,e){this._url=r.urlToObject(this.url=b);w.defaults.geoRSSService&&(this.serviceUrl=w.defaults.geoRSSService);this._createLayer()},parse:function(){return this._io=b({url:this.serviceUrl,content:{url:this.url,refresh:this.loaded?!0:void 0,outSR:this._outSR?q.toJson(this._outSR.toJson()):void 0},callbackParamName:"callback"})},
_initLayer:function(b){this.inherited(arguments);this.loaded||(this.loaded=!0,this.onLoad(this))}});l("extend-esri")&&h.setObject("layers.GeoRSSLayer",p,e);return p})},"esri/layers/ServiceGeneratedFeatureCollection":function(){define("dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-style dojo/has ../kernel ../SpatialReference ../geometry/Extent ../geometry/webMercatorUtils ../renderers/SimpleRenderer ./layer ./FeatureLayer ../dijit/PopupTemplate".split(" "),
function(p,h,q,l,e,w,b,r,t,x,E,z,H,y,F){p=p([H],{declaredClass:"esri.layers._ServiceGeneratedFeatureCollection",constructor:function(b,e){this.pointSymbol=e&&e.pointSymbol;this.polylineSymbol=e&&e.polylineSymbol;this.polygonSymbol=e&&e.polygonSymbol;this._outSR=e&&(e.outSpatialReference||e.outSR)||new t({wkid:4326});this._options=q.mixin({},e)},parse:function(){console.error("parse function has not been implemented")},getFeatureLayers:function(){var b=[];this._fLayers&&(b=b.concat(this._fLayers));
return b},onRefresh:function(){},onOpacityChange:function(){},refresh:function(){this.loaded&&this._map&&!this._io&&this.visible&&this._createLayer()},_createLayer:function(b){var e=this;this._fireUpdateStart();b=this.parse(b);b.addCallback(function(b){e._io=null;e._initLayer(b)});b.addErrback(function(b){e._io=null;b=q.mixin(Error(),b);b.message="Unable to load resource: "+e.url+" "+(b.message||"");e._fireUpdateEnd(b);e.onError(b)})},_initLayer:function(b){this.loaded&&this._removeInternalLayers();
this.name=b.name;this.description=b.description;this.snippet=b.snippet;this.featureInfos=b.featureInfos;this.fullExtent=this.initialExtent=new x(b.lookAtExtent);this.copyright=b.author||b.copyright;var e;(b=q.getObject("featureCollection.layers",!1,b))&&0<b.length&&(this._fLayers=[],l.forEach(b,function(b,c){var n=q.getObject("featureSet.features",!1,b);n&&0<n.length&&(e=q.mixin({outFields:["*"],infoTemplate:b.popupInfo?new F(b.popupInfo):null,editable:!1},this._options),e.id&&(e.id=e.id+"_"+c),e.webgl=
!1,b.layerDefinition.capabilities="Query,Data",b=new y(b,e),b.geometryType&&(this["_"+b.geometryType]=b),this._fLayers.push(b))},this),0===this._fLayers.length&&delete this._fLayers);this.items=[];this._esriGeometryPoint&&(this.items=this.items.concat(this._esriGeometryPoint.graphics),this.pointSymbol&&(b=new z(this.pointSymbol),this._esriGeometryPoint.setRenderer(b)));this._esriGeometryPolyline&&(this.items=this.items.concat(this._esriGeometryPolyline.graphics),this.polylineSymbol&&(b=new z(this.polylineSymbol),
this._esriGeometryPolyline.setRenderer(b)));this._esriGeometryPolygon&&(this.items=this.items.concat(this._esriGeometryPolygon.graphics),this.polygonSymbol&&(b=new z(this.polygonSymbol),this._esriGeometryPolygon.setRenderer(b)));this._fireUpdateEnd();this.loaded&&(this._addInternalLayers(),this.onRefresh())},_addInternalLayers:function(){var b=this._map;this._fireUpdateStart();var e=b.spatialReference,h=this._outSR,c;if(e.wkid)c=e._isWebMercator()&&h._isWebMercator()||e.wkid===h.wkid;else if(e.wkt)c=
e.wkt===h.wkt;else{console.log("_setMap - map has invalid spatial reference");return}if(!c)if(e._isWebMercator()&&4326===h.wkid)this._converter=E.geographicToWebMercator;else if(h._isWebMercator()&&4326===e.wkid)this._converter=E.webMercatorToGeographic;else{console.log("_setMap - unsupported workflow. Spatial reference of the map and layer do not match, and the conversion cannot be done on the client.");return}(e=this._fLayers)&&0<e.length&&l.forEach(e,function(c){if(this._converter){var e=c.graphics,
n,h,l=e?e.length:0;for(n=0;n<l;n++)(h=e[n].geometry)&&e[n].setGeometry(this._converter(h))}b.addLayer(c)},this);this.setVisibility(this.visible);this._fireUpdateEnd()},_removeInternalLayers:function(){var b=this._map;b&&l.forEach(this.getFeatureLayers(),b.removeLayer,b)},setScaleRange:function(b,e){this.inherited(arguments);l.forEach(this.getFeatureLayers(),function(h){h.setScaleRange(b,e)});this._options.minScale=this.minScale;this._options.maxScale=this.maxScale},setOpacity:function(b){this.opacity!=
b&&(l.forEach(this.getFeatureLayers(),function(e){e.setOpacity(b)}),this.opacity=this._options.opacity=b,this.onOpacityChange(b))},onVisibilityChange:function(b){this._fireUpdateStart();l.forEach(this.getFeatureLayers(),function(e){e.setVisibility(b)});this._fireUpdateEnd()},_setMap:function(b,h){this.inherited(arguments);this._map=b;var l=this._div=e.create("div",null,h);w.set(l,"position","absolute");this._addInternalLayers();this.evaluateSuspension();return l},_unsetMap:function(b,l){this._io&&
this._io.cancel();h.disconnect(this._extChgHandle);delete this._extChgHandle;this._removeInternalLayers();var p=this._div;p&&(l.removeChild(p),e.destroy(p));this._div=null;this.inherited(arguments)}});b("extend-esri")&&q.setObject("layers._ServiceGeneratedFeatureCollection",p,r);return p})},"esri/layers/WMTSLayer":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/sniff dojox/xml/parser ../kernel ../lang ../request ../urlUtils ../WKIDUnitConversion ../SpatialReference ../geometry/Point ../geometry/Extent ../geometry/webMercatorUtils ./TiledMapServiceLayer ./TileInfo ./WMTSLayerInfo dojo/query".split(" "),
function(p,h,q,l,e,w,b,r,t,x,E,z,H,y,F,C,G,A){h=h([C],{declaredClass:"esri.layers.WMTSLayer",copyright:null,extent:null,tileUrl:null,spatialReference:null,tileInfo:null,constructor:function(c,b){this.version="1.0.0";this.tileUrl=this._url=c;this.serviceMode="RESTful";this._parseCapabilities=q.hitch(this,this._parseCapabilities);this._getCapabilitiesError=q.hitch(this,this._getCapabilitiesError);this._formatDictionary={"image/png":".png","image/png8":".png","image/png24":".png","image/png32":".png",
"image/jpg":".jpg","image/jpeg":".jpeg","image/gif":".gif","image/bmp":".bmp","image/tiff":".tif","image/jpgpng":"","image/jpegpng":"","image/unknown":""};b||(b={});if(b.serviceMode)if("KVP"===b.serviceMode||"RESTful"===b.serviceMode)this.serviceMode=b.serviceMode;else{console.error("WMTS mode could only be 'KVP' or 'RESTful'");return}this.customParameters=b.customParameters;this.customLayerParameters=b.customLayerParameters;this.layerInfo=new A;b.layerInfo&&(this.layerInfo=b.layerInfo,this._identifier=
b.layerInfo.identifier,this._tileMatrixSetId=b.layerInfo.tileMatrixSet,b.layerInfo.format&&(this.format="image/"+b.layerInfo.format),this._style=b.layerInfo.style,this.title=b.layerInfo.title,this._dimension=b.layerInfo.dimension,this._dimension2=b.layerInfo.dimension2);b.resourceInfo?(this.version=b.resourceInfo.version,b.resourceInfo.getTileUrl&&(this._url=this.tileUrl=b.resourceInfo.getTileUrl),this.copyright=b.resourceInfo.copyright,this.layerInfos=b.resourceInfo.layerInfos,this.customParameters=
b.resourceInfo.customParameters||this.customParameters,this.customLayerParameters=b.resourceInfo.customLayerParameters||this.customLayerParameters,this._parseResourceInfo(),this.loaded=!0,this.onLoad(this)):this._getCapabilities()},setActiveLayer:function(c){this.setVisibleLayer(c)},setVisibleLayer:function(c){this._setActiveLayer(c);this.refresh(!0)},setCustomParameters:function(c,b){this.customParameters=c;this.customLayerParameters=b;this.refresh(!0)},getTileUrl:function(c,b,e){c=this._levelToLevelValue[c];
c=this.resourceUrls&&0<this.resourceUrls.length?this.resourceUrls[b%this.resourceUrls.length].template.replace(/\{Style\}/gi,this._style).replace(/\{TileMatrixSet\}/gi,this._tileMatrixSetId).replace(/\{TileMatrix\}/gi,c).replace(/\{TileRow\}/gi,b).replace(/\{TileCol\}/gi,e).replace(/\{dimensionValue\}/gi,this._dimension).replace(/\{dimensionValue2\}/gi,this._dimension2):this.UrlTemplate.replace(/\{level\}/gi,c).replace(/\{row\}/gi,b).replace(/\{col\}/gi,e);c=this._appendCustomLayerParameters(c);c=
this.addTimestampToURL(c);return x.addProxy(c)},getTileUrlTemplate:function(c){var b=c.identifier,e=c.tileMatrixSet,h=c.format,B=c.style,p=c.dimension,g=c.dimension2;b?c=l.filter(this.layers,function(a){return a.identifier===b})[0]:(c=this.layers[0],b=this.layers[0].identifier);if(c){if(!h)h=c.formats[0];else if(!(-1===h.indexOf("image/")&&-1<l.indexOf(c.formats,h))&&(-1===h.indexOf("image/")&&(h="image/"+h),-1===l.indexOf(c.formats,h))){console.error("The layer doesn't support the format of "+h);
this.onError(Error("The layer doesn't support the format of "+h));return}if(!B)B=c.styles[0];else if(-1===l.indexOf(c.styles,B)){console.error("The layer doesn't support the style of "+B);this.onError(Error("The layer doesn't support the style of "+B));return}if(!p&&c.dimensions)p=c.dimensions[0];else if(-1===l.indexOf(c.dimensions,p)){console.error("The layer doesn't support the dimension of "+p);this.onError(Error("The layer doesn't support the dimension of "+p));return}if(!g&&c.dimensions2)g=c.dimensions2[0];
else if(-1===l.indexOf(c.dimensions2,g)){console.error("The layer doesn't support the dimension of "+g);this.onError(Error("The layer doesn't support the dimension of "+g));return}var a;if(e){if(a=l.filter(c.tileMatrixSetInfos,function(a){return a.tileMatrixSet===e})[0],!a){console.error("The tileMatrixSetId "+e+" is not supported by the layer of "+b);this.onError(Error("The tileMatrixSetId "+e+" is not supported by the layer of "+b));return}}else(a=l.filter(c.tileMatrixSetInfos,function(a){return"GoogleMapsCompatible"===
a.tileMatrixSet})[0])||(a=c.tileMatrixSetInfos[0]),e=a.tileMatrixSet;return this._getTileUrlTemplate(b,e,h,B,p,g)}console.error("couldn't find the layer "+b);this.onError(Error("couldn't find the layer "+b))},_getTileUrlTemplate:function(c,b,e,h,l,p){var g;c||(c=this._identifier);b||(b=this._tileMatrixSetId);e||(e=this.format);h||""===h||(h=this._style);if(this.resourceUrls&&0<this.resourceUrls.length)return g=this.resourceUrls[0].template,g.indexOf(".xxx")===g.length-4&&(g=g.slice(0,g.length-4)),
g=g.replace(/\{Style\}/gi,h),g=g.replace(/\{TileMatrixSet\}/gi,b),g=g.replace(/\{TileMatrix\}/gi,"{level}"),g=g.replace(/\{TileRow\}/gi,"{row}"),g=g.replace(/\{TileCol\}/gi,"{col}"),g=g.replace(/\{dimensionValue\}/gi,l),g=g.replace(/\{dimensionValue2\}/gi,p);"KVP"===this.serviceMode?g=this._url+"SERVICE\x3dWMTS\x26VERSION\x3d"+this.version+"\x26REQUEST\x3dGetTile\x26LAYER\x3d"+c+"\x26STYLE\x3d"+h+"\x26FORMAT\x3d"+e+"\x26TILEMATRIXSET\x3d"+b+"\x26TILEMATRIX\x3d{level}\x26TILEROW\x3d{row}\x26TILECOL\x3d{col}":
"RESTful"===this.serviceMode&&(l="",this._formatDictionary[e.toLowerCase()]&&(l=this._formatDictionary[e.toLowerCase()]),g=this._url+c+"/"+h+"/"+b+"/{level}/{row}/{col}"+l);return g},_parseResourceInfo:function(){var b=this.layerInfos,e,h;"KVP"===this.serviceMode&&(this._url+=-1<this._url.indexOf("?")?"":"?");for(h=0;h<b.length;h++)if(!(this._identifier&&b[h].identifier!==this._identifier||this.title&&b[h].title!==this.title||this._tileMatrixSetId&&b[h].tileMatrixSet!==this._tileMatrixSetId||this.format&&
"image/"+b[h].format!==this.format||this._style&&b[h].style!==this._style)){q.mixin(this,{description:b[h].description,tileInfo:b[h].tileInfo,spatialReference:b[h].tileInfo.spatialReference,fullExtent:b[h].fullExtent,initialExtent:b[h].initialExtent,_identifier:b[h].identifier,_tileMatrixSetId:b[h].tileMatrixSet,format:"image/"+b[h].format,_style:b[h].style});break}for(h=0;h<b.length;h++)e=b[h].tileInfo,96!==e.dpi&&(l.forEach(e.lods,function(b){b.scale=96*b.scale/e.dpi}),e.dpi=96),l.forEach(e.lods,
function(c){c.resolution=this._getResolution(e.spatialReference.wkid,90.71428571428571*c.scale/96,b[h].tileMatrixSet)},this);this._setActiveLayer();this.UrlTemplate=this._getTileUrlTemplate();this._levelToLevelValue=[];l.forEach(this.tileInfo.lods,function(b){this._levelToLevelValue[b.level]=b.levelValue?b.levelValue:b.level},this)},_getCapabilities:function(){var b;"KVP"===this.serviceMode?b=-1<this._url.indexOf("?")?this._url+"\x26request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+this.version:
this._url+"?request\x3dGetCapabilities\x26service\x3dWMTS\x26version\x3d"+this.version:"RESTful"===this.serviceMode&&(b=this._url+"/"+this.version+"/WMTSCapabilities.xml");b=this._appendCustomParameters(b);t({url:b,handleAs:"text",load:this._parseCapabilities,error:this._getCapabilitiesError})},_parseCapabilities:function(b){b=b.replace(/ows:/gi,"");b=w.parse(b);var c=p.query("Contents",b)[0];if(c){var e=p.query("OperationsMetadata",b)[0],h=p.query("[name\x3d'GetTile']",e)[0],e=this._url,h=p.query("Get",
h),B,q=!1,g,a;for(B=0;B<h.length;B++){var d=p.query("Constraint",h[B])[0];if(!d||this._getTagWithChildTagValue("AllowedValues","Value",this.serviceMode,d)){e=h[B].attributes[0].nodeValue;q=!0;break}else if(!d||this._getTagWithChildTagValue("AllowedValues","Value","RESTful",d))g=h[B].attributes[0].nodeValue;else if(!d||this._getTagWithChildTagValue("AllowedValues","Value","KVP",d))a=h[B].attributes[0].nodeValue}q||("KVP"===this.serviceMode&&g?(e=g,this.serviceMode="RESTful"):"RESTful"===this.serviceMode&&
a&&(e=a,this.serviceMode="KVP"));-1===e.indexOf("/1.0.0/")&&"RESTful"===this.serviceMode&&(e+="/");"KVP"===this.serviceMode&&(e+=-1<e.indexOf("?")?"":"?");this._url=e;this.copyright=this._getTagValues("Capabilities\x3eServiceIdentification\x3eAccessConstraints",b)[0];g=p.query("Layer",c);var m,f=[];this.layers=[];l.forEach(g,function(a){m=this._getTagValues("Identifier",a)[0];f.push(m);this.layers.push(this._getWMTSLayerInfo(m,a,c))},this);this._setActiveLayer();this.loaded=!0;this.onLoad(this)}else console.error("The WMTS capabilities XML is not valid"),
this.onError(Error("The WMTS capabilities XML is not valid"))},_setActiveLayer:function(b){b||(b={});b.identifier&&(this._identifier=b.identifier);b.tileMatrixSet&&(this._tileMatrixSetId=b.tileMatrixSet);b.format&&(this.format=b.format);b.style&&(this._style=b.style);b.dimension&&(this._dimension=b.dimension);b.dimension2&&(this._dimension2=b.dimension2);if(this.layers)if(this._identifier?b=l.filter(this.layers,function(b){return b.identifier===this._identifier},this)[0]:(b=this.layers[0],this._identifier=
this.layers[0].identifier),b){if(this.format){if(-1===this.format.indexOf("image/")&&(this.format="image/"+this.format),-1===l.indexOf(b.formats,this.format)){console.error("The layer doesn't support the format of "+this.format);this.onError(Error("The layer doesn't support the format of "+this.format));return}}else this.format=b.formats[0],-1===this.format.indexOf("image/")&&(this.format="image/"+this.format);if(!this._style)this._style=b.styles[0];else if(-1===l.indexOf(b.styles,this._style)){console.error("The layer doesn't support the style of "+
this._style);this.onError(Error("The layer doesn't support the style of "+this._style));return}if(!this._dimension&&b.dimensions)this._dimension=b.dimensions[0];else if(-1===l.indexOf(b.dimensions,this._dimension)){console.error("The layer doesn't support the dimension of "+this._dimension);this.onError(Error("The layer doesn't support the dimension of "+this._dimension));return}if(!this._dimension2&&b.dimensions2)this._dimension2=b.dimensions2[0];else if(-1===l.indexOf(b.dimensions2,this._dimension2)){console.error("The layer doesn't support the dimension of "+
this._dimension2);this.onError(Error("The layer doesn't support the dimension of "+this._dimension2));return}var c;if(this._tileMatrixSetId){if(c=l.filter(b.tileMatrixSetInfos,function(b){return b.tileMatrixSet===this._tileMatrixSetId},this)[0],!c){console.error("The tileMatrixSetId "+this._tileMatrixSetId+" is not supported by the layer of "+this._identifier);this.onError(Error("The tileMatrixSetId "+this._tileMatrixSetId+" is not supported by the layer of "+this._identifier));return}}else(c=l.filter(b.tileMatrixSetInfos,
function(b){return"GoogleMapsCompatible"===b.tileMatrixSet})[0])||(c=b.tileMatrixSetInfos[0]),this._tileMatrixSetId=c.tileMatrixSet;this.description=b.description;this.title=b.title;this.spatialReference=c.tileInfo.spatialReference;this.tileInfo=c.tileInfo;this._levelToLevelValue=[];l.forEach(this.tileInfo.lods,function(b){this._levelToLevelValue[b.level]=b.levelValue?b.levelValue:b.level},this);102100===this.spatialReference.wkid||102113===this.spatialReference.wkid?this.fullExtent=this.initialExtent=
F.geographicToWebMercator(b.gcsExtent):4326===this.spatialReference.wkid?this.fullExtent=this.initialExtent=b.gcsExtent:(this.fullExtent=c.fullExtent,this.initialExtent=c.initialExtent);this.resourceUrls=b.resourceUrls;this.UrlTemplate=this._getTileUrlTemplate();this.layerInfo={identifier:this._identifier,tileMatrixSet:this._tileMatrixSetId,format:this.format,style:this._style,fullExtent:this.fullExtent,initialExtent:this.initialExtent,tileInfo:this.tileInfo,title:this.title,description:this.description}}else console.error("couldn't find the layer "+
this._identifier),this.onError(Error("couldn't find the layer "+this._identifier))},_getWMTSLayerInfo:function(b,e,h){var c=this._getTagValues("Abstract",e)[0],n=this._getTagValues("Title",e)[0],q=p.query("WGS84BoundingBox",e)[0],g=q?this._getTagValues("LowerCorner",q)[0].split(" "):["-180","-90"],a=q?this._getTagValues("UpperCorner",q)[0].split(" "):["180","90"],q=parseFloat(g[0]),g=parseFloat(g[1]),d=parseFloat(a[0]),a=parseFloat(a[1]),q=new y(q,g,d,a,new z({wkid:4326})),a=this._getTagValues("Identifier",
p.query("Style",e)[0]),m=this._getTagValues("Identifier",p.query("Dimension",e)[0]),f=this._getTagValues("Default",p.query("Dimension",e)[0])||this._getTagValues("Value",p.query("Dimension",e)[0]),k=1<p.query("Dimension",e).length?this._getTagValues("Identifier",p.query("Dimension",e)[1]):[],r=1<p.query("Dimension",e).length?this._getTagValues("Default",p.query("Dimension",e)[1])||this._getTagValues("Value",p.query("Dimension",e)[1]):[],g=this._getTagValues("Format",e);h=this._getLayerMatrixInfos(e,
h);b={identifier:b,tileMatrixSetInfos:h,formats:g,styles:a,title:n,description:c,gcsExtent:q,dimensions:f,dimensions2:r};e=p.query("ResourceURL",e);var t=[],v;l.forEach(e,function(a){v=a.getAttribute("template");if(m&&f&&m[0]&&f[0])if(-1<v.indexOf("{"+m+"}"))v=v.replace("{"+m+"}","{dimensionValue}");else{var b=v.toLowerCase().indexOf("{"+m[0].toLowerCase()+"}");-1<b&&(v=v.substring(0,b)+"{dimensionValue}"+v.substring(b+m[0].length+2))}k&&r&&k[0]&&r[0]&&(-1<v.indexOf("{"+k+"}")?v=v.replace("{"+k+"}",
"{dimensionValue2}"):(b=v.toLowerCase().indexOf("{"+k[0].toLowerCase()+"}"),-1<b&&(v=v.substring(0,b)+"{dimensionValue2}"+v.substring(b+k[0].length+2))));t.push({template:v,format:a.getAttribute("format"),resourceType:a.getAttribute("resourceType")})});t&&0<t.length&&(b.resourceUrls=t);return b},_getLayerMatrixInfos:function(b,e){var c=[],h=this._getTagValues("TileMatrixSet",b);if(h&&0!==h.length)return l.forEach(h,function(h){h=this._getLayerMatrixInfo(h,b,e);c.push(h)},this),c},_getLayerMatrixInfo:function(b,
e,h){var c,n,l,g,a=[];e=this._getTagWithChildTagValue("TileMatrixSetLink","TileMatrixSet",b,e);var d=this._getTagValues("TileMatrix",e),m=this._getTagWithChildTagValue("TileMatrixSet","Identifier",b,h),f=this._getTagValues("SupportedCRS",m)[0];c=parseInt(f.split(":").pop(),10);if(900913==c||3857==c)c=102100;if(-1<f.toLowerCase().indexOf("crs84")||-1<f.toLowerCase().indexOf("crs:84"))c=4326,g=!0;else if(-1<f.toLowerCase().indexOf("crs83")||-1<f.toLowerCase().indexOf("crs:83"))c=4269,g=!0;else if(-1<
f.toLowerCase().indexOf("crs27")||-1<f.toLowerCase().indexOf("crs:27"))c=4267,g=!0;var k=new z({wkid:c}),q=p.query("TileMatrix",m)[0];h=parseInt(this._getTagValues("TileWidth",q)[0],10);e=parseInt(this._getTagValues("TileHeight",q)[0],10);n=this._getTagValues("TopLeftCorner",q)[0].split(" ");var r=n[0],t=n[1];1<r.split("E").length&&(n=r.split("E"),r=n[0]*Math.pow(10,n[1]));1<t.split("E").length&&(n=t.split("E"),t=n[0]*Math.pow(10,n[1]));var r=parseFloat(r),t=parseFloat(t),w=g&&4326===c&&90===r&&-180===
t;for(n=0;n<this._flippingAxisForWkids.length;n++)if(f.split(":").pop()>=this._flippingAxisForWkids[n][0]&&f.split(":").pop()<=this._flippingAxisForWkids[n][1]||4326===c&&(!g||w)){4326===c&&90<r&&(r="90");l=new H(t,r,k);break}n===this._flippingAxisForWkids.length&&(l=new H(r,t,k));if(0===d.length)for(d=p.query("TileMatrix",m),n=0;n<d.length;n++)g=this._getLodFromTileMatrix(d[n],c,n,b),a.push(g);else for(n=0;n<d.length;n++)g=this._getTagWithChildTagValue("TileMatrix","Identifier",d[n],m),g=this._getLodFromTileMatrix(g,
c,n,b),a.push(g);c=p.query("BoundingBox",m)[0];var D,x;c&&(D=this._getTagValues("LowerCorner",c)[0].split(" "),x=this._getTagValues("UpperCorner",c)[0].split(" "));D&&1<D.length&&x&&1<x.length?(q=parseFloat(D[0]),c=parseFloat(D[1]),D=parseFloat(x[0]),x=parseFloat(x[1])):(D=this._getTagValues("MatrixWidth",q)[0],c=this._getTagValues("MatrixHeight",q)[0],q=l.x,x=l.y,D=q+D*e*a[0].resolution,c=x-c*h*a[0].resolution);x=D=new y(q,c,D,x,k);l=new G({dpi:96,spatialReference:k,format:this.format,rows:h,cols:e,
origin:l,lods:a});return{tileMatrixSet:b,fullExtent:x,initialExtent:D,tileInfo:l}},_getCapabilitiesError:function(b){console.error("Failed to get capabilities xml");this.onError(b)},_getLodFromTileMatrix:function(b,e,h,l){var c=this._getTagValues("Identifier",b)[0];b=this._getTagValues("ScaleDenominator",b)[0];1<b.split("E").length?(b=b.split("E"),b=b[0]*Math.pow(10,b[1])):b=parseFloat(b);e=this._getResolution(e,b,l);return{level:h,levelValue:c,scale:1.058267716535433*b,resolution:e}},_getResolution:function(b,
e,h){b=r.isDefined(E[b])?E.values[E[b]]:"default028mm"===h?6370997*Math.PI/180:6378137*Math.PI/180;return 7*e/25E3/b},_getTag:function(b,e){return(b=p.query(b,e))&&0<b.length?b[0]:null},_getTagValues:function(b,h){var c=[];b=b.split("\x3e");var n;n=p.query(b[0],h)[0];if(1<b.length){for(h=1;h<b.length-1;h++)n=p.query(b[h],n)[0];h=p.query(b[b.length-1],n)}else h=p.query(b[0],h);h&&0<h.length&&l.forEach(h,function(b){9>e("ie")?c.push(b.childNodes.length?b.childNodes[0].nodeValue:""):c.push(b.textContent)});
return c},_getAttributeValues:function(b,e,h){b=p.query(b,h);var c=[];b&&0<b.length&&l.forEach(b,function(b){c.push(b.getAttribute(e))});return c},_getTagWithChildTagValue:function(b,h,l,q){q=q.childNodes;var c,n;for(n=0;n<q.length;n++)if(-1<q[n].nodeName.indexOf(b)&&(9>e("ie")?r.isDefined(p.query(h,q[n])[0])&&(c=p.query(h,q[n])[0].childNodes[0].nodeValue):r.isDefined(p.query(h,q[n])[0])&&(c=p.query(h,q[n])[0].textContent),c===l||l.split(":")&&c===l.split(":")[1]))return q[n]},_appendCustomParameters:function(b){var c;
if(this.customParameters)for(c in this.customParameters)b+=(-1===b.indexOf("?")?"?":"\x26")+c+"\x3d"+encodeURIComponent(this.customParameters[c]);return b},_appendCustomLayerParameters:function(b){var c,e;if(this.customLayerParameters||this.customParameters)for(c in e=q.clone(this.customParameters||{}),q.mixin(e,this.customLayerParameters||{}),e)b+=(-1===b.indexOf("?")?"?":"\x26")+c+"\x3d"+encodeURIComponent(e[c]);return b},_flippingAxisForWkids:[[3819,3819],[3821,3824],[3889,3889],[3906,3906],[4001,
4025],[4027,4036],[4039,4047],[4052,4055],[4074,4075],[4080,4081],[4120,4176],[4178,4185],[4188,4216],[4218,4289],[4291,4304],[4306,4319],[4322,4326],[4463,4463],[4470,4470],[4475,4475],[4483,4483],[4490,4490],[4555,4558],[4600,4646],[4657,4765],[4801,4811],[4813,4821],[4823,4824],[4901,4904],[5013,5013],[5132,5132],[5228,5229],[5233,5233],[5246,5246],[5252,5252],[5264,5264],[5324,5340],[5354,5354],[5360,5360],[5365,5365],[5370,5373],[5381,5381],[5393,5393],[5451,5451],[5464,5464],[5467,5467],[5489,
5489],[5524,5524],[5527,5527],[5546,5546],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3038,3051],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3150,3151],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3389,3390],[3416,3417],[3833,3841],[3844,3850],[3854,3854],[3873,3885],[3907,3910],[4026,
4026],[4037,4038],[4417,4417],[4434,4434],[4491,4554],[4839,4839],[5048,5048],[5105,5130],[5253,5259],[5269,5275],[5343,5349],[5479,5482],[5518,5519],[5520,5520],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]]});e("extend-esri")&&q.setObject("layers.WMTSLayer",h,b);return h})},
"dojox/xml/parser":function(){define(["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/window","dojo/_base/sniff"],function(p){p.getObject("xml.parser",!0,dojox);dojox.xml.parser.parse=function(h,q){var l=p.doc,e;q=q||"text/xml";if(h&&p.trim(h)&&"DOMParser"in p.global){e=(new DOMParser).parseFromString(h,q);h=e.documentElement;if("parsererror"==h.nodeName&&"http://www.mozilla.org/newlayout/xml/parsererror.xml"==h.namespaceURI){if(l=h.getElementsByTagNameNS("http://www.mozilla.org/newlayout/xml/parsererror.xml",
"sourcetext")[0])l=l.firstChild.data;throw Error("Error parsing text "+h.firstChild.data+" \n"+l);}return e}if("ActiveXObject"in p.global){l=function(b){return"MSXML"+b+".DOMDocument"};l=["Microsoft.XMLDOM",l(6),l(4),l(3),l(2)];p.some(l,function(b){try{e=new ActiveXObject(b)}catch(r){return!1}return!0});if(h&&e&&(e.async=!1,e.loadXML(h),h=e.parseError,0!==h.errorCode))throw Error("Line: "+h.line+"\nCol: "+h.linepos+"\nReason: "+h.reason+"\nError Code: "+h.errorCode+"\nSource: "+h.srcText);if(e)return e}else if(l.implementation&&
l.implementation.createDocument){if(h&&p.trim(h)&&l.createElement){q=l.createElement("xml");q.innerHTML=h;var w=l.implementation.createDocument("foo","",null);p.forEach(q.childNodes,function(b){w.importNode(b,!0)});return w}return l.implementation.createDocument("","",null)}return null};dojox.xml.parser.textContent=function(h,q){if(1<arguments.length)return dojox.xml.parser.replaceChildren(h,(h.ownerDocument||p.doc).createTextNode(q)),q;if(void 0!==h.textContent)return h.textContent;var l="";h&&p.forEach(h.childNodes,
function(e){switch(e.nodeType){case 1:case 5:l+=dojox.xml.parser.textContent(e);break;case 3:case 2:case 4:l+=e.nodeValue}});return l};dojox.xml.parser.replaceChildren=function(h,q){var l=[];p.isIE&&p.forEach(h.childNodes,function(e){l.push(e)});dojox.xml.parser.removeChildren(h);p.forEach(l,p.destroy);p.isArray(q)?p.forEach(q,function(e){h.appendChild(e)}):h.appendChild(q)};dojox.xml.parser.removeChildren=function(h){for(var p=h.childNodes.length;h.hasChildNodes();)h.removeChild(h.firstChild);return p};
dojox.xml.parser.innerXML=function(h){return h.innerXML?h.innerXML:h.xml?h.xml:"undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(h):null};return dojox.xml.parser})},"esri/layers/WMTSLayerInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(p,h,q,l){p=p(null,{declaredClass:"esri.layers.WMTSLayerInfo",identifier:null,tileMatrixSet:null,format:null,style:null,tileInfo:null,title:null,fullExtent:null,initialExtent:null,description:null,
dimension:null,constructor:function(e){e&&(this.title=e.title,this.tileMatrixSet=e.tileMatrixSet,this.format=e.format,this.style=e.style,this.tileInfo=e.tileInfo,this.fullExtent=e.fullExtent,this.initialExtent=e.initialExtent,this.identifier=e.identifier,this.description=e.description,this.dimension=e.dimension)}});q("extend-esri")&&h.setObject("layers.WMTSLayerInfo",p,l);return p})},"widgets/AddData/search/AddFromFilePane":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/on dojo/Deferred dojo/dom-class dijit/Viewport dojo/sniff dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/AddFromFilePane.html dojo/i18n!../nls/strings ./LayerLoader ./util dojo/_base/kernel esri/request esri/layers/FeatureLayer esri/layers/KMLLayer esri/geometry/scaleUtils jimu/dijit/Message jimu/dijit/CheckBox".split(" "),
function(p,h,q,l,e,w,b,r,t,x,E,z,H,y,F,C,G,A,c,n,D,u){return p([x,E,z],{i18n:y,templateString:H,wabWidget:null,maxRecordCount:1E3,maxRecordThreshold:1E5,SHAPETYPE_ICONS:[{type:"shapefile",url:"images/filetypes/zip.svg"},{type:"csv",url:"images/filetypes/csv.svg"},{type:"kml",url:"images/filetypes/kml.svg"},{type:"gpx",url:"images/filetypes/gpx.svg"},{type:"geojson",url:"images/filetypes/geojson.svg"}],postCreate:function(){this.inherited(arguments);this.generalizeCheckBox.setLabel(y.addFromFile.generalizeOn);
this.own(r.on("resize",this.resize()))},destroy:function(){this.inherited(arguments)},startup:function(){if(!this._started){this.wabWidget.isPortal&&(this.SHAPETYPE_ICONS=[{type:"shapefile",url:"images/filetypes/zip.svg"},{type:"csv",url:"images/filetypes/csv.svg"},{type:"kml",url:"images/filetypes/kml.svg"},{type:"geojson",url:"images/filetypes/geojson.svg"}]);this.inherited(arguments);var c=this,n=this.dropArea,g,a=this.wabWidget.config;if(a.addFromFile)try{g=Number(a.addFromFile.maxRecordCount),
"number"!==typeof g||isNaN(g)||(g=Math.floor(g),1<=g&&g<=this.maxRecordThreshold&&(this.maxRecordCount=g))}catch(m){console.warn("Error setting AddFromFile.maxRecordCount:"),console.warn(m)}if(y.addFromFile.types)try{for(var d in y.addFromFile.types)this._createFileTypeImage(d)}catch(m){console.warn("Error reading support file types:"),console.warn(m)}this.own(e(this.fileNode,"change",function(){if(!c._getBusy()){c._setBusy(!0);var a=c._getFileInfo();a.ok&&c._execute(a)}}));this.own(e(this.uploadLabel,
"click",function(a){c._getBusy()&&(a.preventDefault(),a.stopPropagation())}));this.own(e(n,"dragenter",function(a){a.preventDefault();c._getBusy()||(b.add(n,"hit"),c._setStatus(""))}));this.own(e(n,"dragleave",function(a){a.preventDefault();b.remove(n,"hit")}));this.own(e(n,"dragover",function(a){a.preventDefault()}));this.own(e(n,"drop",function(a){a.preventDefault();a.stopPropagation();c._getBusy()||(c._setBusy(!0),a=c._getFileInfo(a),a.ok&&c._execute(a))}));g=this.wabWidget.domNode;this.own(e(g,
"dragenter",function(a){a.preventDefault()}));this.own(e(g,"dragleave",function(a){a.preventDefault()}));this.own(e(g,"dragover",function(a){a.preventDefault()}));this.own(e(g,"drop",function(a){a.preventDefault()}));this.own(e(this.hintButton,"click",h.hitch(this,function(a){a.preventDefault();a='\x3cdiv class\x3d"intro"\x3e\x3clabel\x3e'+y.addFromFile.intro+"\x3c/label\x3e\x3cul\x3e\x3cli\x3e"+y.addFromFile.types.Shapefile+"\x3c/li\x3e\x3cli\x3e"+y.addFromFile.types.CSV+"\x3c/li\x3e\x3cli\x3e"+
y.addFromFile.types.KML+"\x3c/li\x3e\x3cli\x3e"+y.addFromFile.types.GPX+"\x3c/li\x3e\x3cli\x3e"+y.addFromFile.types.GeoJSON+'\x3c/li\x3e\x3cli\x3e\x3cspan class\x3d"note"\x3e'+y.addFromFile.maxFeaturesAllowedPattern.replace("{count}",this.maxRecordCount)+"\x3c/span\x3e\x3c/li\x3e\x3c/ul\x3e\x3c/div\x3e";this.wabWidget.isPortal&&(a='\x3cdiv class\x3d"intro"\x3e\x3clabel\x3e'+y.addFromFile.intro+"\x3c/label\x3e\x3cul\x3e\x3cli\x3e"+y.addFromFile.types.Shapefile+"\x3c/li\x3e\x3cli\x3e"+y.addFromFile.types.CSV+
"\x3c/li\x3e\x3cli\x3e"+y.addFromFile.types.KML+"\x3c/li\x3e\x3cli\x3e"+y.addFromFile.types.GeoJSON+'\x3c/li\x3e\x3cli\x3e\x3cspan class\x3d"note"\x3e'+y.addFromFile.maxFeaturesAllowedPattern.replace("{count}",this.maxRecordCount)+"\x3c/span\x3e\x3c/li\x3e\x3c/ul\x3e\x3c/div\x3e");new u({message:a})})))}},_addFeatures:function(b,e){var g,a=[],d=b.map,h=0,f=new F;e.layers&&(h=e.layers.length);q.forEach(e.layers,function(d){d=new c(d,{id:f._generateLayerId(),outFields:["*"]});d.xtnAddData=!0;d.graphics&&
(b.numFeatures+=d.graphics.length);0===h?d.name=b.baseFileName:"string"!==typeof d.name||0===d.name.length?d.name=b.baseFileName:0!==d.name.indexOf(b.baseFileName)&&(d.name=y.addFromFile.layerNamePattern.replace("{filename}",b.baseFileName).replace("{name}",d.name));f._setFeatureLayerInfoTemplate(d,null,null);if(d.fullExtent){var e=d.fullExtent.getCenter();e.x&&e.y&&(g=g?g.union(d.fullExtent):d.fullExtent)}a.push(d)});0<a.length&&(d.addLayers(a),g&&d.setExtent(g.expand(1.25),!0))},_analyze:function(b,
c){if("csv"!==b.fileType.toLowerCase())return c=new w,c.resolve(null),c;var e=null;this.wabWidget.batchGeocoderServers&&0<this.wabWidget.batchGeocoderServers.length&&(e=this.wabWidget.batchGeocoderServers[0]);var a={enableGlobalGeocoding:!0,sourceLocale:G.locale};e&&(a.geocodeServiceUrl=e.url,e.isWorldGeocodeServer&&(a.sourceCountry="world",a.sourceCountryHint=""));e=b.sharingUrl+"/content/features/analyze";a={f:"json",filetype:b.fileType.toLowerCase(),analyzeParameters:window.JSON.stringify(a)};
c=A({url:e,content:a,form:c,handleAs:"json"});c.then(function(a){a&&a.publishParameters&&(b.publishParameters=a.publishParameters)});return c},_createFileTypeImage:function(b){var c=window.isRTL;q.some(this.SHAPETYPE_ICONS,h.hitch(this,function(e,a){if(b.toLowerCase()===e.type.toLowerCase()){var d=document.createElement("IMG");d.src=this.wabWidget.folderUrl+e.url;d.alt=b;0===a?d.className+=" "+(c?"last":"first")+"-type-icon":1===a?d.className+=" second-"+(c?"last":"first")+"-type-icon":a===this.SHAPETYPE_ICONS.length-
2?d.className+=" second-"+(c?"first":"last")+"-type-icon":a===this.SHAPETYPE_ICONS.length-1&&(d.className+=" "+(c?"first":"last")+"-type-icon");this.supportedFileTypes.appendChild(d)}}))},_execute:function(b){var c={map:this.wabWidget.map,sharingUrl:this.wabWidget.getSharingUrl(),baseFileName:b.baseFileName,fileName:b.fileName,fileType:b.fileType,generalize:!!this.generalizeCheckBox.getValue(),publishParameters:{},numFeatures:0};this._setBusy(!0);this._setStatus(y.addFromFile.addingPattern.replace("{filename}",
b.fileName));if("kml"===b.fileType.toLowerCase())return this._executeKml(b);var e=b.fileName,a=this,d=new FormData;d.append("file",b.file);a._analyze(c,d).then(function(b){b&&b.publishParameters&&b.publishParameters.locationType&&"unknown"===b.publishParameters.locationType&&new u({titleLabel:y._widgetLabel,message:y.addFromFile.featureLocationsCouldNotBeFound});return a._generateFeatures(c,d)}).then(function(b){a._addFeatures(c,b.featureCollection);a._setBusy(!1);a._setStatus(y.addFromFile.featureCountPattern.replace("{filename}",
e).replace("{count}",c.numFeatures))}).otherwise(function(b){a._setBusy(!1);a._setStatus(y.addFromFile.addFailedPattern.replace("{filename}",e));console.warn("Error generating features.");console.warn(b);b&&"string"===typeof b.message&&0<b.message.length&&new u({titleLabel:y._widgetLabel,message:y.addFromFile.generalIssue+"\x3cbr\x3e\x3cbr\x3e"+b.message})})},_executeKml:function(b){var c=this,e=new FileReader,a=this.wabWidget.map,d=function(a,d){c._setBusy(!1);c._setStatus(y.addFromFile.addFailedPattern.replace("{filename}",
b.fileName));console.warn(a);console.error(d);d&&"string"===typeof d.message&&0<d.message.length&&new u({titleLabel:y._widgetLabel,message:y.addFromFile.generalIssue+"\x3cbr\x3e\x3cbr\x3e"+d.message})};e.onerror=function(a){d("FileReader::onerror",a)};e.onload=function(g){if(e.error)d("FileReader::error",e.error);else{var f=g.target.result,k=new F;g=k._generateLayerId();var m=new n("",{id:g,name:b.fileName,linkInfo:{visibility:!1}});m.visible=!0;delete m.linkInfo;m._parseKml=function(){var e=this;
this._fireUpdateStart();this._io=A({url:this.serviceUrl,content:{kmlString:encodeURIComponent(f),model:"simple",folders:"",refresh:this.loaded?!0:void 0,outSR:l.toJson(this._outSR.toJson())},callbackParamName:"callback",load:function(f){e._io=null;e._initLayer(f);k._waitForLayer(m).then(function(d){var e=0;d.name=b.fileName;d.xtnAddData=!0;q.forEach(d.getLayers(),function(a){a&&a.graphics&&0<a.graphics.length&&(e+=a.graphics.length)});var f=a.spatialReference,g=d._outSR;f&&g&&(f.equals(g)||f.isWebMercator()&&
4326===g.wkid||g.isWebMercator()&&4326===f.wkid)?a.addLayer(d):new u({titleLabel:y._widgetLabel,message:y.addFromFile.kmlProjectionMismatch});c._setBusy(!1);c._setStatus(y.addFromFile.featureCountPattern.replace("{filename}",b.fileName).replace("{count}",e))}).otherwise(function(a){d("kml-_waitForLayer.error",a)})},error:function(a){e._io=null;a=h.mixin(Error(),a);a.message="Unable to load KML: "+(a.message||"");e._fireUpdateEnd(a);e._errorHandler(a);d("Unable to load KML",a)}},{usePost:!0})};m._parseKml()}};
try{e.readAsText(b.file)}catch(m){d("FileReader::readAsText",m)}},_generateFeatures:function(b,c){var e=b.sharingUrl+"/content/features/generate";b.publishParameters=b.publishParameters||{};var a=h.mixin(b.publishParameters,{name:b.baseFileName,targetSR:b.map.spatialReference,maxRecordCount:this.maxRecordCount,enforceInputFileSizeLimit:!0,enforceOutputJsonSizeLimit:!0});if(b.generalize){var d=D.getExtentForScale(b.map,4E4).getWidth()/b.map.width;a.generalize=!0;a.maxAllowableOffset=d;for(var d=d/
10,m=0;1>d;)d*=10,m++;a.reducePrecision=!0;a.numberOfDigitsAfterDecimal=m}b={f:"json",filetype:b.fileType.toLowerCase(),publishParameters:window.JSON.stringify(a)};return A({url:e,content:b,form:c,handleAs:"json"})},_getBaseFileName:function(b){t("ie")&&(b=b.split("\\"),b=b[b.length-1]);b=b.split(".");return b=b[0].replace("c:\\fakepath\\","")},_getBusy:function(){return b.contains(this.uploadLabel,"disabled")},_getFileInfo:function(b){var c={ok:!1,file:null,fileName:null,fileType:null};if((b=b?b.dataTransfer.files:
this.fileNode.files)&&1===b.length)if(c.file=b=b[0],c.fileName=b.name,C.endsWith(b.name,".zip"))c.ok=!0,c.fileType="Shapefile";else if(C.endsWith(b.name,".csv"))c.ok=!0,c.fileType="CSV";else if(C.endsWith(b.name,".kml"))c.ok=!0,c.fileType="KML";else if(C.endsWith(b.name,".gpx"))c.ok=!0,c.fileType="GPX";else if(C.endsWith(b.name,".geojson")||C.endsWith(b.name,".geo.json"))c.ok=!0,c.fileType="GeoJSON";c.ok&&(c.ok=q.some(this.SHAPETYPE_ICONS,function(a){return a.type.toLowerCase()===c.fileType.toLowerCase()}));
if(c.ok)c.baseFileName=this._getBaseFileName(c.fileName);else{b=y.addFromFile.invalidType;"string"===typeof c.fileName&&0<c.fileName.length&&(b=y.addFromFile.invalidTypePattern.replace("{filename}",c.fileName));this._setBusy(!1);this._setStatus(b);var e=document.createElement("div");e.appendChild(document.createTextNode(b));new u({titleLabel:y._widgetLabel,message:e})}return c},resize:function(){},_setBusy:function(c){c?(b.add(this.uploadLabel,"disabled"),b.add(this.dropArea,["hit","disabled"])):
(b.remove(this.uploadLabel,"disabled"),b.remove(this.dropArea,["hit","disabled"]))},_setStatus:function(b){this.wabWidget&&this.wabWidget._setStatus(b)}})})},"widgets/AddData/search/LayerListPane":function(){define("dojo/_base/declare dojo/_base/array dojo/on dojo/dom-class dojo/dom-construct dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/LayerListPane.html dojo/i18n!../nls/strings ./util".split(" "),function(p,h,q,l,e,w,b,r,t,x,E){return p([w,b,r],{i18n:x,
templateString:t,wabWidget:null,baseClass:"add-data-widget-layers",postCreate:function(){this.inherited(arguments)},startup:function(){this._started||(this._buildList(),this._initListeners(),this.inherited(arguments))},_addLayer:function(b,h){var l=this,p=this._getLayerTitle(h),q=e.create("div",{"class":"add-data-layerlist--listitem"},b);e.create("A",{"class":"remove-button",href:"#",innerHTML:"\x3cspan class\x3d'esri-icon-trash'\x3e\x3c/span\x3e",title:x.layerList.removeLayer,onclick:function(b){b.preventDefault();
try{l.wabWidget&&l.wabWidget.map&&(l.wabWidget.map.removeLayer(h),e.destroy(q))}catch(A){console.warn("Error removing layer."),console.warn(A)}}},q);b=e.create("label",{"class":"layer-name"},q);E.setNodeText(b,p)},_buildList:function(){var b=this,l=!1,p=[],q=this.wabWidget.map,r=e.create("div",{"class":"add-data-layerlist--list"});h.forEach(q.layerIds,function(b){p.push(b)});h.forEach(q.graphicsLayerIds,function(b){p.push(b)});p.reverse();h.forEach(p,function(e){(e=q.getLayer(e))&&e.xtnAddData&&(l=
!0,b._addLayer(r,e))});return l?r:e.create("div",{"class":"no-data-message",innerHTML:x.layerList.noLayersAdded})},_getLayerTitle:function(b){var e="...";if("string"===typeof b.label&&0<b.label.length)e=b.label;else if("string"===typeof b.title&&0<b.title.length)e=b.title;else if("string"===typeof b.name&&0<b.name.length)e=b.name;else if(b.url){var h=b.url.indexOf("/FeatureServer");-1===h&&(h=b.url.indexOf("/MapServer"));-1===h&&(h=b.url.indexOf("/ImageServer"));-1===h&&(h=b.url.indexOf("/service"));
-1<h&&(b=b.url.substring(0,h),e=b=b.substring(b.lastIndexOf("/")+1,b.length))}return e},_initListeners:function(){var b=this;this.own(q(this._backButton,"click",function(e){e.preventDefault();b.hide()}))},show:function(){var b=this._buildList();this._title.innerHTML=x.layerList.caption;this._layerlist.innerHTML="";b&&b.tagName&&this._layerlist.appendChild(b);this.wabWidget&&this.wabWidget.domNode&&l.add(this.wabWidget.domNode,"layerlist-show");l.add(this.domNode,"show")},hide:function(){this.wabWidget&&
this.wabWidget.domNode&&l.remove(this.wabWidget.domNode,"layerlist-show");l.remove(this.domNode,"show")}})})},"widgets/AddData/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/AddData/search/templates/SearchPane.html":'\x3cdiv class\x3d"search-pane"\x3e\r\n  \x3cdiv class\x3d"search-pane-header" data-dojo-attach-point\x3d"headerNode"\x3e\r\n    \x3cdiv class\x3d"search-bar main-search-bar"\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ScopeOptions"\r\n        data-dojo-attach-point\x3d"scopeOptions"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\x3cspan class\x3d"search-box-placeholder" data-dojo-attach-point\x3d"searchBoxPlaceholder"\x3e\x3c/span\x3e--\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SearchBox"\r\n        data-dojo-attach-point\x3d"searchBox"\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"search-bar-separator"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"search-bar search-bar-secondary" data-dojo-attach-point\x3d"optionsNode"\x3e\r\n      \x3cdiv data-dojo-type\x3d"widgets/AddData/search/BBoxOption"\r\n        data-dojo-attach-point\x3d"bboxOption"\x3e\r\n      \x3c/div\x3e\r\n      \x3c!--\r\n      \x3cdiv class\x3d"filter-wrapper2"\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/TypeOptions"\r\n          data-dojo-attach-point\x3d"typeOptions"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SortOptions"\r\n          data-dojo-attach-point\x3d"sortOptions"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      --\x3e\r\n      \x3cspan class\x3d"filter-placeholder" data-dojo-attach-point\x3d"filterPlaceholder"\x3e\x3c/span\x3e\r\n      \x3cdiv class\x3d"filter-wrapper" data-dojo-attach-point\x3d"filterWrapper"\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/TypeOptions"\r\n          data-dojo-attach-point\x3d"typeOptions"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"widgets/AddData/search/SortOptions"\r\n          data-dojo-attach-point\x3d"sortOptions"\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"search-pane-content" data-dojo-attach-point\x3d"contentNode"\x3e\r\n    \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ResultsPane"\r\n      data-dojo-attach-point\x3d"resultsPane"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"search-pane-footer jimu-float-leading" data-dojo-attach-point\x3d"footerNode"\x3e\r\n    \x3cdiv data-dojo-type\x3d"widgets/AddData/search/Paging"\r\n      data-dojo-attach-point\x3d"paging"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-type\x3d"widgets/AddData/search/ResultCount"\r\n      data-dojo-attach-point\x3d"resultCount"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv style\x3d"clear:both"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/SearchBox.html":'\x3cdiv class\x3d"search-box2"\x3e\r\n\t\x3cinput type\x3d"text" class\x3d"search-textbox"\r\n\t\tplaceholder\x3d"${i18n.search.searchBox.placeholder}"\r\n\t\tdata-dojo-attach-point\x3d"searchTextBox"\r\n\t\x3e\x3cbutton class\x3d"btn btn-confirm" type\x3d"button"\r\n\t\tdata-dojo-attach-point\x3d"searchButton"\r\n\t\tdata-dojo-attach-event\x3d"onClick: searchButtonClicked"\r\n\t\ttitle\x3d"${i18n.search.searchBox.search}"\r\n\t\t\x3e\x3cspan class\x3d"esri-icon-search"\x3e\x3c/span\x3e\r\n\t\x3c/button\x3e\r\n\x3c!--\r\n\x3cdiv class\x3d"search-box"\x3e\r\n\t\x3cdiv class\x3d"input-group"\x3e\r\n\t\t\x3cinput type\x3d"text" class\x3d"search-textbox"\r\n\t\t\tplaceholder\x3d"${i18n.search.searchBox.placeholder}"\r\n\t\t\tdata-dojo-attach-point\x3d"searchTextBox"\x3e\r\n    \x3cspan class\x3d"search-btn"\x3e\r\n\t\t\t\x3cbutton class\x3d"btn btn-clear hidden" type\x3d"button"\r\n\t\t\t\tdata-dojo-attach-point\x3d"clearButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: clearButtonClicked"\x3e\r\n\t\t\t\t\x3cspan class\x3d"esri-icon-close"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/button\x3e\r\n\t\t\t\x3cbutton class\x3d"btn btn-confirm" type\x3d"button"\r\n\t\t\t\tdata-dojo-attach-point\x3d"searchButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: searchButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.searchBox.search}"\r\n\t\t\t\t\x3e\x3cspan class\x3d"esri-icon-search"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/button\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n--\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/BBoxOption.html":'\x3cdiv class\x3d"search-bbox-option"\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"bboxSection" class\x3d"switch-toggle-group"\x3e\r\n    \x3clabel class\x3d"checkbox-inline"\x3e\r\n      \x3cinput id\x3d"${id}_bboxId"\r\n\t      data-dojo-type\x3d"dijit/form/CheckBox"\r\n\t      data-dojo-attach-point\x3d"bboxToggle"\r\n\t      data-dojo-attach-event\x3d"onClick: bboxClicked"\r\n\t      data-dojo-props\x3d"class: \'switch-toggle\'"\r\n        title\x3d"${i18n.search.bboxOption.bbox}"/\x3e\r\n      \x3cspan class\x3d"label-text"\x3e${i18n.search.bboxOption.bbox}\x3c/span\x3e\r\n    \x3c/label\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/ScopeOptions.html":'\x3cdiv class\x3d"search-scope-options"\x3e\r\n  \x3ca href\x3d"#" class\x3d"scope-placeholder"\r\n    data-dojo-attach-point\x3d"scopePlaceholder"\r\n    data-dojo-attach-event\x3d"onClick: scopePlaceholderClicked"\x3e\r\n    \x3cspan data-dojo-attach-point\x3d"scopePlaceholderText"\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"dropdown-arrow"\x3e\x3c/span\x3e\r\n  \x3c/a\x3e\r\n  \x3cdiv class\x3d"btn-group" data-dojo-attach-point\x3d"btnGroup"\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"MyContentToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"MyContent"\x3e\r\n      ${i18n.search.scopeOptions.myContent}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"MyOrganizationToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"MyOrganization"\x3e\r\n      ${i18n.search.scopeOptions.myOrganization}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"CuratedToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"Curated"\x3e\r\n      ${i18n.search.scopeOptions.curated}\r\n    \x3c/button\x3e\r\n    \x3cbutton type\x3d"button" class\x3d"btn btn-sm btn-default" name\x3d"${id}_scope"\r\n      data-dojo-attach-point\x3d"ArcGISOnlineToggle"\r\n      data-dojo-attach-event\x3d"onClick: optionClicked"\r\n      data-option-name\x3d"ArcGISOnline"\x3e\r\n      ${i18n.search.scopeOptions.ArcGISOnline}\r\n    \x3c/button\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/TypeOptions.html":'\x3cdiv class\x3d"search-data-type-options"\x3e\r\n  \x3cdiv data-dojo-type\x3d"dijit/form/DropDownButton"\x3e\r\n    \x3cspan\x3e${i18n.search.typeOptions.prompt}\x3c/span\x3e\r\n    \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog"\r\n         data-dojo-attach-point\x3d"tooltipDialog"\r\n         data-dojo-props\x3d"\'class\':\'add-data-widget-popup\'"\x3e\r\n      \x3clabel for\x3d"${id}_mapServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_mapServiceId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"mapServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Map Service\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.mapService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_featureServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_featureServiceId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"featureServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Feature Service\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.featureService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_imageServiceId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_imageServiceId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"imageServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Image Service\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.imageService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_vectorTileServiceId" class\x3d"search-type-option"\r\n        data-dojo-attach-point\x3d"vectorTileNode"\x3e\r\n        \x3cdiv id\x3d"${id}_vectorTileServiceId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"vectorTileServiceToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;Vector Tile Service\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.vectorTileService}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_kmlId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_kmlId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"kmlToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;KML\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.kml}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_wmsId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_wmsId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"wmsToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;WMS\x26quot;\'\x3e\x3c/div\x3e\r\n        ${i18n.search.typeOptions.wms}\r\n      \x3c/label\x3e\r\n      \x3clabel for\x3d"${id}_wfsId" class\x3d"search-type-option"\x3e\r\n        \x3cdiv id\x3d"${id}_wfsId"\r\n          data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n          data-dojo-attach-point\x3d"wfsToggle"\r\n          data-dojo-attach-event\x3d"onClick: optionClicked"\r\n          data-option-q\x3d\'type:\x26quot;WFS\x26quot;\'\x3e\x3c/div\x3e\r\n        WFS\r\n      \x3c/label\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/SortOptions.html":'\x3cdiv class\x3d"search-sort-options"\x3e\r\n  \x3clabel for\x3d"${id}_select" class\x3d"sort-prompt"\x3e${i18n.search.sortOptions.prompt}\x3c/label\x3e \r\n  \x3cselect id\x3d"${id}_select"\r\n    data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"sortSelect"\x3e\r\n    \x3coption value\x3d"" selected\x3d"selected"\x3e${i18n.search.sortOptions.relevance}\x3c/option\x3e\r\n    \x3coption value\x3d"title"\x3e${i18n.search.sortOptions.title}\x3c/option\x3e\r\n    \x3coption value\x3d"owner"\x3e${i18n.search.sortOptions.owner}\x3c/option\x3e\r\n    \x3coption value\x3d"avgrating"\x3e${i18n.search.sortOptions.rating}\x3c/option\x3e\r\n    \x3coption value\x3d"numviews"\x3e${i18n.search.sortOptions.views}\x3c/option\x3e\r\n    \x3coption value\x3d"modified"\x3e${i18n.search.sortOptions.date}\x3c/option\x3e\r\n  \x3c/select\x3e\r\n  \x3ca href\x3d"#" class\x3d"sort-order-icon"\r\n    title\x3d"${i18n.search.sortOptions.switchOrder}"\r\n    data-dojo-attach-point\x3d"sortOrderBtn"\r\n    data-dojo-attach-event\x3d"onclick: sortOrderClicked"\x3e\r\n  \x3c/a\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/ResultsPane.html":'\x3cdiv class\x3d"search-results-pane" data-dojo-attach-point\x3d"containerNode"\x3e\r\n  \x3cdiv class\x3d"search-results-pane-no-match empty-data-label" data-dojo-attach-point\x3d"noMatchNode" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"itemsNode" class\x3d"search-results"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/AddData/search/templates/ItemCard.html":'\x3cdiv class\x3d"item-card"\x3e\r\n  \x3cdiv class\x3d"item-card-inner"\x3e\r\n    \x3cdiv class\x3d"thumbnail" data-dojo-attach-point\x3d"thumbnailNode"\x3e\x3c/div\x3e\r\n    \x3ch3 class\x3d"title" data-dojo-attach-point\x3d"titleNode"\x3e\x3c/h3\x3e\r\n    \x3cdiv class\x3d"info" data-dojo-attach-point\x3d"typeByOwnerNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"info" data-dojo-attach-point\x3d"dateNode"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"action-bar"\x3e\r\n      \x3cspan class\x3d"message" data-dojo-attach-point\x3d"messageNode"\x3e\x3c/span\x3e\r\n      \x3ca href\x3d"javascript:void(0)"\r\n        data-dojo-attach-point\x3d"addButton"\r\n        data-dojo-attach-event\x3d"onClick: addClicked"\r\n        \x3e${i18n.search.item.actions.add}\r\n      \x3c/a\x3e\r\n      \x3ca href\x3d"javascript:void(0)"\r\n        data-dojo-attach-point\x3d"detailsButton"\r\n        data-dojo-attach-event\x3d"onClick: detailsClicked"\r\n        \x3e${i18n.search.item.actions.details}\r\n      \x3c/a\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/Paging.html":'\x3cdiv class\x3d"search-paging"\x3e\r\n\t\x3cul class\x3d"pagination pagination-sm"\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"First"\r\n\t\t\t\tdata-dojo-attach-point\x3d"firstButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: firstButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.firstTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-expand"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"Previous"\r\n\t\t\t\tdata-dojo-attach-point\x3d"previousButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: previousButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.previousTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-left"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli class\x3d"current-page"\x3e\r\n\t\t  \x3cspan data-dojo-attach-point\x3d"pageNode"\x3e\x3c/span\x3e\r\n\t\t\x3c/li\x3e\r\n\t\t\x3cli\x3e\r\n\t\t\t\x3ca href\x3d"#" aria-label\x3d"Next"\r\n\t\t\t\tdata-dojo-attach-point\x3d"nextButton"\r\n\t\t\t\tdata-dojo-attach-event\x3d"onClick: nextButtonClicked"\r\n\t\t\t\ttitle\x3d"${i18n.search.paging.nextTip}"\x3e\r\n\t\t\t\t\x3cspan aria-hidden\x3d"true" class\x3d"esri-icon-right"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/a\x3e\r\n\t\t\x3c/li\x3e\r\n\t\x3c/ul\x3e\r\n\x3c/div\x3e',
"url:widgets/AddData/search/templates/ResultCount.html":'\x3cdiv class\x3d"search-result-count"\x3e\r\n  \x3cspan class\x3d"search-count" data-dojo-attach-point\x3d"messageNode"\x3e\x3c/span\x3e\r\n\x3c/div\x3e',"url:widgets/AddData/search/templates/AddFromUrlPane.html":'\x3cdiv class\x3d"secondary-pane add-url-pane"\x3e\r\n  \x3cdiv class\x3d"add-url-pane-container"\x3e\r\n    \x3cdiv class\x3d"add-url-pane-container--inner"\x3e\r\n      \x3clabel for\x3d"${id}_select"\x3e${i18n.addFromUrl.type}\x3c/label\x3e\r\n      \x3cselect id\x3d"${id}_select"\r\n        data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-point\x3d"typeSelect"\x3e\r\n        \x3coption value\x3d"ArcGIS" selected\x3d"selected"\x3e${i18n.addFromUrl.types.ArcGIS}\x3c/option\x3e\r\n        \x3coption value\x3d"WMS"\x3e${i18n.addFromUrl.types.WMS}\x3c/option\x3e\r\n        \x3c!--not yet supported \x3coption value\x3d"WMTS"\x3e${i18n.addFromUrl.types.WMTS}\x3c/option\x3e --\x3e\r\n        \x3coption value\x3d"WFS"\x3e${i18n.addFromUrl.types.WFS}\x3c/option\x3e\r\n        \x3coption value\x3d"KML"\x3e${i18n.addFromUrl.types.KML}\x3c/option\x3e\r\n        \x3coption value\x3d"GeoRSS"\x3e${i18n.addFromUrl.types.GeoRSS}\x3c/option\x3e\r\n        \x3coption value\x3d"CSV"\x3e${i18n.addFromUrl.types.CSV}\x3c/option\x3e\r\n      \x3c/select\x3e\r\n      \x3clabel for\x3d"${id}_url"\x3e${i18n.addFromUrl.url}\x3c/label\x3e\r\n      \x3cinput id\x3d"${id}_url" type\x3d"text" class\x3d"url-textbox jimu-input"\r\n          data-dojo-attach-point\x3d"urlTextBox"\r\n          data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n          data-dojo-props\x3d"\r\n            regExp: \'^(http|https):\\/\\/[a-z0-9]+([\\-\\.]{1}[a-z0-9]+)*\\.[a-z]{2,5}(:[0-9]{1,5})?(\\/.*)?$\'\r\n          "/\x3e\r\n      \x3cdiv class\x3d"action-bar"\x3e\r\n        \x3ca class\x3d"jimu-float-leading" href\x3d"javascript:void(0)"\r\n          data-dojo-attach-point\x3d"examplesExpander"\r\n          data-dojo-attach-event\x3d"onClick: examplesExpanderClicked"\r\n          \x3e${i18n.addFromUrl.samplesHint}\x3c/a\x3e\r\n        \x3ca class\x3d"jimu-btn"\r\n          href\x3d"javascript:void(0)"\r\n          data-dojo-attach-point\x3d"addButton"\r\n          data-dojo-attach-event\x3d"onClick: addClicked"\r\n          \x3e${i18n.search.item.actions.add}\r\n        \x3c/a\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"examples" data-dojo-attach-point\x3d"examplesNode"\x3e\r\n        \x3cdiv data-examples-type\x3d"ArcGIS"\x3e\r\n          \x3cdiv\x3ehttp://services.arcgis.com/P3ePLMYs2RVChkJx/arcgis/rest/services/World_Cities/FeatureServer/0\x3c/div\x3e\r\n          \x3cdiv\x3ehttp://services.arcgisonline.com/ArcGIS/rest/services/Demographics/USA_Tapestry/MapServer\x3c/div\x3e\r\n          \x3cdiv\x3ehttp://imagery.arcgisonline.com/ArcGIS/rest/services/LandsatGLS/VegetationAnalysis/ImageServer\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"WMS"\x3e\r\n          \x3cdiv\x3ehttp://mesonet.agron.iastate.edu/cgi-bin/wms/nexrad/n0r.cgi?service\x3dWMS\x26amp;request\x3dGetCapabilities\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"WFS"\x3e\r\n          \x3cdiv\x3ehttps://dservices.arcgis.com/V6ZHFr6zdgNZuVG0/arcgis/services/JapanPrefectures2018/WFSServer\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"KML"\x3e\r\n          \x3cdiv\x3ehttp://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_month_age_animated.kml\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"GeoRSS"\x3e\r\n          \x3cdiv\x3ehttp://www.gdacs.org/xml/rss.xml\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv data-examples-type\x3d"CSV"\x3e\r\n          \x3cdiv\x3ehttp://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/2.5_week.csv\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/AddFromFilePane.html":'\x3cdiv class\x3d"secondary-pane add-file-pane"\x3e\r\n\r\n  \x3cdiv class\x3d"generalize-options"\x3e\r\n    \x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox"\r\n      data-dojo-attach-point\x3d"generalizeCheckBox"\r\n      data-dojo-props\x3d"checked:true"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n  \x3cdiv class\x3d"browse-or-drop"\x3e\r\n    \x3cdiv class\x3d"drop-container" data-dojo-attach-point\x3d"dropContainer"\x3e\r\n      \x3cdiv class\x3d"drop-area" data-dojo-attach-point\x3d"dropArea"\x3e\r\n        \x3cdiv class\x3d"supported-file-types" data-dojo-attach-point\x3d"supportedFileTypes"\x3e\x3c/div\x3e\r\n        \x3cdiv class\x3d"or"\x3e${i18n.addFromFile.dropOrBrowse}\x3c/div\x3e\r\n        \x3cform class\x3d"file-form" enctype\x3d"multipart/form-data" method\x3d"post"\r\n          data-dojo-attach-point\x3d"fileForm"\x3e\r\n          \x3clabel for\x3d"${id}_file" class\x3d"jimu-btn"\r\n            data-dojo-attach-point\x3d"uploadLabel"\x3e${i18n.addFromFile.browse}\x3c/label\x3e\r\n          \x3cinput id\x3d"${id}_file" name\x3d"file" type\x3d"file" style\x3d"display:none"\r\n            data-dojo-attach-point\x3d"fileNode" /\x3e\r\n        \x3c/form\x3e\r\n        \x3ca href\x3d"#" class\x3d"drop-area-hint" data-dojo-attach-point\x3d"hintButton"\x3e\r\n          \x3ci class\x3d"esri-icon-question"\x3e\x3c/i\x3e\r\n        \x3c/a\x3e\r\n        \x3cspan class\x3d"upload-arrow"\x3e\x3c/span\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/search/templates/LayerListPane.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"add-data-layerlist--mask"\x3e\x3c/div\x3e\r\n  \x3cdiv class\x3d"add-data-layerlist--container" data-dojo-attach-point\x3d"_container"\x3e\r\n    \x3ch2 data-dojo-attach-point\x3d"_title"\x3e\x3c/h2\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"_layerlist"\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"add-data-layerlist--footer jimu-widget-add-data-footer" data-dojo-attach-point\x3d"_footer"\x3e\r\n    \x3ca href\x3d"#" class\x3d"back-button" data-dojo-attach-point\x3d"_backButton"\x3e\r\n      ${i18n.layerList.back}\x3ci class\x3d"esri-icon-collapse"\x3e\x3c/i\x3e\r\n    \x3c/a\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/AddData/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"tabsNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"searchNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"urlNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"fileNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:widgets/AddData/css/style.css":'.jimu-widget-add-data .jimu-tab3 {height: 100%;}.jimu-widget-add-data .search-pane,.jimu-widget-add-data .secondary-pane {height: 100%; width: 100%; background-color: #f8f8f8; position: relative;}.jimu-widget-add-data .search-pane \x3e *,.jimu-widget-add-data .secondary-pane \x3e * {width: 100%;}.jimu-widget-add-data .search-pane-content {position: absolute; top: 140px; bottom: 0; overflow: auto; background-color: #efefef;}.jimu-widget-add-data .search-pane .search-bar {padding: 10px 15px; line-height: 20px;}.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn {min-width: 40px; padding-top: 10px; padding-bottom: 13px; background-color: transparent; border: 0; border-bottom: 2px solid transparent; margin-left: 5px; margin-right: 5px; color: #898989; font-size: 12px; font-weight: bold; font-family: inherit;}.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active,.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:active,.jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:hover {background-color: transparent !important; color: #000 !important; border-bottom-color: #24b5cc; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none;}.jimu-widget-add-data .search-pane .search-bar.main-search-bar {background-color: #fff; padding-bottom: 0; position: relative; display: flex;}.jimu-widget-add-data .search-pane .search-scope-options {flex: 1; overflow: hidden;}.jimu-widget-add-data .search-pane .search-bar.search-scope-bar .search-sort-options {margin-top: 5px;}.jimu-widget-add-data .search-pane .search-bar-secondary {background-color: #f8f8f8; padding-top: 5px; padding-bottom: 5px; font-size: 11px;}.jimu-widget-add-data .search-pane .search-pane-header {border-bottom: 1px solid #cccccc;}.jimu-widget-add-data .search-pane .search-pane-header:before,.jimu-widget-add-data .search-pane .search-pane-header:after {content: " "; display: table;}.jimu-widget-add-data .search-pane .search-pane-header:after {clear: both;}.jimu-widget-add-data .search-pane .search-bar:before,.jimu-widget-add-data .search-pane .search-bar:after {content: " "; display: table;}.jimu-widget-add-data .search-pane .search-bar:after {clear: both;}.jimu-widget-add-data .search-pane .search-data-type-options {margin-right: 15px;}.jimu-widget-add-data .search-pane .search-curated-option {display: inline-block; margin-left: 30px;}.jimu-widget-add-data .search-pane .search-bar-separator {border-bottom: 1px solid #e7e7e7;}.jimu-widget-add-data .search-pane .search-pane-default .search-bar {text-align: right; margin-bottom: 24px;}.jimu-widget-add-data .search-pane .search-results-pane {padding: 10px 5px;}.jimu-widget-add-data .search-pane .search-results-pane:after {content: ""; display: table; clear: both;}.jimu-widget-add-data .search-pane .item-card {float: left; width: 100%; padding-left: 5px; padding-right: 5px; -webkit-transition: width 0.1s ease; -moz-transition: width 0.1s ease; -o-transition: width 0.1s ease; transition: width 0.1s ease;}.jimu-widget-add-data .search-pane .item-card .item-card-inner {height: 70px; background: #ffffff; border: 1px solid #e0e0e0; border-bottom-color: #cccccc; padding: 5px; margin-bottom: 10px; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;}.jimu-widget-add-data .search-pane .item-card .thumbnail {float: left; margin-right: 10px;}.jimu-widget-add-data .search-pane .item-card .thumbnail img {height: 60px; width: 90px;}.jimu-widget-add-data .search-pane .item-card h3.title {margin: 0 5px; padding: 0; font-size: 12px; font-weight: bold; color: #4c4c4c; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-add-data .search-pane .item-card div.info {color: #898989; font-size: 10px; overflow: hidden; white-space: nowrap; padding-top: 3px;}.jimu-widget-add-data .search-pane .item-card .action-bar,.jimu-widget-add-data .secondary-pane .action-bar {text-align: right;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card .action-bar,.jimu-rtl .jimu-widget-add-data .secondary-pane .action-bar {text-align: left;}.jimu-widget-add-data .secondary-pane {padding: 20px 15px; overflow: auto;}.jimu-widget-add-data .secondary-pane label {color: #898989; display: block; margin-bottom: 10px;}.jimu-widget-add-data .secondary-pane .dijit {margin-bottom: 10px;}.jimu-widget-add-data .secondary-pane div.action-bar {margin-top: 20px;}.jimu-widget-add-data .secondary-pane .jimu-btn {color: #fff; line-height: 20px; text-decoration: none;}.jimu-widget-add-data .secondary-pane .jimu-btn:active {}.jimu-widget-add-data .search-pane .item-card .action-bar a,.jimu-widget-add-data .add-url-pane .action-bar a,.jimu-widget-add-data .add-file-pane .file-form label {display: inline-block; font-size: 11px; text-transform: uppercase; padding: 5px; margin-right: 5px;}.jimu-widget-add-data .search-pane .item-card .action-bar a.disabled,.jimu-widget-add-data .add-url-pane .action-bar a.disabled,.jimu-widget-add-data .add-file-pane .file-form label.disabled,.jimu-widget-add-data .add-file-pane .drop-area.disabled {opacity: 0.3;}.jimu-widget-add-data .search-pane .item-card .action-bar .message {font-size: 10px; font-style: italic; margin-left: 4px; margin-right: 4px;}.jimu-widget-add-data .add-url-pane .action-bar .jimu-btn,.jimu-widget-add-data .add-file-pane .file-form label {margin-right: 0; min-width: 180px; white-space: normal;}.jimu-widget-add-data .add-url-pane {padding: 0;}.jimu-widget-add-data .add-url-pane-container {background-color: #fff; border-bottom: 1px solid #ccc; padding: 15px 15px 35px;}.jimu-widget-add-data .add-url-pane-container--inner {max-width: 960px; margin: 0 auto;}.jimu-widget-add-data .add-file-pane .intro ul {font-size: 10px; margin: 0; padding: 2px 0 2px 20px;}.jimu-widget-add-data .add-file-pane .intro ul .note {font-style: italic;}.jimu-rtl .jimu-widget-add-data .add-file-pane .intro ul {padding: 2px 20px 2px 0;}.jimu-widget-add-data .add-file-pane .generalize-options .jimu-checkbox .checkbox {margin-top: 0; vertical-align: middle;}.jimu-widget-add-data .add-file-pane .generalize-options .jimu-checkbox .label {font-size: 12px; vertical-align: middle; cursor: pointer;}.jimu-widget-add-data .add-file-pane .browse-or-drop {}.jimu-widget-add-data .add-file-pane .or {display: block; margin: 20px auto; font-size: 11px; color: #898989; width: 90%; max-width: 400px; line-height: 20px; position: relative;}.jimu-widget-add-data .add-file-pane .or:before,.jimu-widget-add-data .add-file-pane .or:after {content: ""; display: block; height: 1px; width: 35%; background: #eee; position: absolute; top: 9px; left: 0;}.jimu-widget-add-data .add-file-pane .or:after {right: 0; left: auto;}.jimu-widget-add-data .add-file-pane .or b {display: inline-block; padding-right: 5px;}.jimu-widget-add-data .add-file-pane .drop-area {width: 100%; background: #fff; margin: 10px auto 0; padding: 25px 50px 35px; border: 1px dashed #ccc; color: #898989; font-size: 12px; text-align: center; line-height: 1.75; text-transform: uppercase; position: relative; -moz-border-radius: 5px; -webkit-border-radius: 5px; border-radius: 5px; -webkit-transition: opacity ease-in-out 0.15s; -moz-transition: opacity ease-in-out 0.15s; -o-transition: opacity ease-in-out 0.15s; transition: opacity ease-in-out 0.15s;}.jimu-widget-add-data .add-file-pane .drop-area i {color: #485566; font-style: normal;}.jimu-widget-add-data .add-file-pane .drop-area a.drop-area-hint {position: absolute; top: 0; right: 0; margin: 5px; padding: 10px; font-size: 14px; line-height: 1;}.jimu-widget-add-data .add-file-pane .drop-area.hit {background: #f9f9f9; border-color: #24b5cc;}.jimu-widget-add-data .add-file-pane .drop-area.hit \x3e * {pointer-events: none; display: none;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types {display: block;}.jimu-widget-add-data .add-file-pane .drop-area.hit .upload-arrow {display: block; width: 48px; height: 48px; background: url(images/arrow_up.png) no-repeat; margin: 0 auto; -moz-animation: updload-arrow-animation 1s infinite; -webkit-animation: updload-arrow-animation 1s infinite; animation: updload-arrow-animation 1s infinite;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types {margin: 15px 0 35px; opacity: .5; pointer-events: none; -webkit-transition: opacity ease-in-out 0.15s; -moz-transition: opacity ease-in-out 0.15s; -o-transition: opacity ease-in-out 0.15s; transition: opacity ease-in-out 0.15s;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img {width: 45px; margin-left: -5px; position: relative; -webkit-transition: all ease-in-out 0.2s; -moz-transition: all ease-in-out 0.2s; -o-transition: all ease-in-out 0.2s; transition: all ease-in-out 0.2s;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.first-type-icon {-moz-transform: rotate(-8deg); -moz-transform-origin: right bottom; -webkit-transform: rotate(-8deg); -webkit-transform-origin: right bottom; -o-transform: rotate(-8deg); -o-transform-origin: right bottom; transform: rotate(-8deg); transform-origin: right bottom; bottom: -1px;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.second-first-type-icon {-moz-transform: rotate(-3deg); -moz-transform-origin: right bottom; -webkit-transform: rotate(-3deg); -webkit-transform-origin: right bottom; -o-transform: rotate(-3deg); -o-transform-origin: right bottom; transform: rotate(-3deg); transform-origin: right bottom;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.second-last-type-icon {-moz-transform: rotate(3deg); -moz-transform-origin: left bottom; -webkit-transform: rotate(3deg); -webkit-transform-origin: left bottom; -o-transform: rotate(3deg); -o-transform-origin: left bottom; transform: rotate(3deg); transform-origin: left bottom;}.jimu-widget-add-data .add-file-pane .drop-area .supported-file-types img.last-type-icon {-moz-transform: rotate(8deg); -moz-transform-origin: left bottom; -webkit-transform: rotate(8deg); -webkit-transform-origin: left bottom; -o-transform: rotate(8deg); -o-transform-origin: left bottom; transform: rotate(8deg); transform-origin: left bottom; bottom: -1px;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types {opacity: 1;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img {margin-left: 0px;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.first-type-icon {-moz-transform: rotate(-12deg); -webkit-transform: rotate(-12deg); -o-transform: rotate(-12deg); transform: rotate(-12deg); bottom: -3px;}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.second-first-type-icon {-moz-transform: rotate(-5deg); -webkit-transform: rotate(-5deg); -o-transform: rotate(-5deg); transform: rotate(-5deg);}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.second-last-type-icon {-moz-transform: rotate(5deg); -webkit-transform: rotate(5deg); -o-transform: rotate(5deg); transform: rotate(5deg);}.jimu-widget-add-data .add-file-pane .drop-area.hit .supported-file-types img.last-type-icon {-moz-transform: rotate(12deg); -webkit-transform: rotate(12deg); -o-transform: rotate(12deg); transform: rotate(12deg); bottom: -3px;}.jimu-widget-add-data .add-file-pane .file-form {display: inline-block;}.jimu-widget-add-data .search-box2 {display: inline-block;}.jimu-widget-add-data .search-box2 {float: right;}.jimu-widget-add-data .search-box2 .search-textbox {vertical-align: middle; height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -moz-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data .search-box2 .btn {display: inline-block; height: 30px; margin-left: -1px; margin-bottom: 0; font-weight: normal; text-align: center; vertical-align: middle; touch-action: manipulation; cursor: pointer; color: #196fa6; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; padding: 5px 10px; white-space: nowrap; font-size: 12px; line-height: 1.5; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;}.jimu-widget-add-data.width-small .search-box2 .search-textbox {width: 150px;}.jimu-widget-add-data.width-small .add-file-pane .or:before,.jimu-widget-add-data.width-small .add-file-pane .or:after {width: 25%;}.jimu-widget-add-data.width-medium .search-box2 .search-textbox {width: 140px;}.jimu-widget-add-data.width-medium .filter-wrapper .sort-prompt,.jimu-widget-add-data.width-small .filter-wrapper .sort-prompt {display: none;}.jimu-widget-add-data.width-medium .search-pane .search-results-pane {padding: 5px 0;}.jimu-widget-add-data.width-medium .search-pane .item-card .item-card-inner {margin-bottom: 5px;}.jimu-widget-add-data.height-small .add-file-pane {padding-top: 15px; padding-bottom: 15px;}.jimu-widget-add-data.height-small .add-file-pane .drop-area {padding-top: 15px; padding-bottom: 25px;}.jimu-widget-add-data.height-small .add-file-pane .drop-area .supported-file-types {margin-bottom: 20px;}.jimu-widget-add-data .search-bbox-option .checkbox-inline,.jimu-widget-add-data .search-bbox-option .checkbox-inline input,.jimu-widget-add-data .search-pane .filter-placeholder {cursor: pointer;}.jimu-widget-add-data.width-small .search-bbox-option {max-width: 120px; font-size: 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;}.jimu-widget-add-data.width-small .search-bbox-option .switch-toggle-group {overflow: hidden; text-overflow: ellipsis;}.jimu-widget-add-data .search-pane .search-bbox-option .checkbox-inline {padding-left: 38px; margin-right: 25px;}.jimu-widget-add-data .search-pane .search-box .input-group {position: relative; display: table; border-collapse: separate;}.jimu-widget-add-data .search-pane .search-box .input-group \x3e * {display: table-cell; vertical-align: middle;}.jimu-widget-add-data .search-pane .search-box .search-textbox {height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -moz-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data .search-pane .search-box .btn {display: inline-block; margin-left: -1px; margin-bottom: 0; font-weight: normal; text-align: center; vertical-align: middle; touch-action: manipulation; cursor: pointer; color: #196fa6; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; padding: 5px 10px; white-space: nowrap; font-size: 12px; line-height: 1.5; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;}.jimu-widget-add-data .search-pane .search-box .btn-clear {border-color: transparent; background: transparent; position: absolute; left: -32px;}.jimu-widget-add-data .search-pane .search-box-placeholder,.jimu-widget-add-data .search-pane .filter-placeholder,.jimu-widget-add-data .search-pane .scope-placeholder {display: none;}.jimu-widget-add-data .search-pane .search-sort-options \x3e * {vertical-align: middle;}.jimu-widget-add-data .search-pane .search-sort-options label {font-weight: normal; font-size: 11px; color: #898989;}.jimu-widget-add-data .search-pane .search-sort-options .sort-order-icon {float: right; width: 24px; height: 24px; margin: 3px 0;}.jimu-widget-add-data .search-pane .search-sort-options .dropdown-toggle .sort-order-icon {float: none; padding: 0 5px;}.jimu-widget-add-data .search-pane .sort-order-icon {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px; background-image: url("images/sort-down-arrow.png");}.jimu-widget-add-data .search-pane .sort-order-icon.descending {background-image: url("images/sort-up-arrow.png");}.jimu-widget-add-data .search-pane .scope-options \x3e * {display: inline-block;}.jimu-widget-add-data .search-pane .checkbox-inline,.jimu-widget-add-data .search-pane .radio-inline {position: relative; padding-left: 21px; margin-right: 10px;}.jimu-widget-add-data .search-pane .checkbox-inline .dijitCheckBox,.jimu-widget-add-data .search-pane .radio-inline .dijitCheckBox {}.jimu-widget-add-data .search-pane .search-item-ratings-comments-views {display: block; padding: 5px;}.jimu-widget-add-data .search-pane .search-item-ratings-comments-views [class*\x3d"gd-icon-"] {margin-right: 10px; vertical-align: middle;}.jimu-widget-add-data .search-pane .search-paging .pagination {margin: 0;}.jimu-widget-add-data .search-pane .search-paging,.jimu-widget-add-data .search-pane .search-result-count {display: inline-block; vertical-align: middle; line-height: 1;}.jimu-widget-add-data .search-pane .pagination \x3e li \x3e span,.jimu-widget-add-data .search-pane .pagination \x3e li \x3e span:focus,.jimu-widget-add-data .search-pane .pagination \x3e li \x3e span:hover {color: inherit; border-color: transparent; background-color: transparent;}.jimu-widget-add-data .search-pane .pagination \x3e li.current-page \x3e span {padding-left: 15px; padding-right: 15px;}.jimu-widget-add-data .search-pane .pagination [class*\x3d" esri-icon-"],.jimu-widget-add-data .search-pane .pagination [class^\x3d"esri-icon-"] {position: relative; top: 1px;}.jimu-widget-add-data .search-pane .search-result-count {margin: 0 10px;}.jimu-widget-add-data.width-768 .item-card {width: 50%;}.jimu-widget-add-data.width-1200 .item-card {width: 33.3333333333%;}.jimu-widget-add-data.width-medium .search-pane .search-bar,.jimu-widget-add-data.width-small .search-pane .search-bar {padding-left: 5px; padding-right: 5px;}.jimu-widget-add-data.width-medium .search-pane .search-bar .btn-group \x3e .btn,.jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin-left: 0;}.jimu-rtl .jimu-widget-add-data.width-medium .search-pane .search-bar .btn-group \x3e .btn,.jimu-rtl .jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin-left: auto; margin-right: 0;}.jimu-widget-add-data.width-medium .search-box-placeholder,.jimu-widget-add-data.width-small .search-box-placeholder,.jimu-widget-add-data.filter-placeholder-on .filter-placeholder {display: block; height: 30px; width: 30px; background-image: url("images/search.png"); background-position: center center; background-repeat: no-repeat; background-size: 12px;}.jimu-widget-add-data.width-medium .search-box,.jimu-widget-add-data.width-small .search-box {display: none; padding: 10px; position: absolute; top: 0; left: 0; right: 40px; background: #ffffff;}.jimu-widget-add-data.width-small .search-box {padding-top: 8px; padding-bottom: 8px;}.jimu-widget-add-data.width-medium .search-box .input-group,.jimu-widget-add-data.width-small .search-box .input-group {width: 100%;}.jimu-widget-add-data.width-medium .search-box .search-textbox,.jimu-widget-add-data.width-small .search-box .search-textbox {width: 100%;}.jimu-widget-add-data.width-medium .search-box .search-btn,.jimu-widget-add-data.width-small .search-box .search-btn {width: 1%; position: relative;}.jimu-widget-add-data.width-medium .search-box.show,.jimu-widget-add-data.width-small .search-box.show {display: block;}.jimu-widget-add-data.width-medium .search-box-placeholder,.jimu-widget-add-data.width-small .search-box-placeholder {margin: 0 0 8px;}.jimu-widget-add-data.width-medium .search-box-placeholder.opened,.jimu-widget-add-data.width-small .search-box-placeholder.opened {background-image: url("images/close.png");}.jimu-widget-add-data.width-medium .filter-placeholder,.jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/menu.png");}.jimu-widget-add-data.width-medium .scope-placeholder,.jimu-widget-add-data.width-small .scope-placeholder {display: block; padding: 5px 10px 15px; color: #196fa6; font-weight: bold;}.jimu-widget-add-data.width-small .scope-placeholder {display: flex;}.jimu-widget-add-data.width-small .scope-placeholder \x3e span:first-child {white-space: nowrap; text-overflow: ellipsis; overflow: hidden; width: calc(100% - 16px); flex: 1;}.jimu-widget-add-data.width-medium .scope-placeholder:focus,.jimu-widget-add-data.width-small .scope-placeholder:focus {text-decoration: none;}.jimu-widget-add-data.width-medium .scope-placeholder \x3e *,.jimu-widget-add-data.width-small .scope-placeholder \x3e * {vertical-align: middle;}.jimu-widget-add-data.width-medium .scope-placeholder .dropdown-arrow,.jimu-widget-add-data.width-small .scope-placeholder .dropdown-arrow {display: inline-block; background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data.width-medium .btn-group,.jimu-widget-add-data.filter-placeholder-on .filter-wrapper,.jimu-widget-add-data.width-small .btn-group {display: none;}.jimu-widget-add-data.width-medium .filter-wrapper.show,.jimu-widget-add-data.width-medium .btn-group.show,.jimu-widget-add-data.width-small .filter-wrapper.show,.jimu-widget-add-data.width-small .btn-group.show {display: block; position: absolute; right: 0; top: 91px; z-index: 10; padding: 5px 10px; background: #ffffff; border: 1px solid #cccccc; -webkit-box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2); -moz-box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2); box-shadow: 0 3px 5px 0 rgba(0, 0, 0, 0.2);}.jimu-rtl .jimu-widget-add-data.width-medium .filter-wrapper.show,.jimu-rtl .jimu-widget-add-data.width-medium .btn-group.show,.jimu-rtl .jimu-widget-add-data.width-small .filter-wrapper.show,.jimu-rtl .jimu-widget-add-data.width-small .btn-group.show {left: 0; right: auto;}.jimu-widget-add-data.width-medium .btn-group.show,.jimu-widget-add-data.width-small .btn-group.show {top: 48px; left: 0; padding: 0; right: auto; min-width: 50%;}.jimu-rtl .jimu-widget-add-data.width-medium .btn-group.show,.jimu-rtl .jimu-widget-add-data.width-small .btn-group.show {left: auto; right: 0;}.jimu-widget-add-data.width-medium .btn-group.show .btn,.jimu-widget-add-data.width-small .btn-group.show .btn {display: block; width: 100%; padding: 10px 15px; border: 0; font-weight: normal;}.jimu-widget-add-data.width-medium .btn-group.show .btn:hover,.jimu-widget-add-data.width-small .btn-group.show .btn:hover {background-color: #f4f4f4;}.jimu-widget-add-data.width-medium .btn-group.show .btn.active,.jimu-widget-add-data.width-medium .btn-group.show .btn.active:hover,.jimu-widget-add-data.width-small .btn-group.show .btn.active,.jimu-widget-add-data.width-small .btn-group.show .btn.active:hover {background-color: #196fa6 !important; color: #fff !important;}.jimu-widget-add-data.width-small .jimu-tab3 .tab-item-td {padding-left: 20px; padding-right: 20px;}.jimu-widget-add-data.width-small .search-pane .search-bar {padding-top: 5px; padding-left: 5px; padding-right: 5px;}.jimu-widget-add-data.width-small .search-pane .search-bar .btn-group \x3e .btn {margin: 0; padding-left: 5px; padding-right: 5px; font-size: 11px;}.jimu-widget-add-data.width-small .search-pane .search-results-pane {padding: 0; overflow: hidden;}.jimu-widget-add-data.width-small .search-pane .item-card {padding-left: 0; padding-right: 0;}.jimu-widget-add-data.width-small .search-pane .item-card .item-card-inner {margin-bottom: 0; border-top: 0; border-left: 0; border-right: 0; border-bottom-color: #e0e0e0;}.add-data-widget-popup .search-type-option {display: flex; align-items: center;}.add-data-widget-popup .search-type-option + .search-type-option {margin-top: 10px;}.add-data-widget-popup .search-type-option .jimu-checkbox {margin-right: 5px;}.jimu-rtl .add-data-widget-popup .search-type-option .jimu-checkbox {margin-right: auto; margin-left: 5px;}.add-data-widget-popup .search-type-option,.add-data-widget-popup .search-type-option input {cursor: pointer;}.jimu-widget-add-data {position: absolute; top: 0; bottom: 0; left: 0; right: 0; padding-top: 5px;}.jimu-widget-add-data .btn.hidden {visibility: hidden;}.jimu-widget-add-data .search-bbox-option,.jimu-widget-add-data .search-box {display: inline-block;}.jimu-widget-add-data .search-box,.jimu-widget-add-data .search-box-placeholder {float: right;}.jimu-widget-add-data .search-scope-options,.jimu-widget-add-data .search-sort-options {display: inline-block;}.jimu-widget-add-data .search-data-type-options {float: left;}.jimu-widget-add-data .filter-wrapper,.jimu-widget-add-data .filter-placeholder {float: right;}.jimu-widget-add-data .search-scope-options button.active {background-color: #cce6ff;}.jimu-widget-add-data .search-results-pane {overflow-y: auto;}.jimu-widget-add-data .search-paging,.jimu-widget-add-data .search-result-count {display: inline-block;}.jimu-widget-add-data .search-paging ul {margin: 0; padding: 0;}.jimu-widget-add-data .search-paging li {display: inline-block;}.jimu-widget-add-data .search-paging li.disabled a,.jimu-widget-add-data .search-paging li.disabled a:hover,.jimu-widget-add-data .search-paging li.disabled a:active,.jimu-widget-add-data .search-paging li.disabled a:focus {cursor: default; opacity: 0.35;}.jimu-widget-add-data .search-item-card .action-bar {margin-left: 20px;}.jimu-widget-add-data .search-item-card .action-bar a {margin-right: 8px;}.jimu-widget-add-data .dijitDropDownButton {margin: 0;}.jimu-widget-add-data .dijitSelect,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode {background: transparent; border: 0; padding: 7px 5px; color: #196fa6; font-weight: bold; -webkit-box-shadow: none; -moz-box-shadow: none; box-shadow: none; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0;}.jimu-widget-add-data .dijitSelect .dijitButtonContents,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitButtonContents {border-color: transparent;}.jimu-widget-add-data .dijitSelect .dijitInputField,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitInputField {padding: 0 5px;}.jimu-widget-add-data .dijitSelect .dijitArrowButton,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode .dijitArrowButton {background: transparent; border: 0;}.jimu-widget-add-data .dijitSelect.dijitSelectFocused .dijitArrowButton,.jimu-widget-add-data .dijitDropDownButton .dijitButtonNode.dijitSelectFocused .dijitArrowButton {padding: 0;}.jimu-widget-add-data .dijitSelect .dijitArrowButton .dijitArrowButtonInner,.jimu-widget-add-data .dijitSelectHover .dijitArrowButton .dijitArrowButtonInner,.jimu-widget-add-data .dijitSelectFocused .dijitArrowButton .dijitArrowButtonInner {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data .dijitDropDownButton .dijitArrowButtonInner {background-image: url("images/down-arrow.png"); background-position: center center; background-repeat: no-repeat; width: 16px; height: 16px;}.jimu-widget-add-data-dialog {background-color: #FFFFFF !important; border-color: #555555 !important; -moz-border-radius: 5px; -webkit-border-radius: 5px; border-radius: 5px; -webkit-box-shadow: 0 0 5px rgba(0, 0, 0, 0.35) !important; -moz-box-shadow: 0 0 5px rgba(0, 0, 0, 0.35) !important; box-shadow: 0 0 5px rgba(0, 0, 0, 0.35) !important;}.jimu-widget-add-data-dialog .dijitDialogPaneContent {border-top: 1px solid #cccccc;}.jimu-widget-add-data-dialog .dijitDialogTitleBar {background: none repeat scroll 0 0 rgba(0, 0, 0, 0); background-color: #FFFFFF; -moz-border-radius: 3px 3px 0 0; -webkit-border-radius: 3px 3px 0 0; border-radius: 3px 3px 0 0;}.jimu-widget-add-data-dialog .dijitDialogTitle {background-color: #FFFFFF; color: #000000; font-size: 16px; font-weight: bold;}.jimu-widget-add-data-dialog div.gap {margin-top: 20px;}.jimu-widget-add-data-dialog div.small-gap {margin-top: 4px;}.jimu-widget-add-data-dialog div.action-bar {margin-top: 10px;}.jimu-widget-add-data-dialog .url-textbox {height: 30px; width: 200px; padding: 5px 10px; font-size: 12px; line-height: 1.5; background-color: #ffffff; background-image: none; border: 1px solid #cccccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -moz-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.075); -webkit-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -moz-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; -o-transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s; transition: border-color ease-in-out 0.15s, box-shadow ease-in-out 0.15s;}.jimu-widget-add-data-dialog .url-textbox-wide {width: 500px;}.jimu-widget-add-data-dialog .examples {font-size: 9px; font-style: italic; margin-top: 4px; margin-left: 4px; opacity: 0.5;}.jimu-widget-add-data .btn-link {color: #196fa6 !important;}.jimu-widget-add-data .switch-toggle-group {padding: 5px;}.jimu-widget-add-data .switch-toggle-group .checkbox-inline {padding-left: 36px; vertical-align: top;}.jimu-widget-add-data .switch-toggle-group .switch-toggle.dijitCheckBox {margin-left: -36px;}.jimu-widget-add-data .switch-toggle.dijitCheckBox {height: 16px; width: 28px; border: 0 none; background: #e04f1d; position: relative; display: inline-block; cursor: pointer; -moz-border-radius: 10px; -webkit-border-radius: 10px; border-radius: 10px;}.jimu-widget-add-data .switch-toggle.dijitCheckBox:before {content: ""; background: #f8f8f8; position: absolute; padding: 0; height: 12px; width: 12px; left: auto; right: 2px; top: 2px; z-index: 1; -webkit-transition: right 0.3s; -moz-transition: right 0.3s; -o-transition: right 0.3s; transition: right 0.3s; -moz-border-radius: 50%; -webkit-border-radius: 50%; border-radius: 50%;}.jimu-widget-add-data .switch-toggle.dijitCheckBox input {width: 100%; height: 100%; position: absolute; left: 0; z-index: 2;}.jimu-widget-add-data .switch-toggle.dijitCheckBox.dijitCheckBoxChecked {background: #50ad4e;}.jimu-widget-add-data .switch-toggle.dijitCheckBox.dijitCheckBoxChecked:before {right: 14px;}.jimu-widget-add-data .panel-default \x3e .panel-heading {background-color: transparent; border-color: #e0e0e0;}.jimu-widget-add-data .panel-title {font-size: 16px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-add-data .panel-footer .btn + .btn {margin-left: 10px;}.jimu-widget-add-data .gp-panel {width: 300px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading {background-color: transparent; border-left: 1px solid rgba(0, 0, 0, 0.35); color: #efefef; height: 40px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading .panel-title {font-weight: normal; line-height: 1.5;}.jimu-widget-add-data .gp-panel \x3e .panel-heading [class^\x3d"esri-icon-"],.jimu-widget-add-data .gp-panel \x3e .panel-heading [class*\x3d" esri-icon-"] {display: inline-block; margin-right: 10px; position: relative; top: 1px;}.jimu-widget-add-data .gp-panel \x3e .panel-heading .btn-icon {width: 20px; padding: 0; color: #efefef; float: right; margin-right: 0; font-size: 16px; line-height: 1.25; line-height: 20px; text-align: center;}.jimu-widget-add-data .gp-panel \x3e .panel-body {background-color: #f8f8f8; border-left: 1px solid #cccccc; position: absolute; top: 40px; bottom: 0; width: 100%; overflow: auto; padding: 0;}.jimu-widget-add-data .gp-panel .panel-section {background-color: #ffffff;}.jimu-widget-add-data .panel-section {border-bottom: 1px solid #cccccc;}.jimu-widget-add-data .panel-section .section-header {display: block; font-size: 16px; line-height: 1.25; line-height: 20px; padding: 10px 15px;}.jimu-widget-add-data .panel-section .section-header:after {content: ""; display: block; clear: both;}.jimu-widget-add-data .panel-section .section-header [class^\x3d"esri-icon-"],.jimu-widget-add-data .panel-section .section-header [class*\x3d" esri-icon-"],.jimu-widget-add-data .panel-section .section-header .btn {margin: 0 5px; float: right;}.jimu-widget-add-data .panel-section .section-header .btn {margin: 0; min-width: 80px;}.jimu-widget-add-data .panel-section .btn.section-header {border: 0; text-align: left; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-transition: all 0.25s ease; -moz-transition: all 0.25s ease; -o-transition: all 0.25s ease; transition: all 0.25s ease;}.jimu-widget-add-data .panel-section .btn.section-header:hover {background-color: #e2f1fb; text-decoration: none;}.jimu-widget-add-data .panel-section .btn.section-header:active,.jimu-widget-add-data .panel-section .btn.section-header:focus {background-color: #aadbfa; text-decoration: none;}.jimu-widget-add-data .panel-section .section-body {padding: 10px 15px;}.jimu-widget-add-data a, .add-url-pane a {display: block; color: #196fa6; text-decoration: none; line-height: 20px; padding: 10px 5px;}.jimu-widget-add-data .btn.hidden {visibility: hidden;}.jimu-widget-add-data .search-bbox-option, .search-box {display: inline-block;}.jimu-widget-add-data .search-box,.jimu-widget-add-data .search-box-placeholder {float: right;}.jimu-widget-add-data .search-scope-options,.jimu-widget-add-data .search-sort-options {display: inline-block;}.jimu-widget-add-data .search-data-type-options {float: left;}.jimu-widget-add-data .filter-wrapper,.jimu-widget-add-data .filter-placeholder {float: right;}.jimu-widget-add-data .search-scope-options button.active {background-color: #cce6ff;}.jimu-widget-add-data .search-results-pane {overflow-y: auto;}.jimu-widget-add-data .search-paging,.jimu-widget-add-data .search-result-count {display: inline-block;}.jimu-widget-add-data .search-paging ul {margin: 0; padding: 0;}.jimu-widget-add-data .search-paging li {display: inline-block;}.jimu-rtl .jimu-widget-add-data .search-paging li {-moz-transform: rotate(180deg); -webkit-transform: rotate(180deg); -o-transform: rotate(180deg); transform: rotate(180deg);}.jimu-rtl .jimu-widget-add-data .search-paging li.current-page {-moz-transform: rotate(0); -webkit-transform: rotate(0); -o-transform: rotate(0); transform: rotate(0);}.jimu-widget-add-data .search-item-card .action-bar {margin-left: 20px;}.jimu-widget-add-data .search-item-card .action-bar a {margin-right: 8px;}.jimu-widget-add-data .add-url-pane .url-textbox {width: 100%; font-size: 12px; color: #000000; padding: 0;}.jimu-widget-add-data .add-url-pane .examples {display: none; margin: 15px -15px 0; padding: 15px; font-size: 12px; color: #898989; word-wrap: break-word;}.jimu-widget-add-data .add-url-pane .examples \x3e div \x3e div {margin-bottom: 15px;}.jimu-widget-add-data .add-url-pane .examples.show {display: block;}.jimu-widget-add-data .jimu-tab3 \x3e .jimu-viewstack {position: absolute; top: 39px; left: 0px; right: 0; bottom: 0; padding-bottom: 40px;}.jimu-widget-add-data-footer {height: 40px; overflow: hidden; background-color: #f8f8f8; border-top: 1px solid #ccc; padding: 0 15px; color: #898989; font-size: 11px;}.jimu-widget-add-data-footer [class^\x3d"esri-icon-"],.jimu-widget-add-data-footer [class*\x3d" esri-icon-"] {line-height: 20px;}.jimu-widget-add-data-footer .layerlist-button {text-transform: uppercase;}.jimu-widget-add-data-footer .layerlist-button .esri-icon-layers {margin: 0 5px; vertical-align: middle; display: inline-block;}.jimu-widget-add-data-footer .message {display: block; color: #898989; line-height: 20px; padding: 10px 10px 10px 0; text-overflow: ellipsis; overflow: hidden; word-break: break-all; white-space: nowrap;}.jimu-widget-add-data.layerlist-show {overflow: hidden;}.jimu-widget-add-data.layerlist-show .jimu-tab3 {-webkit-filter: blur(5px); filter: blur(5px);}.jimu-widget-add-data.layerlist-show .add-data-layerlist--container {-moz-animation: slide-from-right .4s; -webkit-animation: slide-from-right .4s; animation: slide-from-right .4s;}.add-data-widget-layers {width: 100%; height: 100%; background: rgba(0, 0, 0, 0.3); position: absolute; top: 0; right: 0; z-index: 1;}.add-data-widget-layers {display: none;}.add-data-widget-layers.show {display: block;}.add-data-widget-layers .add-data-layerlist--container {background: #fff; position: absolute; top: 0; right: 0; width: 320px; height: 100%; -webkit-transition: width 0.4s ease; -moz-transition: width 0.4s ease; -o-transition: width 0.4s ease; transition: width 0.4s ease;}.width-small .add-data-widget-layers .add-data-layerlist--container {width: 100%;}.add-data-widget-layers .add-data-layerlist--container h2 {margin: 0; padding: 7px 15px; border-bottom: 1px solid #ccc; color: #898989; font-size: 14px; font-weight: normal; line-height: 2;}.add-data-layerlist--list {width: 100%; padding: 10px 15px; line-height: 20px; position: absolute; top: 45px; bottom: 40px; overflow: auto;}.add-data-layerlist--listitem {margin-bottom: 5px;}.add-data-layerlist--listitem:after {content: ""; display: table; clear: both;}.add-data-layerlist--listitem .remove-button {float: right; padding: 5px 10px;}.add-data-layerlist--listitem .layer-name {display: block; padding-top: 5px;}.add-data-widget-layers .add-data-layerlist--footer {width: 100%; position: absolute; bottom: 0;}.add-data-widget-layers .back-button {float: right; text-transform: uppercase;}.add-data-widget-layers .back-button i {display: inline-block; margin-left: 5px;}.add-data-widget-layers .no-data-message {color: #898989; padding: 25px; text-align: center;}.add-data-widget-popup {padding: 0;}.add-data-widget-popup .dijitTooltipConnector {display: none;}.add-data-widget-popup .dijitTooltipContainer {padding: 10px; border-color: #ccc; -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0; -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);}.add-data-widget-popup.dijitMenuPopup {-webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25); box-shadow: 0 1px 3px rgba(0, 0, 0, 0.25);}.add-data-widget-popup .dijitMenu {border-color: #ccc;}.add-data-widget-popup .dijitMenu .dijitMenuItem td {padding: 10px 15px; border: 0;}.add-data-widget-popup .dijitMenu .dijitMenuItemHover td,.add-data-widget-popup .dijitMenu .dijitMenuItemActive td,.add-data-widget-popup .dijitMenu .dijitMenuItemSelected td {background-color: #f4f4f4; background-image: none;}.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption td,.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption.dijitMenuItemHover td,.add-data-widget-popup .dijitMenu .dijitSelectSelectedOption.dijitMenuItemSelected td {background-color: #196fa6; background-image: none; color: #fff; font-weight: normal;}.LaunchpadTheme .jimu-widget-add-data.jimu-widget {position: absolute;}.LaunchpadTheme .jimu-widget-add-data .search-pane .item-card h3.title {height: auto; width: auto; position: static;}.LaunchpadTheme .jimu-widget-add-data .dijitSelect.dijitSelectFocused .dijitArrowButton,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode.dijitSelectFocused .dijitArrowButton {padding: 5px;}.LaunchpadTheme .jimu-widget-add-data .dijitButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitComboButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitToggleButton .dijitButtonNode {color: #196fa6; font-size: inherit; letter-spacing: 0;}.LaunchpadTheme .jimu-widget-add-data .dijitSelect,.LaunchpadTheme .jimu-widget-add-data .dijitButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitComboButton .dijitButtonNode,.LaunchpadTheme .jimu-widget-add-data .dijitToggleButton .dijitButtonNode {background-color: transparent; border: 0;}.LaunchpadTheme .jimu-widget-add-data .secondary-pane .jimu-btn {background-color: #3b8fc4; border: 0;}.LaunchpadTheme .jimu-widget-add-data .secondary-pane .jimu-btn:hover {background-color: #2c6b93;}.DartTheme .jimu-widget-add-data .search-pane {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane .search-bar {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane .search-bar-secondary {background: #3a3a3a;}.DartTheme .jimu-widget-add-data .secondary-pane {background-color: transparent;}.DartTheme .jimu-widget-add-data .search-pane-content {background-color: #222;}.DartTheme .jimu-tab3 .tab-item-td.jimu-state-active {background: #4C4C4C;}.DartTheme .jimu-widget-add-data .search-pane .search-bar-separator,.DartTheme .jimu-widget-add-data .search-pane .search-pane-header {border-bottom: 1px solid #262626;}.DartTheme .jimu-widget-add-data .search-box2 .search-textbox {background: #393939; border: 0; -moz-border-radius: 2px; -webkit-border-radius: 2px; border-radius: 2px;}.DartTheme .jimu-widget-add-data.width-small .search-box2 .search-textbox {width: 100px;}.DartTheme .jimu-widget-add-data .search-box2 .btn {background: #393939; border: 0;}.DartTheme .jimu-widget-add-data .search-pane .item-card .item-card-inner {background: #4c4c4c; border-color: #787878;}.DartTheme .jimu-widget-add-data .search-pane .item-card h3.title {height: auto; width: auto; position: static;}.DartTheme .jimu-widget-add-data.width-medium .filter-wrapper.show,.DartTheme .jimu-widget-add-data.width-medium .btn-group.show,.DartTheme .jimu-widget-add-data.width-small .filter-wrapper.show,.DartTheme .jimu-widget-add-data.width-small .btn-group.show {background: #393939; border: 1px solid #7f8183; -webkit-box-shadow: 0 2px 3px rgba(0,0,0,0.15); -moz-box-shadow: 0 2px 3px rgba(0,0,0,0.15); box-shadow: 0 2px 3px rgba(0,0,0,0.15);}.DartTheme .jimu-widget-add-data.width-medium .btn-group.show .btn:hover,.DartTheme .jimu-widget-add-data.width-small .btn-group.show .btn:hover {background-color: #222;}.DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active,.DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:active,.DartTheme .jimu-widget-add-data .search-pane .search-bar .btn-group \x3e .btn.active:hover {color: #f8f8f8 !important;}.DartTheme .jimu-widget-add-data .search-pane .search-sort-options label {color: #a7a7a7 !important;}.DartTheme .jimu-widget-add-data .secondary-pane {border-bottom: 0;}.DartTheme .jimu-widget-add-data .search-pane .item-card div.info {color: #ddd !important;}.DartTheme .jimu-widget-add-data .search-pane .item-card .action-bar a,.DartTheme .jimu-widget-add-data .add-url-pane .action-bar a,.DartTheme .jimu-widget-add-data .add-file-pane .file-form label {color: #15a4fa !important;}.DartTheme .jimu-widget-add-data .dijitDropDownButton .dijitButtonNode {padding: 7px;}.DartTheme .jimu-widget-add-data .dijitSelect {background-color: transparent; border: 0;}.DartTheme .jimu-widget-add-data .dijitSelect .dijitArrowButton {background-color: transparent; border: 0;}.DartTheme .jimu-widget-add-data.width-medium .scope-placeholder .dropdown-arrow,.DartTheme .jimu-widget-add-data.width-small .scope-placeholder .dropdown-arrow,.DartTheme .jimu-widget-add-data .dijitDropDownButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelect .dijitArrowButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelectHover .dijitArrowButton .dijitArrowButtonInner,.DartTheme .jimu-widget-add-data .dijitSelectFocused .dijitArrowButton .dijitArrowButtonInner {background-image: url("images/down-arrow_white.png");}.DartTheme .jimu-widget-add-data.width-medium .search-box-placeholder,.DartTheme .jimu-widget-add-data.width-medium .filter-placeholder,.DartTheme .jimu-widget-add-data.width-small .search-box-placeholder,.DartTheme .jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/search_white.png");}.DartTheme .jimu-widget-add-data.width-medium .filter-placeholder,.DartTheme .jimu-widget-add-data.width-small .filter-placeholder {background-image: url("images/menu_white.png");}.DartTheme .jimu-widget-add-data.width-medium .search-box-placeholder.opened,.DartTheme .jimu-widget-add-data.width-small .search-box-placeholder.opened {background-image: url("images/close_white.png");}.DartTheme.add-data-widget-popup .dijitTooltipContainer {color: #f8f8f8; background: #4c4c4c; border: 1px solid #7f8183; -webkit-box-shadow: 0 2px 3px rgba(0,0,0,0.15); -moz-box-shadow: 0 2px 3px rgba(0,0,0,0.15); box-shadow: 0 2px 3px rgba(0,0,0,0.15);}.DartTheme .add-data-widget-layers .add-data-layerlist--container {background-color: #4c4c4c;}.DartTheme .add-data-widget-layers .add-data-layerlist--container h2 {border-color: #262626;}.DartTheme .jimu-widget-add-data-footer,.DartTheme .add-data-widget-layers .add-data-layerlist--footer {background-color: transparent; border-top-color: #262626;}.DartTheme .jimu-widget-add-data .add-url-pane-container {background-color: transparent; border-color: transparent;}.DartTheme .jimu-widget-add-data .add-url-pane .action-bar a {padding-top: 0; padding-bottom: 0;}.DartTheme .jimu-widget-add-data .add-url-pane .action-bar .jimu-btn {min-width: 140px;}.DartTheme .jimu-widget-add-data .add-file-pane .drop-area {background: transparent; border-color: #ccc;}.DartTheme .jimu-widget-add-data.height-small .add-file-pane .drop-area {padding-left: 15px; padding-right: 15px;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card {float: right;}.jimu-rtl .jimu-widget-add-data .search-pane .item-card .thumbnail {float: right; margin-left: 10px; margin-right: 0;}.jimu-rtl .jimu-widget-add-data .search-pane .search-bbox-option .checkbox-inline {padding-left: auto; padding-right: 38px; margin-right: auto; margin-left: 25px;}.jimu-rtl .jimu-widget-add-data .search-box2 {float: left;}.jimu-rtl .jimu-widget-add-data .search-box2 .btn {margin-left: auto; margin-right: -1px;}.jimu-rtl .jimu-widget-add-data .search-pane .search-sort-options .sort-order-icon {float: left;}.jimu-rtl .jimu-widget-add-data .search-box, .search-box-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .search-data-type-options {float: right;}.jimu-rtl .jimu-widget-add-data .filter-wrapper,.jimu-rtl .jimu-widget-add-data .filter-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .switch-toggle-group .checkbox-inline {padding-left: auto; padding-right: 36px;}.jimu-rtl .jimu-widget-add-data .switch-toggle-group .switch-toggle.dijitCheckBox {margin-left: auto; margin-right: -36px;}.jimu-rtl .jimu-widget-add-data .gp-panel \x3e .panel-heading .btn-icon {float: left;}.jimu-rtl .jimu-widget-add-data .panel-section .section-header [class^\x3d"esri-icon-"],.jimu-rtl .jimu-widget-add-data .panel-section .section-header [class*\x3d" esri-icon-"],.jimu-rtl .jimu-widget-add-data .panel-section .section-header .btn {float: left;}.jimu-rtl .jimu-widget-add-data .search-box,.jimu-rtl .jimu-widget-add-data .search-box-placeholder {float: left;}.jimu-rtl .jimu-widget-add-data .search-data-type-options {float: right;}.jimu-rtl .jimu-widget-add-data .filter-wrapper,.jimu-rtl .jimu-widget-add-data .filter-placeholder {float: left;}.jimu-widget-add-data .add-file-pane .or b {padding-left: 5px; padding-right: 0;}.jimu-rtl .jimu-widget-add-data .add-file-pane .drop-area a.drop-area-hint {left: 0; right: auto;}.jimu-rtl .add-data-widget-layers .add-data-layerlist--container {left: 0; right: auto;}.jimu-rtl .jimu-widget-add-data.layerlist-show .add-data-layerlist--container {-moz-animation: slide-from-left .4s; -webkit-animation: slide-from-left .4s; animation: slide-from-left .4s;}.jimu-rtl .add-data-layerlist--listitem .remove-button {float: left;}.jimu-rtl .add-data-widget-layers .back-button {float: left;}.jimu-rtl .add-data-widget-layers .back-button i {margin-left: 0; margin-right: 5px;}.jimu-rtl .add-data-widget-layers .back-button i.esri-icon-collapse:before {content: "\\e631";}.ar .esri-icon-question {-webkit-transform: rotateY(180deg); transform: rotateY(180deg); display: inline-block;}@-moz-keyframes updload-arrow-animation {0% {-moz-transform: translateY(0px);} 50% {-moz-transform: translateY(-10px);} 100% {-moz-transform: translateY(0px);}}@-webkit-keyframes updload-arrow-animation {0% {-webkit-transform: translateY(0px);} 50% {-webkit-transform: translateY(-10px);} 100% {-webkit-transform: translateY(0px);}}@keyframes updload-arrow-animation {0% {transform: translateY(0px);} 50% {transform: translateY(-10px);} 100% {transform: translateY(0px);}}@-moz-keyframes slide-from-right {0% {-moz-transform: translateX(50%); opacity: 0.5;} 100% {-moz-transform: translateX(0%); opacity: 1;}}@-webkit-keyframes slide-from-right {0% {-webkit-transform: translateX(50%); opacity: 0.5;} 100% {-webkit-transform: translateX(0%); opacity: 1;}}@keyframes slide-from-right {0% {transform: translateX(50%); opacity: 0.5;} 100% {transform: translateX(0%); opacity: 1;}}@-moz-keyframes slide-from-left {0% {-moz-transform: translateX(-50%); opacity: 0.5;} 100% {-moz-transform: translateX(0%); opacity: 1;}}@-webkit-keyframes slide-from-left {0% {-webkit-transform: translateX(-50%); opacity: 0.5;} 100% {-webkit-transform: translateX(0%); opacity: 1;}}@keyframes slide-from-left {0% {transform: translateX(-50%); opacity: 0.5;} 100% {transform: translateX(0%); opacity: 1;}}',
"*now":function(p){p(['dojo/i18n!*preload*widgets/AddData/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/on dojo/aspect dojo/Deferred dojo/dom-class jimu/portalUrlUtils jimu/portalUtils jimu/tokenUtils jimu/BaseWidget jimu/dijit/TabContainer3 dijit/_WidgetsInTemplateMixin ./search/SearchContext ./search/util ./search/SearchPane ./search/AddFromUrlPane ./search/AddFromFilePane ./search/LayerListPane dojo/_base/array".split(" "),function(p,h,q,l,e,w,b,r,t,x,E,z,H,y,F,C,G,A,c){return p([x,z],{name:"AddData",baseClass:"jimu-widget-add-data",batchGeocoderServers:null,
isPortal:!1,_isOpen:!1,_searchOnOpen:!1,tabContainer:null,searchPane:null,addFromUrlPane:null,addFromFilePane:null,postCreate:function(){this.inherited(arguments)},startup:function(){if(!this._started){var b=this,c=arguments;this._getUser().then(function(c){b._checkConfig();b._initTabs();return b._initContext(c)}).then(function(){b.inherited(c);b.tabContainer?b.tabContainer.startup():b.searchPane?b.searchPane.startup():b.addFromUrlPane?b.addFromUrlPane.startup():b.addFromFilePane&&b.addFromFilePane.startup();
b._initFooter(b.tabContainer,{searchWidget:b.searchPane,addFromUrlWidget:b.addFromUrlPane,addFromFileWidget:b.addFromFilePane});b._initListeners();b.resize()}).otherwise(function(e){console.warn("AddData.startup error:",e);b.inherited(c);b.resize()})}},_checkConfig:function(){this.config||(this.config={});var b=function(b,c){var e=b[c];e||(e=b[c]={allow:!0,label:null});"boolean"!==typeof e.allow&&(e.allow=!0);"Curated"!==c||"string"===typeof e.filter&&0!==h.trim(e.filter).length||(e.allow=!1)},c=
this.config;c.scopeOptions||(c.scopeOptions={});var e=c.scopeOptions;b(e,"MyContent");b(e,"MyOrganization");b(e,"Curated");b(e,"ArcGISOnline");b(c,"addFromUrl");b(c,"addFromFile")},getSharingUrl:function(){var c=r.getPortal(this.appConfig.portalUrl);return b.getSharingUrl(c.portalUrl)},_getUser:function(){var b=new e,c=this.appConfig.portalUrl;t.userHaveSignInPortal(c)?r.getPortal(c).getUser().then(function(c){b.resolve(c)}).otherwise(function(c){console.warn("AddData._getUser error:",c);b.resolve(null)}):
b.resolve(null);return b},_initBatchGeocoder:function(b,e){var h=!1,l=/(arcgis.com\/arcgis\/rest\/services\/world\/geocodeserver).*/ig,n=/(\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/ig,g=b&&b.helperServices&&b.helperServices.geocode||[],a,d,m=[];e&&e.privileges&&(h=-1<c.indexOf(e.privileges,"premium:user:geocode"));c.forEach(g,function(c){a=!!c.url.match(l);d=!!c.url.match(n);(a&&!b.isPortal&&h||d||c.batch)&&m.push({isWorldGeocodeServer:a||d,isWorldGeocodeServerProxy:d,label:c.name,
value:c.url,url:c.url,name:c.name})});this.batchGeocoderServers=m},_initContext:function(c){var h=new e,l=!0,n=y.checkMixedContent("http://www.arcgis.com"),p=this.config.scopeOptions,g=c&&"string"===typeof c.username&&0<c.username.length,a=new H,d=r.getPortal(this.appConfig.portalUrl);this.isPortal=d.isPortal;a.portal=d;d.isPortal&&(a.orgId=d.id);c&&"string"===typeof c.orgId&&0<c.orgId.length&&(a.orgId=c.orgId);g?a.username=c.username:p.MyContent.allow=!1;this.searchPane&&(this.searchPane.searchContext=
a,this.searchPane.portal=d);this._initBatchGeocoder(d,c);if(d.isPortal)try{var m=b.getSharingUrl(d.portalUrl)+"/kml",m=m.replace("/sharing/rest/kml","/sharing/kml");window.esri.config.defaults.kmlService=m;window.esri.config.defaults.geoRSSService=m.replace("/kml","/rss")}catch(K){console.error(K)}var f=this.nls.search.loadError+n,k=p.ArcGISOnline;a.allowArcGISOnline=k.allow;if(d.isPortal&&a.allowArcGISOnline){var q=r.getPortal(n);q?q.helperServices||(l=!1,q.loadSelfInfo().then(function(){q.helperServices?
a.arcgisOnlinePortal=q:(console.warn(f),a.allowArcGISOnline=!1,k.allow=!1);h.resolve()}).otherwise(function(b){a.allowArcGISOnline=!1;k.allow=!1;console.warn(f);console.warn(b);h.resolve()})):(console.warn(f),a.allowArcGISOnline=!1,k.allow=!1)}else!g&&!d.isPortal&&p.MyOrganization.allow&&p.ArcGISOnline.allow&&(p.MyOrganization.allow=!1);l&&h.resolve();return h},_initFooter:function(b,c){if(b){var e=c.searchWidget,l=!1;e&&e.footerNode&&e.footerNode.nodeName&&(l=!0);c=this.footerContainer=document.createElement("DIV");
c.className=this.baseClass+"-footer";l&&c.appendChild(e.footerNode);var n=document.createElement("A");n.className="layerlist-button jimu-float-trailing";n.href="#";n.innerHTML="\x3cspan class\x3d'esri-icon-layers'\x3e\x3c/span\x3e"+this.nls.layerList.caption;this.own(q(n,"click",h.hitch(this,function(a){a.preventDefault();this.showLayers()})));c.appendChild(n);var g=this.messageNode=document.createElement("SPAN");g.className="message";c.appendChild(g);b=b.containerNode||b.domNode||b;b.nodeName&&b.appendChild(c);
this.own(q(this.tabContainer,"tabChanged",h.hitch(this,function(a){this._setStatus("");l&&(e.footerNode.style.display=a===this.nls.tabs.search?"":"none");this.nls.tabs.search===a?(l&&(e.footerNode.style.display=""),g.style.display="none"):(l&&(e.footerNode.style.display="none"),g.style.display="")})))}},_initListeners:function(){var b=this;this.map&&this.own(this.map.on("extent-change",function(){try{b.searchPane&&b.searchPane.bboxOption.bboxToggle.get("checked")&&(b._isOpen?b.searchPane.search():
b._searchOnOpen=!0)}catch(D){console.warn(D)}}))},_initTabs:function(){var b=this.config,c=[],e=!!(window.File&&window.FileReader&&window.FormData),h=!1,p=b.scopeOptions,g=function(a){h||p&&p[a]&&p[a].allow&&(h=!0)};g("MyContent");g("MyOrganization");g("Curated");g("ArcGISOnline");h&&(this.searchPane=new F({wabWidget:this},this.searchNode),c.push({title:this.nls.tabs.search,content:this.searchPane.domNode}));b.addFromUrl&&b.addFromUrl.allow&&(this.addFromUrlPane=new C({wabWidget:this},this.urlNode),
c.push({title:this.nls.tabs.url,content:this.addFromUrlPane.domNode}));e&&b.addFromFile&&b.addFromFile.allow&&(this.addFromFilePane=new G({wabWidget:this},this.fileNode),c.push({title:this.nls.tabs.file,content:this.addFromFilePane.domNode}));var a=this;if(0<c.length){this.tabContainer=new E({average:!0,tabs:c},this.tabsNode);try{1===c.length&&this.tabContainer.controlNode&&this.tabContainer.containerNode&&(this.tabContainer.controlNode.style.display="none",this.tabContainer.containerNode.style.top=
"0px")}catch(d){}this.own(l.after(this.tabContainer,"selectTab",function(b){a.searchPane&&b===a.nls.tabs.search&&a.searchPane.resize()},!0))}else 0===c.length&&this.tabsNode.appendChild(document.createTextNode(this.nls.noOptionsConfigured))},_setStatus:function(b){this.messageNode&&(y.setNodeText(this.messageNode,b),this.messageNode.title=b)},onClose:function(){this._isOpen=!1},onOpen:function(){var b=this.searchPane&&this._searchOnOpen;this._isOpen=!0;this._searchOnOpen=!1;this.resize();b&&this.searchPane.search()},
resize:function(){var b=this.domNode.clientWidth,c=this.domNode.clientHeight;1E3<b?(w.remove(this.domNode,"width-768"),w.add(this.domNode,"width-1200")):768<b?(w.remove(this.domNode,"width-1200"),w.add(this.domNode,"width-768")):w.remove(this.domNode,["width-768","width-1200"]);420>b?(w.remove(this.domNode,"width-medium"),w.add(this.domNode,"width-small")):750>b?(w.remove(this.domNode,"width-small"),w.add(this.domNode,"width-medium")):w.remove(this.domNode,["width-small","width-medium"]);340>b?w.add(this.domNode,
"filter-placeholder-on"):w.remove(this.domNode,"filter-placeholder-on");400>c?w.add(this.domNode,"height-small"):w.remove(this.domNode,"height-small");this.searchPane&&this.searchPane.resize()},showLayers:function(){this.layerListPane||(this.layerListPane=new A({wabWidget:this}),this.layerListPane.placeAt(this.domNode));this.layerListPane.show()}})});