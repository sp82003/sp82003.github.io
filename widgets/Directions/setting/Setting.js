// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Directions/setting/PresetDestinations":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/_base/html dojo/query esri/lang dojo/Deferred esri/tasks/locator jimu/utils ../searchUtil jimu/LayerInfos/LayerInfos dojo/when dojo/promise/all dojo/_base/array esri/layers/FeatureLayer dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./PresetDestinations.html esri/dijit/Search jimu/dijit/RadioBtn".split(" "),function(m,k,l,t,u,f,e,c,n,r,
v,a,y,w,x,h,d,g,z,p){return m([h,d,g],{templateString:z,_defaultLocations:null,_startSearchResults:null,_endSearchResults:null,_isSearchResultsShown:!1,_ERROR_CLASS:"have-error",constructor:function(b){b&&(this._defaultLocations=[],this._defaultLocations=this._parseDefaultLocations(b.defaultLocations),this.nls=b.nls)},postCreate:function(){this.inherited(arguments)},startup:function(){this._getLayerInfos().then(k.hitch(this,function(){this.startSearch=new p({enableSuggestions:!1,enableButtonMode:!1,
theme:"arcgisSearch"});this.startSearch.placeAt(this.startSearchDom);this.own(l(this.startSearch,"search-results",k.hitch(this,"_onStartSearchResults")));this.own(l(this.startSearchResultsNode,"li:click",k.hitch(this,"_onSelectStartSearchResult")));this.own(l(this.startSearch.inputNode,"focus",k.hitch(this,"_onCleanStartError")));this.own(l(this.startSearch.inputNode,"blur",k.hitch(this,function(){!1===this._isSearchResultsShown&&this.startSearch&&this.startSearch.search&&this.startSearch.search()})));
this.endSearch=new p({enableSuggestions:!1,enableButtonMode:!1,theme:"arcgisSearch"});this.endSearch.placeAt(this.endSearchDom);this.own(l(this.endSearch,"search-results",k.hitch(this,"_onEndSearchResults")));this.own(l(this.endSearchResultsNode,"li:click",k.hitch(this,"_onSelectEndSearchResult")));this.own(l(this.endSearch.inputNode,"focus",k.hitch(this,"_onCleanEndError")));this.own(l(this.endSearch.inputNode,"blur",k.hitch(this,function(){!1===this._isSearchResultsShown&&this.endSearch&&this.endSearch.search&&
this.endSearch.search()})));this.own(l(window.document,"click",k.hitch(this,function(b){t.isDescendant(b.target,this.searchResultsNode)||this._hideResultMenu()})));if(this._defaultLocations&&this._defaultLocations.length&&0<this._defaultLocations.length)for(var b=0,a=this._defaultLocations.length;b<a;b++)0===b?this._setSearchValue(this.startSearch,this._defaultLocations[b]):1===b&&this._setSearchValue(this.endSearch,this._defaultLocations[b])}));this.inherited(arguments)},_setSearchValue:function(b,
a){"string"===typeof a?b.set("value",a):a.name&&(b.set("selectedResult",a),b.set("value",a.name))},getValue:function(){var b=[],a=this._getSearchRest(this.startSearch,this._defaultLocations[0]);b.push(a);a=this._getSearchRest(this.endSearch,this._defaultLocations[1]);b.push(a);return b},_getSearchRest:function(b,a){var d=b.selectedResult;if(d)d.feature&&(d.feature._layer&&(d.feature._layer=""),d.feature._sourceLayer&&(d.feature._sourceLayer=""));else if(b.value)d=!1,"string"===typeof a?d=a!==b.value:
a.name&&(d=a.name!==b.value),d=d?b.value:a;else return"";return d},_parseDefaultLocations:function(b){for(var a=[],d=0,h=b.length;d<h;d++)a.push(b[d]);return a},setValue:function(b){b&&0<b.length&&(this._defaultLocations=[],this._defaultLocations=this._parseDefaultLocations(b))},validate:function(){var b=!1;u(".searchLoading",this.domNode).forEach(k.hitch(this,function(){b=!0}));return!1!==b||t.hasClass(this.startSearch,this._ERROR_CLASS)||t.hasClass(this.endSearch,this._ERROR_CLASS)?!1:!0},setSources:function(b){if(b&&
b.sources&&b.sources.length)this.shelter.show(),a(r.getConfigInfo(b)).then(k.hitch(this,function(b){return y(this._convertConfig(b)).then(function(b){return w.filter(b,function(b){return b})})})).then(k.hitch(this,function(b){this.startSearch.set("sources",b);this.endSearch.set("sources",b);this.shelter.hide()}));else if(d&&d.url&&d.singleLineFieldName){var d={locator:new c(d.url||""),outFields:["*"],singleLineFieldName:d.singleLineFieldName};this.startSearch.set("sources",[d]);this.endSearch.set("sources",
[d])}else this.startSearch.set("sources",[]),this.endSearch.set("sources",[])},_onCleanError:function(b){t.removeClass(b,this._ERROR_CLASS)},_onCleanStartError:function(){this._onCleanError(this.startSearch)},_onCleanEndError:function(){this._onCleanError(this.endSearch)},_onStartSearchResults:function(b){this._onSearchResults(b,{searchDijit:this.startSearch,searchResultsNode:this.startSearchResultsNode,searchError:this.startSearchError,results:"start"})},_onEndSearchResults:function(b){this._onSearchResults(b,
{searchDijit:this.endSearch,searchResultsNode:this.endSearchResultsNode,searchError:this.endSearchError,results:"end"})},_onSearchResults:function(b,d){var a=d.searchDijit.get("sources"),h=d.searchDijit.get("activeSourceIndex"),g=d.searchDijit.get("value"),p="",c=b.results;if(""!==g)if(c&&0<b.numResults){"start"===d.results?this._startSearchResults=c:"end"===d.results&&(this._endSearchResults=c);var p=p+'\x3cdiv class\x3d"searchMenu searchResultsMenu" role\x3d"menu"\x3e',B;for(B in c)if(c[B]&&c[B].length){b=
a[parseInt(B,10)].name;1<a.length&&"all"===h&&(p+='\x3cdiv title\x3d"'+b+'" class\x3d"menuHeader"\x3e'+b+"\x3c/div\x3e");p+="\x3cul\x3e";b=a[B].maxResults||5;for(var g=0,e=c[B].length;g<e&&g<b;g++){var x;f.isDefined(c[B][g].name)?(x=c[B][g].name,x=n.sanitizeHTML(x)):x=this.nls.untitled;p+='\x3cli title\x3d"'+x+'" data-index\x3d"'+g+'" data-source-index\x3d"'+B+'" role\x3d"menuitem" tabindex\x3d"0"\x3e'+x.toString()+"\x3c/li\x3e"}p+="\x3c/url\x3e"}d.searchResultsNode.innerHTML=p+"\x3c/div\x3e";this._showResultMenu(d.searchDijit,
d.searchResultsNode);this._resetSelectorPosition(d.searchDijit,".searchResultsMenu")}else t.addClass(d.searchDijit,this._ERROR_CLASS),this._resetSelectorPosition(d.searchDijit,".noResultsMenu")},_onSelectStartSearchResult:function(b){this._onSelectSearchResult(b,this.startSearch,this._startSearchResults)},_onSelectEndSearchResult:function(b){this._onSelectSearchResult(b,this.endSearch,this._endSearchResults)},_onSelectSearchResult:function(b,d,a){for(b=b.target;!t.hasAttr(b,"data-source-index")||
!t.getAttr(b,"data-index");)b=b.parentNode;var g=null,g=t.getAttr(b,"data-source-index");b=parseInt(t.getAttr(b,"data-index"),10);"all"!==g&&(g=parseInt(g,10));a&&a[g]&&a[g][b]&&(g=a[g][b],d.select(g),g.name&&d.set("value",g.name))},_showResultMenu:function(b,d){t.setStyle(d,"display","block");u(".searchMenu",d).style("display","block");this._isSearchResultsShown=!0;if(b=u(".searchInputGroup",b.domNode)[0])b={width:t.getMarginBox(b).w+"px"},u(".searchMenu",d).style(b)},_resetSelectorPosition:function(b,
d){var a=t.getMarginBox(this.domNode.offsetParent);u(d,this.domNode).forEach(k.hitch(this,function(g){var h=t.position(g),p=t.position(b.domNode),p=".noResultsMenu"===d?0:p.h;h.y+h.h>a.h&&t.setStyle(g,"top",-(h.h+p)-4+"px")}))},_hideResultMenu:function(){u(".searchMenu",this.domNode).style("display","none");this._isSearchResultsShown=!1},_getLayerInfos:function(){var b=new e;v.getInstance(this.map,this.map.itemInfo).then(k.hitch(this,function(d){this.layerInfosObj=d;this.own(this.layerInfosObj.on("layerInfosFilterChanged",
k.hitch(this,function(b){r.config.onLayerInfosFilterChanged(b,this.config)})));b.resolve()}));return b},_convertConfig:function(b){return w.map(b.sources,k.hitch(this,function(b){var d=new e;if(b&&b.url&&"locator"===b.type){var a={locator:new c(b.url||""),outFields:["*"],singleLineFieldName:b.singleLineFieldName||"",name:n.stripHTML(b.name||""),placeholder:n.stripHTML(b.placeholder||""),countryCode:b.countryCode||"",maxSuggestions:b.maxSuggestions,useMapExtent:!!b.searchInCurrentMapExtent};b.enableLocalSearch&&
(a.localSearchOptions={minScale:b.localSearchMinScale,distance:b.localSearchDistance});b.zoomScale&&(a.autoNavigate=!1);d.resolve(a)}else b&&b.url&&"query"===b.type?(a=new x(b.url||null,{outFields:["*"]}),this.own(l(a,"load",k.hitch(this,function(a){var g=a.layer;a=this.map.getLayer(b.layerId);var h=this.layerInfosObj.getLayerInfoById(b.layerId);a?h=a=!1:h?h=a=!1:(a=!1,h=!0);var p=null;b.searchFields&&0<b.searchFields.length?p=b.searchFields:(p=[],w.forEach(g.fields,function(b){"esriFieldTypeOID"!==
b.type&&b.name!==g.objectIdField&&"esriFieldTypeGeometry"!==b.type&&p.push(b.name)}));var c={featureLayer:g,outFields:["*"],searchFields:p,autoNavigate:!1,displayField:b.displayField||"",exactMatch:!!b.exactMatch,name:n.stripHTML(b.name||""),placeholder:n.stripHTML(b.placeholder||""),maxSuggestions:b.maxSuggestions||6,useMapExtent:!!b.searchInCurrentMapExtent,showInfoWindowOnSelect:a,enableInfoWindow:h,_featureLayerId:b.layerId};c._featureLayerId&&(a=this.layerInfosObj.getLayerInfoById(c._featureLayerId))&&
g.setDefinitionExpression(a.getFilter());r.config.getInfoTemplate(g,b,this.layerInfosObj).then(k.hitch(this,function(b){c.infoTemplate=k.clone(b);d.resolve(c)}),k.hitch(this,function(){d.resolve(c)}))}))),this.own(l(a,"error",function(){d.resolve(null)}))):d.resolve(null);return d}))}})})},"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),
function(m,k,l,t,u,f,e,c,n,r,v){m=m(r,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],"suggest-locations-complete":["suggestions"]},constructor:function(a){this._geocodeHandler=k.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=k.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=k.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},
outSpatialReference:null,setOutSpatialReference:function(a){this.outSpatialReference=a},_geocodeHandler:function(a,c,e,f,h){try{var d=a.candidates,g;c=[];var x,p=d.length,b=a.spatialReference,n;for(x=0;x<p;x++){g=d[x];if(n=g.location)n.spatialReference=b;c[x]=new v(g)}this._successHandler([c],"onAddressToLocationsComplete",e,h)}catch(E){this._errorHandler(E,f,h)}},_geocodeAddressesHandler:function(a,c,e,f,h){try{var d=a.locations;c=[];var g,x=d.length,p=a.spatialReference,b;for(g=0;g<x;g++){if(b=
d[g].location)b.spatialReference=p;c[g]=new v(d[g])}this._successHandler([c],"onAddressesToLocationsComplete",e,h)}catch(B){this._errorHandler(B,f,h)}},addressToLocations:function(a,e,f,x,h){var d,g,v,p,b,B,r,y;a.address&&(x=f,f=e,e=a.outFields,h=a.searchExtent,y=a.countryCode,d=a.magicKey,g=a.distance,r=a.categories,a.location&&this.normalization&&(v=a.location.normalize()),p=a.locationType,b=a.maxLocations,B=a.forStorage,a=a.address);h&&(h=h.shiftCentralMeridian());var w=this.outSpatialReference;
a=this._encode(k.mixin({},this._url.query,a,{f:"json",outSR:w&&u.toJson(w.toJson()),outFields:e&&e.join(",")||null,searchExtent:h&&u.toJson(h.toJson()),category:r&&r.join(",")||null,countryCode:y||null,magicKey:d||null,distance:g||null,location:v||null,locationType:p||null,maxLocations:b||null,forStorage:B||null}));var l=this._geocodeHandler,m=this._errorHandler,I=new t(n._dfdCanceller);I._pendingDfd=c({url:this._url.path+"/findAddressCandidates",content:a,callbackParamName:"callback",load:function(b,
d){l(b,d,f,x,I)},error:function(b){m(b,x,I)}});return I},suggestLocations:function(a){var e;e=new t(n._dfdCanceller);a.hasOwnProperty("location")&&this.normalization&&(a.location=a.location.normalize());a.searchExtent&&(a.searchExtent=a.searchExtent.shiftCentralMeridian());a=this._encode(k.mixin({},this._url.query,{f:"json",text:a.text,maxSuggestions:a.maxSuggestions,searchExtent:a.searchExtent&&u.toJson(a.searchExtent.toJson()),category:a.categories&&a.categories.join(",")||null,countryCode:a.countryCode||
null,location:a.location||null,distance:a.distance||null},{f:"json"}));a=c({url:this._url.path+"/suggest",content:a,callbackParamName:"callback"});e._pendingDfd=a;a.then(k.hitch(this,function(a){a=a.suggestions||[];this.onSuggestLocationsComplete(a);e.resolve(a)}),k.hitch(this,function(a){this._errorHandler(a);e.reject(a)}));return e},addressesToLocations:function(a,e,f){var x=this.outSpatialReference,h=[],d=a.categories,g=a.locationType,v=a.countryCode;l.forEach(a.addresses,function(b,a){h.push({attributes:b})});
a=this._encode(k.mixin({},this._url.query,{category:d&&d.join(",")||null,locationType:g||null,sourceCountry:v||null},{addresses:u.toJson({records:h})},{f:"json",outSR:x&&u.toJson(x.toJson())}));var p=this._geocodeAddressesHandler,b=this._errorHandler,B=new t(n._dfdCanceller);B._pendingDfd=c({url:this._url.path+"/geocodeAddresses",content:a,callbackParamName:"callback",load:function(b,a){p(b,a,e,f,B)},error:function(a){b(a,f,B)}});return B},_reverseGeocodeHandler:function(a,c,e,f,h){try{var d=new v({address:a.address,
location:a.location,score:100});this._successHandler([d],"onLocationToAddressComplete",e,h)}catch(g){this._errorHandler(g,f,h)}},locationToAddress:function(a,e,f,x){a&&this.normalization&&(a=a.normalize());var h=this.outSpatialReference;a=this._encode(k.mixin({},this._url.query,{outSR:h&&u.toJson(h.toJson()),location:a&&u.toJson(a.toJson()),distance:e,f:"json"}));var d=this._reverseGeocodeHandler,g=this._errorHandler,v=new t(n._dfdCanceller);v._pendingDfd=c({url:this._url.path+"/reverseGeocode",content:a,
callbackParamName:"callback",load:function(a,b){d(a,b,f,x,v)},error:function(a){g(a,x,v)}});return v},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}});f("extend-esri")&&k.setObject("tasks.Locator",m,e);return m})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(m,k,l,t,u){m=m(null,{declaredClass:"esri.tasks.AddressCandidate",
constructor:function(f){k.mixin(this,f);this.location=new u(this.location)}});l("extend-esri")&&k.setObject("tasks.AddressCandidate",m,t);return m})},"widgets/Directions/searchUtil":function(){define("dojo/_base/lang dojo/_base/array dojo/Deferred dojo/when dojo/promise/all jimu/portalUtils esri/lang esri/request jimu/utils esri/dijit/PopupTemplate esri/graphic esri/geometry/webMercatorUtils esri/tasks/ProjectParameters".split(" "),function(m,k,l,t,u,f,e,c,n,r,v,a,y){var w={map:null,layerInfosObj:null,
appConfig:null,_esriLocatorRegExp:/geocode(.){0,3}\.arcgis.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,setMap:function(a){this.map=a},setLayerInfosObj:function(a){this.layerInfosObj=a},setAppConfig:function(a){this.appConfig=a},getConfigInfo:function(a){if(a&&a.sources&&0<a.sources.length){var h=null;return this.searchLayer(this.map)&&a.upgradeFromGeocoder?(h=this.map.itemInfo.itemData.applicationProperties.viewing.search,h=k.map(h.layers,m.hitch(this,function(a,g){g.hintText=a;return this._getQueryTypeGeocoder(g)},
h.hintText)),u(h).then(m.hitch(this,function(d){a.sources=[].concat(d).concat(a.sources);return a}))):a}return t(this._getSoucesFromPortalAndWebmap()).then(m.hitch(this,function(a){return{allPlaceholder:"",showInfoWindowOnSelect:!0,sources:a}}))},_getSoucesFromPortalAndWebmap:function(){var a=[],h=null;this.searchLayer(this.map)&&(h=this.map.itemInfo.itemData.applicationProperties.viewing.search,k.forEach(h.layers,m.hitch(this,function(d,g){g.hintText=d;a.push(this._getQueryTypeGeocoder(g))},h.hintText)));
return f.getPortalSelfInfo(this.appConfig.portalUrl).then(m.hitch(this,function(d){if((d=d.helperServices&&d.helperServices.geocode)&&0<d.length)for(var g=0,h=d.length;g<h;g++){var c=d[g];c&&a.push(this._processSingleLine(c))}return u(a).then(m.hitch(this,function(b){for(var a=[],d=0;d<b.length;d++){var g=b[d];g&&(g&&"query"===g.type||(g={name:g.name||this._getGeocodeName(g.url),url:g.url,singleLineFieldName:g.singleLineFieldName,placeholder:"Find address or place",maxResults:6,searchInCurrentMapExtent:!1,
type:"locator"},g.enableLocalSearch=this._isEsriLocator(g.url),g.localSearchMinScale=3E5,g.localSearchDistance=5E4),a.push(g))}return a}))}))},_getQueryTypeGeocoder:function(a){var h=this.map.getLayer(a.id),d=null,g=null,c=null,c=e.isDefined(a.subLayer)?a.id+"_"+a.subLayer:a.id,d=this.layerInfosObj.traversal(function(a){return a.id===c?(g=a,!0):!1});return h&&d&&g?(d=e.isDefined(a.subLayer)?g.url||h.url+"/"+a.subLayer:g.url||h.url,{name:g.title,layerId:c,url:d,placeholder:a.hintText,searchFields:[a.field.name],
displayField:a.field.name,exactMatch:a.field.exactMatch||!1,maxResults:6,searchInCurrentMapExtent:!1,type:"query"}):null},_isEsriLocator:function(a){this._esriLocatorRegExp.lastIndex=0;return this._esriLocatorRegExp.test(a)},_processSingleLine:function(a){if(a.singleLineFieldName)return a;if(this._isEsriLocator(a.url))return a.singleLineFieldName="SingleLine",a;var h=new l;c({url:a.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(m.hitch(this,function(d){d.singleLineAddressField&&
d.singleLineAddressField.name?(a.singleLineFieldName=d.singleLineAddressField.name,h.resolve(a)):(console.warn(a.url+"has no singleLineFieldName"),h.resolve(null))}),m.hitch(this,function(a){console.error(a);h.resolve(null)}));return h.promise},_getGeocodeName:function(a){if("string"!==typeof a)return"geocoder";a=a.split("/");return a[a.length-2]||"geocoder"},getGeocoderName:function(a){return this._getGeocodeName(a)},hasAppSearchInfo:function(a){return a.itemInfo&&a.itemInfo.itemData&&a.itemInfo.itemData.applicationProperties&&
a.itemInfo.itemData.applicationProperties.viewing&&a.itemInfo.itemData.applicationProperties.viewing.search},searchLayer:function(a){if(!this.hasAppSearchInfo(a))return!1;a=a.itemInfo.itemData.applicationProperties.viewing.search;return a.enabled&&0!==a.layers.length?!0:!1},getSingleLineAddressName:function(a){var h=new l;c({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(m.hitch(this,function(a){a&&a.singleLineAddressField&&a.singleLineAddressField.name?h.resolve(a.singleLineAddressField.name):
h.resolve(null)}),m.hitch(this,function(a){console.error(a);h.reject()}));return h},version:{isConfigBefore63:function(a){var h=!1;a&&a.geocoderOptions&&(h=!0);return h},upgradeConfig:function(a){a.geocoderOptions&&delete a.geocoderOptions},getVersionState:function(){}},config:{onLayerInfosFilterChanged:function(a,h){k.some(a,m.hitch(this,function(a){h.searchOptions&&h.searchOptions.sources&&0<h.searchOptions.sources.length&&k.forEach(h.searchOptions.sources,function(d){d._featureLayerId===a.id&&
d.featureLayer.setDefinitionExpression(a.getFilter())})}))},getInfoTemplate:function(a,h,d){var g=new l;d=d.getLayerInfoById(h.layerId);var c;if(d)g=d.loadInfoTemplate();else{var p=[];k.filter(a.fields,function(b){"shape"!==b.name.toLowerCase()&&p.push(b.name)});(a=n.getDefaultPopupInfo(a,h.name+": {"+h.displayField+"}",p))&&(c=new r(a));g.resolve(c)}return g},getWayPoints:function(a,h,d){var g=new l;h&&g.resolve(a.defaultLocations);h=[];for(var c=0,p=a.defaultLocations.length;c<p;c++){var b;b=a.defaultLocations[c];
if("object"===typeof b&&b.feature&&b.name){var e={},e=b.feature.attributes;b.name&&(e.Name=b.name);b=new v(b.feature,null,e);h.push(b)}else"string"===typeof b?h.push(b):h.push("")}w.config.projectGeometriesToMapCoords(h,d).then(m.hitch(this,function(b){g.resolve(b)}),m.hitch(this,function(b){g.reject(b)}));return g},projectGeometriesToMapCoords:function(c,h){var d=new l,g=[],e=[];if(4326===parseInt(h.spatialReference.wkid,10))g.push((new l).resolve(c));else if(h.spatialReference.isWebMercator()){for(var p=
0,b=c.length;p<b;p++){var f=c[p];if(h=f.geometry)if(h=a.geographicToWebMercator(h))f.geometry=h;e.push(f)}g.push((new l).resolve(e))}else for(e=esriConfig&&esriConfig.defaults&&esriConfig.defaults.geometryService,e&&"esri.tasks.GeometryService"===e.declaredClass||(geoServiceUrl&&"string"===typeof geoServiceUrl&&m.trim(geoServiceUrl)?(geoServiceUrl=m.trim(geoServiceUrl),e=new GeometryService(geoServiceUrl)):e=n.getArcGISDefaultGeometryService()),p=0,b=c.length;p<b;p++)(f=c[p])?g.push(w.config.projectedToOthersCoords(f,
e,h)):g.push((new l).resolve(""));u(g).then(m.hitch(this,function(b){var a=[];if(1<b.length){for(var g=0,c=b.length;g<c;g++)a.push(b[g]);return d.resolve(a)}return d.resolve(b[0])}),m.hitch(this,function(b){return d.reject(b)}));return d},projectedToOthersCoords:function(a,c,d){var g=new l,h=new y;h.geometries=[a.geometry];h.outSR=d.spatialReference;c.project(h).then(function(d){return(d=d&&d[0])?(a.geometry=d,g.resolve(a)):g.reject("")},function(a){console.error(a);return g.reject("")});return g},
_toPointGeometry:function(a){var c=a.feature.geometry;c&&(c.getCentroid?a.feature.geometry=c.getCentroid():c.getExtent&&(c=c.getExtent())&&(a.feature.geometry=c.getCenter()));return a},_getLocationObject:function(a){return{name:a.name,extent:a.extent,feature:{geometry:a.feature.geometry,attributes:{Score:100,Addr_Type:"PointAddress"}}}}}};return w})},"esri/dijit/Search":function(){define("require dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Evented dojo/Deferred dojo/keys dojo/on dojo/query dojo/uacss dojo/regexp dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-style dojo/dom-construct dojo/date/locale dojo/i18n!../nls/jsapi dojo/text!./Search/templates/Search.html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_FocusMixin dijit/a11yclick dijit/focus ../lang ../InfoTemplate ../kernel ../SpatialReference ../graphic ../promiseList ../symbols/PictureMarkerSymbol ../symbols/SimpleMarkerSymbol ../symbols/SimpleLineSymbol ../symbols/SimpleFillSymbol ../symbols/TextSymbol ../symbols/Font ../geometry/Point ../geometry/Extent ../geometry/normalizeUtils ../geometry/scaleUtils ../tasks/locator ../tasks/query ../Color ../styles/basic".split(" "),
function(m,k,l,t,u,f,e,c,n,r,v,a,y,w,x,h,d,g,z,p,b,B,E,C,F,M,N,I,G,L,Q,R,O,S,T,D,J,H,A,K,V,U,W,X){function P(b,a){b&&a&&(b._layer=a,b._sourceLayer=a)}k=k([p,b,B,u],{declaredClass:"esri.dijit.Search",templateString:z,reHostedFS:/https?:\/\/services.*\.arcgis\.com/i,constructor:function(b,a){this.css={searchGroup:"searchGroup",searchInput:"searchInput",searchInputGroup:"searchInputGroup",searchBtn:"searchBtn",searchSubmit:"searchSubmit",searchIcon:"searchIcon esri-icon-search",searchButtonText:"searchButtonText",
searchToggle:"searchToggle",searchToggleIcon:"searchIcon esri-icon-down-arrow",searchMenu:"searchMenu",searchMenuHeader:"menuHeader",searchClear:"searchClear",searchClearIcon:"searchIcon esri-icon-close searchClose",searchSpinner:"searchIcon esri-icon-loading-indicator searchSpinner",searchSourceName:"sourceName",suggestionsMenu:"suggestionsMenu",sourcesMenu:"sourcesMenu",activeSource:"active",hasValue:"hasValue",hasButtonMode:"hasButtonMode",hasMultipleSources:"hasMultipleSources",showSuggestions:"showSuggestions",
showSources:"showSources",showNoResults:"showNoResults",searchLoading:"searchLoading",latLonHeader:"searchLatLongHeader",searchMoreResults:"moreResults",searchMoreResultsList:"resultsList",searchMoreResultsHeader:"moreHeader",searchMoreResultsItem:"moreItem",searchMoreResultsListHeader:"popupHeader",searchShowMoreResults:"showMoreResults",searchNoResultsMenu:"noResultsMenu",searchNoResultsBody:"noResultsBody",searchNoResultsHeader:"noResultsHeader",searchNoValueIcon:"noValueIcon esri-icon-notice-triangle",
searchNoValueText:"noValueText",searchNoResultsText:"noResultsText",searchExpandContainer:"searchExpandContainer",searchAnimateContainer:"searchAnimate",searchExpanded:"searchExpanded",searchCollapsed:"searchCollapsed",searchClearFloat:"searchClearFloat"};this._allIndex="all";this._objectIdIdentifier="_objectId";this._deferreds=[];this._sourceNames=[];this.defaultSource={locator:new V("//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer"),singleLineFieldName:"SingleLine",outFields:["Addr_type",
"Match_addr","StAddr","City"],name:g.widgets.Search.main.esriLocatorName,localSearchOptions:{minScale:3E5,distance:5E4},placeholder:g.widgets.Search.main.placeholder,highlightSymbol:(new Q(m.toUrl("./Search/images/search-pointer.png"),36,36)).setOffset(9,18)};this.options={map:null,theme:"arcgisSearch",visible:!0,value:"",allPlaceholder:"",sources:[this.defaultSource],activeSourceIndex:0,suggestionDelay:150,enableSourcesMenu:!0,enableSuggestionsMenu:!0,enableInfoWindow:!0,showInfoWindowOnSelect:!0,
enableSuggestions:!0,enableButtonMode:!1,autoNavigate:!0,autoSelect:!0,addLayersFromMap:!1,zoomScale:1E3,graphicsLayer:null,enableHighlight:!0,highlightGraphic:null,enableLabel:!1,labelSymbol:(new T).setColor(new W([181,56,46,.9])).setFont(new D("14px",D.STYLE_NORMAL,D.VARIANT_NORMAL,D.WEIGHT_BOLD,"Arial")),labelGraphic:null,infoTemplate:new M(g.widgets.Search.main.searchResult,'\x3cdiv class\x3d"${searchTheme}"\x3e\x3cdiv id\x3d"${searchMoreResultsId}" class\x3d"${searchMoreResults}"\x3e\x3cdiv class\x3d"${searchMoreResultsItem}"\x3e${searchResult}\x3c/div\x3e\x3cdiv\x3e${searchMoreResultsHtml}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e'),
searchResults:null,suggestResults:null,selectedResult:null,magicKey:null,selectedFeatureId:null,expanded:!1,maxLength:128,maxResults:6,maxSuggestions:6,locationToAddressDistance:1500,minCharacters:1,enableSearchingAll:!0};b=l.mixin({},this.options,b);this.set(b);this._updateActiveSource();this._i18n=g;this._defaultSR=new I(4326);this.domNode=a},startup:function(){this.inherited(arguments);this.sources||(this.sources=[]);this._mapLoaded().then(l.hitch(this,this._init))},postCreate:function(){var b=
this;this.inherited(arguments);this._moreResultsId=this.id+"_more_results";this.own(c(this.submitNode,E,l.hitch(this,this._searchButton)));this.own(c(this.sourcesBtnNode,E,l.hitch(this,this._toggleSourcesMenu)));this.own(c(this.inputNode,E,l.hitch(this,this._inputClick)));this.own(c(this.clearNode,E,l.hitch(this,this._clearButton)));this.own(c(this.formNode,"submit",l.hitch(this,function(b){b.preventDefault();this._cancelSuggest();this.search()})));this.own(c(this.inputNode,"keyup",l.hitch(this,function(b){this._inputKey(b)})));
this.own(c(this.sourcesBtnNode,"keyup",l.hitch(this,function(b){this._sourceBtnKey(b)})));this.own(c(this.suggestionsNode,"li:click, li:keyup",function(a){b._suggestionsEvent(a,this)}));this.own(c(this.sourcesNode,"li:click, li:keyup",function(a){b._sourcesEvent(a,this)}));this.own(c(this.inputNode,"input, paste",l.hitch(this,function(){this._suggestDelay()})));this.map&&this.map.infoWindow&&this.map.infoWindow.domNode&&this.enableInfoWindow&&(this.own(c(this.map.infoWindow.domNode,"#"+this._moreResultsId+
"_show:click",l.hitch(this,function(b){this._showMoreResultsClick(b)}))),this.own(c(this.map.infoWindow.domNode,"#"+this._moreResultsId+"_list li a:click",l.hitch(this,function(b){this._moreResultsClick(b)}))),this.own(c(this.map.infoWindow.domNode,"#"+this._moreResultsId+" [data-switch-coordinates]:click",l.hitch(this,function(b){this._switchCoordinatesClick(b)}))));this.value&&this._checkStatus();this._hideMenus();this._updateVisible();this._insertSources(this.sources);this._setPlaceholder(this.activeSourceIndex);
this._updateButtonMode(this.enableButtonMode);this.toggle(this.expanded)},destroy:function(){this.clear();h.empty(this.domNode);this.inherited(arguments)},clear:function(){this.clearGraphics();y.get(this.inputNode,"value")&&y.set(this.inputNode,"value","");this._changeAttrValue("value","");this.set("searchResults",null);this.set("suggestResults",null);this.set("selectedResult",null);this.set("magicKey",null);this.set("selectedFeatureId",null);w.remove(this.containerNode,this.css.hasValue);y.set(this.clearNode,
"title","");this._hideMenus();this._closePopup();this._hideLoading();this.emit("clear-search")},show:function(){x.set(this.domNode,"display","block")},hide:function(){x.set(this.domNode,"display","none")},expand:function(){this.enableButtonMode&&(w.add(this.containerNode,this.css.searchExpanded),w.remove(this.containerNode,this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!0))},collapse:function(){this.enableButtonMode&&(w.remove(this.containerNode,this.css.searchExpanded),w.add(this.containerNode,
this.css.searchCollapsed),this._hideMenus(),this.set("expanded",!1))},toggle:function(b){this.enableButtonMode&&("undefined"===typeof b&&(b=!this.expanded),b?this.expand():this.collapse())},search:function(b){var a=new f;this._mapLoaded().then(l.hitch(this,function(){this._searchDeferred(b).then(l.hitch(this,function(b){var q=b.results;this.set("searchResults",q);0===b.numResults&&(this._noResults(b.value),this._showNoResultsMenu());this._hideLoading();this.emit("search-results",b);this._selectFirstResult(q,
b.activeSourceIndex);a.resolve(q)}),l.hitch(this,function(b){a.reject(b)}))}));return a.promise},suggest:function(b){var a=new f;this._mapLoaded().then(l.hitch(this,function(){this._suggestDeferred(b).then(l.hitch(this,function(b){if(b){var q=b.results;this.set("suggestResults",q);this._insertSuggestions(q,b.value);this.emit("suggest-results",b);a.resolve(q)}}),l.hitch(this,function(b){a.reject(b)}))}));return a.promise},select:function(b){var a=this._getDefaultSymbol(b),q=this.labelSymbol,d,g=this.sources,
c=this.activeSourceIndex,h=this.enableHighlight,p=this.enableLabel,e=this.autoNavigate,f=this.showInfoWindowOnSelect,A=this.enableInfoWindow,n=this.infoTemplate,v=b.feature?new G(b.feature.toJson()):null,B=v?b.feature._sourceLayer:null;P(v,B);if(c===this._allIndex){var r=this._getSourceIndexOfResult(b);null!==r&&(d=g[r],c=r)}else d=g[c];d&&(d.hasOwnProperty("highlightSymbol")&&(a=d.highlightSymbol),d.hasOwnProperty("labelSymbol")&&(q=d.labelSymbol),d.hasOwnProperty("enableHighlight")&&(h=d.enableHighlight),
d.hasOwnProperty("enableLabel")&&(p=d.enableLabel),d.hasOwnProperty("autoNavigate")&&(e=d.autoNavigate),d.hasOwnProperty("showInfoWindowOnSelect")&&(f=d.showInfoWindowOnSelect),d.hasOwnProperty("enableInfoWindow")&&(A=d.enableInfoWindow),d.hasOwnProperty("infoTemplate")?n=d.infoTemplate:d.featureLayer&&d.featureLayer.infoTemplate&&(n=d.featureLayer.infoTemplate));this._hideMenus();this._hideLoading();if(v){var g=this.highlightGraphic,K=this.graphicsLayer,r=this.labelGraphic,k=l.mixin({},v.attributes,
{searchTheme:this.theme,searchResult:this._searchResultHTML(b),searchMoreResults:this.css.searchMoreResults,searchMoreResultsItem:this.css.searchMoreResultsItem,searchMoreResultsId:this._moreResultsId,searchMoreResultsHtml:this._moreResultsHTML(b)}),y=null;A&&(y=n);r?(r.setGeometry(v.geometry),r.setAttributes(k),r.setSymbol(q),q&&"textsymbol"===q.type&&r.symbol.setText(b.name)):(r=new G(v.geometry,q,k),P(r,B),q&&"textsymbol"===q.type&&r.symbol.setText(b.name),p&&(K?K.add(r):this.map&&this.map.graphics&&
this.map.graphics.add(r)));g?(g.setGeometry(v.geometry),g.setAttributes(k),g.setInfoTemplate(y),g.setSymbol(a)):(g=new G(v.geometry,a,k,y),P(g,B),h&&(K?K.add(g):this.map&&this.map.graphics&&this.map.graphics.add(g)));g&&g.symbol&&"textsymbol"===g.symbol.type&&g.symbol.setText(b.name);this.map&&this.map.infoWindow&&A&&f&&(this.map.infoWindow.setFeatures([g]),a=this._getPointFromGeometry(g.geometry),this.map.infoWindow.show(a));this.map&&e&&b&&b.hasOwnProperty("extent")&&"function"===typeof this.map.setExtent&&
this.map.setExtent(b.extent,!0);this.set("highlightGraphic",g);this.set("labelGraphic",r)}this.set("selectedResult",b);this.emit("select-result",{result:b,source:d,sourceIndex:c})},focus:function(){C.focus(this.inputNode)},blur:function(){this.inputNode.blur();C.curNode&&C.curNode.blur()},clearGraphics:function(){var b=this.highlightGraphic,a=this.graphicsLayer,d=this.labelGraphic;b&&(a?a.remove(b):this.map&&this.map.graphics&&this.map.graphics.remove(b));d&&(a?a.remove(d):this.map&&this.map.graphics&&
this.map.graphics.remove(d));this.set("labelGraphic",null);this.set("highlightGraphic",null)},_mapLoaded:function(){var b=new f;if(this.map)if(this.map.loaded)b.resolve();else c.once(this.map,"load",l.hitch(this,function(){b.resolve()}));else b.resolve();return b.promise},_init:function(){this._getMapLayers().then(l.hitch(this,function(){this.set("loaded",!0);this.emit("load")}))},_clearButton:function(){this.clear();C.focus(this.inputNode)},_error:function(b){return Error(this.declaredClass+" "+
b)},_searchDeferred:function(b){var a=new f,q=this.value,d=this.activeSourceIndex;b&&b.hasOwnProperty("index")&&(d=b.index);this._showLoading();this._hideMenus();this._closePopup();this.clearGraphics();var g={magicKey:this.magicKey,text:q};b?"string"===typeof b?(g.text=b,b=this._searchQueries(g)):b="object"===typeof b&&b.hasOwnProperty("magicKey")?this._searchQueries(b):"object"===typeof b&&b.hasOwnProperty("geometry")?this._searchQueries({geometry:b}):"object"===typeof b&&b.hasOwnProperty(this._objectIdIdentifier)?
this._searchQueries(b):"object"===typeof b&&"point"===b.type?this._searchQueries({point:b}):b instanceof Array&&2===b.length?this._searchQueries({latlon:b}):this._searchQueries(g):b=this._searchQueries(g);b.always(l.hitch(this,function(b){b=this._formatResults(b,d,q);a.resolve(b)}));return a.promise},_suggestDeferred:function(b){var a=new f;this._deferreds.push(a);b||(b=this.value);var q=this.activeSourceIndex;this._suggestQueries({text:b}).always(l.hitch(this,function(d){var g;if(d)for(var c=0;c<
d.length;c++)d[c]&&(g=!0);g?(d=this._formatResults(d,q,b),a.resolve(d)):a.resolve()}));return a.promise},_getDefaultSymbol:function(b){var a,q,d,g;this.map&&(g=this.map.getBasemap());g||(g="topo");b&&b.feature&&b.feature.geometry&&(d=b.feature.geometry.type);"polyline"===d?d="line":"circle"===d||"extent"===d?d="polygon":"multipoint"===d&&(d="point");if(d){if(b=X.getSchemes({theme:"default",basemap:g,geometryType:d}))q=b.primaryScheme;if(q){q.color&&q.hasOwnProperty("opacity")&&(q.color.a=q.opacity);
a=q;b=q.color;q=q.size;var c;switch(d){case "point":c=new R;c.setColor(b);c.setSize(null!==q?q:a.size);d=new O;d.setColor(a.outline.color);d.setWidth(a.outline.width);c.setOutline(d);break;case "line":c=new O;c.setColor(b);c.setWidth(null!==q?q:a.width);break;case "polygon":c=new S,c.setColor(b),d=new O,d.setColor(a.outline.color),d.setWidth(a.outline.width),c.setOutline(d)}a=c}}return a},_selectFirstResult:function(b,a){if(this.autoSelect&&b){var q;a===this._allIndex?q=this._getFirstResult(b):b[a]&&
b[a][0]&&(q=b[a][0]);q&&this.select(q)}},_getSourceIndexOfResult:function(b){var a=this.searchResults;if(a)for(var q in a)if(a[q]&&a[q].length)for(var d=0;d<a[q].length;d++)if(a[q][d]===b)return parseInt(q,10);return null},_getFirstResult:function(b){if(b)for(var a in b)if(b[a]&&b[a][0])return b[a][0];return!1},_onFocus:function(){this.map&&"function"===typeof this.map.disableKeyboardNavigation&&this.map.disableKeyboardNavigation();this.emit("focus");this.inherited(arguments)},_onBlur:function(){this._hideMenus();
this.map&&"function"===typeof this.map.enableKeyboardNavigation&&this.map.enableKeyboardNavigation();this.enableButtonMode&&this.loaded&&this.collapse();this.emit("blur");this.inherited(arguments)},_getMapLayers:function(){var b=new f;if(this.addLayersFromMap&&this.map){var a=[],d=this.map.graphicsLayerIds;if(d&&d.length){for(var g=0;g<d.length;g++){var c=this.map.getLayer(d[g]);c&&a.push(this._featureLayerLoaded(c))}L(a).always(l.hitch(this,function(a){for(var q,d=this.sources,g=0;g<a.length;g++)a[g]&&
a[g].loaded&&"Feature Layer"===a[g].type&&(d.push({featureLayer:a[g],enableSuggestions:!0}),q=!0);q&&this.set("sources",d);b.resolve()}))}else b.resolve()}else b.resolve();return b.promise},_switchCoordinatesClick:function(b){b.preventDefault();if(b=y.get(b.target,"data-switch-coordinates"))this._cancelSuggest(),this.set("value",b),this.search()},_moreResultsClick:function(b){b.preventDefault();var a=b.target;b=parseInt(y.get(a,"data-source-index"),10);var a=parseInt(y.get(a,"data-index"),10),q=this.searchResults;
q&&q[b]&&(b=q[b][a])&&this.select(b)},_showMoreResultsClick:function(b){b.preventDefault();if(b=a.byId(this._moreResultsId)){w.toggle(b,this.css.searchShowMoreResults);var q=a.byId(this._moreResultsId+"_show");q&&(w.contains(b,this.css.searchShowMoreResults)?y.set(q,"textContent",g.widgets.Search.main.hideMoreResults):y.set(q,"textContent",g.widgets.Search.main.showMoreResults))}},_featureLayerLoaded:function(b){var a=new f;if(b.loaded)a.resolve(b);else if(b.loadError)a.reject(this._error("Layer failed to load."));
else{var q,d;q=c.once(b,"load",l.hitch(this,function(){d.remove();a.resolve(b)}));d=c.once(b,"error",l.hitch(this,function(){q.remove();a.reject(this._error("Layer could not be loaded."))}))}return a.promise},_getObjectSize:function(b){var a=0,q;for(q in b)b.hasOwnProperty(q)&&a++;return a},_sourcesEvent:function(b,a){var d=y.get(a,"data-index"),q=n("li",this.sourcesNode);a=t.indexOf(q,a);d!==this._allIndex&&(d=parseInt(d,10));"click"===b.type||b.keyCode===e.ENTER?(this.set("activeSourceIndex",d),
C.focus(this.inputNode),this._hideSourcesMenu()):b.keyCode===e.UP_ARROW?(b.stopPropagation(),b.preventDefault(),b=a-1,0>b?C.focus(this.sourcesBtnNode):C.focus(q[b])):b.keyCode===e.DOWN_ARROW?(b.stopPropagation(),b.preventDefault(),b=a+1,b>=q.length?C.focus(this.sourcesBtnNode):C.focus(q[b])):b.keyCode===e.ESCAPE&&(this._hideSourcesMenu(),C.focus(this.inputNode))},_suggestionsEvent:function(b,a){var d=y.get(a,"data-source-index"),q=parseInt(y.get(a,"data-index"),10),g=n("li",this.suggestionsNode),
c=this.sources;a=t.indexOf(g,a);d!==this._allIndex&&(d=parseInt(d,10));var h;this._clearQueryTimeout();"click"===b.type||b.keyCode===e.ENTER?((g=this.suggestResults)&&g[d]&&g[d][q]&&(h=g[d][q]),h&&(h.index=d,c[d].featureLayer?(d=c[d].featureLayer.objectIdField,h[this._objectIdIdentifier]=h.feature.attributes[d],this.set("value",this._getSuggestionName(h)),this.set("selectedFeatureId",h.feature.attributes[d])):h.magicKey&&h.text&&(this.set("value",h.text),this.set("magicKey",h.magicKey)),this.search(h),
C.focus(this.inputNode))):b.keyCode===e.BACKSPACE||b.keyCode===e.DELETE?C.focus(this.inputNode):b.keyCode===e.UP_ARROW?(b.stopPropagation(),b.preventDefault(),h=a-1,0>h?C.focus(this.inputNode):C.focus(g[h])):b.keyCode===e.DOWN_ARROW?(b.stopPropagation(),b.preventDefault(),h=a+1,h>=g.length?C.focus(this.inputNode):C.focus(g[h])):b.keyCode===e.ESCAPE&&(this._hideMenus(),C.focus(this.inputNode))},_getResultName:function(b){var a;b.hasOwnProperty("name")&&null!==b.name&&(a=b.name.toString());a||(a=g.widgets.Search.main.untitledResult);
return a},_getSuggestionName:function(b){var a;b.hasOwnProperty("name")&&null!==b.name&&(a=b.name.toString());b=b.text||a;b||(b=g.widgets.Search.main.untitledResult);return b},_searchResultHTML:function(b){var a="";if(b.feature&&b.feature.attributes&&b.feature.attributes.Addr_type&&"LatLong"===b.feature.attributes.Addr_type){var d=b.name.split(" "),q,c;2===d.length&&(q=d[0],c=d[1]);c&&q?(b=parseFloat(q),c=parseFloat(c),d=c+", "+b,a+='\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e',a+='\x3cdiv class\x3d"'+
this.css.latLonHeader+'"\x3e'+g.widgets.Search.main.lonlat+"\x3c/div\x3e",a=a+(b+", "+c)+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),b===c||90<b||-90>b||180<c||-180>c||(a+='\x3cdiv class\x3d"'+this.css.latLonHeader+'"\x3e'+g.widgets.Search.main.reverseLonLatHeader+"\x3c/div\x3e",a=a+('\x3ca data-switch-coordinates\x3d"'+d+'" tabindex\x3d"0" href\x3d"#"\x3e'+d+"\x3c/a\x3e")+"\x3c/div\x3e")):a=b.name}else a=b.name;return a},_moreResultsHTML:function(b){var a="",d="",
q=this.searchResults,c=this.sources,h=0;if(q){var d=d+('\x3cdiv class\x3d"'+this.css.searchMoreResultsItem+'"\x3e'),d=d+('\x3ca href\x3d"#" id\x3d"'+this._moreResultsId+'_show"\x3e'+g.widgets.Search.main.showMoreResults+"\x3c/a\x3e"),d=d+"\x3c/div\x3e"+('\x3cdiv class\x3d"'+this.css.searchMoreResultsList+'"\x3e'),d=d+('\x3cdiv id\x3d"'+this._moreResultsId+'_list"\x3e'),p;for(p in q)if(q[p]){var e=q[p].length;if(e){var f=1===e&&q[p][0]===b;if(1<this._getObjectSize(q)&&!f)var A=this._getSourceName(p),
d=d+('\x3cdiv class\x3d"'+this.css.searchMoreResultsListHeader+'"\x3e'+A+"\x3c/div\x3e");if(e&&!f){d+="\x3cul\x3e";A=c[p].maxResults||this.maxResults;for(f=0;f<e&&f<A;++f)if(q[p][f]!==b){var n=this._getResultName(q[p][f]),d=d+('\x3cli\x3e\x3ca tabindex\x3d"0" data-index\x3d"'+f+'" data-source-index\x3d"'+p+'" href\x3d"#"\x3e'+n+"\x3c/a\x3e\x3c/li\x3e");h++}d+="\x3c/ul\x3e"}}}d+="\x3c/div\x3e\x3c/div\x3e"}h&&(a+=d);return a},_validField:function(b,a){return b.getField(a)},_validFields:function(b,a){if(b&&
a&&a.length){for(var d=0;d<a.length;d++)if(!this._validField(b,a[d]))return!1;return!0}return!1},_getCodedName:function(b,a){if(b&&b.length)for(var d=0,q=b.length;d<q;d++){var g=b[d];if(g.code===a)return g.name}},_getCodedValue:function(b,a,d){if(b&&b.length)for(var q=0,g=b.length;q<g;q++){var c=b[q],h=c.name,p=a;d||(h=h.toLowerCase(),p=p.toLowerCase());if(h===p)return c.code}return!1},_whereClause:function(b,a,d,g){var q=null;if(b){var c="";this.reHostedFS.test(a.url)&&this._containsNonLatinCharacter(b)&&
(c="N");if(d&&d.length)for(var h=0,p=d.length;h<p;h++){var e="",f=b.replace(/\'/g,"''"),e=d[h],A=a.getField(e),n=a.getDomain(e);n&&"codedValue"===n.type&&(f=this._getCodedValue(n.codedValues,f,g));!1!==f&&(A=A.type,"esriFieldTypeString"===A||"esriFieldTypeDate"===A?e=g?e+" \x3d "+c+"'"+f+"'":"UPPER("+e+") LIKE "+c+"'%"+f.toUpperCase()+"%'":"esriFieldTypeOID"===A||"esriFieldTypeSmallInteger"===A||"esriFieldTypeInteger"===A||"esriFieldTypeSingle"===A||"esriFieldTypeDouble"===A?(f=parseFloat(f),e=isNaN(f)?
!1:e+" \x3d "+f):e=e+" \x3d "+f,e&&(q=q?q+" or ":"",q+=e))}}return q},_suggest:function(b){b||(b={index:this.activeSourceIndex,text:this.value});var a=new f,d=b.index,g=this.sources[d],q=this.enableSuggestions;g.hasOwnProperty("enableSuggestions")&&(q=g.enableSuggestions);var c=0,h;b.hasOwnProperty("text")&&b.text&&(h=l.trim(b.text),c=b.text.length);b=g.minCharacters||this.minCharacters;if(q&&h&&c>=b&&this._supportsPagination(g)){var e="";g.prefix&&(e+=g.prefix);e+=h;g.suffix&&(e+=g.suffix);var p=
this._defaultSR;this.map&&(p=this.map.spatialReference);q={};g.locator?(g.categories&&(q.categories=g.categories),g.locator.outSpatialReference=p,this.map&&g.localSearchOptions&&g.localSearchOptions.hasOwnProperty("distance")&&g.localSearchOptions.hasOwnProperty("minScale")&&(c=this._getScale(),!g.localSearchOptions.minScale||c&&c<=parseFloat(g.localSearchOptions.minScale))&&(q.location=this.map.extent.getCenter(),q.distance=g.localSearchOptions.distance),q.text=e,g.useMapExtent&&this.map&&this.map.extent&&
(q.searchExtent=this.map.extent),g.searchExtent&&(q.searchExtent=g.searchExtent),q.maxSuggestions=g.maxSuggestions||this.maxSuggestions,g.sourceCountry&&(q.countryCode=g.sourceCountry),g.countryCode&&(q.countryCode=g.countryCode),g.locator.suggestLocations(q).then(l.hitch(this,function(b){a.resolve(b)}),l.hitch(this,function(b){b||(b=this._error("Locator suggestLocations could not be performed."));a.reject(b)}))):g.featureLayer?this._featureLayerLoaded(g.featureLayer).then(l.hitch(this,function(){var b=
this._getDisplayField(g),q=g.searchFields||[b],c=[];g.suggestionTemplate?g.suggestionTemplate.replace(/(?:\$\{([^}]+)\})/g,function(b,a){c.push(a)}):c=[b];-1===t.indexOf(c,g.featureLayer.objectIdField)&&c.push(g.featureLayer.objectIdField);var b=this._validField(g.featureLayer,b),h=this._validFields(g.featureLayer,c),f=this._validFields(g.featureLayer,q);if(b&&h&&f){b=new U;g.hasOwnProperty("suggestQueryParams")&&l.mixin(b,g.suggestQueryParams);b.outSpatialReference=p;b.returnGeometry=!1;b.num=g.maxSuggestions||
this.maxSuggestions;b.outFields=c;g.useMapExtent&&this.map&&this.map.extent&&(b.geometry=this.map.extent);g.searchExtent&&(b.geometry=g.searchExtent);var A;if(q=this._whereClause(e,g.featureLayer,q,!1))b.where=q,A=!0;A?g.featureLayer.queryFeatures(b,l.hitch(this,function(b){var g;(b=b.features)&&(g=this._hydrateResults(b,d,!0));a.resolve(g)}),l.hitch(this,function(b){b||(b=this._error("FeatureLayer queryFeatures errored with suggestions"));a.reject(b)})):a.resolve()}else a.reject(this._error("Invalid FeatureLayer field"))})):
a.reject(this._error("Invalid source"))}else a.resolve();return a.promise},_supportsPagination:function(b){var a;b.locator?a=!0:b.featureLayer&&b.featureLayer.advancedQueryCapabilities&&b.featureLayer.advancedQueryCapabilities.supportsPagination&&(a=!0);return a},_suggestQueries:function(b){var a=this.sources,d=this.activeSourceIndex,g=[],q;if(d===this._allIndex)for(d=0;d<a.length;d++)q=b,q.index=d,q=this._suggest(q),g.push(q);else b.index=d,q=this._suggest(b),g.push(q);return L(g)},_getPointFromGeometry:function(b){var a;
switch(b.type){case "extent":a=b.getCenter();break;case "multipoint":a=b.getPoint(0);break;case "point":a=b;break;case "polygon":a=b.getCentroid();break;case "polyline":a=b.getPoint(0,0)}return a},_searchQueries:function(b){b.hasOwnProperty("index")||(b.index=this.activeSourceIndex);var a=[],d;if(b.index===this._allIndex)for(var g=this.sources,q=0;q<g.length;q++)d=b,d.index=q,d=this._search(d),a.push(d);else b=this._search(b),a.push(b);return L(a)},_searchButton:function(){this.enableButtonMode&&
!this.expanded?(this.expand(),C.focus(this.inputNode)):(this._cancelSuggest(),this.search())},_search:function(b){b||(b={text:this.value,magicKey:null,geometry:null,point:null,index:this.activeSourceIndex,latlon:null});this.selectedFeatureId&&(b.text=null,b[this._objectIdIdentifier]=this.selectedFeatureId);var a,d=new f,g=b.index,c=this.sources[g],q;b.hasOwnProperty("text")&&b.text&&(q=l.trim(b.text));if(c){var h="";c.prefix&&!b.magicKey&&(h+=c.prefix);h+=q;c.suffix&&!b.magicKey&&(h+=c.suffix);var e=
this._defaultSR;this.map&&(e=this.map.spatialReference);if(c.locator)if(b.hasOwnProperty("text")&&q){var p={};c.categories&&(p.categories=c.categories);c.locationType&&(p.locationType=c.locationType);e&&(c.locator.outSpatialReference=e);if(this.map&&c.localSearchOptions&&c.localSearchOptions.hasOwnProperty("distance")&&c.localSearchOptions.hasOwnProperty("minScale")){var A=this._getScale();if(!c.localSearchOptions.minScale||A&&A<=parseFloat(c.localSearchOptions.minScale))p.location=this.map.extent.getCenter(),
p.distance=c.localSearchOptions.distance}p.address={};p.maxLocations=c.maxResults||this.maxResults;c.useMapExtent&&this.map&&this.map.extent&&(p.searchExtent=this.map.extent);c.searchExtent&&(p.searchExtent=c.searchExtent);c.sourceCountry&&(p.countryCode=c.sourceCountry);c.countryCode&&(p.countryCode=c.countryCode);b.magicKey&&(p.magicKey=b.magicKey);c.singleLineFieldName?p.address[c.singleLineFieldName]=h:p.address["Single Line Input"]=h;c.outFields&&(p.outFields=c.outFields);c.locator.addressToLocations(p).then(l.hitch(this,
function(b){b=this._hydrateResults(b,g,!1);d.resolve(b)}),l.hitch(this,function(b){b||(b=this._error("Locator addressToLocations could not be performed"));d.reject(b)}))}else b.geometry?(a=this._getPointFromGeometry(b.geometry.geometry))?this._reverseGeocodePoint(g,a).then(function(b){d.resolve(b)},function(b){d.reject(b)}):d.reject(this._error("Invalid point to reverse geocode")):b.point?this._reverseGeocodePoint(g,b.point).then(function(b){d.resolve(b)},function(b){d.reject(b)}):b.latlon?(p=new J(b.latlon,
this._defaultSR),this._reverseGeocodePoint(g,p).then(function(b){d.resolve(b)},function(b){d.reject(b)})):b.hasOwnProperty("text")&&!q?d.resolve([]):d.reject(this._error("Invalid query type for Locator"));else c.featureLayer?this._featureLayerLoaded(c.featureLayer).then(l.hitch(this,function(){var p=this._getDisplayField(c),f=c.searchFields||[p],p=this._validField(c.featureLayer,p),A=this._validFields(c.featureLayer,f);if(p&&A){p=new U;c.hasOwnProperty("searchQueryParams")&&l.mixin(p,c.searchQueryParams);
e&&(p.outSpatialReference=e,A=this.map&&this.map.getMaxResolution()||1/K.getUnitValueForSR(e))&&(p.maxAllowableOffset=A);p.returnGeometry=!0;c.outFields&&(p.outFields=c.outFields);var n;b.hasOwnProperty(this._objectIdIdentifier)||(this._supportsPagination(c)&&(p.num=c.maxResults||this.maxResults),c.useMapExtent&&this.map&&this.map.extent&&(p.geometry=this.map.extent),c.searchExtent&&(p.geometry=c.searchExtent),n=c.exactMatch);b.hasOwnProperty("text")&&q?(f=this._whereClause(h,c.featureLayer,f,n))?
(p.where=f,f=!0):f=!1:b.hasOwnProperty(this._objectIdIdentifier)?(p.objectIds=[b[this._objectIdIdentifier]],f=!0):b.geometry?(p.geometry=b.geometry,f=!0):b.point?(p.geometry=b.point,f=!0):b.latlon?(a=new J(b.latlon,this._defaultSR),p.geometry=a,f=!0):(b.hasOwnProperty("text")&&!q?d.resolve([]):d.reject(this._error("Invalid query type for FeatureLayer")),f=!1);f?c.featureLayer.queryFeatures(p,l.hitch(this,function(b){b=b.features;var a;b&&(a=this._hydrateResults(b,g,!1));d.resolve(a)}),l.hitch(this,
function(b){b||(b=this._error("FeatureLayer queryFeatures could not be performed"));d.reject(b)})):d.resolve()}else d.reject(this._error("Invalid FeatureLayer field"))})):d.reject(this._error("Invalid source"))}else d.reject(this._error("Source is undefined"));return d.promise},_clearQueryTimeout:function(){this._queryTimer&&clearTimeout(this._queryTimer)},_formatResults:function(b,a,d){d={activeSourceIndex:a,value:d,numResults:0,numErrors:0,errors:null,results:null};var g={},c={};if(b)if(a===this._allIndex)for(a=
0;a<b.length;a++)b[a]&&(b[a]instanceof Error?(g[a]=b[a],d.numErrors++):(c[a]=b[a],d.numResults+=b[a].length));else b[0]&&(b[0]instanceof Error?(g[a]=b[0],d.numErrors++):(c[a]=b[0],d.numResults+=b[0].length));d.numErrors&&(d.errors=g);d.numResults&&(d.results=c);return d},_reverseGeocodePoint:function(b,a){var d=new f,g=this.sources[b];if(a&&g){var c=g.locationToAddressDistance||this.locationToAddressDistance;g.locator.outSpatialReference=this._defaultSR;this.map&&(g.locator.outSpatialReference=this.map.spatialReference);
g.locator.locationToAddress(a,c,l.hitch(this,function(a){a=this._hydrateResults([a],b,!1);d.resolve(a)}),l.hitch(this,function(b){b||(b=this._error("Locator locationToAddress could not be performed"));d.reject(b)}))}else d.reject(this._error("No point or source defined for reverse geocoding"));return d.promise},_cancelDeferreds:function(){if(this._deferreds&&this._deferreds.length)for(var b=0;b<this._deferreds.length;b++)this._deferreds[b].cancel(this.declaredClass+" cancelling request");this._deferreds=
[]},_sourceBtnKey:function(b){if(b){var a=n("li",this.sourcesNode);b.keyCode===e.UP_ARROW?(b.stopPropagation(),b.preventDefault(),this._showSourcesMenu(),(b=a.length)&&C.focus(a[b-1])):b.keyCode===e.DOWN_ARROW&&(b.stopPropagation(),b.preventDefault(),this._showSourcesMenu(),a[0]&&C.focus(a[0]))}},_inputKey:function(b){if(b){var a=n("li",this.suggestionsNode),d=this.suggestResults;if(b.keyCode===e.TAB||b.keyCode===e.ESCAPE)this._cancelSuggest(),this._hideMenus();else if(b.keyCode===e.UP_ARROW)b.stopPropagation(),
b.preventDefault(),this._cancelSuggest(),d&&this._showSuggestionsMenu(),(b=a.length)&&C.focus(a[b-1]);else if(b.keyCode===e.DOWN_ARROW)b.stopPropagation(),b.preventDefault(),this._cancelSuggest(),d&&this._showSuggestionsMenu(),a[0]&&C.focus(a[0]);else{if(b.ctrlKey||b.metaKey||b.keyCode===e.copyKey||b.keyCode===e.LEFT_ARROW||b.keyCode===e.RIGHT_ARROW||b.keyCode===e.ENTER)return b;this._suggestDelay()}}},_cancelSuggest:function(){this._cancelDeferreds();this._clearQueryTimeout()},_suggestDelay:function(){this._cancelSuggest();
this._changeValue();this._queryTimer=setTimeout(l.hitch(this,function(){this.suggest()}),this.suggestionDelay)},_changeValue:function(){this.set("magicKey",null);this.set("selectedFeatureId",null);this._changeAttrValue("value",this.inputNode.value);this._checkStatus()},_inputClick:function(){this._hideSourcesMenu();this._hideNoResultsMenu()},_getSourceName:function(b){return this._sourceNames[b]},_loadSources:function(b){b=t.filter(b,function(b){return!!b.featureLayer});b=t.map(b,function(b){return this._featureLayerLoaded(b.featureLayer)},
this);return L(b)},_createSourceNameMap:function(b){return this._loadSources(b).then(l.hitch(this,function(){var a=t.map(b,function(b){return b.name||b.featureLayer&&b.featureLayer.name||g.widgets.Search.main.untitledSource});this._preventDuplicateSourceNames(b,a);return a}))},_getDuplicateSourceNameIndexes:function(b){var a={},d=[];t.forEach(b,function(g,c){a.hasOwnProperty(g)?(-1===d.indexOf(a[g])&&d.push(a[g]),d.push(c)):b.lastIndexOf(g)!==c&&(a[g]=c)});return d},_preventDuplicateSourceNames:function(b,
a){if(a&&1<a.length){var d=this._getDuplicateSourceNameIndexes(a);t.forEach(d,function(d){a[d]+=this._getFieldsString(b[d])},this)}},_getFieldsString:function(b){var a="",d=b.featureLayer;if(d){b=b.searchFields||[this._getDisplayField(b)];for(var g=0;g<b.length;g++)var a=0===g?a+": ":a+", ",c=b[g],h=d.getFieldLabel(c),a=a+(h||c)}return a},_splitResult:function(b,a){a=v.escapeString(a);return b.replace(new RegExp("(^|)("+a+")(|$)","ig"),"$1|$2|$3").split("|")},_insertSuggestions:function(b,a){if(this.enableSuggestionsMenu&&
this.suggestionsNode){this._hideSourcesMenu();this._hideNoResultsMenu();var d,g=this.sources;if(b){d=h.create("div");for(var c in b)if(b[c]&&b[c].length){var p=this._getSourceName(c);1<g.length&&this.activeSourceIndex===this._allIndex&&h.create("div",{className:this.css.searchMenuHeader,textContent:p},d);for(var p=h.create("ul",{role:"menu"},d),e=g[c].maxSuggestions||this.maxSuggestions,f=0;f<b[c].length&&f<e;++f)for(var q=h.create("li",{"data-index":f,"data-source-index":c,role:"menuitem",tabindex:0},
p),A=this._getSuggestionName(b[c][f]),A=this._splitResult(A,a),n=A.length,v=0;v<n;v++){var r=A[v];r.toLowerCase()===a.toLowerCase()?h.create("strong",{textContent:r},q):(r=document.createTextNode(r),h.place(r,q))}}}d?(h.place(d,this.suggestionsNode,"only"),this._showSuggestionsMenu()):(h.empty(this.suggestionsNode),this._hideSuggestionsMenu())}},_insertSources:function(b){if(this.enableSourcesMenu&&b&&1<b.length){var a,d,c=this.activeSourceIndex,p=h.create("ul",{role:"menu"});this.enableSearchingAll&&
(a="",c===this._allIndex&&(a="active"),h.create("li",{"data-index":this._allIndex,role:"menuitem",className:a,tabIndex:0,textContent:g.widgets.Search.main.all},p));for(d=0;d<b.length;d++){a="";d===c&&(a=this.css.activeSource);var e=this._getSourceName(d);h.create("li",{"data-index":d,role:"menuitem",className:a,tabIndex:0,textContent:e},p)}w.add(this.containerNode,this.css.hasMultipleSources);h.place(p,this.sourcesNode,"only")}else w.remove(this.containerNode,this.css.hasMultipleSources),h.empty(this.sourcesNode)},
_showLoading:function(){w.add(this.containerNode,this.css.searchLoading)},_hideLoading:function(){w.remove(this.containerNode,this.css.searchLoading)},_checkStatus:function(){this.value?(w.add(this.containerNode,this.css.hasValue),y.set(this.clearNode,"title",g.widgets.Search.main.clearButtonTitle)):this.clear()},_closePopup:function(){this.enableInfoWindow&&this.map&&this.map.infoWindow&&this.map.infoWindow.hide()},_noResults:function(b){var a;b&&(a=l.trim(b));var d=h.create("div",{className:this.css.searchNoResultsBody});
b&&a?(h.create("div",{className:this.css.searchNoResultsHeader,textContent:g.widgets.Search.main.noResults},d),h.create("div",{className:this.css.searchNoResultsText,textContent:F.substitute({value:'"'+b+'"'},g.widgets.Search.main.noResultsFound)},d)):(b=h.create("div",{},d),h.create("span",{"aria-hidden":"true",className:this.css.searchNoValueIcon},b),h.create("span",{className:this.css.searchNoValueText,textContent:g.widgets.Search.main.emptyValue},b));h.place(d,this.noResultsMenuNode,"only")},
_hideMenus:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();this._hideNoResultsMenu()},_hideNoResultsMenu:function(){w.remove(this.containerNode,this.css.showNoResults)},_showNoResultsMenu:function(){this._hideSourcesMenu();this._hideSuggestionsMenu();w.add(this.containerNode,this.css.showNoResults)},_hideSourcesMenu:function(){w.remove(this.containerNode,this.css.showSources)},_hideSuggestionsMenu:function(){w.remove(this.containerNode,this.css.showSuggestions)},_showSourcesMenu:function(){this._hideSuggestionsMenu();
this._hideNoResultsMenu();w.add(this.containerNode,this.css.showSources)},_showSuggestionsMenu:function(){this._hideSourcesMenu();this._hideNoResultsMenu();w.add(this.containerNode,this.css.showSuggestions)},_toggleSourcesMenu:function(){this._hideSuggestionsMenu();this._hideNoResultsMenu();w.toggle(this.containerNode,this.css.showSources)},_getFirstStringField:function(b){if(b&&(b=b.fields)&&b.length)for(var a=0;a<b.length;a++){var d=b[a];if("esriFieldTypeString"===d.type)return d.name}return""},
_getDisplayField:function(b){return b.displayField||b.featureLayer.displayField||this._getFirstStringField(b.featureLayer)},_validLocation:function(b){return b&&"number"===typeof b.x&&"number"===typeof b.y},_validExtent:function(b){return b&&"number"===typeof b.xmin&&"number"===typeof b.ymin&&"number"===typeof b.xmax&&"number"===typeof b.ymax},_hydrateResult:function(b,a,g){var c={},h=this._defaultSR,p;a=this.sources[a];this.map&&(h=this.map.spatialReference);if(b.hasOwnProperty("text")&&b.hasOwnProperty("magicKey"))return b;
if(b.hasOwnProperty("geometry"))p=new G(b.toJson()),c.feature=p,(p=c.feature.geometry)&&p.setSpatialReference(h);else if(b.hasOwnProperty("location")&&this._validLocation(b.location)){var e=new J(b.location.x,b.location.y,h);p={};b.hasOwnProperty("attributes")&&(p=b.attributes);b.hasOwnProperty("address")&&"object"===typeof b.address&&l.mixin(p,b.address);b.hasOwnProperty("score")&&(p.score=b.score);c.feature=new G(e,null,p,null)}!c.feature&&g&&(p={},b.hasOwnProperty("attributes")&&(p=b.attributes),
b.hasOwnProperty("score")&&(p.score=b.score),c.feature=new G(null,null,p,null));if(c.feature){if(b.hasOwnProperty("extent")&&this._validExtent(b.extent))c.extent=new H(b.extent),c.extent.setSpatialReference(h);else if(c.feature&&c.feature.geometry)switch(c.feature.geometry.type){case "extent":c.extent=c.feature.geometry;break;case "multipoint":c.extent=A.getDenormalizedExtent(c.feature.geometry);break;case "polygon":c.extent=A.getDenormalizedExtent(c.feature.geometry);break;case "polyline":c.extent=
A.getDenormalizedExtent(c.feature.geometry);break;case "point":this.map?(h=this.zoomScale,a&&a.zoomScale&&(h=a.zoomScale),this._getScale()>h?c.extent=K.getExtentForScale(this.map,h).centerAt(c.feature.geometry):c.extent=this.map.extent.centerAt(c.feature.geometry)):c.extent=new H({xmin:c.feature.geometry.x-.25,ymin:c.feature.geometry.y-.25,xmax:c.feature.geometry.x+.25,ymax:c.feature.geometry.y+.25,spatialReference:this._defaultSR})}else c.extent=null;c.name="";a.featureLayer?a.suggestionTemplate&&
g?c.name=F.substitute(b.attributes,a.suggestionTemplate):a.searchTemplate?c.name=F.substitute(b.attributes,a.searchTemplate):(p=this._getDisplayField(a),g=a.featureLayer.getField(p),h=a.featureLayer.getDomain(p),p&&b.hasOwnProperty("attributes")&&b.attributes.hasOwnProperty(p)&&(b=b.attributes[p],h&&"codedValue"===h.type?c.name=this._getCodedName(h.codedValues,b):g&&"esriFieldTypeDate"===g.type&&!isNaN(b)?c.name=d.format(new Date(b)):c.name=b)):b.address&&a.searchTemplate?c.name=F.substitute(b.address,
a.searchTemplate):b.hasOwnProperty("name")?c.name=b.name:b.hasOwnProperty("attributes")&&"object"===typeof b.attributes&&b.attributes.LongLabel?c.name=b.attributes.LongLabel:b.hasOwnProperty("attributes")&&"object"===typeof b.attributes&&b.attributes.Match_addr?(c.name=b.attributes.Match_addr,b.attributes.Addr_type&&"POI"===b.attributes.Addr_type&&b.attributes.StAddr&&b.attributes.City?c.name+=" - "+b.attributes.StAddr+", "+b.attributes.City:b.attributes.Addr_type&&"POI"===b.attributes.Addr_type&&
b.attributes.City&&(c.name+=" - "+b.attributes.City)):b.hasOwnProperty("address")&&"string"===typeof b.address?c.name=b.address:b.hasOwnProperty("address")&&"object"===typeof b.address&&b.address.hasOwnProperty("Address")?b.address.hasOwnProperty("Match_addr")?c.name=b.address.Match_addr:b.address.hasOwnProperty("Address")&&(c.name=b.address.Address):c.feature&&c.feature.geometry&&(c.name=c.feature.geometry.x+","+c.feature.geometry.y);a.featureLayer&&c.feature&&P(c.feature,a.featureLayer);return c}},
_getScale:function(){var b;this.map&&"function"===typeof this.map.getScale&&(b=this.map.getScale());return b},_hydrateResults:function(b,a,d,c){c=[];var g=0;if(b&&b.length)for(g;g<b.length;g++){var p=this._hydrateResult(b[g],a,d);p&&c.push(p)}return c},_containsNonLatinCharacter:function(b){for(var a=0;a<b.length;a++)if(255<b.charCodeAt(a))return!0;return!1},_setPlaceholder:function(b){var a="",d=this.sources[b];b===this._allIndex?a=this.allPlaceholder||g.widgets.Search.main.allPlaceholder:d&&d.placeholder&&
(a=d.placeholder);var c=g.widgets.Search.main.all;d&&(c=this._getSourceName(b));y.set(this.sourceNameNode,"textContent",c);y.set(this.inputNode,"placeholder",a);y.set(this.inputNode,"title",a)},_updateActiveSource:function(){var b=this.sources,a=this.activeSourceIndex,d;b&&b[a]&&(d=b[a]);d?this.set("activeSource",d):this.set("activeSource",null)},_updateVisible:function(){this.visible?this.show():this.hide()},_updateButtonMode:function(b){b?(w.toggle(this.containerNode,this.css.searchExpanded,this.expanded),
w.toggle(this.containerNode,this.css.searchCollapsed,!this.expanded),w.add(this.containerNode,this.css.hasButtonMode)):(w.remove(this.containerNode,this.css.searchExpanded),w.remove(this.containerNode,this.css.searchCollapsed),w.remove(this.containerNode,this.css.hasButtonMode))},_setDefaultActiveSourceIndex:function(b){b&&1===b.length||!this.enableSearchingAll?this.set("activeSourceIndex",0):this.set("activeSourceIndex",this._allIndex)},_setEnableSourcesMenuAttr:function(b){this._set("enableSourcesMenu",
b);this._created&&this._insertSources(this.sources)},_setEnableSearchingAllAttr:function(b){this._set("enableSearchingAll",b);this._created&&(this._setDefaultActiveSourceIndex(this.sources),this._hideMenus(),this._insertSources(this.sources))},_setSourcesAttr:function(b){this._createSourceNameMap(b).then(l.hitch(this,function(a){this._sourceNames=a;this._created&&(this._setDefaultActiveSourceIndex(b),this._hideMenus(),this._insertSources(b))}));this._set("sources",b)},_setAllPlaceholderAttr:function(b){this._set("allPlaceholder",
b);this._created&&this._setPlaceholder(this.activeSourceIndex)},_setActiveSourceIndexAttr:function(b){this._set("activeSourceIndex",b);this._updateActiveSource();this._created&&(this._setPlaceholder(b),this._hideMenus(),this._insertSources(this.sources))},_setMaxLengthAttr:function(b){this._set("maxLength",b);this._created&&y.set(this.inputNode,"maxLength",b)},_setValueAttr:function(b){this.set("magicKey",null);this.set("selectedFeatureId",null);this._set("value",b);this._created&&(y.set(this.inputNode,
"value",b),this._checkStatus())},_setVisibleAttr:function(b){this._set("visible",b);this._created&&this._updateVisible()},_setEnableButtonModeAttr:function(b){this._set("enableButtonMode",b);this._created&&this._updateButtonMode(b)},_setThemeAttr:function(b){this._created&&(w.remove(this.domNode,this.theme),w.add(this.domNode,b));this._set("theme",b)}});r("extend-esri")&&l.setObject("dijit.Search",k,N);return k})},"esri/styles/basic":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/has",
"../kernel","../Color"],function(m,k,l,t,u){function f(c,a){var e;if(c)switch(e={},e.color=new u(c.color),e.opacity=c.opacity||1,a){case "point":e.outline={color:new u(c.outline.color),width:c.outline.width};e.size=c.size;break;case "line":e.width=c.width;break;case "polygon":e.outline={color:new u(c.outline.color),width:c.outline.width}}return e}function e(c){if("esriGeometryPoint"===c||"esriGeometryMultipoint"===c)c="point";else if("esriGeometryPolyline"===c)c="line";else if("esriGeometryPolygon"===
c||"esriGeometryMultiPatch"===c)c="polygon";return c}var c={"default":{name:"default",label:"Default",description:"Default theme for basic visualization of features.",basemapGroups:{light:"streets gray topo terrain national-geographic oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector".split(" "),dark:["satellite","hybrid","dark-gray","dark-gray-vector","streets-night-vector"]},pointSchemes:{light:{primary:{color:[77,77,77,1],outline:{color:[255,255,
255,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[255,255,255,1],outline:{color:[51,51,51,.25],width:1},size:8}]},dark:{primary:{color:[255,255,255,1],outline:{color:[92,92,92,.25],width:1},size:8},secondary:[{color:[226,119,40,1],outline:{color:[255,255,255,.25],width:1},size:8},{color:[26,26,26,1],outline:{color:[178,178,178,.25],width:1},size:8}]}},lineSchemes:{light:{primary:{color:[77,77,77,1],width:2},secondary:[{color:[226,
119,40,1],width:2},{color:[255,255,255,1],width:2}]},dark:{primary:{color:[255,255,255,1],width:2},secondary:[{color:[226,119,40,1],width:2},{color:[26,26,26,1],width:2}]}},polygonSchemes:{light:{primary:{color:[227,139,79,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},secondary:[{color:[128,128,128,1],outline:{color:[255,255,255,.25],width:1},opacity:.8},{color:[255,255,255,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]},dark:{primary:{color:[227,139,79,1],outline:{color:[92,
92,92,.25],width:1},opacity:.8},secondary:[{color:[178,178,178,1],outline:{color:[92,92,92,.25],width:1},opacity:.8},{color:[26,26,26,1],outline:{color:[128,128,128,.25],width:1},opacity:.8}]}}}},n={};(function(){var e,a,f,r,k,h,d,g;for(e in c)for(r in a=c[e],f=a.basemapGroups,k=n[e]={basemaps:[].concat(f.light).concat(f.dark),point:{},line:{},polygon:{}},f)for(h=f[r],d=0;d<h.length;d++)g=h[d],a.pointSchemes&&(k.point[g]=a.pointSchemes[r]),a.lineSchemes&&(k.line[g]=a.lineSchemes[r]),a.polygonSchemes&&
(k.polygon[g]=a.polygonSchemes[r])})();var r={getAvailableThemes:function(e){var a=[],f,r,v;for(f in c)r=c[f],v=n[f],e&&-1===m.indexOf(v.basemaps,e)||a.push({name:r.name,label:r.label,description:r.description,basemaps:v.basemaps.slice(0)});return a},getSchemes:function(c){var a=c.theme,r=c.basemap,k=e(c.geometryType);c=n[a];var v;(c=(c=c&&c[k])&&c[r])&&(v={primaryScheme:f(c.primary,k),secondarySchemes:m.map(c.secondary,function(a){return f(a,k)})});return v},cloneScheme:function(c){var a;c&&(a=k.mixin({},
c),a.color&&(a.color=new u(a.color)),a.outline&&(a.outline={color:a.outline.color&&new u(a.outline.color),width:a.outline.width}));return a}};l("extend-esri")&&k.setObject("styles.basic",r,t);return r})},"widgets/Directions/setting/SearchConfig/SearchConfig":function(){define("dojo/_base/declare dojo/_base/lang dojo/on dojo/_base/html dojo/query dojo/_base/array dojo/Evented dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./SearchConfig.html ./QuerySourceSetting ./LocatorSourceSetting jimu/LayerInfos/LayerInfos jimu/dijit/LoadingShelter dojo/Deferred ../../searchUtil dojo/when jimu/dijit/Message jimu/dijit/SimpleTable jimu/dijit/RadioBtn".split(" "),
function(m,k,l,t,u,f,e,c,n,r,v,a,y,w,x,h,d,g,z,p){return m([c,n,r,e],{templateString:v,postMixInProperties:function(){this.inherited(arguments);k.mixin(this.nls,window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.sourceList=new p({autoHeight:!1,selectable:!0,fields:[{name:"name",title:this.nls.name,width:"auto",type:"text",editable:!1},{name:"type",hidden:!0,type:"text",editable:!1},{name:"actions",title:"",width:"70px",type:"actions",actions:["up","down","delete"]}]},this.sourceList);
t.setStyle(this.sourceList.domNode,"height","100%");this.sourceList.startup();this.own(l(this.sourceList,"row-select",k.hitch(this,this._onSourceItemSelected)));this.own(l(this.sourceList,"row-delete",k.hitch(this,this._onSourceItemRemoved)));this.own(l(this.sourceList,"row-edit",k.hitch(this,this._onSourceItemChanged)));this.shelter=new x({hidden:!0})},startup:function(){this.inherited(arguments);this.shelter.show();w.getInstance(this.map,this.map.itemInfo).then(k.hitch(this,function(b){this.layerInfosObj=
b;d.setMap(this.map);d.setLayerInfosObj(this.layerInfosObj);d.setAppConfig(this.appConfig);this._upgradeConfig().then(k.hitch(this,function(){g(d.getConfigInfo(this.config.searchOptions)).then(k.hitch(this,function(b){this.domNode&&(this.setConfig(b),this.shelter.hide())}))}))}))},setConfig:function(b){f.forEach(b.sources,k.hitch(this,function(b,a){var d=this.sourceList.addRow({name:b.name||"",type:b.type});d&&d.success?(this._setRelatedConfig(d.tr,b),0===a&&setTimeout(k.hitch(this,function(){this.sourceList.selectRow(d.tr)}),
100)):console.error("add row failed ",d)}))},getConfig:function(b){this._currentSourceSetting&&this._closeSourceSetting(!0===b?!0:!1);var a={},d=this.sourceList.getRows(),c=[];f.forEach(d,k.hitch(this,function(a){var d=this._getRelatedConfig(a);b&&(delete d._definition,this._removeRelatedConfig(a));c.push(d)}));a.sources=c;return a},destroy:function(){d.setMap(null);d.setLayerInfosObj(null);d.setAppConfig(null);this.inherited(arguments)},validate:function(){return!0},_onMenuItemClick:function(b){this._currentSourceSetting&&
!this._currentSourceSetting.isValidConfig()?this._currentSourceSetting.showValidationTip():(b=b&&b.target&&t.getAttr(b.target,"type"),"locator"===b?this._addNewLocator():"query"===b&&this._addNewQuerySource())},_addNewLocator:function(){this._createNewLocatorSourceSettingFromMenuItem({},{})},_addNewQuerySource:function(){this._createNewQuerySourceSettingFromMenuItem({},{})},_setRelatedConfig:function(b,a){u(b).data("config",k.clone(a))},_getRelatedConfig:function(b){return u(b).data("config")[0]},
_removeRelatedConfig:function(b){return u(b).removeData("config")},_createNewLocatorSourceSettingFromMenuItem:function(b,a){var d=new y({nls:this.nls,map:this.map});d.setDefinition(a);b={url:b.url||"",name:b.name||"",singleLineFieldName:b.singleLineFieldName||"",placeholder:b.placeholder||"",countryCode:b.countryCode||"",maxSuggestions:b.maxSuggestions,searchInCurrentMapExtent:!!b.searchInCurrentMapExtent,type:"locator",maxLocations:b.maxLocations,autoComplete:b.autoComplete,searchDelay:b.searchDelay,
minCharacters:b.minCharacters,_isUpgrade:b._isUpgrade};this._upgradeGeocoderConfig(b);d.setConfig(b);d._openLocatorChooser();d.own(l(d,"select-locator-url-ok",k.hitch(this,function(b){(b=this.sourceList.addRow({name:b.name||"New Geocoder",type:"locator"},this.sourceList.getRows().length))&&b.success&&(this._currentSourceSetting&&this._closeSourceSetting(),d.setRelatedTr(b.tr),d.placeAt(this.sourceSettingNode),this.sourceList.selectRow(b.tr),this._currentSourceSetting=d,this._checkConfig())})));d.own(l(d,
"reselect-locator-url-ok",k.hitch(this,function(b){var a=this._currentSourceSetting.getRelatedTr();this.sourceList.editRow(a,{name:b.name,type:"locator"});this._checkConfig()})));d.own(l(d,"select-locator-url-cancel",k.hitch(this,function(){this._currentSourceSetting!==d&&(d.destroy(),d=null)})))},_createNewLocatorSourceSettingFromSourceList:function(b,a,d){this._currentSourceSetting&&this._closeSourceSetting();this._currentSourceSetting=new y({nls:this.nls,map:this.map});this._currentSourceSetting.setDefinition(a);
a={url:b.url||"",name:b.name||"",singleLineFieldName:b.singleLineFieldName||"",placeholder:b.placeholder||"",countryCode:b.countryCode||"",maxSuggestions:b.maxSuggestions,searchInCurrentMapExtent:!!b.searchInCurrentMapExtent,enableLocalSearch:!!b.enableLocalSearch,localSearchMinScale:b.localSearchMinScale,localSearchDistance:b.localSearchDistance,type:"locator",maxLocations:b.maxLocations,autoComplete:b.autoComplete,searchDelay:b.searchDelay,minCharacters:b.minCharacters,_isUpgrade:b._isUpgrade};
this._upgradeGeocoderConfig(a);this._currentSourceSetting.setConfig(a);this._currentSourceSetting.setRelatedTr(d);this._currentSourceSetting.placeAt(this.sourceSettingNode);this._currentSourceSetting._processlocalSearchTable(!!b.enableLocalSearch);this._currentSourceSetting.own(l(this._currentSourceSetting,"reselect-locator-url-ok",k.hitch(this,function(b){var a=this._currentSourceSetting.getRelatedTr();this.sourceList.editRow(a,{name:b.name,type:"locator"});this._checkConfig()})))},_closeSourceSetting:function(b){var a=
this._currentSourceSetting.getRelatedTr(),d=this._currentSourceSetting.getConfig();d._definition=this._currentSourceSetting.getDefinition();this._setRelatedConfig(a,d);this.sourceList.editRow(a,{name:d.name});"undefined"!==typeof b&&!0!==b||this._currentSourceSetting.destroy()},_createNewQuerySourceSettingFromMenuItem:function(b,d){var c=new a({nls:this.nls,map:this.map,appConfig:this.appConfig});c.setDefinition(d);b={url:b.url,name:b.name||"",layerId:b.layerId,placeholder:b.placeholder||"",searchFields:b.searchFields||
[],displayField:b.displayField||d.displayField||"",exactMatch:!!b.exactMatch,maxSuggestions:b.maxSuggestions,searchInCurrentMapExtent:!!b.searchInCurrentMapExtent,type:"query",maxLocations:b.maxLocations,autoComplete:b.autoComplete,searchDelay:b.searchDelay,minCharacters:b.minCharacters,_isUpgrade:b._isUpgrade};this._upgradeGeocoderConfig(b);c.setConfig(b);c._openQuerySourceChooser();c.own(l(c,"select-query-source-ok",k.hitch(this,function(b){(b=this.sourceList.addRow({name:b.name,type:"query"},0))&&
b.success&&(this._currentSourceSetting&&this._closeSourceSetting(),c.setRelatedTr(b.tr),c.placeAt(this.sourceSettingNode),this.sourceList.selectRow(b.tr),this._currentSourceSetting=c)})));c.own(l(c,"reselect-query-source-ok",k.hitch(this,function(b){var a=this._currentSourceSetting.getRelatedTr();this.sourceList.editRow(a,{name:b.name})})));c.own(l(c,"select-query-source-cancel",k.hitch(this,function(){this._currentSourceSetting!==c&&(c.destroy(),c=null)})))},_createNewQuerySourceSettingFromSourceList:function(b,
d,c){this._currentSourceSetting&&this._closeSourceSetting();this._currentSourceSetting=new a({nls:this.nls,map:this.map,appConfig:this.appConfig});this._currentSourceSetting.placeAt(this.sourceSettingNode);this._currentSourceSetting.setDefinition(d);b={url:b.url,name:b.name||"",layerId:b.layerId,placeholder:b.placeholder||"",searchFields:b.searchFields||[],displayField:b.displayField||d.displayField||"",exactMatch:!!b.exactMatch,maxSuggestions:b.maxSuggestions,searchInCurrentMapExtent:!!b.searchInCurrentMapExtent,
type:"query",maxLocations:b.maxLocations,autoComplete:b.autoComplete,searchDelay:b.searchDelay,minCharacters:b.minCharacters,_isUpgrade:b._isUpgrade};this._upgradeGeocoderConfig(b);this._currentSourceSetting.setConfig(b);this._currentSourceSetting.setRelatedTr(c);this._currentSourceSetting.own(l(this._currentSourceSetting,"reselect-query-source",k.hitch(this,function(b){var a=this._currentSourceSetting.getRelatedTr();this.sourceList.editRow(a,{name:b.name})})))},_onSourceItemRemoved:function(b){this._checkConfig();
this._currentSourceSetting&&this._currentSourceSetting.getRelatedTr()===b&&(this._currentSourceSetting.destroy(),this._currentSourceSetting=null)},_onSourceItemChanged:function(){this._checkConfig()},_checkConfig:function(){!1===this._hasGeoLocator()?this.emit("isConfigValid","false"):this.emit("isConfigValid","true")},_hasGeoLocator:function(){var b=!1,a=this.sourceList.getData();f.some(a,k.hitch(this,function(a){if(a&&"locator"===a.type)return b=!0}));return b},_onSourceItemSelected:function(b){var a=
this._getRelatedConfig(b),d=this._currentSourceSetting&&this._currentSourceSetting.tr;a&&b!==d&&(this._currentSourceSetting&&!this._currentSourceSetting.isValidConfig()?(this._currentSourceSetting.showValidationTip(),this.sourceList.selectRow(d)):"query"===a.type?this._createNewQuerySourceSettingFromSourceList(a,a._definition||{},b):"locator"===a.type&&this._createNewLocatorSourceSettingFromSourceList(a,a._definition||{},b))},_upgradeConfig:function(){var b=new h,a=[],c="";if(d.version.isConfigBefore63(this.config)&&
(a=this.config.geocoderOptions&&this.config.geocoderOptions.geocoders)&&0<a.length){var g=a[0];g&&g.url&&(c=g.url)}c?d.getSingleLineAddressName(c).then(k.hitch(this,function(a){if(a){var p=[];p.push({type:"locator",url:c,name:d.getGeocoderName(c),placeholder:g.placeholder||"",singleLineFieldName:a});this.config.searchOptions={};this.config.searchOptions.sources=p;b.resolve()}else null===a&&(b.resolve(null),new z({message:this.nls.locatorWarning}))}),k.hitch(this,function(){b.resolve(null)})):b.resolve(null);
return b},_upgradeGeocoderConfig:function(b){this.config.geocoderOptions&&(b._oldConfig={},this.config.geocoderOptions.geocoders[0]&&(b._oldConfig.placeholder=this.config.geocoderOptions.geocoders[0].placeholder||""),b._oldConfig.autoComplete=this.config.geocoderOptions.autoComplete,b._oldConfig.maxLocations=this.config.geocoderOptions.maxLocations,b._oldConfig.minCharacters=this.config.geocoderOptions.minCharacters,b._oldConfig.searchDelay=this.config.geocoderOptions.searchDelay)}})})},"widgets/Directions/setting/SearchConfig/QuerySourceSetting":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./QuerySourceSetting.html dojo/_base/lang dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented jimu/dijit/_FeaturelayerSourcePopup jimu/portalUrlUtils esri/request esri/lang jimu/utils jimu/dijit/Popup jimu/dijit/CheckBox jimu/dijit/LoadingShelter dijit/form/ValidationTextBox dojo/NodeList-data".split(" "),
function(m,k,l,t,u,f,e,c,n,r,v,a,y,w,x,h,d,g,z){return m([l,t,u,a],{baseClass:"jimu-widget-search-query-source-setting",templateString:f,nls:null,appConfig:null,map:null,tr:null,config:null,fieldsPopup:null,_layerDefinition:null,_fieldsCheckBox:null,_layerId:null,_suggestible:!1,_clickSet:!1,postCreate:function(){this.inherited(arguments);this.exactMatch=new z({checked:!1,label:this.nls.exactMatch},this.exactMatch);this.searchInCurrentMapExtent=new z({checked:!1,label:this.nls.searchInCurrentMapExtent},
this.searchInCurrentMapExtent);this._layerDefinition={};this._fieldsCheckBox=[];this._setMessageNodeContent("");this.autoComplete=new z({checked:!1,label:this.nls.autoComplete},this.autoComplete)},setDefinition:function(a){this._layerDefinition=a||{}},getDefinition:function(){return this._layerDefinition},setRelatedTr:function(a){this.tr=a},getRelatedTr:function(){return this.tr},setConfig:function(a){if("[object Object]"===Object.prototype.toString.call(a)){var b=a.url;b&&(this.config=a,this.shelter.show(),
this._layerDefinition.url!==b?this._getDefinitionFromRemote(b).then(e.hitch(this,function(a){b&&a&&"error"!==a.type?(this._layerDefinition=a,this._layerDefinition.url=b,this._setSourceItems(),this._setMessageNodeContent("")):b&&a&&"error"===a.type&&(this._setSourceItems(),this._disableSourceItems(),this._setMessageNodeContent(h.substitute({URL:a.url},e.clone(this.nls.invalidUrlTip)),!0));this.shelter.hide()})):(this._setMessageNodeContent(""),this._setSourceItems(),this.shelter.hide()))}},isValidConfig:function(){var a=
this.getConfig();return a.url&&a.name&&a.displayField?!0:!1},showValidationTip:function(){this._showValidationErrorTip(this.sourceUrl);this._showValidationErrorTip(this.sourceName)},getConfig:function(){var a={layerId:this._layerId,url:this.sourceUrl.get("value"),name:d.stripHTML(this.sourceName.get("value")),placeholder:d.stripHTML(this.placeholder.get("value")),searchFields:this._getSearchFields(),displayField:this.displayField.get("value"),exactMatch:this.exactMatch.getValue(),searchInCurrentMapExtent:this.searchInCurrentMapExtent.checked,
maxSuggestions:this.maxSuggestions.get("value")||6,type:"query",autoComplete:this.autoComplete?this.autoComplete.getValue():!0,searchDelay:this.searchDelay.get("value")||350,minCharacters:this.minCharacters.get("value")||3};!0===this.config._isUpgrade&&(a._isUpgrade=!0);return a},destroy:function(){this.inherited(arguments);this.fieldsPopup&&(this.fieldsPopup.close(),this.fieldsPopup=null);this.tr=this.nls=this.config=this._layerDefinition=null},_onSourceNameBlur:function(){this.sourceName.set("value",
d.stripHTML(this.sourceName.get("value")))},_onPlaceholderBlur:function(){this.placeholder.set("value",d.stripHTML(this.placeholder.get("value")))},_disableSourceItems:function(){this.sourceName.set("disabled",!0);this.placeholder.set("disabled",!0);this.searchFields.set("disabled",!0);k.setStyle(this.fieldsSelectorNode,"display","none");this.displayField.set("disabled",!0);this.maxSuggestions.set("disabled",!0);this.autoComplete.set("disabled",!0);this.searchDelay.set("disabled",!0);this.minCharacters.set("disabled",
!0)},_enableSourceItems:function(){this.sourceName.set("disabled",!1);this.placeholder.set("disabled",!1);this.searchFields.set("disabled",!1);k.setStyle(this.fieldsSelectorNode,"display","inline-block");this.displayField.set("disabled",!1);this.maxSuggestions.set("disabled",!1);this.autoComplete.set("disabled",!1);this.searchDelay.set("disabled",!1);this.minCharacters.set("disabled",!1)},_setSourceItems:function(){this.sourceUrl.set("value",this.config.url);this.sourceName.set("value",d.stripHTML(this.config.name||
""));this.placeholder.set("value",d.stripHTML(this.config.placeholder||""));this.maxSuggestions.set("value",this.config.maxSuggestions||6);this.autoComplete.setValue("undefined"!==this.config.autoComplete?this.config.autoComplete:!0);this.searchDelay.set("value",this.config.searchDelay||350);this.minCharacters.set("value",this.config.minCharacters||3);this.config._oldConfig&&!this.config._isUpgrade&&(this.config._oldConfig.placeholder&&this.placeholder.set("value",d.stripHTML(this.config._oldConfig.placeholder)),
this.config._oldConfig.maxLocations&&this.maxSuggestions.set("value",this.config._oldConfig.maxLocations),this.config._oldConfig.autoComplete&&this.autoComplete.setValue(this.config._oldConfig.autoComplete),this.config._oldConfig.searchDelay&&this.searchDelay.set("value",this.config._oldConfig.searchDelay),this.config._oldConfig.minCharacters&&this.minCharacters.set("value",this.config._oldConfig.minCharacters),this.config._isUpgrade=!0);this._setSearchFields2Node();this.searchFields.set("value",
this._getSearchFieldsAlias());this._setDisplayFieldOptions();this.displayField.set("value",this.config.displayField||"");this.exactMatch.setValue(!!this.config.exactMatch);this.searchInCurrentMapExtent.setValue(!!this.config.searchInCurrentMapExtent);this._layerId=this.config.layerId;(this._suggestible=this._layerDefinition&&this._layerDefinition.advancedQueryCapabilities&&this._layerDefinition.advancedQueryCapabilities.supportsPagination)?this._hideSuggestibleTips():this._showSuggestibleTips();this._enableSourceItems()},
_getDefinitionFromRemote:function(a){var b=new v,d=x({url:a,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});this.own(d);d.then(e.hitch(this,function(a){b.resolve(a)}),e.hitch(this,function(d){console.error(d);b.resolve({type:"error",url:this._getRequestUrl(a)})}));return b.promise},_setMessageNodeContent:function(a,b){k.empty(this.messageNode);a.nodeType||(a=k.toDom(a));k.place(a,this.messageNode);b?k.setStyle(this.messageTr,"display",""):k.setStyle(this.messageTr,"display","none")},
_getRequestUrl:function(a){var b=window.location.protocol;return"http:"===b?w.setHttpProtocol(a):"https:"===b?w.setHttpsProtocol(a):a},_setSearchFields2Node:function(){var a=null,b=this._layerDefinition&&this._layerDefinition.fields&&0<this._layerDefinition.fields.length;this.config&&this.config.searchFields&&0<this.config.searchFields.length||(a=[]);if(b)var d=this._layerDefinition.fields,a=c.filter(this.config.searchFields,function(b){return c.some(d,function(a){return a.name===b})});else a=this.config.searchFields;
this.searchFields.set("_fields",a)},_setDisplayFieldOptions:function(){var a=[];this._layerDefinition&&this._layerDefinition.fields&&0<this._layerDefinition.fields.length?a=c.map(this._layerDefinition.fields,function(b){return{label:b.alias||b.name||"",value:b.name||""}}):this.config&&this.config.displayField&&(a=[{label:this.config.displayField,value:this.config.displayField}]);this.displayField.set("options",a)},_getSearchFieldsAlias:function(){var a=this._getSearchFields();if(!(a&&0<a.length))return"";
if(this._layerDefinition&&this._layerDefinition.fields&&0<this._layerDefinition.fields.length){for(var b=this._layerDefinition.fields,d=c.map(b,function(b){return b&&b.name}),g=[],h=0,e=a.length;h<e;h++){var f=d.indexOf(a[h]);-1<f&&g.push(b[f].alias)}return g.join(",")}return a.join(",")},_getSearchFields:function(){return this.searchFields.get("_fields")},_setSearchFields:function(a){this.searchFields.set("_fields",a)},_onSetSourceClick:function(){this._clickSet=!0;this._openServiceChooser()},_openQuerySourceChooser:function(){this._clickSet=
!1;this._openServiceChooser()},_openServiceChooser:function(){var a=new y({titleLabel:this.nls.setLayerSource,dijitArgs:{multiple:!1,createMapResponse:this.map.webMapResponse,portalUrl:this.appConfig.portalUrl,style:{height:"100%"}}});n.once(a,"ok",e.hitch(this,function(b){a.close();this.setDefinition(b.definition||{});this.setConfig({layerId:b.layerInfo&&b.layerInfo.id||null,url:b.url,name:b.name||"",placeholder:"",searchFields:[],displayField:this._layerDefinition.displayField||"",exactMatch:!1,
maxSuggestions:6,type:"query"});a=null;this._setMessageNodeContent("");this._clickSet?this.emit("reselect-query-source-ok",b):this.emit("select-query-source-ok",b)}));n.once(a,"cancel",e.hitch(this,function(){a.close();a=null;this.emit("select-query-source-cancel")}))},_onFieldsSelectorClick:function(){var a=k.create("div",{style:{maxHeight:"480px"}}),b=this._layerDefinition.fields;this._fieldsCheckBox=[];c.forEach(b,e.hitch(this,function(b,d){var c=new z({checked:this._isSearchable(b),label:b.alias||
b.name});k.addClass(c.domNode,"fields-checkbox");k.addClass(c.labelNode,"jimu-ellipsis");k.setAttr(c.domNode,{title:b.alias||b.name});0===d%3&&(window.isRTL?k.setStyle(c.domNode,"marginRight",0):k.setStyle(c.domNode,"marginLeft",0));c.placeAt(a);r(c.domNode).data("fieldName",b.name);this._fieldsCheckBox.push(c)}));this.fieldsPopup=new g({titleLabel:this.nls.setSearchFields,autoHeight:!0,content:a,container:window.jimuConfig.layoutId,width:640,maxHeight:600,buttons:[{label:this.nls.ok,onClick:e.hitch(this,
"_onSearchFieldsOk")},{label:this.nls.cancel,classNames:["jimu-btn-vacation"]}],onClose:e.hitch(this,function(){this.fieldsPopup=null})});k.addClass(this.fieldsPopup.domNode,"direction-setting jimu-widget-search-query-source-setting-fields")},_onSearchFieldsOk:function(){var a=[];c.forEach(this._fieldsCheckBox,function(b){if(b.getValue()){var d=r(b.domNode).data("fieldName");a.push(d[0]);r(b.domNode).removeData()}});this._setSearchFields(a);this.searchFields.set("value",this._getSearchFieldsAlias());
this.fieldsPopup.close()},_isSearchable:function(a){var b=this._getSearchFields();return c.some(b,e.hitch(this,function(b){return a.name===b}))},_showSuggestibleTips:function(){k.addClass(this.tipsNode,"source-tips-show");k.setStyle(this.maxSuggestions.domNode,"display","none")},_hideSuggestibleTips:function(){k.removeClass(this.tipsNode,"source-tips-show");k.setStyle(this.maxSuggestions.domNode,"display","block")},_showValidationErrorTip:function(a){if(!a.validate()&&a.domNode&&a.focusNode){var b=
a.get("disabled");b&&a.set("disabled",!1);a.focusNode.focus();setTimeout(e.hitch(this,function(){a.focusNode.blur();b&&a.set("disabled",!0);a=null}),100)}}})})},"jimu/dijit/_FeaturelayerSourcePopup":function(){define("dojo/_base/declare dojo/Evented dojo/on dojo/_base/lang dojo/_base/html jimu/dijit/Popup jimu/dijit/FeaturelayerSource jimu/dijit/LoadingIndicator esri/request".split(" "),function(m,k,l,t,u,f,e,c,n){return m([f,k],{width:830,height:560,titleLabel:"",dijitArgs:null,postCreate:function(){this.inherited(arguments);
u.addClass(this.domNode,"jimu-featurelayer-source-popup");this._initFls();this._initLoading()},getSelectedRadioType:function(){return this.fls.getSelectedRadioType()},_initFls:function(){this.fls=new e(this.dijitArgs);this.fls.placeAt(this.contentContainerNode);this.fls.startup();this.own(l(this.fls,"ok",t.hitch(this,function(c){if(0!==c.length){var e=c[0];if(e.definition)try{e.definition.name=e.name,e.definition.url=e.url,this.emit("ok",e)}catch(a){console.error(a)}else this.loading.show(),n({url:e.url,
content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(t.hitch(this,function(a){if(this.domNode){this.loading.hide();e.definition=a;try{e.definition.name=e.name,e.definition.url=e.url,this.emit("ok",e)}catch(y){console.error(y)}}}),t.hitch(this,function(a){console.error(a);this.domNode&&this.loading.hide()}))}})));this.own(l(this.fls,"cancel",t.hitch(this,function(){try{this.emit("cancel")}catch(r){console.error(r)}})))},_initLoading:function(){this.loading=new c({hidden:!0});this.loading.placeAt(this.domNode);
this.loading.startup()}})})},"jimu/dijit/FeaturelayerSource":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FeaturelayerSource.html dojo/_base/lang dojo/_base/html dojo/on dojo/Evented jimu/dijit/RadioBtn jimu/dijit/_FeaturelayerChooserWithButtons jimu/dijit/FeaturelayerChooserFromPortal jimu/dijit/_FeaturelayerServiceChooserContent jimu/portalUrlUtils".split(" "),function(m,k,l,t,u,f,e,c,n,r,v,a,y,w){return m([k,l,
t,n],{templateString:u,baseClass:"jimu-layer-source jimu-featurelayer-source",declaredClass:"jimu.dijit.FeaturelayerSource",nls:null,multiple:!1,createMapResponse:null,portalUrl:null,layerChooserFromMap:null,postMixInProperties:function(){this.nls=window.jimuNls.featureLayerSource;this.portalUrl=w.getStandardPortalUrl(this.portalUrl)},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedRadioType:function(){if(this.mapRadio.checked)return"map";if(this.portalRadio.checked)return"portal";
if(this.urlRadio.checked)return"url"},getSelectedItems:function(){var a=[];this.mapRadio.checked?a=this.flcMap.getSelectedItems():this.portalRadio.checked?a=this.flcPortal.getSelectedItems():this.urlRadio.checked&&(a=this.flcUrl.getSelectedItems());return a},startup:function(){this.inherited(arguments);this.flcMap.startup();this.flcPortal.startup();this.flcUrl.startup()},_initSelf:function(){this._initRadios();this._createFeaturelayerChooserWithButtons();this._createFeaturelayerChooserFromPortal();
this._createFeaturelayerServiceChooserContent();this._onRadioClicked()},_createFeaturelayerChooserWithButtons:function(){this.flcMap=new v({style:{width:"100%",height:"100%"},multiple:this.multiple,createMapResponse:this.createMapResponse,onlyShowWebMapLayers:!0,layerChooserFromMap:this.layerChooserFromMap});this.flcMap.operationTip=this.nls.selectLayer;this.flcMap.placeAt(this.flcContainer);this.own(c(this.flcMap,"ok",f.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(c(this.flcMap,
"cancel",f.hitch(this,function(){this.emit("cancel")})))},_createFeaturelayerChooserFromPortal:function(){this.flcPortal=new a({multiple:this.multiple,portalUrl:this.portalUrl,style:{width:"100%",height:"100%"}});this.flcPortal.operationTip=this.nls.chooseItem;this.flcPortal.placeAt(this.hflcContainer);this.own(c(this.flcPortal,"next",f.hitch(this,function(){this.flcPortal.operationTip=this.nls.chooseItem+" -\x3e "+this.nls.chooseLayer;this._updateOperationTip()})));this.own(c(this.flcPortal,"back",
f.hitch(this,function(){this.flcPortal.operationTip=this.nls.chooseItem;this._updateOperationTip()})));this.own(c(this.flcPortal,"ok",f.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(c(this.flcPortal,"cancel",f.hitch(this,function(){this.emit("cancel")})));0<=(this.portalUrl||"").toLowerCase().indexOf(".arcgis.com")?this.portalLabel.innerHTML=this.nls.selectFromOnline:this.portalLabel.innerHTML=this.nls.selectFromPortal},_createFeaturelayerServiceChooserContent:function(){this.flcUrl=
new y({multiple:this.multiple,style:{width:"100%",height:"100%"}});this.flcUrl.operationTip=this.nls.setServiceUrl;this.flcUrl.placeAt(this.flscContainer);this.own(c(this.flcUrl,"ok",f.hitch(this,function(a){a&&0<a.length&&this.emit("ok",a)})));this.own(c(this.flcUrl,"cancel",f.hitch(this,function(){this.emit("cancel")})))},_initRadios:function(){var a="featureLayerSourceRadios_"+this._getRandomString(),h=f.hitch(this,this._onRadioClicked);this.mapRadio=new r({group:a,onStateChange:h,checked:!0});
this.mapRadio.placeAt(this.mapTd,"first");this.portalRadio=new r({group:a,onStateChange:h,checked:!1});this.portalRadio.placeAt(this.portalTd,"first");this.urlRadio=new r({group:a,onStateChange:h,checked:!1});this.urlRadio.placeAt(this.urlTd,"first");this.own(c(this.mapLabel,"click",f.hitch(this,function(){this.mapRadio.check()})));this.own(c(this.portalLabel,"click",f.hitch(this,function(){this.portalRadio.check()})));this.own(c(this.urlLabel,"click",f.hitch(this,function(){this.urlRadio.check()})))},
_getRandomString:function(){var a=Math.random().toString();return a=a.slice(2,a.length)},_onRadioClicked:function(){e.setStyle(this.flcContainer,"display","none");e.setStyle(this.hflcContainer,"display","none");e.setStyle(this.flscContainer,"display","none");this.mapRadio.checked?(e.setStyle(this.flcContainer,"display","block"),this.operationTip.innerHTML=this.nls.selectLayer):this.portalRadio.checked?(e.setStyle(this.hflcContainer,"display","block"),this.operationTip.innerHTML=this.nls.chooseItem):
this.urlRadio.checked&&(e.setStyle(this.flscContainer,"display","block"),this.operationTip.innerHTML=this.nls.setServiceUrl);this._updateOperationTip()},_updateOperationTip:function(){this.mapRadio.checked?this.operationTip.innerHTML=this.flcMap.operationTip:this.portalRadio.checked?this.operationTip.innerHTML=this.flcPortal.operationTip:this.urlRadio.checked&&(this.operationTip.innerHTML=this.flcUrl.operationTip)}})})},"jimu/dijit/_FeaturelayerChooserWithButtons":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin jimu/dijit/FeaturelayerChooserFromMap".split(" "),
function(m,k,l,t,u,f,e,c,n){return u([f,e,c,k],{baseClass:"jimu-layer-chooser-with-buttons jimu-feature-layer-chooser-with-buttons",declaredClass:"jimu.dijit.FeaturelayerChooserWithButtons",templateString:'\x3cdiv\x3e\x3cdiv class\x3d"chooser-container" data-dojo-attach-point\x3d"chooserContainer"\x3e\x3c/div\x3e\x3cdiv class\x3d"footer"\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel"\x3e${nls.cancel}\x3c/div\x3e\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-trailing-margin1 jimu-state-disabled" data-dojo-attach-point\x3d"btnOk"\x3e${nls.ok}\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e',
layerChooserFromMap:null,constructor:function(c){this.options=c},postMixInProperties:function(){this.nls=l.clone(window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.layerChooser=this.layerChooserFromMap?this.layerChooserFromMap:new n(this.options);this.layerChooser.placeAt(this.chooserContainer);t.setStyle(this.layerChooser.domNode,{width:"100%",height:"100%"});this.own(m(this.layerChooser,"tree-click",l.hitch(this,function(){0<this.getSelectedItems().length?t.removeClass(this.btnOk,
"jimu-state-disabled"):t.addClass(this.btnOk,"jimu-state-disabled")})));this.own(m(this.btnOk,"click",l.hitch(this,function(){var c=this.getSelectedItems();0<c.length&&this.emit("ok",c)})));this.own(m(this.btnCancel,"click",l.hitch(this,function(){this.emit("cancel")})))},getSelectedItems:function(){return this.layerChooser.getSelectedItems()},startup:function(){this.inherited(arguments);this.layerChooser.startup()}})})},"jimu/dijit/FeaturelayerChooserFromMap":function(){define(["dojo/_base/declare",
"dojo/Deferred","dojo/_base/html","dojo/_base/lang","./LayerChooserFromMap"],function(m,k,l,t,u){return m([u],{baseClass:"jimu-featurelayer-chooser-from-map",declaredClass:"jimu.dijit.FeaturelayerChooserFromMap",types:null,showLayerFromFeatureSet:!1,showTable:!1,onlyShowVisible:!1,ignoredFeaturelayerIds:null,mustSupportStatistics:!1,ignoreVirtualLayer:!1,postMixInProperties:function(){this.inherited(arguments);this.ignoredFeaturelayerIds||(this.ignoredFeaturelayerIds=[]);this.basicFilter=t.hitch(this,
this.basicFilter);this.filter=u.createFeaturelayerFilter(this.types,this.showLayerFromFeatureSet,this.showTable,this.mustSupportStatistics);this.ignoreVirtualLayer&&(this.filter=u.andCombineFilters([this.filter,t.hitch(this,this._ignoreVirtualLayerFilter)]))},postCreate:function(){this.inherited(arguments);l.addClass(this.domNode,"jimu-basic-layer-chooser-from-map")},_ignoreVirtualLayerFilter:function(f){return f.getLayerType().then(function(e){return!("ArcGISDynamicMapServiceLayer"===e||"ArcGISTiledMapServiceLayer"===
e||"GroupLayer"===e)})},basicFilter:function(f){var e=new k;0<=this.ignoredFeaturelayerIds.indexOf(f.id)?e.resolve(!1):this.onlyShowVisible&&"Table"!==f.getLayerType()?e.resolve(f.isShowInMap()):e.resolve(!0);return e},getHandledItem:function(f){var e=this.inherited(arguments),c=f&&f.layerInfo,c=c&&c.layerObject;e.url=c&&c.url||"";return e}})})},"jimu/dijit/LayerChooserFromMap":function(){define("dojo/on dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/store/Memory dojo/Deferred dojo/store/Observable dijit/tree/ObjectStoreModel dojo/promise/all dojo/_base/lang dojo/_base/html dojo/_base/array jimu/utils jimu/dijit/_Tree jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator".split(" "),
function(m,k,l,t,u,f,e,c,n,r,v,a,y,w,x,h,d,g){var z=l([t,u,f,k],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"errorTipSection" class\x3d"error-tip-section"\x3e\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\x3cspan class\x3d"jimu-state-error-text" data-dojo-attach-point\x3d"errTip"\x3e${nls.noLayersTip}\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_treeClass:"layer-chooser-tree",createMapResponse:null,multiple:!1,onlyShowVisible:!1,
updateWhenLayerInfosIsShowInMapChanged:!1,onlyShowWebMapLayers:!1,displayTooltipForTreeNode:!1,postMixInProperties:function(){this.nls=window.jimuNls.basicLayerChooserFromMap},postCreate:function(){this.inherited(arguments);y.addClass(this.domNode,"jimu-basic-layer-chooser-from-map");this.multiple=!!this.multiple;this.shelter=new g({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this._createTree();this.basicFilter=a.hitch(this,this.basicFilter);this.filter=z.andCombineFilters([this.basicFilter,
this.filter]);this.createMapResponse&&this.setCreateMapResponse(this.createMapResponse)},basicFilter:function(a){var b=new c;this.onlyShowVisible?b.resolve(a.isShowInMap()):b.resolve(!0);return b},filter:function(a){a=new c;a.resolve(!0);return a},getSelectedItems:function(){var d=this.tree.getSelectedItems();return w.map(d,a.hitch(this,function(b){return this.getHandledItem(b)}))},getAllItems:function(){var d=this.tree.getAllItems(),b=[];w.forEach(d,a.hitch(this,function(a){"root"!==a.id&&(a=this.getHandledItem(a),
b.push(a))}));return b},getHandledItem:function(a){return{name:a.name,layerInfo:a.layerInfo}},_isLeafItem:function(a){return a.isLeaf},setCreateMapResponse:function(c){this.createMapResponse=c;d.getInstance(this.createMapResponse.map,this.createMapResponse.itemInfo).then(a.hitch(this,function(b){this.layerInfosObj=b;this.own(m(this.layerInfosObj,"layerInfosChanged",a.hitch(this,this._onLayerInfosChanged)));this.updateWhenLayerInfosIsShowInMapChanged&&this.own(m(this.layerInfosObj,"layerInfosIsShowInMapChanged",
a.hitch(this,this._onLayerInfosIsShowInMapChanged)));this._buildTree(this.layerInfosObj)}))},_onLayerInfosChanged:function(a,b){this._buildTree(this.layerInfosObj);this.emit("update")},_onLayerInfosIsShowInMapChanged:function(a){this._buildTree(this.layerInfosObj);this.emit("update")},_buildTree:function(d){this._clear();y.setStyle(this.errorTipSection,"display","block");var b=[];this.onlyShowWebMapLayers?(b=d.getLayerInfoArrayOfWebmap(),b=b.concat(d.getTableInfoArrayOfWebmap())):(b=d.getLayerInfoArray(),
b=b.concat(d.getTableInfoArray()));0!==b.length&&(y.setStyle(this.errorTipSection,"display","none"),w.forEach(b,a.hitch(this,function(b){this._addDirectLayerInfo(b)})))},_addDirectLayerInfo:function(d){d&&d.getLayerObject().then(a.hitch(this,function(){this._addItem("root",d)}),a.hitch(this,function(b){console.error(b)}))},_clear:function(){var d=this._store.query({parent:"root"});w.forEach(d,a.hitch(this,function(b){b&&"root"!==b.id&&this._store.remove(b.id)}))},_addItem:function(d,b){var c=null,
g=b.getLayerType(),h=this.filter(b);v({layerType:g,valid:h}).then(a.hitch(this,function(g){if(g.valid){var h=a.hitch(this,function(a,h){this._id++;c={name:b.title||"",parent:d,layerInfo:b,type:g.layerType,layerClass:b.layerObject.declaredClass,id:this._id.toString(),isLeaf:a,hasChildren:h};this._store.add(c)}),e=b.getSubLayers(),f=0===e.length;f?h(f,!1):(e=w.map(e,a.hitch(this,function(b){return this.filter(b)})),v(e).then(a.hitch(this,function(b){(b=w.some(b,function(b){return b}))&&h(f,b)})))}}))},
_getRootItem:function(){return{id:"root",name:"Map Root",type:"root",isLeaf:!1,hasChildren:!0}},_createTree:function(){var d=this._getRootItem(),d=new e({data:[d],getChildren:function(b){return this.query({parent:b.id})}});this._store=new n(d);d=new r({store:this._store,query:{id:"root"},mayHaveChildren:a.hitch(this,this._mayHaveChildren)});this.tree=new h({multiple:this.multiple,model:d,showRoot:!1,isLeafItem:a.hitch(this,this._isLeafItem),style:{width:"100%"},onOpen:a.hitch(this,function(b,a){"root"!==
b.id&&this._onTreeOpen(b,a)}),onClick:a.hitch(this,function(b,a,d){this._onTreeClick(b,a,d);this.emit("tree-click",b,a,d)}),getIconStyle:a.hitch(this,function(b,a){var d=null;if(!b||"root"===b.id)return null;var c={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},g=window.location.protocol+"//"+window.location.host+require.toUrl("jimu");if(b=this._getIconInfo(b,a).imageName)c.backgroundImage="url("+g+"/css/images/"+b+")",d=c;return d}),
getIconClass:a.hitch(this,function(b,a){return this._getIconInfo(b,a).className}),getTooltip:a.hitch(this,function(b){return this.displayTooltipForTreeNode?b.layerInfo.title:""})});y.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.shelter.domNode,"before")},_mayHaveChildren:function(a){return a.hasChildren},_getIconInfo:function(a,b){var d="",c="";"ArcGISDynamicMapServiceLayer"===a.type||"ArcGISTiledMapServiceLayer"===a.type?b?(d="mapserver_open.png",c="mapservice-layer-icon open"):
(d="mapserver_close.png",c="mapservice-layer-icon close"):"GroupLayer"===a.type?b?(d="group_layer2.png",c="group-layer-icon open"):(d="group_layer1.png",c="group-layer-icon close"):"FeatureLayer"===a.type?(a=x.getTypeByGeometryType(a.layerInfo.layerObject.geometryType),"point"===a?(d="point_layer1.png",c="point-layer-icon"):"polyline"===a?(d="line_layer1.png",c="line-layer-icon"):"polygon"===a&&(d="polygon_layer1.png",c="polygon-layer-icon")):"Table"===a.type?(d="table.png",c="table-icon"):"ArcGISImageServiceLayer"===
a.type||"ArcGISImageServiceVectorLayer"===a.type?(d="image_layer.png",c="iamge-layer-icon"):b?(d="mapserver_open.png",c="mapservice-layer-icon open"):(d="mapserver_close.png",c="mapservice-layer-icon close");return{imageName:d,className:c}},_onTreeOpen:function(d,b){if("root"!==d.id){var c=[];b=[];c=d.layerInfo.getSubLayers();d.checked||(this.shelter.show(),b=w.map(c,a.hitch(this,function(b){return b.getLayerObject()})),v(b).then(a.hitch(this,function(){this.domNode&&(w.forEach(c,a.hitch(this,function(b){this._addItem(d.id,
b)})),d.checked=!0,this.shelter.hide())}),a.hitch(this,function(b){console.error(b);this.shelter.hide()})))}},_onTreeClick:function(a,b,d){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.tree&&this.tree.destroy();this.inherited(arguments)}});z.createFilterByLayerType=function(d){a.isArrayLike(d)||(d=[]);return function(b){var a=new c;if(0===d.length)a.resolve(!0);else{var g=[];b.traversal(function(b){g.push(b.getLayerType())});v(g).then(function(b){for(var c=0;c<
b.length;c++)for(var g=0;g<d.length;g++)if(b[c]===d[g]){a.resolve(!0);return}a.resolve(!1)},function(b){console.error(b);a.reject(b)})}return a}};z.createFeaturelayerFilter=function(a,b,d,c){var g=["point","polyline","polygon"];a&&0<a.length?(a=w.filter(a,function(b){return 0<=g.indexOf(b)}),0===a.length&&(a=g)):a=g;return function(g){var h=g.getLayerType();g=g.getLayerObject();return v({layerType:h,layerObject:g}).then(function(g){var h=g.layerType;g=g.layerObject;if("ArcGISDynamicMapServiceLayer"===
h||"ArcGISTiledMapServiceLayer"===h||"GroupLayer"===h||"FeatureCollection"===h)return!0;if("FeatureLayer"===h){var h=x.getTypeByGeometryType(g.geometryType),h=0<=w.indexOf(a,h),e=z._shouldPassStatisticsCheck(c,g);return g.url?(g=x.isFeaturelayerUrlSupportQuery(g.url,g.capabilities),h&&g&&e):b&&h}return"Table"===h?(h=x.isFeaturelayerUrlSupportQuery(g.url,g.capabilities),g=z._shouldPassStatisticsCheck(c,g),d&&h&&g):!1})}};z.createImageServiceLayerFilter=function(a,b){return function(d){var c=d.getLayerType();
d=d.getLayerObject();return v({layerType:c,layerObject:d}).then(function(d){var c=d.layerType,g=d.layerObject;return"ArcGISImageServiceLayer"===c||"ArcGISImageServiceVectorLayer"===c?a?x.isImageServiceSupportQuery(d.layerObject.capabilities)?b?z._shouldPassStatisticsCheck(b,g):!0:!1:!0:!1})}};z._shouldPassStatisticsCheck=function(a,b){return a?(a=!1,a=b.advancedQueryCapabilities?!!b.advancedQueryCapabilities.supportsStatistics:!!b.supportsStatistics):!0};z.createQueryableLayerFilter=function(a){var b=
z.createFeaturelayerFilter(["point","polyline","polygon"],!1,!0,a);a=z.createImageServiceLayerFilter(!0,a);return z.orCombineFilters([b,a])};z.andCombineFilters=function(a){return z._combineFilters(a,!0)};z.orCombineFilters=function(a){return z._combineFilters(a,!1)};z._combineFilters=function(a,b){return function(d){var g=new c,h=w.map(a,function(b){return b(d)});v(h).then(function(a){var d=!1,d=b?w.every(a,function(b){return b}):w.some(a,function(b){return b});g.resolve(d)},function(b){console.error(b);
g.reject(b)});return g}};return z})},"dijit/tree/ObjectStoreModel":function(){define("dojo/_base/array dojo/aspect dojo/_base/declare dojo/Deferred dojo/_base/lang dojo/when ../Destroyable".split(" "),function(m,k,l,t,u,f,e){return l("dijit.tree.ObjectStoreModel",e,{store:null,labelAttr:"name",labelType:"text",root:null,query:null,constructor:function(c){u.mixin(this,c);this.childrenCache={}},getRoot:function(c,e){if(this.root)c(this.root);else{var n=this.store.query(this.query);n.then&&this.own(n);
f(n,u.hitch(this,function(e){if(1!=e.length)throw Error("dijit.tree.ObjectStoreModel: root query returned "+e.length+" items, but must return exactly one");this.root=e[0];c(this.root);n.observe&&n.observe(u.hitch(this,function(a){this.onChange(a)}),!0)}),e)}},mayHaveChildren:function(){return!0},getChildren:function(c,e,r){var n=this.store.getIdentity(c);if(this.childrenCache[n])f(this.childrenCache[n],e,r);else{var a=this.childrenCache[n]=this.store.getChildren(c);a.then&&this.own(a);a.observe&&
this.own(a.observe(u.hitch(this,function(e,n,r){this.onChange(e);n!=r&&f(a,u.hitch(this,"onChildrenChange",c))}),!0));f(a,e,r)}},isItem:function(){return!0},getIdentity:function(c){return this.store.getIdentity(c)},getLabel:function(c){return c[this.labelAttr]},newItem:function(c,e,f,k){return this.store.put(c,{parent:e,before:k})},pasteItem:function(c,e,f,k,a,l){var n=new t;if(e===f&&!k&&!l)return n.resolve(!0),n;e&&!k?this.getChildren(e,u.hitch(this,function(a){a=[].concat(a);var h=m.indexOf(a,
c);a.splice(h,1);this.onChildrenChange(e,a);n.resolve(this.store.put(c,{overwrite:!0,parent:f,oldParent:e,before:l,isCopy:!1}))})):n.resolve(this.store.put(c,{overwrite:!0,parent:f,oldParent:e,before:l,isCopy:!0}));return n},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}})})},"jimu/dijit/_Tree":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dojo/text!./templates/_TreeNode.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/event dojo/query dojo/aspect dojo/on dojo/keys dojo/Evented dijit/registry dijit/Tree jimu/utils".split(" "),
function(m,k,l,t,u,f,e,c,n,r,v,a,y,w,x,h){var d=m([x._TreeNode,y],{templateString:t,declaredClass:"jimu._TreeNode",isLeaf:!1,groupId:"",postCreate:function(){this.inherited(arguments);f.addClass(this.domNode,"jimu-tree-node");this.isLeaf=!!this.isLeaf;this.groupId?(this.checkNode=f.toDom('\x3cinput type\x3d"radio" /\x3e'),this.checkNode.name=this.groupId):this.checkNode=f.toDom('\x3cinput type\x3d"checkbox" /\x3e');f.addClass(this.checkNode,"jimu-tree-check-node");f.place(this.checkNode,this.contentNode,
"first");this.own(v(this.checkNode,"click",u.hitch(this,this._onClick)));this.own(v(this.rowNode,"keydown",u.hitch(this,function(d,c){c.target=d;c.keyCode!==a.ENTER&&c.keyCode!==a.SPACE||this._onClick(c)},this.checkNode)));this.isLeaf?this.groupId?f.setStyle(this.checkNode,"display","none"):f.setStyle(this.checkNode,"display","inline"):f.setStyle(this.checkNode,"display","none");this.isLeaf?f.addClass(this.domNode,"jimu-tree-leaf-node"):f.addClass(this.domNode,"jimu-tree-not-leaf-node")},select:function(){this.isLeaf&&
(this.checkNode.checked=!0,f.addClass(this.domNode,"jimu-tree-selected-leaf-node"))},unselect:function(){this.isLeaf&&(this.checkNode.checked=!1,f.removeClass(this.domNode,"jimu-tree-selected-leaf-node"))},toggleSelect:function(){this.isLeaf&&(this.checkNode.checked?this.unselect():this.select())},_onClick:function(a){(a.target||a.srcElement)===this.checkNode?this.tree._onCheckNodeClick(this,this.checkNode.checked,a):this.tree._onClick(this,a)},_onChange:function(){this.isLeaf&&setTimeout(u.hitch(this,
function(){this.checkNode.checked?this.emit("tn-select",this):this.emit("tn-unselect",this)}),100)},destroy:function(){delete this.tree;this.inherited(arguments)}});return m([x,y],{declaredClass:"jimu._Tree",openOnClick:!0,multiple:!0,uniqueId:"",showRoot:!1,postMixInProperties:function(){this.inherited(arguments);this.uniqueId="tree_"+h.getRandomString()},postCreate:function(){this.inherited(arguments);f.addClass(this.domNode,"jimu-tree");this.own(r.before(this,"onClick",u.hitch(this,this._jimuBeforeClick)));
this.rootLoadingIndicator&&f.setStyle(this.rootLoadingIndicator,"display","none");this.dndController.singular=!0;f.setAttr(this.domNode,"tabindex",0)},removeItem:function(a){this.model.store.remove(a)},getAllItems:function(){var a=this.getAllTreeNodeWidgets();return e.map(a,u.hitch(this,function(a){var d=a.item;d.selected=a.checkNode.checked;return d}))},getSelectedItems:function(){var a=this.getAllTreeNodeWidgets(),a=e.filter(a,u.hitch(this,function(a){return a.checkNode.checked}));return e.map(a,
u.hitch(this,function(a){return a.item}))},getFilteredItems:function(a){var d=this.getAllTreeNodeWidgets(),d=e.map(d,u.hitch(this,function(a){var b=a.item;b.selected=a.checkNode.checked;return b}));return e.filter(d,u.hitch(this,function(d){return a(d)}))},getTreeNodeByItemId:function(a){for(var d=this._getAllTreeNodeDoms(),c=0;c<d.length;c++){var b=w.byNode(d[c]);if(b.item.id.toString()===a.toString())return b}return null},selectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&this.selectNodeWidget(a)},
unselectItem:function(a){(a=this.getTreeNodeByItemId(a))&&a.isLeaf&&a.unselect()},getAllLeafTreeNodeWidgets:function(){var a=this.getAllTreeNodeWidgets();return e.filter(a,u.hitch(this,function(a){return a.isLeaf}))},getAllTreeNodeWidgets:function(){var a=this._getAllTreeNodeDoms();return e.map(a,u.hitch(this,function(a){return w.byNode(a)}))},isLeafItem:function(a){return a&&a.isLeaf},_getAllTreeNodeDoms:function(){return n(".dijitTreeNode",this.domNode)},_createTreeNode:function(a){a.isLeaf=this.isLeafItem(a.item);
this.multiple||(a.groupId=this.uniqueId);return new d(a)},_onTreeNodeSelect:function(a){this.emit("item-select",{item:a.item,treeNode:a})},_onTreeNodeUnselect:function(a){this.emit("item-unselect",{item:a.item,treeNode:a})},selectNodeWidget:function(a){this.multiple||this.unselectAllLeafNodeWidgets();a.select()},_jimuBeforeClick:function(a,d,c){d.isLeaf&&(f.hasClass(c.target||c.srcElement,"jimu-tree-check-node")||(this.multiple?d.toggleSelect():this.selectNodeWidget(d)));return arguments},_onCheckNodeClick:function(a,
d,h){!this.multiple&&d&&this.unselectAllLeafNodeWidgets();c.stop(h);this.focusNode(a);setTimeout(u.hitch(this,function(){d?this.selectNodeWidget(a):a.unselect();this.onClick(a.item,a,h)}),0)},unselectAllLeafNodeWidgets:function(){var a=this.getAllLeafTreeNodeWidgets();e.forEach(a,u.hitch(this,function(a){a.unselect()}))}})})},"dijit/Tree":function(){define("dojo/_base/array dojo/aspect dojo/cookie dojo/_base/declare dojo/Deferred dojo/promise/all dojo/dom dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/errors/create dojo/fx dojo/has dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/topic dojo/touch dojo/when ./a11yclick ./focus ./registry ./_base/manager ./_Widget ./_TemplatedMixin ./_Container ./_Contained ./_CssStateMixin ./_KeyNavMixin dojo/text!./templates/TreeNode.html dojo/text!./templates/Tree.html ./tree/TreeStoreModel ./tree/ForestStoreModel ./tree/_dndSelector dojo/query!css2".split(" "),
function(m,k,l,t,u,f,e,c,n,r,v,a,y,w,x,h,d,g,z,p,b,B,E,C,F,M,N,I,G,L,Q,R,O,S,T){function D(b){return h.delegate(b.promise||b,{addCallback:function(b){this.then(b)},addErrback:function(b){this.otherwise(b)}})}var J=t("dijit._TreeNode",[F,M,N,I,G],{item:null,isTreeNode:!0,label:"",_setLabelAttr:function(b){this.labelNode["html"==this.labelType?"innerHTML":"innerText"in this.labelNode?"innerText":"textContent"]=b;this._set("label",b);y("dojo-bidi")&&this.applyTextDir(this.labelNode)},labelType:"text",
isExpandable:null,isExpanded:!1,state:"NotLoaded",templateString:Q,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);this.isExpandable&&this.labelNode.setAttribute("aria-expanded",this.isExpanded);this.setSelected(!1)},_setIndentAttr:function(b){var a=Math.max(b,0)*this.tree._nodePixelIndent+"px";r.set(this.domNode,
"backgroundPosition",a+" 0px");r.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",a);m.forEach(this.getChildren(),function(a){a.set("indent",b+1)});this._set("indent",b)},markProcessing:function(){this.state="Loading";this._setExpando(!0)},unmarkProcessing:function(){this._setExpando(!1)},_updateItemClasses:function(b){var a=this.tree,d=a.model;a._v10Compat&&b===d.root&&(b=null);this._applyClassAndStyle(b,"icon","Icon");this._applyClassAndStyle(b,"label","Label");this._applyClassAndStyle(b,
"row","Row");this.tree._startPaint(!0)},_applyClassAndStyle:function(b,a,d){var g="_"+a+"Class";a+="Node";var h=this[g];this[g]=this.tree["get"+d+"Class"](b,this.isExpanded);c.replace(this[a],this[g]||"",h||"");r.set(this[a],this.tree["get"+d+"Style"](b,this.isExpanded)||{})},_updateLayout:function(){var b=this.getParent(),b=!b||!b.rowNode||"none"==b.rowNode.style.display;c.toggle(this.domNode,"dijitTreeIsRoot",b);c.toggle(this.domNode,"dijitTreeIsLast",!b&&!this.getNextSibling())},_setExpando:function(b){var a=
["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"];b=b?0:this.isExpandable?this.isExpanded?1:2:3;c.replace(this.expandoNode,a[b],a);this.expandoNodeText.innerHTML=["*","-","+","*"][b]},expand:function(){if(this._expandDeferred)return D(this._expandDeferred);this._collapseDeferred&&(this._collapseDeferred.cancel(),delete this._collapseDeferred);this.isExpanded=!0;this.labelNode.setAttribute("aria-expanded","true");(this.tree.showRoot||this!==this.tree.rootNode)&&
this.containerNode.setAttribute("role","group");c.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","true");var b=a.wipeIn({node:this.containerNode,duration:C.defaultDuration}),d=this._expandDeferred=new u(function(){b.stop()});k.after(b,"onEnd",function(){d.resolve(!0)},!0);b.play();return D(d)},collapse:function(){if(this._collapseDeferred)return D(this._collapseDeferred);
this._expandDeferred&&(this._expandDeferred.cancel(),delete this._expandDeferred);this.isExpanded=!1;this.labelNode.setAttribute("aria-expanded","false");this==this.tree.rootNode&&this.tree.showRoot&&this.tree.domNode.setAttribute("aria-expanded","false");c.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);var b=a.wipeOut({node:this.containerNode,duration:C.defaultDuration}),d=this._collapseDeferred=new u(function(){b.stop()});k.after(b,"onEnd",
function(){d.resolve(!0)},!0);b.play();return D(d)},indent:0,setChildItems:function(b){var a=this.tree,d=a.model,c=[],g=a.focusedChild,h=this.getChildren();m.forEach(h,function(b){N.prototype.removeChild.call(this,b)},this);this.defer(function(){m.forEach(h,function(b){if(!b._destroyed&&!b.getParent()){var c=function(b){var g=d.getIdentity(b.item),h=a._itemNodesMap[g];1==h.length?delete a._itemNodesMap[g]:(g=m.indexOf(h,b),-1!=g&&h.splice(g,1));m.forEach(b.getChildren(),c)};a.dndController.removeTreeNode(b);
c(b);if(a.persist){var h=m.map(b.getTreePath(),function(b){return a.model.getIdentity(b)}).join("/"),f;for(f in a._openedNodes)f.substr(0,h.length)==h&&delete a._openedNodes[f];a._saveExpandedNodes()}a.lastFocusedChild&&!e.isDescendant(a.lastFocusedChild.domNode,a.domNode)&&delete a.lastFocusedChild;g&&!e.isDescendant(g.domNode,a.domNode)&&a.focus();b.destroyRecursive()}})});this.state="Loaded";b&&0<b.length?(this.isExpandable=!0,m.forEach(b,function(b){var g=d.getIdentity(b),h=a._itemNodesMap[g],
e;if(h)for(var f=0;f<h.length;f++)if(h[f]&&!h[f].getParent()){e=h[f];e.set("indent",this.indent+1);break}e||(e=this.tree._createTreeNode({item:b,tree:a,isExpandable:d.mayHaveChildren(b),label:a.getLabel(b),labelType:a.model&&a.model.labelType||"text",tooltip:a.getTooltip(b),ownerDocument:a.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir,indent:this.indent+1}),h?h.push(e):a._itemNodesMap[g]=[e]);this.addChild(e);(this.tree.autoExpand||this.tree._state(e))&&c.push(a._expandNode(e))},this),m.forEach(this.getChildren(),
function(b){b._updateLayout()})):this.isExpandable=!1;this._setExpando&&this._setExpando(!1);this._updateItemClasses(this.item);b=f(c);this.tree._startPaint(b);return D(b)},getTreePath:function(){for(var b=this,a=[];b&&b!==this.tree.rootNode;)a.unshift(b.item),b=b.getParent();a.unshift(this.tree.rootNode.item);return a},getIdentity:function(){return this.tree.model.getIdentity(this.item)},removeChild:function(b){this.inherited(arguments);var a=this.getChildren();0==a.length&&(this.isExpandable=!1,
this.collapse());m.forEach(a,function(b){b._updateLayout()})},makeExpandable:function(){this.isExpandable=!0;this._setExpando(!1)},setSelected:function(b){this.labelNode.setAttribute("aria-selected",b?"true":"false");c.toggle(this.rowNode,"dijitTreeRowSelected",b)},focus:function(){B.focus(this.focusNode)}});y("dojo-bidi")&&J.extend({_setTextDirAttr:function(b){!b||this.textDir==b&&this._created||(this._set("textDir",b),this.applyTextDir(this.labelNode),m.forEach(this.getChildren(),function(a){a.set("textDir",
b)},this))}});var H=t("dijit.Tree",[F,L,M,G],{baseClass:"dijitTree",store:null,model:null,query:null,label:"",showRoot:!0,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:!1,openOnDblClick:!1,templateString:R,persist:!1,autoExpand:!1,dndController:T,dndParams:"onDndDrop itemCreator onDndCancel checkAcceptance checkItemAcceptance dragThreshold betweenThreshold".split(" "),onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,
dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(b,a){g.publish(this.id,h.mixin({tree:this,event:b},a||{}))},postMixInProperties:function(){this.tree=this;this.autoExpand&&(this.persist=!1);this._itemNodesMap={};!this.cookieName&&this.id&&(this.cookieName=this.id+"SaveStateCookie");this.expandChildrenDeferred=new u;this.pendingCommandsPromise=this.expandChildrenDeferred.promise;this.inherited(arguments)},postCreate:function(){this._initState();var a=this;this.own(d(this.containerNode,
d.selector(".dijitTreeNode",z.enter),function(b){a._onNodeMouseEnter(E.byNode(this),b)}),d(this.containerNode,d.selector(".dijitTreeNode",z.leave),function(b){a._onNodeMouseLeave(E.byNode(this),b)}),d(this.containerNode,d.selector(".dijitTreeRow",b.press),function(b){a._onNodePress(E.getEnclosingWidget(this),b)}),d(this.containerNode,d.selector(".dijitTreeRow",b),function(b){a._onClick(E.getEnclosingWidget(this),b)}),d(this.containerNode,d.selector(".dijitTreeRow","dblclick"),function(b){a._onDblClick(E.getEnclosingWidget(this),
b)}));this.model||this._store2model();this.own(k.after(this.model,"onChange",h.hitch(this,"_onItemChange"),!0),k.after(this.model,"onChildrenChange",h.hitch(this,"_onItemChildrenChange"),!0),k.after(this.model,"onDelete",h.hitch(this,"_onItemDelete"),!0));this.inherited(arguments);if(this.dndController){h.isString(this.dndController)&&(this.dndController=h.getObject(this.dndController));for(var c={},g=0;g<this.dndParams.length;g++)this[this.dndParams[g]]&&(c[this.dndParams[g]]=this[this.dndParams[g]]);
this.dndController=new this.dndController(this,c)}this._load();this.onLoadDeferred=D(this.pendingCommandsPromise);this.onLoadDeferred.then(h.hitch(this,"onLoad"))},_store2model:function(){this._v10Compat=!0;w.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var b={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};this.params.mayHaveChildren&&(b.mayHaveChildren=h.hitch(this,"mayHaveChildren"));this.params.getItemChildren&&
(b.getChildren=h.hitch(this,function(b,a,d){this.getItemChildren(this._v10Compat&&b===this.model.root?null:b,a,d)}));this.model=new S(b);this.showRoot=!!this.label},onLoad:function(){},_load:function(){this.model.getRoot(h.hitch(this,function(b){var a=this.rootNode=this.tree._createTreeNode({item:b,tree:this,isExpandable:!0,label:this.label||this.getLabel(b),labelType:this.model.labelType||"text",textDir:this.textDir,indent:this.showRoot?0:-1});this.showRoot?(this.domNode.setAttribute("aria-multiselectable",
!this.dndController.singular),this.rootLoadingIndicator.style.display="none"):(a.rowNode.style.display="none",this.domNode.setAttribute("role","presentation"),this.domNode.removeAttribute("aria-expanded"),this.domNode.removeAttribute("aria-multiselectable"),this["aria-label"]?(a.containerNode.setAttribute("aria-label",this["aria-label"]),this.domNode.removeAttribute("aria-label")):this["aria-labelledby"]&&(a.containerNode.setAttribute("aria-labelledby",this["aria-labelledby"]),this.domNode.removeAttribute("aria-labelledby")),
a.labelNode.setAttribute("role","presentation"),a.labelNode.removeAttribute("aria-selected"),a.containerNode.setAttribute("role","tree"),a.containerNode.setAttribute("aria-expanded","true"),a.containerNode.setAttribute("aria-multiselectable",!this.dndController.singular));this.containerNode.appendChild(a.domNode);b=this.model.getIdentity(b);this._itemNodesMap[b]?this._itemNodesMap[b].push(a):this._itemNodesMap[b]=[a];a._updateLayout();this._expandNode(a).then(h.hitch(this,function(){this._destroyed||
(this.rootLoadingIndicator.style.display="none",this.expandChildrenDeferred.resolve(!0))}))}),h.hitch(this,function(b){console.error(this,": error loading root: ",b)}))},getNodesByItem:function(b){if(!b)return[];b=h.isString(b)?b:this.model.getIdentity(b);return[].concat(this._itemNodesMap[b])},_setSelectedItemAttr:function(b){this.set("selectedItems",[b])},_setSelectedItemsAttr:function(b){var a=this;return this.pendingCommandsPromise=this.pendingCommandsPromise.always(h.hitch(this,function(){var d=
m.map(b,function(b){return!b||h.isString(b)?b:a.model.getIdentity(b)}),c=[];m.forEach(d,function(b){c=c.concat(a._itemNodesMap[b]||[])});this.set("selectedNodes",c)}))},_setPathAttr:function(b){return b.length?D(this.set("paths",[b]).then(function(b){return b[0]})):D(this.set("paths",[]).then(function(b){return b[0]}))},_setPathsAttr:function(b){function a(b,c){var g=b.shift(),h=m.filter(c,function(b){return b.getIdentity()==g})[0];if(h)return b.length?d._expandNode(h).then(function(){return a(b,
h.getChildren())}):h;throw new H.PathError("Could not expand path at "+g);}var d=this;return D(this.pendingCommandsPromise=this.pendingCommandsPromise.always(function(){return f(m.map(b,function(b){b=m.map(b,function(b){return b&&h.isObject(b)?d.model.getIdentity(b):b});if(b.length)return a(b,[d.rootNode]);throw new H.PathError("Empty path");}))}).then(function(b){d.set("selectedNodes",b);return d.paths}))},_setSelectedNodeAttr:function(b){this.set("selectedNodes",[b])},_setSelectedNodesAttr:function(b){this.dndController.setSelection(b)},
expandAll:function(){function b(d){return a._expandNode(d).then(function(){var a=m.filter(d.getChildren()||[],function(b){return b.isExpandable});return f(m.map(a,b))})}var a=this;return D(b(this.rootNode))},collapseAll:function(){function b(d){var c=m.filter(d.getChildren()||[],function(b){return b.isExpandable}),c=f(m.map(c,b));return!d.isExpanded||d==a.rootNode&&!a.showRoot?c:c.then(function(){return a._collapseNode(d)})}var a=this;return D(b(this.rootNode))},mayHaveChildren:function(){},getItemChildren:function(){},
getLabel:function(b){return this.model.getLabel(b)},getIconClass:function(b,a){return!b||this.model.mayHaveChildren(b)?a?"dijitFolderOpened":"dijitFolderClosed":"dijitLeaf"},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return""},_onDownArrow:function(b,a){(b=this._getNext(a))&&b.isTreeNode&&this.focusNode(b)},_onUpArrow:function(b,a){if(b=a.getPreviousSibling())for(a=b;a.isExpandable&&a.isExpanded&&
a.hasChildren();)a=a.getChildren(),a=a[a.length-1];else if(b=a.getParent(),this.showRoot||b!==this.rootNode)a=b;a&&a.isTreeNode&&this.focusNode(a)},_onRightArrow:function(b,a){a.isExpandable&&!a.isExpanded?this._expandNode(a):a.hasChildren()&&(a=a.getChildren()[0])&&a.isTreeNode&&this.focusNode(a)},_onLeftArrow:function(b,a){a.isExpandable&&a.isExpanded?this._collapseNode(a):(b=a.getParent())&&b.isTreeNode&&(this.showRoot||b!==this.rootNode)&&this.focusNode(b)},focusLastChild:function(){var b=this._getLast();
b&&b.isTreeNode&&this.focusNode(b)},_getFirst:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0]},_getLast:function(){for(var b=this.rootNode;b.isExpanded;){var a=b.getChildren();if(!a.length)break;b=a[a.length-1]}return b},_getNext:function(b){if(b.isExpandable&&b.isExpanded&&b.hasChildren())return b.getChildren()[0];for(;b&&b.isTreeNode;){var a=b.getNextSibling();if(a)return a;b=b.getParent()}return null},childSelector:".dijitTreeRow",isExpandoNode:function(b,a){return e.isDescendant(b,
a.expandoNode)||e.isDescendant(b,a.expandoNodeText)},_onNodePress:function(b,a){this.focusNode(b)},__click:function(b,a,d,c){var g=this.isExpandoNode(a.target,b);b.isExpandable&&(d||g)?this._onExpandoClick({node:b}):(this._publish("execute",{item:b.item,node:b,evt:a}),this[c](b.item,b,a),this.focusNode(b));a.stopPropagation();a.preventDefault()},_onClick:function(b,a){this.__click(b,a,this.openOnClick,"onClick")},_onDblClick:function(b,a){this.__click(b,a,this.openOnDblClick,"onDblClick")},_onExpandoClick:function(b){b=
b.node;this.focusNode(b);b.isExpanded?this._collapseNode(b):this._expandNode(b)},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(b){w.deprecated(this.declaredClass+"::_getNextNode(node) is deprecated. Use _getNext(node) instead.","","2.0");return this._getNext(b)},_getRootOrFirstNode:function(){w.deprecated(this.declaredClass+"::_getRootOrFirstNode() is deprecated. Use _getFirst() instead.","","2.0");return this._getFirst()},_collapseNode:function(b){b._expandNodeDeferred&&
delete b._expandNodeDeferred;if("Loading"!=b.state&&b.isExpanded){var a=b.collapse();this.onClose(b.item,b);this._state(b,!1);this._startPaint(a);return a}},_expandNode:function(b){if(b._expandNodeDeferred)return b._expandNodeDeferred;var a=this.model,d=b.item,c=this;b._loadDeferred||(b.markProcessing(),b._loadDeferred=new u,a.getChildren(d,function(a){b.unmarkProcessing();b.setChildItems(a).then(function(){b._loadDeferred.resolve(a)})},function(a){console.error(c,": error loading "+b.label+" children: ",
a);b._loadDeferred.reject(a)}));a=b._loadDeferred.then(h.hitch(this,function(){var a=b.expand();this.onOpen(b.item,b);this._state(b,!0);return a}));this._startPaint(a);return a},focusNode:function(b){for(var a=[],d=this.domNode;d&&d.tagName&&"IFRAME"!==d.tagName.toUpperCase();d=d.parentNode)a.push({domNode:d.contentWindow||d,scrollLeft:d.scrollLeft||0,scrollTop:d.scrollTop||0});this.focusChild(b);this.defer(function(){for(var b=0,d=a.length;b<d;b++)a[b].domNode.scrollLeft=a[b].scrollLeft,a[b].domNode.scrollTop=
a[b].scrollTop},0)},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(b){var a=this.model.getIdentity(b);if(a=this._itemNodesMap[a]){var d=this.getLabel(b),c=this.getTooltip(b);m.forEach(a,function(a){a.set({item:b,label:d,tooltip:c});a._updateItemClasses(b)})}},_onItemChildrenChange:function(b,a){b=this.model.getIdentity(b);(b=this._itemNodesMap[b])&&m.forEach(b,function(b){b.setChildItems(a)})},_onItemDelete:function(b){b=this.model.getIdentity(b);var a=this._itemNodesMap[b];
a&&(m.forEach(a,function(b){this.dndController.removeTreeNode(b);var a=b.getParent();a&&a.removeChild(b);this.lastFocusedChild&&!e.isDescendant(this.lastFocusedChild.domNode,this.domNode)&&delete this.lastFocusedChild;this.focusedChild&&!e.isDescendant(this.focusedChild.domNode,this.domNode)&&this.focus();b.destroyRecursive()},this),delete this._itemNodesMap[b])},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var b=l(this.cookieName);b&&m.forEach(b.split(","),function(b){this._openedNodes[b]=
!0},this)}},_state:function(b,a){if(!this.persist)return!1;var d=m.map(b.getTreePath(),function(b){return this.model.getIdentity(b)},this).join("/");if(1===arguments.length)return this._openedNodes[d];a?this._openedNodes[d]=!0:delete this._openedNodes[d];this._saveExpandedNodes()},_saveExpandedNodes:function(){if(this.persist&&this.cookieName){var b=[],a;for(a in this._openedNodes)b.push(a);l(this.cookieName,b.join(","),{expires:365})}},destroy:function(){this._curSearch&&(this._curSearch.timer.remove(),
delete this._curSearch);this.rootNode&&this.rootNode.destroyRecursive();this.dndController&&!h.isString(this.dndController)&&this.dndController.destroy();this.rootNode=null;this.inherited(arguments)},destroyRecursive:function(){this.destroy()},resize:function(b){b&&n.setMarginBox(this.domNode,b);this._nodePixelIndent=n.position(this.tree.indentDetector).w||this._nodePixelIndent;this.expandChildrenDeferred.then(h.hitch(this,function(){this.rootNode.set("indent",this.showRoot?0:-1);this._adjustWidths()}))},
_outstandingPaintOperations:0,_startPaint:function(b){this._outstandingPaintOperations++;this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);var a=h.hitch(this,function(){this._outstandingPaintOperations--;0>=this._outstandingPaintOperations&&!this._adjustWidthsTimer&&this._started&&(this._adjustWidthsTimer=this.defer("_adjustWidths"))});p(b,a,a)},_adjustWidths:function(){this._adjustWidthsTimer&&(this._adjustWidthsTimer.remove(),delete this._adjustWidthsTimer);
this.containerNode.style.width="auto";this.containerNode.style.width=this.domNode.scrollWidth>this.domNode.offsetWidth?"auto":"100%"},_createTreeNode:function(b){return new J(b)},focus:function(){this.lastFocusedChild?this.focusNode(this.lastFocusedChild):this.focusFirstChild()}});y("dojo-bidi")&&H.extend({_setTextDirAttr:function(b){b&&this.textDir!=b&&(this._set("textDir",b),this.rootNode.set("textDir",b))}});H.PathError=v("TreePathError");H._TreeNode=J;return H})},"dijit/tree/TreeStoreModel":function(){define(["dojo/_base/array",
"dojo/aspect","dojo/_base/declare","dojo/_base/lang"],function(m,k,l,t){return l("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:!1,constructor:function(l){t.mixin(this,l);this.connects=[];l=this.store;if(!l.getFeatures()["dojo.data.api.Identity"])throw Error("dijit.tree.TreeStoreModel: store must support dojo.data.Identity");l.getFeatures()["dojo.data.api.Notification"]&&(this.connects=this.connects.concat([k.after(l,
"onNew",t.hitch(this,"onNewItem"),!0),k.after(l,"onDelete",t.hitch(this,"onDeleteItem"),!0),k.after(l,"onSet",t.hitch(this,"onSetItem"),!0)]))},destroy:function(){for(var k;k=this.connects.pop();)k.remove()},getRoot:function(k,f){this.root?k(this.root):this.store.fetch({query:this.query,onComplete:t.hitch(this,function(e){if(1!=e.length)throw Error("dijit.tree.TreeStoreModel: root query returned "+e.length+" items, but must return exactly one");this.root=e[0];k(this.root)}),onError:f})},mayHaveChildren:function(k){return m.some(this.childrenAttrs,
function(f){return this.store.hasAttribute(k,f)},this)},getChildren:function(k,f,e){var c=this.store;if(c.isItemLoaded(k)){for(var n=[],r=0;r<this.childrenAttrs.length;r++)var l=c.getValues(k,this.childrenAttrs[r]),n=n.concat(l);var a=0;this.deferItemLoadingUntilExpand||m.forEach(n,function(e){c.isItemLoaded(e)||a++});0==a?f(n):m.forEach(n,function(k,r){c.isItemLoaded(k)||c.loadItem({item:k,onItem:function(c){n[r]=c;0==--a&&f(n)},onError:e})})}else{var y=t.hitch(this,arguments.callee);c.loadItem({item:k,
onItem:function(a){y(a,f,e)},onError:e})}},isItem:function(k){return this.store.isItem(k)},fetchItemByIdentity:function(k){this.store.fetchItemByIdentity(k)},getIdentity:function(k){return this.store.getIdentity(k)},getLabel:function(k){return this.labelAttr?this.store.getValue(k,this.labelAttr):this.store.getLabel(k)},newItem:function(k,f,e){var c={parent:f,attribute:this.childrenAttrs[0]},n;this.newItemIdAttr&&k[this.newItemIdAttr]?this.fetchItemByIdentity({identity:k[this.newItemIdAttr],scope:this,
onItem:function(r){r?this.pasteItem(r,null,f,!0,e):(n=this.store.newItem(k,c))&&void 0!=e&&this.pasteItem(n,f,f,!1,e)}}):(n=this.store.newItem(k,c))&&void 0!=e&&this.pasteItem(n,f,f,!1,e)},pasteItem:function(k,f,e,c,n){var r=this.store,l=this.childrenAttrs[0];f&&m.forEach(this.childrenAttrs,function(a){if(r.containsValue(f,a,k)){if(!c){var e=m.filter(r.getValues(f,a),function(a){return a!=k});r.setValues(f,a,e)}l=a}});if(e)if("number"==typeof n){var a=r.getValues(e,l).slice();a.splice(n,0,k);r.setValues(e,
l,a)}else r.setValues(e,l,r.getValues(e,l).concat(k))},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(k,f){f&&this.getChildren(f.item,t.hitch(this,function(e){this.onChildrenChange(f.item,e)}))},onDeleteItem:function(k){this.onDelete(k)},onSetItem:function(k,f){if(-1!=m.indexOf(this.childrenAttrs,f))this.getChildren(k,t.hitch(this,function(e){this.onChildrenChange(k,e)}));else this.onChange(k)}})})},"dijit/tree/ForestStoreModel":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/kernel","dojo/_base/lang","./TreeStoreModel"],function(m,k,l,t,u){return k("dijit.tree.ForestStoreModel",u,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(f){this.root={store:this,root:!0,id:f.rootId,label:f.rootLabel,children:f.rootChildren}},mayHaveChildren:function(f){return f===this.root||this.inherited(arguments)},getChildren:function(f,e,c){f===this.root?this.root.children?e(this.root.children):this.store.fetch({query:this.query,onComplete:t.hitch(this,
function(c){this.root.children=c;e(c)}),onError:c}):this.inherited(arguments)},isItem:function(f){return f===this.root?!0:this.inherited(arguments)},fetchItemByIdentity:function(f){if(f.identity==this.root.id){var e=f.scope||l.global;f.onItem&&f.onItem.call(e,this.root)}else this.inherited(arguments)},getIdentity:function(f){return f===this.root?this.root.id:this.inherited(arguments)},getLabel:function(f){return f===this.root?this.root.label:this.inherited(arguments)},newItem:function(f,e,c){return e===
this.root?(this.onNewRootItem(f),this.store.newItem(f)):this.inherited(arguments)},onNewRootItem:function(){},pasteItem:function(f,e,c,k,r){if(e===this.root&&!k)this.onLeaveRoot(f);this.inherited(arguments,[f,e===this.root?null:e,c===this.root?null:c,k,r]);if(c===this.root)this.onAddToRoot(f)},onAddToRoot:function(f){console.log(this,": item ",f," added to root")},onLeaveRoot:function(f){console.log(this,": item ",f," removed from root")},_requeryTop:function(){var f=this.root.children||[];this.store.fetch({query:this.query,
onComplete:t.hitch(this,function(e){this.root.children=e;if(f.length!=e.length||m.some(f,function(c,f){return e[f]!=c}))this.onChildrenChange(this.root,e)})})},onNewItem:function(f,e){this._requeryTop();this.inherited(arguments)},onDeleteItem:function(f){-1!=m.indexOf(this.root.children,f)&&this._requeryTop();this.inherited(arguments)},onSetItem:function(f,e,c,k){this._requeryTop();this.inherited(arguments)}})})},"dijit/tree/_dndSelector":function(){define("dojo/_base/array dojo/_base/declare dojo/_base/kernel dojo/_base/lang dojo/dnd/common dojo/dom dojo/mouse dojo/on dojo/touch ../a11yclick ./_dndContainer".split(" "),
function(m,k,l,t,u,f,e,c,n,r,v){return k("dijit.tree._dndSelector",v,{constructor:function(){this.selection={};this.anchor=null;this.events.push(c(this.tree.domNode,n.press,t.hitch(this,"onMouseDown")),c(this.tree.domNode,n.release,t.hitch(this,"onMouseUp")),c(this.tree.domNode,n.move,t.hitch(this,"onMouseMove")),c(this.tree.domNode,r.press,t.hitch(this,"onClickPress")),c(this.tree.domNode,r.release,t.hitch(this,"onClickRelease")))},singular:!1,getSelectedTreeNodes:function(){var a=[],c=this.selection,
e;for(e in c)a.push(c[e]);return a},selectNone:function(){this.setSelection([]);return this},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null},addTreeNode:function(a,c){this.setSelection(this.getSelectedTreeNodes().concat([a]));c&&(this.anchor=a);return a},removeTreeNode:function(a){var c=m.filter(this.getSelectedTreeNodes(),function(c){return!f.isDescendant(c.domNode,a.domNode)});this.setSelection(c);return a},isTreeNodeSelected:function(a){return a.id&&!!this.selection[a.id]},
setSelection:function(a){var c=this.getSelectedTreeNodes();m.forEach(this._setDifference(c,a),t.hitch(this,function(a){a.setSelected(!1);this.anchor==a&&delete this.anchor;delete this.selection[a.id]}));m.forEach(this._setDifference(a,c),t.hitch(this,function(a){a.setSelected(!0);this.selection[a.id]=a}));this._updateSelectionProperties()},_setDifference:function(a,c){m.forEach(c,function(a){a.__exclude__=!0});a=m.filter(a,function(a){return!a.__exclude__});m.forEach(c,function(a){delete a.__exclude__});
return a},_updateSelectionProperties:function(){var a=this.getSelectedTreeNodes(),c=[],e=[];m.forEach(a,function(a){var h=a.getTreePath();e.push(a);c.push(h)},this);a=m.map(e,function(a){return a.item});this.tree._set("paths",c);this.tree._set("path",c[0]||[]);this.tree._set("selectedNodes",e);this.tree._set("selectedNode",e[0]||null);this.tree._set("selectedItems",a);this.tree._set("selectedItem",a[0]||null)},onClickPress:function(a){if(!(this.current&&this.current.isExpandable&&this.tree.isExpandoNode(a.target,
this.current))){"mousedown"==a.type&&e.isLeft(a)&&a.preventDefault();var c="keydown"==a.type?this.tree.focusedChild:this.current;if(c){var f=u.getCopyKeyState(a),k=c.id;this.singular||a.shiftKey||!this.selection[k]?(this._doDeselect=!1,this.userSelect(c,f,a.shiftKey)):this._doDeselect=!0}}},onClickRelease:function(a){this._doDeselect&&(this._doDeselect=!1,this.userSelect("keyup"==a.type?this.tree.focusedChild:this.current,u.getCopyKeyState(a),a.shiftKey))},onMouseMove:function(){this._doDeselect=
!1},onMouseDown:function(){},onMouseUp:function(){},_compareNodes:function(a,c){if(a===c)return 0;if("sourceIndex"in document.documentElement)return a.sourceIndex-c.sourceIndex;if("compareDocumentPosition"in document.documentElement)return a.compareDocumentPosition(c)&2?1:-1;if(document.createRange){var e=doc.createRange();e.setStartBefore(a);a=doc.createRange();a.setStartBefore(c);return e.compareBoundaryPoints(e.END_TO_END,a)}throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");
},userSelect:function(a,c,e){if(this.singular)this.anchor==a&&c?this.selectNone():(this.setSelection([a]),this.anchor=a);else if(e&&this.anchor){c=this._compareNodes(this.anchor.rowNode,a.rowNode);e=this.anchor;0>c?c=e:(c=a,a=e);for(e=[];c!=a;)e.push(c),c=this.tree._getNext(c);e.push(a);this.setSelection(e)}else this.selection[a.id]&&c?this.removeTreeNode(a):c?this.addTreeNode(a,!0):(this.setSelection([a]),this.anchor=a)},getItem:function(a){return{data:this.selection[a],type:["treeNode"]}},forInSelectedItems:function(a,
c){c=c||l.global;for(var e in this.selection)a.call(c,this.getItem(e),e,this)}})})},"dijit/tree/_dndContainer":function(){define("dojo/aspect dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/on dojo/touch".split(" "),function(m,k,l,t,u,f){return k("dijit.tree._dndContainer",null,{constructor:function(e,c){this.tree=e;this.node=e.domNode;t.mixin(this,c);this.containerState="";l.add(this.node,"dojoDndContainer");this.events=[u(this.node,f.enter,t.hitch(this,"onOverEvent")),u(this.node,f.leave,
t.hitch(this,"onOutEvent")),m.after(this.tree,"_onNodeMouseEnter",t.hitch(this,"onMouseOver"),!0),m.after(this.tree,"_onNodeMouseLeave",t.hitch(this,"onMouseOut"),!0),u(this.node,"dragstart, selectstart",function(c){c.preventDefault()})]},destroy:function(){for(var e;e=this.events.pop();)e.remove();this.node=this.parent=null},onMouseOver:function(e){this.current=e},onMouseOut:function(){this.current=null},_changeState:function(e,c){var f="dojoDnd"+e;e=e.toLowerCase()+"State";l.replace(this.node,f+
c,f+this[e]);this[e]=c},_addItemClass:function(e,c){l.add(e,"dojoDndItem"+c)},_removeItemClass:function(e,c){l.remove(e,"dojoDndItem"+c)},onOverEvent:function(){this._changeState("Container","Over")},onOutEvent:function(){this._changeState("Container","")}})})},"jimu/dijit/FeaturelayerChooserFromPortal":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/FeaturelayerChooserFromPortal.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/query dojo/Deferred dojo/Evented dojo/promise/all jimu/dijit/ItemSelector jimu/dijit/FeaturelayerServiceBrowser jimu/portalUrlUtils esri/request".split(" "),
function(m,k,l,t,u,f,e,c,n,r,v,a,y,w,x,h,d){return m([k,l,t,a],{templateString:u,declaredClass:"jimu.dijit.FeaturelayerChooserFromPortal",baseClass:"jimu-service-chooser-from-portal jimu-featurelayer-chooser-from-portal",_serviceBrowserDef:null,portalUrl:null,multiple:!1,postMixInProperties:function(){this.nls=f.mixin({},window.jimuNls.common);this.nls=f.mixin(this.nls,window.jimuNls.featureLayerChooserFromPortal);this.portalUrl=h.getStandardPortalUrl(this.portalUrl);this.multiple=!0===this.multiple?
!0:!1},postCreate:function(){this.inherited(arguments);this._initSelf()},getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},_initSelf:function(){this.selector=new w({portalUrl:this.portalUrl,itemTypes:["Feature Service","Map Service"],onlyShowOnlineFeaturedItems:!1});this.own(n(this.selector,"item-selected",f.hitch(this,this._onItemSelected)));this.own(n(this.selector,"none-item-selected",f.hitch(this,this._onNoneItemSelected)));this.selector.placeAt(this.selectorContainer);
this.selector.startup();this.serviceBrowser=new x({multiple:this.multiple});this.own(n(this.serviceBrowser,"tree-click",f.hitch(this,this._onServiceBrowserClicked)));this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup()},_onItemSelected:function(){e.removeClass(this.btnNext,"jimu-state-disabled")},_onNoneItemSelected:function(){e.addClass(this.btnNext,"jimu-state-disabled")},_onBtnBackClicked:function(){this._serviceBrowserDef&&!this._serviceBrowserDef.isFulfilled()&&
this._serviceBrowserDef.cancel();e.setStyle(this.btnOk,"display","none");e.setStyle(this.btnNext,"display","block");e.setStyle(this.btnBack,"display","none");e.addClass(this.btnOk,"jimu-state-disabled");e.setStyle(this.selectorContainer,"display","block");e.setStyle(this.serviceBrowserContainer,"display","none");this.serviceBrowser.reset();this.emit("back")},_onBtnOkClicked:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnNextClicked:function(){var a=this.selector.getSelectedItem();
a&&(e.setStyle(this.btnNext,"display","none"),e.setStyle(this.btnBack,"display","block"),e.setStyle(this.btnOk,"display","block"),e.addClass(this.btnOk,"jimu-state-disabled"),e.setStyle(this.selectorContainer,"display","none"),e.setStyle(this.serviceBrowserContainer,"display","block"),this.serviceBrowser.reset(),this._serviceBrowserDef=this.serviceBrowser.setUrl(a.url||a.item),this._serviceBrowserDef.then(f.hitch(this,function(){this._serviceBrowserDef=null;this._setOkStateBySelectedItems()}),f.hitch(this,
function(){this._serviceBrowserDef=null})),this.emit("next"))},_setOkStateBySelectedItems:function(){0<this.serviceBrowser.getSelectedItems().length?e.removeClass(this.btnOk,"jimu-state-disabled"):e.addClass(this.btnOk,"jimu-state-disabled")},_onServiceBrowserClicked:function(){this._setOkStateBySelectedItems()},_onBtnCancelClicked:function(){this.emit("cancel")}})})},"jimu/dijit/ItemSelector":function(){define("dojo/_base/declare dojo/topic dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/ItemSelector.html dojo/Evented dojo/_base/lang dojo/_base/config dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/promise/all dojo/query dojo/on dojo/dom-style jimu/utils jimu/portalUtils jimu/tokenUtils jimu/portalUrlUtils jimu/dijit/ViewStack jimu/dijit/Search jimu/dijit/TabContainer3 jimu/dijit/_ItemTable jimu/dijit/BindLabelPropsMixin dijit/form/RadioButton".split(" "),
function(m,k,l,t,u,f,e,c,n,r,v,a,y,w,x,h,d,g,z,p,b,B,E,C,F){return m([l,t,u,F,e],{templateString:f,declaredClass:"jimu.dijit.ItemSelector",baseClass:"jimu-item-selector",tab:null,_user:null,_group:null,_allPublicPortalQuery:null,_filterPublicPortalQuery:null,_allPublicOnlineQuery:null,_filterPublicOnlineQuery:null,_allOrganizationQuery:null,_filterOrganizationQuery:null,_allMyContentQuery:null,_filterMyContentQuery:null,_allGroupQuery:null,_filterGroupQuery:null,_isPublicTabShow:!1,_signIn:!1,_itemTypeQueryString:"",
_typeKeywordQueryString:"",portalUrl:null,itemTypes:"",typeKeywords:"",showOnlineItems:!0,onlyShowOnlineFeaturedItems:!1,showMyContent:!0,showMyOrganization:!0,showMyGroups:!0,showPublic:!0,showOnlyEditableGroups:!1,postMixInProperties:function(){this.portalUrl=p.getStandardPortalUrl(this.portalUrl);this.showOnlineItems=!1===this.showOnlineItems?!1:!0;this.itemTypes&&0<this.itemTypes.length||(this.itemTypes=[]);this._itemTypes="";r.forEach(this.itemTypes,c.hitch(this,function(b,a){this._itemTypes+=
'"'+b+'"';a!==this.itemTypes.length-1&&(this._itemTypes+=",")}));this._itemTypes="["+this._itemTypes+"]";this.typeKeywords&&0<this.typeKeywords.length||(this.typeKeywords=[]);this._typeKeywords="";r.forEach(this.typeKeywords,c.hitch(this,function(b,a){this._typeKeywords+='"'+b+'"';a!==this.typeKeywords.length-1&&(this._typeKeywords+=",")}));this._typeKeywords="["+this._typeKeywords+"]";this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);var b=this._getPortalUrl();
this.portal=g.getPortal(b);this._initOptions();this._initSearchQuery();this._initTabs();this._initPortalRadio();this._initItemTables();this._initPublic();this._initPrivate();this._updateUIbySignIn()},_initOptions:function(){this._itemTypeQueryString=d.getItemQueryStringByTypes(this.itemTypes);this._typeKeywordQueryString=d.getItemQueryStringByTypeKeywords(this.typeKeywords)},_initTabs:function(){var b={title:this.nls.myContent,content:this.mycontentTabNode},a={title:this.nls.myOrganization,content:this.organizationTabNode},
d={title:this.nls.myGroup,content:this.groupTabNode},g={title:this.nls.publicMap,content:this.publicTabNode};h.set(this.mycontentTabNode,"display","none");h.set(this.organizationTabNode,"display","none");h.set(this.groupTabNode,"display","none");h.set(this.publicTabNode,"display","none");var e=[];this.showMyContent&&(e.push(b),h.set(this.mycontentTabNode,"display","block"));this.showMyOrganization&&(e.push(a),h.set(this.organizationTabNode,"display","block"));this.showMyGroups&&(e.push(d),h.set(this.groupTabNode,
"display","block"));this.showPublic&&(e.push(g),h.set(this.publicTabNode,"display","block"));this.tab=new E({tabs:e},this.tabNode);this.own(x(this.tab,"tabChanged",c.hitch(this,function(b){v.setStyle(this.signinSection,"display","none");b!==this.nls.publicMap?(this._isPublicTabShow=!1,this._updateUIbySignIn()):this._isPublicTabShow=!0})))},_updateUIbySignIn:function(){v.setStyle(this.signinSection,"display","none");var b=w(".organization-tab-content-main,.group-tab-content-main,.mycontent-tab-content-main",
this.domNode);z.userHaveSignInPortal(this._getPortalUrl())?b.style("display","block"):(b.style("display","none"),this._isPublicTabShow||v.setStyle(this.signinSection,"display","block"))},_initPortalRadio:function(){var b=this._getPortalUrl(),b=p.getServerByUrl(b);this.portalPublicRaido.set("disabled",!1);this.onlinePublicRaido.set("disabled",!1);this.portalPublicRaido.set("checked",!0);var a=!1;p.isArcGIScom(b)?(a=!0,this.portalPublicLabel.innerHTML="ArcGIS.com"):(this.portalPublicLabel.innerHTML=
b,a=this.showOnlineItems?!1:!0);a&&(this.onlinePublicRaido.set("disabled",!0),v.setStyle(this.onlinePublicRaido,"display","none"),v.setStyle(this.onlinePublicLabel,"display","none"))},_initSearchQuery:function(){var b="esri_"+(n.locale&&n.locale.slice(0,2)||"en").toLowerCase(),a=r.filter("esri_he esri_fr esri_ja esri_nl esri_th esri_tr esri_nb esri_ro esri_it esri_pl esri_po esri_ru esri_pt esri_en esri_ar esri_et esri_es esri_ko esri_cs esri_da esri_zh esri_sv esri_lt esri_fi esri_lv esri_de esri_vi".split(" "),
c.hitch(this,function(a){return a!==b})),d="";r.forEach(a,c.hitch(this,function(b){d+=" -owner:"+b+" "}));a=" ";this.portal&&this.portal.user&&this.portal.user.orgId&&(a=" orgid:"+this.portal.user.orgId+" ");a=a+this._itemTypeQueryString+" AND access:public "+d+" "+this._typeKeywordQueryString;this._allPublicPortalQuery=this._getQuery({sortField:"numViews",sortOrder:"desc",q:a});this._filterPublicPortalQuery=this._getQuery({q:a,basicQ:a});this._allPublicOnlineQuery=this._getQuery({sortField:"numViews",
sortOrder:"desc",q:(this.onlyShowOnlineFeaturedItems?' (group:"c755678be14e4a0984af36a15f5b643e"  OR group:"b8787a74b4d74f7fb9b8fac918735153") ':" ")+this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._filterPublicOnlineQuery=this._getQuery({q:this._itemTypeQueryString+" AND access:public "+this._typeKeywordQueryString});this._allOrganizationQuery=this._getQuery();this._filterOrganizationQuery=this._getQuery();this._allMyContentQuery=this._getQuery();this._filterMyContentQuery=
this._getQuery();this._allGroupQuery=this._getQuery();this._filterGroupQuery=this._getQuery()},_getQuery:function(b){return c.mixin({start:1,num:16,f:"json"},b||{})},_getPortalUrl:function(){return p.getStandardPortalUrl(this.portalUrl)},_initItemTables:function(){"function"===typeof this.onCreateItemContent&&(this.mycontentItemTable.onCreateItemContent=this.onCreateItemContent,this.organizationItemTable.onCreateItemContent=this.onCreateItemContent,this.groupItemTable.onCreateItemContent=this.onCreateItemContent,
this.publicPortalItemTable.onCreateItemContent=this.onCreateItemContent,this.publicOnlineItemTable.onCreateItemContent=this.onCreateItemContent);this.own(x(this.publicPortalItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));this.own(x(this.publicOnlineItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));this.own(x(this.organizationItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));this.own(x(this.groupItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));
this.own(x(this.mycontentItemTable,"item-dom-clicked",c.hitch(this,this._onItemDomClicked)));this.own(x(this.publicPortalItemTable,"update",c.hitch(this,this._onItemTableUpdate)));this.own(x(this.publicOnlineItemTable,"update",c.hitch(this,this._onItemTableUpdate)));this.own(x(this.organizationItemTable,"update",c.hitch(this,this._onItemTableUpdate)));this.own(x(this.groupItemTable,"update",c.hitch(this,this._onItemTableUpdate)));this.own(x(this.mycontentItemTable,"update",c.hitch(this,this._onItemTableUpdate)));
var b=this._getPortalUrl();this.portalPublicRaido.get("disabled")||(this.publicPortalItemTable.set("portalUrl",b),this.publicPortalItemTable.searchAllItems(this._allPublicPortalQuery),this.publicPortalItemTable.set("filteredQuery",this._filterPublicPortalQuery));this.onlinePublicRaido.get("disabled")||(this.publicOnlineItemTable.set("portalUrl",window.location.protocol+"//www.arcgis.com"),this.publicOnlineItemTable.searchAllItems(this._allPublicOnlineQuery),this.publicOnlineItemTable.set("filteredQuery",
this._filterPublicOnlineQuery))},_initPublic:function(){this.own(x(this.portalPublicRaido,"click",c.hitch(this,this._onPublicRaidoClicked)));this.own(x(this.onlinePublicRaido,"click",c.hitch(this,this._onPublicRaidoClicked)));this._onPublicRaidoClicked()},_onPublicRaidoClicked:function(){this.portalPublicRaido.get("checked")?(this.publicPortalItemTable.show(),this.publicOnlineItemTable.hide()):this.onlinePublicRaido.get("checked")&&(this.publicPortalItemTable.hide(),this.publicOnlineItemTable.show())},
_onPublicSearch:function(b){(b=b&&c.trim(b))?(this.publicPortalItemTable.showFilterItemsSection(),this.publicOnlineItemTable.showFilterItemsSection(),this.portalPublicRaido.get("checked")?(this._filterPublicPortalQuery.q=b+" "+this._filterPublicPortalQuery.basicQ,this._filterPublicPortalQuery.start=1,this.publicPortalItemTable.searchFilteredItems(this._filterPublicPortalQuery)):this.onlinePublicRaido.get("checked")&&(this._filterPublicOnlineQuery.q=b+" "+this._itemTypeQueryString+" AND access:public "+
this._typeKeywordQueryString,this._filterPublicOnlineQuery.start=1,this.publicOnlineItemTable.searchFilteredItems(this._filterPublicOnlineQuery))):(this.publicPortalItemTable.showAllItemsSection(),this.publicOnlineItemTable.showAllItemsSection())},_initPrivate:function(){this._resetPortalMaps();this.own(x(this.groupsSelect,"change",c.hitch(this,this._onGroupsSelectChange)));var b=p.getServerByUrl(this._getPortalUrl());p.isArcGIScom(b)&&(b="ArcGIS.com");z.userHaveSignInPortal(this._getPortalUrl())&&
this._onSignIn()},_onOrganizationSearch:function(b){if(b=b&&c.trim(b)){if(this._allOrganizationQuery){var a=this._allOrganizationQuery.q;a&&(this._filterOrganizationQuery.q=b+" "+a,this._filterOrganizationQuery.start=1,this.organizationItemTable.searchFilteredItems(this._filterOrganizationQuery))}}else this.organizationItemTable.showAllItemsSection()},_onMyContentSearch:function(b){if(b=b&&c.trim(b)){if(this._allMyContentQuery){var a=this._allMyContentQuery.q;a&&(this._filterMyContentQuery.q=b+" "+
a,this._filterMyContentQuery.start=1,this.mycontentItemTable.searchFilteredItems(this._filterMyContentQuery))}}else this.mycontentItemTable.showAllItemsSection()},_onGroupSearch:function(b){if(b=b&&c.trim(b)){if(this._allGroupQuery){var a=this._allGroupQuery.q;a&&(this._filterGroupQuery.q=b+" "+a,this._filterGroupQuery.start=1,this.groupItemTable.searchFilteredItems(this._filterGroupQuery))}}else this.groupItemTable.showAllItemsSection()},_onSignIn:function(){this._updateUIbySignIn();if(!this._signIn){this._signIn=
!0;var b=this._getPortalUrl();g.getPortal(b).getUser().then(c.hitch(this,function(b){this.domNode&&(this._resetPortalMaps(),this._searchOrganization(b),this._searchMyContent(b),this._searchGroups(b))}))}},_onSignOut:function(){this._signIn=!1;this._resetPortalMaps();this._updateUIbySignIn()},_resetPortalMaps:function(){this.organizationItemTable.clear();this.mycontentItemTable.clear();this._resetGroupsSection()},_searchOrganization:function(b){this.organizationItemTable.clear();b=" orgid:"+b.orgId+
" AND "+this._itemTypeQueryString+" AND (access:org OR access:public) "+this._typeKeywordQueryString;var a=this._getPortalUrl();this._allOrganizationQuery=this._getQuery({q:b});this._filterOrganizationQuery=this._getQuery({q:b});this.organizationItemTable.set("portalUrl",a);this.organizationItemTable.searchAllItems(this._allOrganizationQuery)},_searchMyContent:function(b){this.mycontentItemTable.clear();var a=this._getPortalUrl();b="owner:"+b.username+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;
this._allMyContentQuery=this._getQuery({q:b});this._filterMyContentQuery=this._getQuery({q:b});this.mycontentItemTable.set("portalUrl",a);this.mycontentItemTable.searchAllItems(this._allMyContentQuery)},_searchGroups:function(b){this._resetGroupsSection();v.setStyle(this.groupsSection,"display","flex");b=b.getGroups();if(0<b.length){v.setStyle(this.groupSearch.domNode,"display","block");this.groupItemTable.show();v.empty(this.groupsSelect);for(var a=0;a<b.length;a++){var d=b[a];v.create("option",
{value:d.id,innerHTML:d.title},this.groupsSelect)}this._onGroupsSelectChange()}this._updateUIbyGroups(b.length)},_resetGroupsSection:function(){v.setStyle(this.groupsSection,"display","none");v.empty(this.groupsSelect);v.create("option",{value:"nodata",innerHTML:this.nls.noneGroups},this.groupsSelect);this.groupItemTable.clear();v.setStyle(this.groupSearch.domNode,"display","none");this.groupItemTable.hide();this._updateUIbyGroups(0)},_updateUIbyGroups:function(b){0===b?v.setStyle(this.groupsSection,
"top","15px"):v.setStyle(this.groupsSection,"top","50px")},_onGroupsSelectChange:function(){var b=this.groupsSelect.value;this.groupItemTable.clear();if("nodata"===b)v.setStyle(this.groupSearch,"display","none"),this.groupItemTable.hide();else{v.setStyle(this.groupSearch,"display","block");this.groupItemTable.show();var a=this._getPortalUrl(),b="group:"+b+" AND "+this._itemTypeQueryString+" "+this._typeKeywordQueryString;this._allGroupQuery=this._getQuery({q:b});this._filterGroupQuery=this._getQuery({q:b});
this.groupItemTable.set("portalUrl",a);this.groupItemTable.searchAllItems(this._allGroupQuery)}},_onItemTableUpdate:function(){this.emit("update")},_onItemDomClicked:function(b){var a=v.hasClass(b,"jimu-state-active");w(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active");a&&v.addClass(b,"jimu-state-active");(b=this.getSelectedItem())?this.emit("item-selected",b):this.emit("none-item-selected")},getSelectedItem:function(){var b=null,a=w(".item.jimu-state-active",this.domNode);
0<a.length&&(b=c.mixin({},a[0].item));return b}})})},"jimu/dijit/_ItemTable":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_ItemTable.html dojo/Evented dojo/_base/lang dojo/_base/array dojo/_base/html dojo/_base/Deferred dojo/query dojo/on jimu/utils jimu/portalUtils jimu/portalUrlUtils jimu/dijit/LoadingIndicator".split(" "),function(m,k,l,t,u,f,e,c,n,r,v,a,y,w,x,h){return m([k,l,t,f],{templateString:u,declaredClass:"jimu.dijit.ItemTable",
baseClass:"jimu-item-table",query:null,filteredQuery:null,portalUrl:null,hidden:!1,nls:null,types:"",typeKeywords:"",_defaultThumbnail:{"Web Mapping Application":"desktopapp.png","Mobile Application":"mobileapp.png"},postMixInProperties:function(){this.nls=window.jimuNls.itemSelector},postCreate:function(){this.inherited(arguments);this._initSelf()},_initSelf:function(){this.types&&0<this.types.length||(this.types=[]);(this.hidden=!0===this.hidden)&&this.hide();this.portalUrl&&(this.portalUrl=x.getStandardPortalUrl(this.portalUrl));
this.showAllItemsSection();this.searchAllItems()},show:function(){n.setStyle(this.domNode,"display","block")},hide:function(){n.setStyle(this.domNode,"display","none")},searchAllItems:function(a){this.showAllItemsSection();a&&(this.query=e.mixin({},a),this.query.start=1,this.clearAllItemsSection());this.portalUrl&&this.query&&0<this.query.start&&(this.allItemsShelter.show(),w.getPortal(this.portalUrl).queryItems(this.query).then(e.hitch(this,function(a){this.domNode&&(this.allItemsShelter.hide(),
this.query.start=a.nextStart,this._createItems(a,this.allItemTbody))}),e.hitch(this,function(a){console.error(a);this.domNode&&this.allItemsShelter.hide()})))},searchFilteredItems:function(a){this.showFilterItemsSection();a&&(this.filteredQuery=e.clone(a),this.filteredQuery.start=1,this.clearFilteredItemsSection());this.portalUrl&&this.filteredQuery&&0<this.filteredQuery.start&&(this.filteredItemShelter.show(),w.getPortal(this.portalUrl).queryItems(this.filteredQuery).then(e.hitch(this,function(d){this.domNode&&
(this.showFilterItemsSection(),a&&this.clearFilteredItemsSection(),this.filteredQuery.start=d.nextStart,this._createItems(d,this.filteredItemsTbody),this._filterItemCallback())}),e.hitch(this,function(a){console.error(a);this.domNode&&this._filterItemCallback()})))},_filterItemCallback:function(){this.filteredItemShelter.hide();0<this._getItemCount(this.filteredItemsTbody)?(n.setStyle(this.filteredItemsTableDiv,"display","block"),n.setStyle(this.searchNoneTipSection,"display","none")):(n.setStyle(this.filteredItemsTableDiv,
"display","none"),n.setStyle(this.searchNoneTipSection,"display","block"))},clear:function(){this.clearAllItemsSection();this.clearFilteredItemsSection()},clearAllItemsSection:function(){n.empty(this.allItemTbody)},clearFilteredItemsSection:function(){n.empty(this.filteredItemsTbody)},showAllItemsSection:function(){n.setStyle(this.allItemsSection,"display","block");n.setStyle(this.filteredItemsSection,"display","none")},showFilterItemsSection:function(){n.setStyle(this.allItemsSection,"display","none");
n.setStyle(this.filteredItemsSection,"display","block");n.setStyle(this.filteredItemsTableDiv,"display","block");n.setStyle(this.searchNoneTipSection,"display","none")},_onAllItemsSectionScroll:function(){this._isScrollToBottom(this.allItemsTableDiv)&&this.searchAllItems()},_onFilteredItemsSectionScroll:function(){this._isScrollToBottom(this.filteredItemsTableDiv)&&this.searchFilteredItems()},_isScrollToBottom:function(a){return y.isScrollToBottom(a)},_createItems:function(a,g){a=a.results;var d=
c.map(this.types,e.hitch(this,function(b){return b.toLowerCase()}));a=c.filter(a,e.hitch(this,function(b){b=b.type&&b.type.toLowerCase()||"";return 0<=c.indexOf(d,b)}));if(0!==a.length){var h,b=v("td.empty",g),f;if(0<b.length){var k=Math.min(a.length,b.length),r=a.splice(0,k);for(f=0;f<k;f++){var l=b[f];h=this._createItem(r[f]);n.place(h,l);n.removeClass(l,"empty")}}if(0!==a.length){b=Math.ceil(a.length/2);for(f=0;f<b;f++)for(h=n.toDom("\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e"),
n.place(h,g),k=v("td",h),r=0;r<k.length;r++)l=k[r],(h=a[2*f+r])?(h=this._createItem(h),n.place(h,l)):n.addClass(l,"empty");this.emit("update")}}},_getItemCount:function(a){return v(".item",a).length},_createItem:function(a){var d=n.toDom('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"item-border"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-thumbnail jimu-auto-vertical"\x3e\x3cdiv class\x3d"none-thumbnail-tip jimu-auto-vertical-content"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"item-info"\x3e\x3cdiv class\x3d"item-name"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-type-owner"\x3e\x3c/div\x3e\x3cdiv class\x3d"item-date"\x3e\x3c/div\x3e\x3ca class\x3d"item-details" target\x3d"_blank"\x3e\x3c/a\x3e\x3c/div\x3e\x3c/div\x3e');
d.item=a;var c=v(".item-thumbnail",d)[0],h=v(".item-name",d)[0],b=v(".item-type-owner",d)[0],e=v(".item-date",d)[0],f=v(".item-details",d)[0],k=v(".none-thumbnail-tip",d)[0];if(!a.thumbnailUrl){var r=this._defaultThumbnail[a.type];r&&(a.thumbnailUrl=require.toUrl("jimu")+"/images/"+r)}a.thumbnailUrl?n.setStyle(c,"backgroundImage","url("+a.thumbnailUrl+")"):k.innerHTML=this.nls.noneThumbnail;"function"===typeof this.onCreateItemContent?(e=v(".item-info",d)[0],this.onCreateItemContent(a,e)):(h.innerHTML=
a.title,h.title=h.innerHTML,b.innerHTML=a.type+" by "+a.owner,b.title=b.innerHTML,c=new Date,c.setTime(a.modified),e.innerHTML=c.toLocaleString(),e.title=e.innerHTML,f.innerHTML=this.nls.moreDetails,f.href=a.detailsPageUrl||"#");return d},_onItemsTableClicked:function(a){var d=a.target||a.srcElement;a=null;n.hasClass(d,"item-thumbnail")?a=d.parentNode:n.hasClass(d,"none-thumbnail-tip")&&(a=d.parentNode.parentNode);a&&(d=n.hasClass(a,"jimu-state-active"),v(".item.jimu-state-active",this.domNode).removeClass("jimu-state-active"),
d?n.removeClass(a,"jimu-state-active"):n.addClass(a,"jimu-state-active"),this.emit("item-dom-clicked",a))},getSelectedItem:function(){var a=null,c=v(".item.jimu-state-active",this.domNode);0<c.length&&(a=e.mixin({},c[0].item));return a}})})},"jimu/dijit/FeaturelayerServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(m,k,l,t,u){return m([k],{baseClass:"jimu-featurelayer-service-browser",declaredClass:"jimu.dijit.FeaturelayerServiceBrowser",
url:"",multiple:!1,types:null,isSupportQuery:!0,postMixInProperties:function(){this.inherited(arguments);this.rule=u.getFeaturelayerServiceBrowserRule(this.types,this.isSupportQuery)},getSelectedItems:function(){var f=this.inherited(arguments);return f=t.map(f,l.hitch(this,function(e){return{name:e.name,url:e.url,definition:e.definition}}))}})})},"jimu/dijit/_BasicServiceBrowser":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/Deferred dojo/promise/all dojo/store/Memory dojo/store/Observable dijit/tree/ObjectStoreModel jimu/utils jimu/dijit/_Tree jimu/dijit/LoadingIndicator".split(" "),
function(m,k,l,t,u,f,e,c,n,r,v,a,y,w,x){return m([k,l,t,u],{templateString:'\x3cdiv style\x3d"width:100%;"\x3e\x3cdiv data-dojo-attach-point\x3d"shelter"  data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\x3c/div\x3e',_store:null,_id:0,_currentUrl:"",_treeClass:"service-browser-tree",_def:null,url:"",multiple:!1,rule:null,postMixInProperties:function(){this.nls=window.jimuNls.basicServiceBrowser},postCreate:function(){this.inherited(arguments);e.addClass(this.domNode,
"jimu-basic-service-browser");this.multiple=!!this.multiple;this._createTree();this.url&&"string"===typeof this.url&&this.setUrl(this.url)},reset:function(){this.url="";this._clear()},getSelectedItems:function(){return this.tree.getSelectedItems()},setUrl:function(a){this._def&&(this._def.isFulfilled()||this._def.cancel(),this._def=null);this._def=new n;a&&"string"===typeof a&&a.replace(/\/*$/g,"")||this._def.reject();a=a.replace(/\/*$/g,"");a=f.trim(a);var d=a.match(/^http(s?):\/\//gi);d&&0<d.length||
(a="http://"+a);if(!(0>=a.search(/\/rest\/services/i))&&(this._clear(),this._currentUrl=a))return a=this._getRootItem(),a=w.isStringEndWith(this._currentUrl,"rest/services")?this._searchBaseServiceUrl(this._currentUrl,a):this._isUrlContainsServiceType(this._currentUrl)?this._searchServiceUrl(this._currentUrl,a):this._searchFolderServiceUrl(this._currentUrl,a),this.shelter.show(),a.then(f.hitch(this,function(a){this.domNode&&this.shelter.hide();var d=this.tree.getAllLeafTreeNodeWidgets();1===d.length&&
d[0].select();this._def.resolve(a)}),f.hitch(this,function(a){this.domNode&&this.shelter.hide();this._showRequestError();this._def.reject(a)})),this._def;this._def.reject()},_getItem:function(a){return this.rule.getItem(a)},_getSubItemUrls:function(a){return this.rule.getSubItemUrls(a)},_getSubItems:function(a){var d=new n;this._getSubItemUrls(a).then(f.hitch(this,function(a){a=c.map(a,f.hitch(this,function(a){return this._getItem(a)}));r(a).then(f.hitch(this,function(a){a=c.filter(a,f.hitch(this,
function(a){return a&&"object"===typeof a}));d.resolve(a)}),f.hitch(this,function(a){d.reject(a)}))}),f.hitch(this,function(a){d.reject(a)}));return d},_selectFirstLeafTreeNodeWidget:function(){var a=this.tree.getAllLeafTreeNodeWidgets();1===a.length&&a[0].select()},isLeafItem:function(a){return 0<=this.rule.leafTypes.indexOf(a.type)},isServiceTypeSupported:function(a){return this.rule.isServiceTypeSupported(a)},_getStringEndWith:function(a,d){var c="",e=a.indexOf(d);0<=e&&(c=a.slice(0,e+d.length));
return c},_isUrlContainsServiceType:function(a){return this.rule.isUrlContainsServiceType(a)},_getBaseServiceUrl:function(){return this._getStringEndWith(this._currentUrl,"rest/services")},_getServiceName:function(a){var d="";a=a.split("/");return d=a[a.length-1]},_searchBaseServiceUrl:function(a,d){var g=new n;this._getRestInfo(a).then(f.hitch(this,function(e){if(this.domNode){var h=[];c.map(e.folders,f.hitch(this,function(b){var g={name:b,type:"folder",url:a+"/"+b,parent:d.id};this._addItem(g);
var e=new n;this._doSearchFolderServiceUrl(g.url,g.id).then(f.hitch(this,function(b){0<b.length?c.forEach(b,f.hitch(this,function(b){b.parent=g.id;this._addItem(b)})):this._removeItem(g.id);e.resolve()}),f.hitch(this,function(b){e.reject(b)}));h.push(e);return e}));c.forEach(e.services,f.hitch(this,function(b){if(this.isServiceTypeSupported(b.type)){b=a+"/"+b.name+"/"+b.type;var c=new n;this.rule.getItem(b).then(f.hitch(this,function(b){b&&(b.parent=d.id,this._addItem(b));c.resolve()}),f.hitch(this,
function(b){console.error(b);c.reject(b)}));h.push(c)}}));r(h).then(f.hitch(this,function(){this.domNode&&g.resolve()}),f.hitch(this,function(b){console.error(b);this.domNode&&g.reject(b)}))}}),f.hitch(this,function(a){console.error(a);this.domNode&&g.reject({errorCode:"NETWORK_ERROR",error:a})}));return g},_searchFolderServiceUrl:function(a,d){var g=new n;this._doSearchFolderServiceUrl(a,d).then(f.hitch(this,function(a){this.domNode&&(c.forEach(a,f.hitch(this,function(a){a.parent=d.id;this._addItem(a)})),
g.resolve())}),f.hitch(this,function(a){console.error(a);this.domNode&&g.reject({errorCode:"NETWORK_ERROR",error:a})}));return g},_doSearchFolderServiceUrl:function(a){var d=new n,g=this._getBaseServiceUrl();this._getRestInfo(a).then(f.hitch(this,function(a){a=a.services;var e=[];a&&0<a.length&&c.forEach(a,f.hitch(this,function(b){this.isServiceTypeSupported(b.type)&&(b=this.rule.getItem(g+"/"+b.name+"/"+b.type),e.push(b))}));r(e).then(f.hitch(this,function(b){b=c.filter(b,f.hitch(this,function(b){return b}));
d.resolve(b)}),f.hitch(this,function(b){console.error(b);d.reject(b)}))}),f.hitch(this,function(a){console.error(a);d.reject(a)}));return d},_searchServiceUrl:function(a,d){var g=new n;this._getSubItems(a).then(f.hitch(this,function(e){e&&0<e.length?(c.forEach(e,f.hitch(this,function(a){a.parent=d.id;this._addItem(a)})),g.resolve()):this._getItem(a).then(f.hitch(this,function(a){a&&(a.parent=d.id,this._addItem(a));g.resolve()}),f.hitch(this,function(a){g.reject(a)}))}),f.hitch(this,function(a){g.reject(a)}));
return g},_getRestInfo:function(a){var d=new n;this.rule.getRestInfo(a).then(f.hitch(this,function(a){this.domNode&&d.resolve(a)}),f.hitch(this,function(a){this.domNode&&d.reject(a)}));return d},_clear:function(){var a=this._store.query({parent:"root"});c.forEach(a,f.hitch(this,function(a){a&&"root"!==a.id&&this._store.remove(a.id)}))},_showRequestError:function(){this.emit("error",this.nls.invalidUrlTip)},_addItem:function(a){this._id++;a.id=this._id.toString();this._store.add(a);return a},_removeItem:function(a){this._store.remove(a)},
_getRootItem:function(){return{id:"root",name:"Services Root",type:"root"}},_createTree:function(){var c=this._getRootItem(),c=new v({data:[c],getChildren:function(a){return this.query({parent:a.id})}});this._store=new a(c);c=new y({store:this._store,query:{id:"root"},mayHaveChildren:f.hitch(this,this._mayHaveChildren)});this.tree=new x({multiple:this.multiple,model:c,showRoot:!1,style:{width:"100%"},isLeafItem:f.hitch(this,this.isLeafItem),onOpen:f.hitch(this,function(a,c){this._onTreeOpen(a,c);
this.emit("tree-open",a,c)}),onClick:f.hitch(this,function(a,c,e){this._onTreeClick(a,c,e);this.emit("tree-click",a,c,e)}),getIconStyle:f.hitch(this,function(a,c){var d=null;if(!a)return null;var g={width:"20px",height:"20px",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundImage:""},b=window.location.protocol+"//"+window.location.host+require.toUrl("jimu"),e=this._getIconImageName(a,c);e||("folder"===a.type?e=c?"folder_open_default.png":"folder_close_default.png":this.isServiceTypeSupported(a.type)&&
(e=c?"folder_open_default.png":"folder_close_default.png"));e&&(g.backgroundImage="url("+b+"/css/images/"+e+")",d=g);return d})});e.addClass(this.tree.domNode,this._treeClass);this.tree.placeAt(this.domNode)},_getIconImageName:function(a,d){var c="";"function"===typeof this.rule.getIconImageName&&(c=this.rule.getIconImageName(a,d));return c},_mayHaveChildren:function(a){return"root"===a.type?!0:!this.isLeafItem(a)},_onTreeOpen:function(a,d){"root"===a.id||0<this._store.query({parent:a.id}).length||
a.checking||a.checked||(a.checking=!0,this._getSubItems(a.url).then(f.hitch(this,function(d){c.forEach(d,f.hitch(this,function(d){d.parent=a.id;this._addItem(d)}));a.checking=!1;a.checked=!0}),f.hitch(this,function(d){console.error(d);a.checking=!1;a.checked=!0})))},_onTreeClick:function(a,d,c){},destroy:function(){this.shelter&&(this.shelter.destroy(),this.shelter=null);this.inherited(arguments)}})})},"jimu/serviceBrowserRuleUtils":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/Deferred",
"jimu/utils","jimu/ServiceBrowserRule"],function(m,k,l,t,u){var f={combineRules:function(e){var c=new u;k.forEach(e,function(e){k.forEach(e.leafTypes,function(e){0>c.leafTypes.indexOf(e)&&c.leafTypes.push(e)});k.forEach(e.serviceTypes,function(e){0>c.serviceTypes.indexOf(e)&&c.serviceTypes.push(e)})});c.getMatchedRule=function(c){var f=null;k.some(e,function(e){return e.isUrlContainsServiceType(c)?(f=e,!0):!1});return f};c.getItem=function(e){var f=null;return f=(f=c.getMatchedRule(e))?f.getItem(e):
c.defaultGetItem(e)};c.getSubItemUrls=function(e){var f=null;return f=(f=c.getMatchedRule(e))?f.getSubItemUrls(e):c.defaultGetSubItemUrls(e)};c.getIconImageName=function(e,f){var k="";if(e.url){var a=c.getMatchedRule(e.url);a&&"function"===typeof a.getIconImageName&&(k=a.getIconImageName(e,f))}return k};return c},getFeaturelayerServiceBrowserRule:function(e,c,n){e=m.clone(e);var l=["point","polyline","polygon"];m.isArrayLike(e)&&0<e.length?(e=k.filter(e,function(c){return 0<=l.indexOf(c)}),0===e.length&&
(e=l)):e=l;return f._getFeaturelayerServiceBrowserRule(e,c,n)},_getFeaturelayerServiceBrowserRule:function(e,c,f){return new u({types:e,leafTypes:["Feature Layer","Table"],serviceTypes:["MapServer","FeatureServer"],_groupLayerType:"Group Layer",_featureLayerType:"Feature Layer",_tableType:"Table",getItem:function(c){var e=new l;this.isUrlEndWithServiceType(c,this.serviceTypes)?e=this.defaultGetItem(c):this.getRestInfo(c).then(m.hitch(this,function(a){a=this._getItemByLayerDefinition(c,a);e.resolve(a)}),
m.hitch(this,function(a){e.reject(a)}));return e},getSubItemUrls:function(c){var e=new l;return e=this.isUrlEndWithServiceType(c)?this._getSubUrlsByServiceUrl(c):this._getSubUrlsByGroupUrl(c)},getIconImageName:function(c,e){var a="";"MapServer"===c.type||"FeatureServer"===c.type?a=e?"mapserver_open.png":"mapserver_close.png":c.type===this._groupLayerType?a=e?"group_layer2.png":"group_layer1.png":c.type===this._featureLayerType?(c=t.getTypeByGeometryType(c.definition&&c.definition.geometryType),"point"===
c?a="point_layer1.png":"polyline"===c?a="line_layer1.png":"polygon"===c&&(a="polygon_layer1.png")):c.type===this._tableType?a="table.png":"root"===c.type&&this._currentUrl&&k.some(this.serviceTypes,m.hitch(this,function(a){return t.isStringEndWith(this._currentUrl,"/"+a)}))&&(a=e?"mapserver_open.png":"mapserver_close.png");return a},_getSubUrlsByServiceUrl:function(c){var e=new l;this.getRestInfo(c).then(m.hitch(this,function(a){var l=[];k.forEach(a.layers,m.hitch(this,function(a){0<=a.parentLayerId||
l.push(c+"/"+a.id)}));f&&k.forEach(a.tables,m.hitch(this,function(a){0<=a.parentLayerId||l.push(c+"/"+a.id)}));e.resolve(l)}),m.hitch(this,function(a){e.reject(a)}));return e},_getSubUrlsByGroupUrl:function(c){var e=new l;this.getRestInfo(c).then(m.hitch(this,function(a){var f=[];if(a.type===this._groupLayerType)var l=this._getServiceUrlByLayerUrl(c),f=k.map(a.subLayers||[],m.hitch(this,function(a){return l+"/"+a.id}));e.resolve(f)}),m.hitch(this,function(a){e.reject(a)}));return e},_getItemByLayerDefinition:function(e,
f){var a=null,k=f.type;if(k===this._groupLayerType)a={name:f.name,type:k,url:e,definition:f};else if(k===this._featureLayerType||k===this._tableType){var l=!1;k===this._featureLayerType?l=this._validateEsriGeometryType(f.geometryType):k===this._tableType&&(l=!0);l&&(l=!1,(l=c?t.isFeaturelayerUrlSupportQuery(e,f.capabilities):!0)&&(a={name:f.name,type:k,url:e,definition:f}))}return a},_validateEsriGeometryType:function(c){c=t.getTypeByGeometryType(c);return 0<=this.types.indexOf(c)},_getServiceUrlByLayerUrl:function(c){for(var e=
"",a=0;a<this.serviceTypes.length;a++){var f=this.serviceTypes[a].toLowerCase(),k=c.toLowerCase().lastIndexOf("/"+f+"/");if(0<=k){e=c.slice(0,k+f.length+1);break}}return e}})},getGeocodeServiceBrowserRule:function(){return new u({leafTypes:["GeocodeServer"],serviceTypes:["GeocodeServer"]})},getGpServiceBrowserRule:function(){return new u({leafTypes:["GPTask"],serviceTypes:["GPServer"],getItem:function(e){var c=new l;this.isUrlEndWithServiceType(e)?c=this.defaultGetItem(e):this.getRestInfo(e).then(m.hitch(this,
function(f){c.resolve({name:f.displayName||f.name,type:"GPTask",url:e,definition:f})}),m.hitch(this,function(e){c.reject(e)}));return c},getSubItemUrls:function(e){var c=new l;this.isUrlEndWithServiceType(e)?this.getRestInfo(e).then(m.hitch(this,function(f){f=k.map(f.tasks||[],m.hitch(this,function(c){return e+"/"+c}));c.resolve(f)}),m.hitch(this,function(e){c.reject(e)})):c.resolve([]);return c},getIconImageName:function(e,c){c="";"GPServer"===e.type?c="toolbox.png":"GPTask"===e.type&&(c="tool.png");
return c}})},getImageServiceBrowserRule:function(e){return new u({leafTypes:["ImageServer"],serviceTypes:["ImageServer"],getItem:function(c){var f=new l;this.isUrlEndWithServiceType(c)?this.defaultGetItem(c).then(m.hitch(this,function(c){e?t.isImageServiceSupportQuery(c.definition.capabilities)?f.resolve(c):f.resolve(null):f.resolve(c)}),m.hitch(this,function(c){f.reject(c)})):f.resolve(null);return f},getIconImageName:function(c,e){e="";"ImageServer"===c.type&&(e="image_layer.png");return e}})},
getQueryableServiceBrowserRule:function(){var e=f.getFeaturelayerServiceBrowserRule(["point","polyline","polygon"],!0,!0),c=f.getImageServiceBrowserRule(!0);return f.combineRules([e,c])}};return f})},"jimu/ServiceBrowserRule":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred jimu/utils esri/request esri/IdentityManager".split(" "),function(m,k,l,t,u,f,e){return m([],{leafTypes:null,serviceTypes:null,_restInfoCache:{},constructor:function(c){k.mixin(this,c);k.isArrayLike(this.leafTypes)||
(this.leafTypes=[]);k.isArrayLike(this.serviceTypes)||(this.serviceTypes=[])},getItem:function(c){return this.defaultGetItem(c)},getSubItemUrls:function(c){return this.defaultGetSubItemUrls(c)},getIconImageName:function(c,e){return""},defaultGetItem:function(c){var e=new t;c=c.replace(/\/*$/g,"");if(this.isUrlEndWithServiceType(c)){var f=c.split("/"),l=f[f.length-1],a=f[f.length-2];this.getRestInfo(c).then(k.hitch(this,function(f){e.resolve({name:a,type:l,url:c,definition:f})}),k.hitch(this,function(a){console.error(a);
e.reject({errorCode:"NETWORK_ERROR",error:a})}))}else e.resolve(null);return e},defaultGetSubItemUrls:function(c){c=new t;c.resolve([]);return c},getRestInfo:function(c){var l=new t;c=c.replace(/\/*$/g,"");var m=this._restInfoCache[c];if(m)l.resolve(m);else{var m={url:c,content:{f:"json"},handleAs:"json",callbackParamName:"callback",timeout:2E4},v=e.findCredential(c);v&&v.token&&(m.content.token=v.token);f(m).then(k.hitch(this,function(a){this._restInfoCache[c]=a;l.resolve(a)}),function(a){l.reject(a)})}return l},
isServiceTypeSupported:function(c){c=c.toLowerCase();return l.some(this.serviceTypes,k.hitch(this,function(e){return e.toLowerCase()===c}))},isUrlEndWithServiceType:function(c){return l.some(this.serviceTypes,k.hitch(this,function(e){return u.isStringEndWith(c,"/"+e)}))},isUrlContainsServiceType:function(c){c=c.toLowerCase();return l.some(this.serviceTypes,k.hitch(this,function(e){e=e.toLowerCase();return 0<=c.indexOf("/"+e)}))}})})},"jimu/dijit/_FeaturelayerServiceChooserContent":function(){define(["dojo/_base/declare",
"./_BasicServiceChooserContent","./FeaturelayerServiceBrowser"],function(m,k,l){return m([k],{baseClass:"jimu-featurelayer-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/MapServer","http://myserver/arcgis/rest/services/myservice/FeatureServer"],_createServiceBrowser:function(k){return new l(k)}})})},"jimu/dijit/_BasicServiceChooserContent":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_BasicServiceChooserContent.html dojo/Evented dojo/Deferred dojo/_base/html dojo/_base/array dojo/_base/lang dojo/on dojo/aspect dojo/promise/all jimu/dijit/URLInput jimu/dijit/LoadingIndicator".split(" "),
function(m,k,l,t,u,f,e,c,n,r,v,a,y,w,x){return m([k,l,t,f],{templateString:u,_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/servicetype"],multiple:!1,url:"",getSelectedItems:function(){return this.serviceBrowser.getSelectedItems()},postMixInProperties:function(){this.nls=r.mixin({},window.jimuNls.common);this.nls=r.mixin(this.nls,window.jimuNls.basicServiceChooser)},postCreate:function(){this.inherited(arguments);
c.addClass(this.domNode,"jimu-basic-service-chooser-content");this.multiple=!!this.multiple;this._initSelf();this.exampleTd.innerHTML=this.exampleTd.innerHTML},setUrl:function(a){var c=new e;(this.url=a)&&"string"===typeof this.url?(this.urlInput.set("value",this.url),c=this._onBtnValidateClick()):c.reject();return c},focusInput:function(){this.urlInput.focus()},_initSelf:function(){this._examples&&0<this._examples.length?n.forEach(this._examples,r.hitch(this,function(a){c.create("div",{innerHTML:a,
"class":"example-url"},this.exampleTd)})):c.setStyle(this.exampleTr,"display","none");var e={multiple:this.multiple,_onTreeClick:r.hitch(this,this._onTreeClick)};this.serviceBrowser=this._createServiceBrowser(e);this.serviceBrowser.placeAt(this.serviceBrowserContainer);this.serviceBrowser.startup();this.own(a.after(this.urlInput,"validator",r.hitch(this,this._afterUrlValidate)));this.url&&"string"===typeof this.url&&this.urlInput.set("value",this.url);this.own(v(this.serviceBrowser,"error",r.hitch(this,
this._onServiceBrowserError)))},_createServiceBrowser:function(a){},_validateUrl:function(a){a=a.replace(/\/*$/g,"");if((a=a.match(/\/rest\/services\/*(.*)/gi))&&0<a.length)if(a=a[0].replace(/\/rest\/services\/*/,"")){var c=a.split("/");if(1===c.length)return!0;if(2===c.length)return this.serviceBrowser.isServiceTypeSupported(c[1]);if(3<=c.length)return a=this.serviceBrowser.isServiceTypeSupported(c[1]),c=this.serviceBrowser.isServiceTypeSupported(c[2]),a||c}else return!0;else return!1},_afterUrlValidate:function(a){a&&
(a=this.urlInput.get("value"),a=this._validateUrl(a));a?c.removeClass(this.btnValidate,"jimu-state-disabled"):c.addClass(this.btnValidate,"jimu-state-disabled");return a},_onServiceBrowserError:function(a){this._showErrorMessage(a)},_showErrorMessage:function(a){a&&"string"===typeof a?(this.errorNode.innerHTML=a,c.addClass(this.errorSection,"visible")):c.removeClass(this.errorSection,"visible")},_clearErrorMessage:function(){this.errorNode.innerHTML="";c.removeClass(this.errorSection,"visible")},
_onBtnValidateClick:function(){this._clearErrorMessage();var a=new e;if(this.urlInput.validate()){var c=this.urlInput.get("value");this.serviceBrowser.setUrl(c).then(r.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.resolve()}),r.hitch(this,function(){this.domNode&&this._checkSelectedItemsNumber();a.reject()}));this.emit("validate-click")}else a.reject();return a},_checkSelectedItemsNumber:function(){0<this.getSelectedItems().length?c.removeClass(this.btnOk,"jimu-state-disabled"):
c.addClass(this.btnOk,"jimu-state-disabled")},_onTreeClick:function(){this._checkSelectedItemsNumber()},_onBtnOkClick:function(){var a=this.getSelectedItems();0<a.length&&this.emit("ok",a)},_onBtnCancelClick:function(){this.emit("cancel")}})})},"dojo/NodeList-data":function(){define(["./_base/kernel","./query","./_base/lang","./_base/array","./dom-attr"],function(m,k,l,t,u){var f=k.NodeList,e={},c=0,n=function(a){var e=u.get(a,"data-dojo-dataid");e||(e="pid"+c++,u.set(a,"data-dojo-dataid",e));return e},
r=m._nodeData=function(a,c,f){var k=n(a),h;e[k]||(e[k]={});if(1==arguments.length)return e[k];"string"==typeof c?2<arguments.length?e[k][c]=f:h=e[k][c]:h=l.mixin(e[k],c);return h},v=m._removeNodeData=function(a,c){a=n(a);e[a]&&(c?delete e[a][c]:delete e[a])};f._gcNodeData=m._gcNodeData=function(){var a=k("[data-dojo-dataid]").map(n),c;for(c in e)0>t.indexOf(a,c)&&delete e[c]};l.extend(f,{data:f._adaptWithCondition(r,function(a){return 0===a.length||1==a.length&&"string"==typeof a[0]}),removeData:f._adaptAsForEach(v)});
return f})},"widgets/Directions/setting/SearchConfig/LocatorSourceSetting":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/on dojo/Evented dojo/Deferred dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin jimu/portalUrlUtils jimu/dijit/Message jimu/dijit/_GeocodeServiceChooserContent jimu/dijit/Popup jimu/dijit/LoadingShelter esri/request esri/lang ../../searchUtil jimu/utils dojo/text!./LocatorSourceSetting.html jimu/dijit/CheckBox dijit/form/ValidationTextBox dijit/form/NumberTextBox".split(" "),
function(m,k,l,t,u,f,e,c,n,r,v,a,y,w,x,h,d,g,z,p){return m([e,c,n,u],{baseClass:"jimu-widget-search-locator-source-setting",tr:null,nls:null,config:null,singleLineFieldName:null,templateString:z,_suggestible:!1,_locatorDefinition:null,_esriLocatorRegExp:/http(s)?:\/\/geocode(.){0,3}\.arcgis.com\/arcgis\/rest\/services\/World\/GeocodeServer/g,serviceChooserContent:null,geocoderPopup:null,_clickSet:!1,postCreate:function(){this.inherited(arguments);this.exampleHint=this.nls.locatorExample+": http://\x26lt;myServerName\x26gt;/arcgis/rest/services/World/GeocodeServer";
this.searchInCurrentMapExtent=new p({checked:!1,label:this.nls.searchInCurrentMapExtent},this.searchInCurrentMapExtent);this.enableLocalSearch=new p({checked:!1,label:this.nls.enableLocalSearch},this.enableLocalSearch);this._processlocalSearchTable(!1);this.own(t(this.enableLocalSearch,"change",k.hitch(this,function(){this._processlocalSearchTable(this.enableLocalSearch.getValue())})));l.setStyle(this.enableLocalSearch.domNode,"display","none");this._setMessageNodeContent(this.exampleHint);this.autoComplete=
new p({checked:!1,label:this.nls.autoComplete},this.autoComplete);this.config=this.config?this.config:{};this.setConfig(this.config)},setRelatedTr:function(b){this.tr=b},getRelatedTr:function(){return this.tr},setDefinition:function(b){this._locatorDefinition=b||{}},getDefinition:function(){return this._locatorDefinition},setConfig:function(b){if("[object Object]"===Object.prototype.toString.call(b)){var a=b.url;a&&(this.config=b,this.shelter.show(),this._locatorDefinition.url!==a?this._getDefinitionFromRemote(a).then(k.hitch(this,
function(b){a&&b&&"error"!==b.type?(this._locatorDefinition=b,this._locatorDefinition.url=a,this._setSourceItems(),this._setMessageNodeContent(this.exampleHint)):a&&b&&"error"===b.type&&(this._setSourceItems(),this._disableSourceItems(),this._setMessageNodeContent(h.substitute({URL:b.url},k.clone(this.nls.invalidUrlTip)),!0));this.shelter.hide()})):(this._setSourceItems(),this._setMessageNodeContent(this.exampleHint),this.shelter.hide()))}},isValidConfig:function(){var b=this.getConfig();return b.url&&
b.name&&b.singleLineFieldName?!0:!1},showValidationTip:function(){this._showValidationErrorTip(this.locatorUrl);this._showValidationErrorTip(this.locatorName)},getConfig:function(){var b={url:this.locatorUrl.get("value"),name:g.stripHTML(this.locatorName.get("value")),singleLineFieldName:this.singleLineFieldName,placeholder:g.stripHTML(this.placeholder.get("value")),countryCode:g.stripHTML(this.countryCode.get("value")),maxSuggestions:this.maxSuggestions.get("value")||6,searchInCurrentMapExtent:this.searchInCurrentMapExtent.checked,
enableLocalSearch:this.enableLocalSearch.getValue(),localSearchMinScale:this.localSearchMinScale.get("value"),localSearchDistance:this.localSearchDistance.get("value"),type:"locator",autoComplete:this.autoComplete?this.autoComplete.getValue():!0,searchDelay:this.searchDelay.get("value")||350,minCharacters:this.minCharacters.get("value")||3};!0===this.config._isUpgrade&&(b._isUpgrade=!0);return b},_onLocatorNameBlur:function(){this.locatorName.set("value",g.stripHTML(this.locatorName.get("value")))},
_onPlaceholderBlur:function(){this.placeholder.set("value",g.stripHTML(this.placeholder.get("value")))},_onCountryCodeBlur:function(){this.countryCode.set("value",g.stripHTML(this.countryCode.get("value")))},_disableSourceItems:function(){this.locatorName.set("disabled",!0);this.placeholder.set("disabled",!0);this.countryCode.set("disabled",!0);this.maxSuggestions.set("disabled",!0)},_enableSourceItems:function(){this.locatorName.set("disabled",!1);this.placeholder.set("disabled",!1);this.countryCode.set("disabled",
!1);this.maxSuggestions.set("disabled",!1)},_setSourceItems:function(){var b=this.config;b.url&&(this.locatorUrl.set("value",b.url),this._processCountryCodeRow(b.url));b.name&&this.locatorName.set("value",g.stripHTML(b.name));b.singleLineFieldName&&(this.singleLineFieldName=b.singleLineFieldName);b.placeholder&&this.placeholder.set("value",g.stripHTML(b.placeholder));this.maxSuggestions.set("value",b.maxSuggestions||6);this.autoComplete.setValue("undefined"!==this.config.autoComplete?this.config.autoComplete:
!0);this.searchDelay.set("value",b.searchDelay||350);this.minCharacters.set("value",b.minCharacters||3);b._oldConfig&&!b._isUpgrade&&(b._oldConfig.placeholder&&this.placeholder.set("value",g.stripHTML(b._oldConfig.placeholder)),b._oldConfig.maxLocations&&this.maxSuggestions.set("value",b._oldConfig.maxLocations),b._oldConfig.autoComplete&&this.autoComplete.setValue(b._oldConfig.autoComplete),b._oldConfig.searchDelay&&this.searchDelay.set("value",b._oldConfig.searchDelay),b._oldConfig.minCharacters&&
this.minCharacters.set("value",b._oldConfig.minCharacters),b._isUpgrade=!0);b.countryCode&&this.countryCode.set("value",g.stripHTML(b.countryCode));"capabilities"in this._locatorDefinition?(l.setStyle(this.enableLocalSearch.domNode,"display",""),this._processlocalSearchTable(b.enableLocalSearch),this.enableLocalSearch.setValue(b.enableLocalSearch),b.localSearchMinScale&&b.enableLocalSearch&&this.localSearchMinScale.set("value",b.localSearchMinScale),b.localSearchDistance&&b.enableLocalSearch&&this.localSearchDistance.set("value",
b.localSearchDistance)):(this.enableLocalSearch.setValue(!1),l.setStyle(this.enableLocalSearch.domNode,"display","none"));(this._suggestible=this._locatorDefinition&&this._locatorDefinition.capabilities&&-1<this._locatorDefinition.capabilities.indexOf("Suggest"))?this._hideSuggestibleTips():this._showSuggestibleTips();this.searchInCurrentMapExtent.setValue(!!b.searchInCurrentMapExtent);this._enableSourceItems()},_isEsriLocator:function(b){this._esriLocatorRegExp.lastIndex=0;return this._esriLocatorRegExp.test(b)},
_getDefinitionFromRemote:function(b){var a=new f;if(this._isEsriLocator(b))a.resolve({singleLineAddressField:{name:"SingleLine",type:"esriFieldTypeString",alias:"Single Line Input",required:!1,length:200,localizedNames:{},recognizedNames:{}},capabilities:"Geocode,ReverseGeocode,Suggest"});else{var c=x({url:b,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});this.own(c);c.then(k.hitch(this,function(b){a.resolve(b)}),k.hitch(this,function(c){console.error(c);a.resolve({type:"error",
url:this._getRequestUrl(b)})}))}return a.promise},_setMessageNodeContent:function(b,a){l.empty(this.messageNode);b.nodeType||(b=l.toDom(b));l.place(b,this.messageNode);a?l.addClass(this.messageNode,"error-message"):l.removeClass(this.messageNode,"error-message")},_getRequestUrl:function(b){var a=window.location.protocol;return"http:"===a?r.setHttpProtocol(b):"https:"===a?r.setHttpsProtocol(b):b},_onSetLocatorUrlClick:function(){this._clickSet=!0;this._openServiceChooser()},_openLocatorChooser:function(){this._clickSet=
!1;this._openServiceChooser()},_openServiceChooser:function(){this.serviceChooserContent=new a({url:this.locatorUrl.get("value")||""});this.shelter=new w({hidden:!0});this.geocoderPopup=new y({titleLabel:this.nls.setGeocoderURL,autoHeight:!0,content:this.serviceChooserContent.domNode,container:window.jimuConfig.layoutId,width:640});this.shelter.placeAt(this.geocoderPopup.domNode);l.setStyle(this.serviceChooserContent.domNode,"width","580px");l.addClass(this.serviceChooserContent.domNode,"override-geocode-service-chooser-content");
this.serviceChooserContent.own(t(this.serviceChooserContent,"validate-click",k.hitch(this,function(){l.removeClass(this.serviceChooserContent.domNode,"override-geocode-service-chooser-content")})));this.serviceChooserContent.own(t(this.serviceChooserContent,"ok",k.hitch(this,"_onSelectLocatorUrlOk")));this.serviceChooserContent.own(t(this.serviceChooserContent,"cancel",k.hitch(this,"_onSelectLocatorUrlCancel")))},_onSelectLocatorUrlOk:function(b){b&&b[0]&&b[0].url&&this.domNode&&(this.shelter.show(),
x({url:b[0].url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(k.hitch(this,function(a){this.shelter.hide();a&&a.singleLineAddressField&&a.singleLineAddressField.name?(this._enableSourceItems(),this.locatorUrl.set("value",b[0].url),this.locatorName.get("value")||this.locatorName.set("value",d.getGeocoderName(b[0].url)),"capabilities"in a?(l.setStyle(this.enableLocalSearch.domNode,"display",""),this._isEsriLocator(b[0].url)?this.enableLocalSearch.setValue(!0):this.enableLocalSearch.setValue(!1)):
(this.enableLocalSearch.setValue(!1),l.setStyle(this.enableLocalSearch.domNode,"display","none")),this.singleLineFieldName=a.singleLineAddressField.name,this._processCountryCodeRow(b[0].url),this._locatorDefinition=a,this._locatorDefinition.url=b[0].url,(this._suggestible=a.capabilities&&-1<this._locatorDefinition.capabilities.indexOf("Suggest"))?this._hideSuggestibleTips():this._showSuggestibleTips(),this._clickSet?this.emit("reselect-locator-url-ok",this.getConfig()):this.emit("select-locator-url-ok",
this.getConfig()),this.geocoderPopup&&(this.geocoderPopup.close(),this.geocoderPopup=null),this._setMessageNodeContent(this.exampleHint)):new v({message:this.nls.locatorWarning})}),k.hitch(this,function(a){console.error(a);this.shelter.hide();new v({message:h.substitute({URL:this._getRequestUrl(b[0].url)},k.clone(this.nls.invalidUrlTip))})})))},_onSelectLocatorUrlCancel:function(){this.geocoderPopup&&(this.geocoderPopup.close(),this.geocoderPopup=null,this.emit("select-locator-url-cancel"))},_processlocalSearchTable:function(b){b?
(l.removeClass(this.minScaleNode,"hide-local-search-table"),l.removeClass(this.radiusNode,"hide-local-search-table"),b=l.getMarginBox(this.radiusHintNode),l.setStyle(this.radiusHintNode.parentNode,"paddingBottom",(45<b.h?b.h+10:45)+"px")):(l.addClass(this.minScaleNode,"hide-local-search-table"),l.addClass(this.radiusNode,"hide-local-search-table"))},_processCountryCodeRow:function(b){this._isEsriLocator(b)?(this.countryCode.set("value",""),l.removeClass(this.countryCodeRow,"hide-country-code-row")):
l.addClass(this.countryCodeRow,"hide-country-code-row")},_showSuggestibleTips:function(){l.addClass(this.tipsNode,"source-tips-show");l.setStyle(this.maxSuggestions.domNode,"display","none")},_hideSuggestibleTips:function(){l.removeClass(this.tipsNode,"source-tips-show");l.setStyle(this.maxSuggestions.domNode,"display","block")},_showValidationErrorTip:function(b){if(!b.validate()&&b.domNode&&b.focusNode){var a=b.get("disabled");a&&b.set("disabled",!1);b.focusNode.focus();setTimeout(k.hitch(this,
function(){b.focusNode.blur();a&&b.set("disabled",!0);b=null}),100)}}})})},"jimu/dijit/_GeocodeServiceChooserContent":function(){define(["dojo/_base/declare","./_BasicServiceChooserContent","./GeocodeServiceBrowser"],function(m,k,l){return m([k],{baseClass:"jimu-geocode-service-chooser-content",_examples:["http://myserver/arcgis/rest/services","http://myserver/arcgis/rest/services/folder","http://myserver/arcgis/rest/services/myservice/GeocodeServer"],_createServiceBrowser:function(k){return new l(k)}})})},
"jimu/dijit/GeocodeServiceBrowser":function(){define(["dojo/_base/declare","./_BasicServiceBrowser","dojo/_base/lang","dojo/_base/array","jimu/serviceBrowserRuleUtils"],function(m,k,l,t,u){return m([k],{baseClass:"jimu-geocode-service-browser",declaredClass:"jimu.dijit.GeocodeServiceBrowser",url:"",multiple:!1,postMixInProperties:function(){this.inherited(arguments);this.rule=u.getGeocodeServiceBrowserRule()},getSelectedItems:function(){var f=this.inherited(arguments);return f=t.map(f,l.hitch(this,
function(e){return{name:e.name,url:e.url}}))}})})},"widgets/Directions/setting/BarrierLayers":function(){define("dojo/_base/declare dojo/_base/lang jimu/LayerInfos/LayerInfos dijit/form/Select dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./BarrierLayers.html".split(" "),function(m,k,l,t,u,f,e,c){return m([u,f,e],{templateString:c,constructor:function(c){c&&(this.nls=c.nls)},postCreate:function(){this.inherited(arguments)},startup:function(){this.layerInfosObj=l.getInstanceSync();
var c=[],e=[],f=[];this.layerInfosObj.traversal(k.hitch(this,function(a){"esriGeometryPoint"===a.layerObject.geometryType&&this._isLayerInMap(a)&&c.push(a);"esriGeometryPolyline"===a.layerObject.geometryType&&this._isLayerInMap(a)&&e.push(a);"esriGeometryPolygon"===a.layerObject.geometryType&&this._isLayerInMap(a)&&f.push(a)}));this.pointLayers=(new t({name:"pointLayers",options:this._getOptionsByLayers(c,this.nls.noPointBarrier)})).placeAt(this.pointLayersNode);this.pointLayers.startup();this.polylineLayers=
(new t({name:"polylineLayers",options:this._getOptionsByLayers(e,this.nls.noLineBarrier)})).placeAt(this.polylineLayersNode);this.polylineLayers.startup();this.polygonLayers=(new t({name:"polygonLayers",options:this._getOptionsByLayers(f,this.nls.noPolygonBarrier)})).placeAt(this.polygonLayersNode);this.polygonLayers.startup();this.inherited(arguments)},destroy:function(){this.pointLayers&&this.pointLayers.destroy&&(this.pointLayers.closeDropDown(),this.pointLayers.destroy());this.polylineLayers&&
this.polylineLayers.destroy&&(this.polylineLayers.closeDropDown(),this.polylineLayers.destroy());this.polygonLayers&&this.polygonLayers.destroy&&(this.polygonLayers.closeDropDown(),this.polygonLayers.destroy())},_getOptionsByLayers:function(c,e){var f=[];f.push({label:e||"",value:"",selected:"true"});e=0;for(var a=c.length;e<a;e++){var k=c[e];f.push({label:k.title||k.id,value:k.layerObject.id})}return f},validate:function(){return!0},getValue:function(){var c={pointLayers:[],polylineLayers:[],polygonLayers:[]};
c.pointLayers.push(this.pointLayers.getValue());c.polylineLayers.push(this.polylineLayers.getValue());c.polygonLayers.push(this.polygonLayers.getValue());return c},setValue:function(c){this._selectItem(this.pointLayers,c.pointLayers||[]);this._selectItem(this.polylineLayers,c.polylineLayers||[]);this._selectItem(this.polygonLayers,c.polygonLayers||[])},_selectItem:function(c,e){for(var f=c.getOptions(),a=0,k=f.length;a<k;a++)f[a].value===e[0]&&c.setValue(e[0])},_isLayerInMap:function(c){for(var e=
this.layerInfosObj.getLayerInfoArrayOfWebmap(),f=c.getRootLayerInfo(),a=0,k=e.length;a<k;a++){var l=e[a];if(l.id===c.id||f&&f.id===l.id)return!0}return!1}})})},"jimu/dijit/ServiceURLComboBox":function(){define(["dojo/_base/declare","dojo/_base/html","dijit/form/ComboBox","jimu/dijit/ServiceURLInput"],function(m,k,l,t){return m([t,l],{declaredClass:"jimu.dijit.ServiceURLComboBox",postCreate:function(){this.inherited(arguments);k.addClass(this.domNode,"jimu-dijit-ServiceURLComboBox")},setProcessFunction:function(){this.inherited(arguments)}})})},
"widgets/Directions/setting/_build-generate_module":function(){define(["dojo/text!./Setting.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/Directions/setting/PresetDestinations.html":'\x3cdiv\x3e\r\n  \x3cspan class\x3d"title"\x3e${nls.presetDestinations}\x3c/span\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\r\n  \x3ctable style\x3d"width:98%;" cellspacing\x3d"0"\x3e\r\n    \x3ctbody\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd style\x3d"width:50%;"\x3e\r\n        \x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n          \x3ctbody\x3e\r\n          \x3ctr\x3e\r\n            \x3ctd style\x3d"width:200px;"\x3e\r\n              \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.startPoint}\x3c/span\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd style\x3d"width:auto;"\x3e\r\n              \x3cspan data-dojo-attach-point\x3d"startSearchDom" style\x3d"width:220px;"\x3e\x3c/span\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"startSearchResultsNode" class\x3d"searchResults arcgisSearch"\x3e\x3c/div\x3e\r\n              \x3c!--\x3cdiv data-dojo-attach-point\x3d"startSearchError" class\x3d"hide preset-des-error"\x3eNo Results\x3c/div\x3e--\x3e\r\n            \x3c/td\x3e\r\n\r\n            \x3ctd style\x3d"width:200px;"\x3e\r\n              \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.endPoint}\x3c/span\x3e\r\n            \x3c/td\x3e\r\n            \x3ctd style\x3d"width:auto;"\x3e\r\n              \x3cspan data-dojo-attach-point\x3d"endSearchDom" class\x3d"end-search" style\x3d"width:220px;"\x3e\x3c/span\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"endSearchResultsNode" class\x3d"searchResults arcgisSearch"\x3e\x3c/div\x3e\r\n              \x3c!--\x3cdiv data-dojo-attach-point\x3d"endSearchError" class\x3d"hide preset-des-error"\x3eNo Results\x3c/div\x3e--\x3e\r\n            \x3c/td\x3e\r\n          \x3c/tr\x3e\r\n          \x3c/tbody\x3e\r\n        \x3c/table\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:esri/dijit/Search/templates/Search.html":'\x3cdiv role\x3d"presentation" class\x3d"${theme}"\x3e\r\n  \x3cdiv role\x3d"presentation" class\x3d"${css.searchGroup}" data-dojo-attach-point\x3d"containerNode"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"expandNode" class\x3d"${css.searchExpandContainer}"\x3e\r\n      \x3cdiv class\x3d"${css.searchAnimateContainer}"\x3e\r\n        \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchIn}" id\x3d"${id}_menu_button" class\x3d"${css.searchBtn} ${css.searchToggle}" tabindex\x3d"0" data-dojo-attach-point\x3d"sourcesBtnNode"\x3e\r\n          \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchToggleIcon}"\x3e\x3c/span\x3e\x3cspan class\x3d"${css.searchSourceName}" data-dojo-attach-point\x3d"sourceNameNode"\x3e\x3c/span\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"${css.searchInputGroup}"\x3e\r\n          \x3cform data-dojo-attach-point\x3d"formNode"\x3e\r\n            \x3cinput maxlength\x3d"${maxLength}" autocomplete\x3d"off" type\x3d"text" tabindex\x3d"0" class\x3d"${css.searchInput}" value\x3d"${value}" aria-haspopup\x3d"true" id\x3d"${id}_input" data-dojo-attach-point\x3d"inputNode" role\x3d"textbox"\x3e\r\n          \x3c/form\x3e\r\n          \x3cdiv role\x3d"button" class\x3d"${css.searchClear}" tabindex\x3d"0" data-dojo-attach-point\x3d"clearNode"\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchClearIcon}"\x3e\x3c/span\x3e\x3cspan aria-hidden\x3d"true" class\x3d"${css.searchSpinner}"\x3e\x3c/span\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"suggestionsNode" class\x3d"${css.searchMenu} ${css.suggestionsMenu}"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv role\x3d"button" title\x3d"${_i18n.widgets.Search.main.searchButtonTitle}" class\x3d"${css.searchBtn} ${css.searchSubmit}" tabindex\x3d"0" data-dojo-attach-point\x3d"submitNode"\x3e\r\n      \x3cspan aria-hidden\x3d"true" role\x3d"presentation" class\x3d"${css.searchIcon}"\x3e\x3c/span\x3e\r\n      \x3cspan class\x3d"${css.searchButtonText}"\x3e${_i18n.widgets.Search.main.searchButtonTitle}\x3c/span\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"sourcesNode" class\x3d"${css.searchMenu} ${css.sourcesMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"noResultsMenuNode" class\x3d"${css.searchMenu} ${css.searchNoResultsMenu}"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"${css.searchClearFloat}"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/SearchConfig/SearchConfig.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"search-config"\x3e\r\n    \x3cdiv class\x3d"dropdown-button" role\x3d"button"\x3e\r\n      \x3cdiv class\x3d"button"\x3e\r\n        \x3cspan class\x3d"button-text"\x3e${nls.add}\x3c/span\x3e\r\n      \x3c/div\x3e\r\n      \x3cul class\x3d"dropdown-menu" role\x3d"menu" data-dojo-attach-event\x3d"click:_onMenuItemClick"\x3e\r\n        \x3cli class\x3d"dropdown-item" type\x3d"query"\x3e${nls.searchableLayer}\x3c/li\x3e\r\n        \x3cli class\x3d"dropdown-item" type\x3d"locator"\x3e${nls.geocoder}\x3c/li\x3e\r\n      \x3c/ul\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"sources"\x3e\r\n      \x3cdiv class\x3d"source-list jimu-float-leading"\x3e\r\n        \x3cdiv class\x3d"source-list-table" data-dojo-attach-point\x3d"sourceList"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv class\x3d"source-setting jimu-float-trailing" data-dojo-attach-point\x3d"sourceSettingNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/SearchConfig/QuerySourceSetting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"source-url-section"\x3e\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.layerSource}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"sourceUrl" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true,disabled:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"third"\x3e\r\n            \x3cspan title\x3d"${nls.set}" class\x3d"jimu-btn" data-dojo-attach-event\x3d"click:_onSetSourceClick"\x3e${nls.set}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"messageTr"\x3e\r\n          \x3ctd class\x3d"first"\x3e\x3c/td\x3e\r\n          \x3ctd class\x3d"second" colspan\x3d"2"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"messageNode" class\x3d"tip error-message"\x3e\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"source-details-section"\x3e\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.name}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"sourceName" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-event\x3d"Blur:_onSourceNameBlur" data-dojo-props\x3d"trim:true,required:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.placeholderText}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"placeholder" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-event\x3d"Blur:_onPlaceholderBlur" data-dojo-props\x3d"trim:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.searchFields}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv class\x3d"search-fields"\x3e\r\n            \x3c!-- \x3cspan class\x3d"fields jimu-float-leading" data-dojo-attach-point\x3d"fieldsNode"\x3e\x3c/span\x3e --\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"searchFields" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true,disabled:true,style:{width:\'95%\'}"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"search-fields-selector jimu-float-trailing" data-dojo-attach-point\x3d"fieldsSelectorNode" data-dojo-attach-event\x3d"click:_onFieldsSelectorClick"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.displayField}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"displayField" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d\'style:{width:"100%"}\'\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd class\x3d"first"\x3e\r\n          \x3cspan class\x3d"source-label"\x3e${nls.maxSuggestions}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd class\x3d"second"\x3e\r\n          \x3cdiv class\x3d"source-tips" title\x3d"${nls.searchLayerTips}" data-dojo-attach-point\x3d"tipsNode"\x3e\r\n            \x3cem\x3e${nls.searchLayerTips}\x3c/em\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"maxSuggestions" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1,places:0},style:{width:\'100%\'},value:6"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/table\x3e\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"exactMatch"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"searchInCurrentMapExtent"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n\r\n    \x3ctable class\x3d"source-table"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"auto-complete-td" data-dojo-attach-point\x3d"autoComplete"\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"width:200px;"\x3e\r\n            \x3cspan class\x3d"search-delay"\x3e${nls.searchDelay}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd style\x3d"width:auto;"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"searchDelay" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d\'required:true,value:350,smallDelta:1,largeDelta:10,constraints:{min:10},intermediateChanges:true\'\r\n              type\x3d"text" style\x3d"width:220px;" /\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"width:200px;"\x3e\r\n            \x3cspan class\x3d"min-characters jimu-ellipsis"\x3e${nls.minCharacters}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd style\x3d"width:auto;"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"minCharacters" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d\'required:true,value:3,smallDelta:1,largeDelta:1,constraints:{min:3},intermediateChanges:true\'\r\n              type\x3d"text" style\x3d"width:220px;" /\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/FeaturelayerSource.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"map-td" nowrap data-dojo-attach-point\x3d"mapTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"mapLabel"\x3e${nls.selectFromMap}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"portal-td" nowrap data-dojo-attach-point\x3d"portalTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalLabel"\x3e${nls.selectFromPortal}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"url-td" nowrap data-dojo-attach-point\x3d"urlTd"\x3e\r\n\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"urlLabel"\x3e${nls.addServiceUrl}\x3c/label\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"source-content"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"operationTip" class\x3d"operation-tip"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"flcContainer" class\x3d"dijit-container map-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"hflcContainer" class\x3d"dijit-container portal-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"flscContainer" class\x3d"dijit-container url-dijit-container" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"contentNode" class\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem" tabindex\x3d"-1" aria-selected\x3d"false"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation" style\x3d"display: none;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/TreeNode.html":'\x3cdiv class\x3d"dijitTreeNode" role\x3d"presentation"\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"rowNode" class\x3d"dijitTreeRow" role\x3d"presentation"\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNode" class\x3d"dijitInline dijitTreeExpando" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"expandoNodeText" class\x3d"dijitExpandoText" role\x3d"presentation"\x3e\x3c/span\r\n\t\t\x3e\x3cspan data-dojo-attach-point\x3d"contentNode"\r\n\t\t\tclass\x3d"dijitTreeContent" role\x3d"presentation"\x3e\r\n\t\t\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTreeIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\r\n\t\t\t\x3e\x3cspan data-dojo-attach-point\x3d"labelNode,focusNode" class\x3d"dijitTreeLabel" role\x3d"treeitem"\r\n\t\t\t\t   tabindex\x3d"-1" aria-selected\x3d"false" id\x3d"${id}_label"\x3e\x3c/span\x3e\r\n\t\t\x3c/span\r\n\t\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeNodeContainer" role\x3d"presentation"\r\n\t\t style\x3d"display: none;" aria-labelledby\x3d"${id}_label"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/Tree.html":'\x3cdiv role\x3d"tree"\x3e\r\n\t\x3cdiv class\x3d"dijitInline dijitTreeIndent" style\x3d"position: absolute; top: -9999px" data-dojo-attach-point\x3d"indentDetector"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTreeExpando dijitTreeExpandoLoading" data-dojo-attach-point\x3d"rootLoadingIndicator"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"containerNode" class\x3d"dijitTreeContainer" role\x3d"presentation"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',"url:jimu/dijit/templates/FeaturelayerChooserFromPortal.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"selector-container" data-dojo-attach-point\x3d"selectorContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"footer"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-point\x3d"btnCancel" data-dojo-attach-event\x3d"onclick:_onBtnCancelClicked"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing next jimu-state-disabled" data-dojo-attach-point\x3d"btnNext" data-dojo-attach-event\x3d"onclick:_onBtnNextClicked"\x3e${nls.next}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing ok jimu-state-disabled" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClicked"\x3e${nls.ok}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing back" data-dojo-attach-point\x3d"btnBack" data-dojo-attach-event\x3d"onclick:_onBtnBackClicked"\x3e${nls.back}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/ItemSelector.html":'\r\n\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"setting-tab-container"\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"tabNode"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content mycontent-tab" data-dojo-attach-point\x3d"mycontentTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main mycontent-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onMyContentSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"mycontentItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content organization-tab" data-dojo-attach-point\x3d"organizationTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main organization-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onOrganizationSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"organizationItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:50px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content group-tab" data-dojo-attach-point\x3d"groupTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main group-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv class\x3d"groups-section" data-dojo-attach-point\x3d"groupsSection"\x3e\r\n\t\t\t\t\t\x3cdiv\x3e${nls.groups}:\x3c/div\x3e\r\n\t\t\t\t\t\x3cselect class\x3d"groups-select" data-dojo-attach-point\x3d"groupsSelect"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"nodata"\x3e${nls.noneGroups}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onGroupSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"groupItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\' style\x3d"top:85px;"\x3e\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3cdiv class\x3d"tab-content public-tab" data-dojo-attach-point\x3d"publicTabNode"\x3e\r\n\t\t\t\x3cdiv class\x3d"tab-content-main public-tab-content-main"\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicSearch" data-dojo-type\x3d"jimu/dijit/Search" data-dojo-props\x3d\'searchWhenInput:false\' data-dojo-attach-event\x3d"onSearch:_onPublicSearch" style\x3d"position:absolute;width:100%;top:0;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3cdiv class\x3d"public-search-radios"\x3e\r\n\t\t\t\t\t\x3cfieldset id\x3d"publicSearchRaido"\x3e\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"portalPublicRaido" data-dojo-type\x3d"dijit/form/RadioButton" \r\n\t\t\t\t\t\t\tdata-label-id\x3d"portalPublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading portal-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"portalPublicLabel" data-label-for\x3d"portalPublicRaido" class\x3d"jimu-float-leading portal-public-label"\x3ePortal\x3c/label\x3e\r\n\r\n\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"onlinePublicRaido" data-dojo-type\x3d"dijit/form/RadioButton"\r\n\t\t\t\t\t\t\tdata-label-id\x3d"onlinePublicRaido" name\x3d"publicSearchRaido" class\x3d"jimu-float-leading online-public-radio" /\x3e\r\n\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"onlinePublicLabel" data-label-for\x3d"onlinePublicRaido" class\x3d"jimu-float-leading portal-public-label"\x3eArcGIS Online\x3c/label\x3e\r\n\t\t\t\t\t\x3c/fieldset\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicItemSection" class\x3d"public-item-section"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicPortalItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"publicOnlineItemTable" data-dojo-type\x3d"jimu/dijit/_ItemTable" data-dojo-props\x3d\'types:${_itemTypes},typeKeywords:${_typeKeywords}\'\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/div\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"signin-section" data-dojo-attach-point\x3d"signinSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cdiv class\x3d"signin-tip"\x3e${nls.signInTip}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_ItemTable.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"items-section all-items-section" data-dojo-attach-point\x3d"allItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"allItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onAllItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"allItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"allItemTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"allItemsShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"items-section filtered-items-section" data-dojo-attach-point\x3d"filteredItemsSection"\x3e\r\n\t\t\x3cdiv class\x3d"items-table-div" data-dojo-attach-point\x3d"filteredItemsTableDiv" data-dojo-attach-event\x3d"onscroll:_onFilteredItemsSectionScroll"\x3e\r\n\t\t\t\x3ctable class\x3d"items-table" cellpadding\x3d"10" data-dojo-attach-point\x3d"filteredItemsTable" data-dojo-attach-event\x3d"onclick:_onItemsTableClicked"\x3e\r\n\t\t\t\t\x3ctbody data-dojo-attach-point\x3d"filteredItemsTbody"\x3e\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"search-none-tip-section" data-dojo-attach-point\x3d"searchNoneTipSection" style\x3d"display:none;"\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-icon jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan class\x3d"search-none-tip jimu-state-error-text"\x3e${nls.searchNone}\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-attach-point\x3d"filteredItemShelter" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_BasicServiceChooserContent.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"content-section"\x3e\r\n\t\t\x3ctable class\x3d"layout"\x3e\r\n\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\x3ccol width\x3d"80px" align\x3d"right"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"auto"\x3e\x3c/col\x3e\r\n\t\t\t\t\x3ccol width\x3d"170px"\x3e\x3c/col\x3e\r\n\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3eURL:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"urlInput" data-dojo-type\x3d"jimu/dijit/URLInput" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\x3cdiv class\x3d"jimu-btn jimu-state-disabled validate-btn jimu-float-trailing" data-dojo-attach-point\x3d"btnValidate" data-dojo-attach-event\x3d"onclick:_onBtnValidateClick"\x3e${nls.validate}\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"exampleTr" class\x3d"example-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td" style\x3d"padding-top:5px;"\x3e\r\n\t\t\t\t\t\t\x3cspan title\x3d"${nls.example}:"\x3e${nls.example}:\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"exampleTd" colspan\x3d"2" style\x3d"padding-top:5px;font-style:italic;color:#ccc;"\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\t\x3cdiv class\x3d"service-browser-container" data-dojo-attach-point\x3d"serviceBrowserContainer"\x3e\r\n\t\t\t\x3cdiv class\x3d"error-section" data-dojo-attach-point\x3d"errorSection"\x3e\r\n\t\t\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"error-message" data-dojo-attach-point\x3d"errorNode"\x3e\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv class\x3d"operations"\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing cancel jimu-btn-vacation" data-dojo-attach-event\x3d"onclick:_onBtnCancelClick"\x3e${nls.cancel}\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d"jimu-btn jimu-float-trailing jimu-state-disabled ok" data-dojo-attach-point\x3d"btnOk" data-dojo-attach-event\x3d"onclick:_onBtnOkClick"\x3e${nls.ok}\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d\'hidden:true\'\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/SearchConfig/LocatorSourceSetting.html":'\x3cdiv\x3e\r\n  \x3cdiv class\x3d"source-url-section"\x3e\r\n    \x3ctable class\x3d"source-table" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.locatorUrl}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"locatorUrl" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true,disabled:true,style:{width:\'100%\'}"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"third"\x3e\r\n            \x3cspan title\x3d"${nls.set}" class\x3d"jimu-btn" data-dojo-attach-event\x3d"click:_onSetLocatorUrlClick"\x3e${nls.set}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cspan data-dojo-attach-point\x3d"messageNode" class\x3d"tip"\x3e\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"source-details-section" data-dojo-attach-point\x3d"detailsSection"\x3e\r\n    \x3ctable class\x3d"source-table" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e${nls.locatorName}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-point\x3d"locatorName" data-dojo-attach-event\x3d"Blur: _onLocatorNameBlur"\r\n            placeHolder\x3d"${nls.locatorName}"\r\n            required\x3d"true" data-dojo-props\x3d\'style:{width:"100%"}\'/\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e${nls.placeholderText}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"placeholder"\r\n            data-dojo-attach-event\x3d"Blur: _onPlaceholderBlur"\r\n            placeHolder\x3d"${nls.placeholderText}" data-dojo-props\x3d\'style:{width:"100%"}\'/\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr class\x3d"hide-country-code-row country-code-row" data-dojo-attach-point\x3d"countryCodeRow"\x3e\r\n          \x3ctd class\x3d"first"\x3e${nls.countryCode}\x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/TextBox" data-dojo-attach-point\x3d"countryCode"\r\n            data-dojo-attach-event\x3d"Blur:_onCountryCodeBlur"\r\n            placeHolder\x3d"${nls.countryCodeEg} USA,CHN" data-dojo-props\x3d\'style:{width:"96%"}\'/\x3e\r\n            \x3ca class\x3d"jimu-float-trailing" target\x3d"_blank" href\x3d"https://developers.arcgis.com/rest/geocode/api-reference/geocode-coverage.htm" style\x3d"line-height:30px;"\x3e\r\n              \x3ci class\x3d"esri-icon-question"\x3e\x3c/i\x3e\r\n            \x3c/a\x3e\r\n            \x3cspan class\x3d"example"\x3e${nls.countryCodeHint}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.maxSuggestions}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv class\x3d"source-tips" title\x3d"${nls.locatorTips}" data-dojo-attach-point\x3d"tipsNode"\x3e\r\n              ${nls.locatorTips}\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"maxSuggestions" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1,places:0},style:{width:\'100%\'},value:6"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first" colspan\x3d"2"\x3e\r\n            \x3cspan class\x3d"source-label" data-dojo-attach-point\x3d"enableLocalSearch"\x3e\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"minScaleNode" class\x3d"local-search-row"\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.minScale}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cspan class\x3d"jimu-float-leading" style\x3d"line-height:30px;"\x3e1: \x3c/span\x3e\r\n            \x3cdiv class\x3d"jimu-float-trailing" data-dojo-attach-point\x3d"localSearchMinScale" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1},style:{width:\'96%\'},value:300000"\x3e\x3c/div\x3e\r\n            \x3cspan class\x3d"example" title\x3d"${nls.minScaleHint}"\x3e${nls.minScaleHint}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr data-dojo-attach-point\x3d"radiusNode" class\x3d"local-search-row"\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cspan class\x3d"source-label"\x3e${nls.radius}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd class\x3d"second"\x3e\r\n            \x3cdiv class\x3d"jimu-float-leading" style\x3d"width:100%;"\x3e\r\n              \x3cdiv class\x3d"jimu-float-leading" data-dojo-attach-point\x3d"localSearchDistance" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"constraints:{min:1},style:{width:\'75%\'},value:50000"\x3e\x3c/div\x3e\r\n              \x3cspan class\x3d"jimu-float-trailing" style\x3d"line-height:30px;"\x3e${nls.meters}\x3c/span\x3e\r\n            \x3c/div\x3e\r\n            \x3cspan class\x3d"example" data-dojo-attach-point\x3d"radiusHintNode" title\x3d"${nls.radiusHint}"\x3e${nls.radiusHint}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \x3ctable class\x3d"source-table" cellspacing\x3d"0"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd class\x3d"first"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"searchInCurrentMapExtent"\x3e\x3c/div\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n    \r\n    \x3ctable class\x3d"source-table" style\x3d"margin-left: -2px;"\x3e\r\n      \x3ctbody\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd colspan\x3d"2" class\x3d"auto-complete-td" data-dojo-attach-point\x3d"autoComplete"\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"width:200px;"\x3e\r\n            \x3cspan class\x3d"search-delay"\x3e${nls.searchDelay}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd style\x3d"width:auto;"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"searchDelay" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d\'required:true,value:350,smallDelta:1,largeDelta:10,constraints:{min:10},intermediateChanges:true\'\r\n              type\x3d"text" style\x3d"width:220px;" /\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n        \x3ctr\x3e\r\n          \x3ctd style\x3d"width:200px;"\x3e\r\n            \x3cspan class\x3d"min-characters jimu-ellipsis"\x3e${nls.minCharacters}\x3c/span\x3e\r\n          \x3c/td\x3e\r\n          \x3ctd style\x3d"width:auto;"\x3e\r\n            \x3cinput data-dojo-attach-point\x3d"minCharacters" data-dojo-type\x3d"dijit/form/NumberSpinner" data-dojo-props\x3d\'required:true,value:3,smallDelta:1,largeDelta:1,constraints:{min:3},intermediateChanges:true\'\r\n              type\x3d"text" style\x3d"width:220px;" /\x3e\r\n          \x3c/td\x3e\r\n        \x3c/tr\x3e\r\n      \x3c/tbody\x3e\r\n    \x3c/table\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"shelter" data-dojo-type\x3d"jimu/dijit/LoadingShelter" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Directions/setting/BarrierLayers.html":'\x3cdiv\x3e\r\n  \x3cspan class\x3d"title"\x3e${nls.barrierLayers}\x3c/span\x3e\r\n  \x3ctable style\x3d"width:98%;" cellspacing\x3d"0"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr\x3e\r\n        \x3ctd style\x3d"width:200px;"\x3e\r\n          \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.pointBarrier}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd style\x3d"width:auto;"\x3e\r\n          \x3cdiv class\x3d"barrierLayersNode" data-dojo-attach-point\x3d"pointLayersNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n\r\n      \x3ctr\x3e\r\n        \x3ctd style\x3d"width:200px;"\x3e\r\n          \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.lineBarrier}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd style\x3d"width:auto;"\x3e\r\n          \x3cdiv class\x3d"barrierLayersNode" data-dojo-attach-point\x3d"polylineLayersNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n\r\n      \x3ctr\x3e\r\n        \x3ctd style\x3d"width:200px;"\x3e\r\n          \x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.polygonBarrier}\x3c/span\x3e\r\n        \x3c/td\x3e\r\n        \x3ctd style\x3d"width:auto;"\x3e\r\n          \x3cdiv class\x3d"barrierLayersNode" data-dojo-attach-point\x3d"polygonLayersNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/Setting.html":'\x3cdiv style\x3d"width:100%;height:auto;"\x3e\r\n\t\x3cdiv class\x3d"query-setting-content" data-dojo-attach-point\x3d"content"\x3e\r\n\t\t\x3c!-- search tab --\x3e\r\n\t\t\x3cdiv class\x3d"search-section" data-dojo-attach-point\x3d"searchTabNode" onselectstart\x3d"return false;"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"searchConfigNode"\x3e\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\r\n\t\t\x3c!-- route tab --\x3e\r\n\t\t\x3cdiv class\x3d"route-section" data-dojo-attach-point\x3d"routeTabNode" onselectstart\x3d"return false;"\x3e\r\n\t\t\t\x3ctable style\x3d"width:98%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\x3ccolgroup\x3e\r\n\t\t\t\t\t\x3ccol width\x3d"200px" /\x3e\r\n\t\t\t\t\t\x3ccol width\x3d"auto" /\x3e\r\n\t\t\t\t\x3c/colgroup\x3e\r\n\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cspan class\x3d"jimu-ellipsis"\x3e${nls.routeUrl}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd class\x3d"route-td"\x3e\r\n\t\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"routeUrl" data-dojo-type\x3d"jimu/dijit/ServiceURLComboBox" data-dojo-attach-props\x3d"trim:true;hasDownArrow:false;autoComplete:true"\r\n\t\t\t\t\t\t\t id\x3d"routeLayer" name\x3d"routeLayer" style\x3d"width:100%;height:30px;"\x3e\r\n\t\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cspan\x3e${nls.travelModesUrl}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd class\x3d"travelmodes-td"\x3e\r\n\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"travelModesUrl" data-dojo-type\x3d"jimu/dijit/ServiceURLInput"\r\n\t\t\t\t\t\t\t data-dojo-attach-props\x3d"trim:true" type\x3d"text" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cspan\x3e${nls.trafficLayerUrl}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd class\x3d"trafficlayer-td"\x3e\r\n\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"trafficLayerUrl" data-dojo-type\x3d"jimu/dijit/ServiceURLInput"\r\n\t\t\t\t\t\t\t data-dojo-attach-props\x3d"trim:true" type\x3d"text" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\x3ctr style\x3d"display:none;"\x3e\r\n\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\x3cspan\x3e${nls.barrierLayerUrl}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\r\n\t\t\t\x3cspan class\x3d"title"\x3e${nls.routeOptions}\x3c/span\x3e\r\n\t\t\t\x3ctable style\x3d"width:98%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd style\x3d"width:50%;"\x3e\r\n\t\t\t\t\t\t\t\x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:200px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cspan class\x3d"jimu-ellipsis"\x3e${nls.directionsLanguage}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"directionsLanguage" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n\t\t\t\t\t\t\t\t\t\t\t data-dojo-props\x3d\'required:true\' style\x3d"width:220px;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd style\x3d"width:50%;"\x3e\r\n\t\t\t\t\t\t\t\x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:200px"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cspan class\x3d"length-units jimu-ellipsis"\x3e${nls.directionsLengthUnits}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"directionsLengthUnits" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:220px;height:30px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriFeet"\x3e${nls.feet}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriKilometers" selected\x3e${nls.kilometers}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriMeters"\x3e${nls.meters}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriMiles"\x3e${nls.miles}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriNauticalMiles"\x3e${nls.nauticalMiles}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"esriYards"\x3e${nls.yards}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\x3ctd style\x3d"width:50%;display: none;"\x3e\r\n\t\t\t\t\t\t\t\x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:200px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cspan class\x3d"jimu-ellipsis"\x3e${nls.directionsOutputType}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"directionsOutputType" data-dojo-type\x3d"dijit/form/Select" style\x3d"width:220px;height:30px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"standard"\x3e${nls.standard}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"complete" selected\x3e${nls.complete}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"complete-no-events"\x3e${nls.completeNoEvents}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"instructions-only"\x3e${nls.instructionsOnly}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3coption value\x3d"summary-only"\x3e${nls.summaryOnly}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\x3ctd style\x3d"width:50%;"\x3e\r\n\t\t\t\t\t\t\t\x3ctable style\x3d"width:100%;" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:200px;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cspan class\x3d"impedance-attribute jimu-ellipsis"\x3e${nls.impedanceAttribute}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:auto;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"impedanceAttribute" data-dojo-type\x3d"dijit/form/ValidationTextBox" style\x3d"width:220px;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\t\r\n\t\t\x3c!-- preset destinations --\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"presetDestinations"\x3e\x3c/div\x3e\r\n\r\n\t\t\x3c!-- BarrierLayers --\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"barrierLayersNode"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Directions/setting/css/style.css":".jimu-widget-directions-setting{font-size: 14px; margin-bottom: 20px;}.jimu-widget-directions-setting .title{display:inline-block; font-size: 16px; font-weight:bold; margin:10px 0 5px 0px;}.jimu-widget-directions-setting .route-section table \x3e tbody \x3e tr \x3e td{padding:5px 0;}.jimu-widget-directions-setting .route-td{padding-left: 10px;}.jimu-widget-directions-setting .jimu-ellipsis{white-space: normal;}.jimu-rtl .jimu-widget-directions-setting .route-td{padding-left: 0; padding-right: 10px;}.jimu-widget-directions-setting .locator-td{padding-left: 10px;}.jimu-rtl .jimu-widget-directions-setting .locator-td{padding-left: 0; padding-right: 10px;}.jimu-widget-directions-setting .travelmodes-td{padding-left: 10px;}.jimu-rtl .jimu-widget-directions-setting .travelmodes-td{padding-left: 0; padding-right: 10px;}.jimu-widget-directions-setting .trafficlayer-td{padding-left: 10px;}.jimu-rtl .jimu-widget-directions-setting .trafficlayer-td{padding-left: 0; padding-right: 10px;}.jimu-widget-directions-setting .auto-complete-td span{margin-left: 10px;}.jimu-rtl .jimu-widget-directions-setting .auto-complete-td span{margin-left: 0px; margin-right: 10px;}.jimu-widget-directions-setting .searchResults.arcgisSearch{position: relative;}.jimu-widget-directions-setting .arcgisSearch{width: 220px;}.jimu-widget-directions-setting .arcgisSearch .searchMenu {position: absolute;}.jimu-widget-directions-setting .arcgisSearch .searchMenu.searchResultsMenu{width: 220px !important;}.jimu-widget-directions-setting .arcgisSearch .showNoResults .noResultsMenu{height: 122px;}.jimu-widget-directions-setting .arcgisSearch .hasValue.showNoResults .noResultsMenu{display: block !important;}.jimu-widget-directions-setting .arcgisSearch .searchGroup .searchInput{width:168px; padding: 6px; border-radius: 0; border-left: 6px green solid; overflow: hidden; text-overflow:ellipsis; white-space: nowrap;}.jimu-widget-directions-setting .end-search .arcgisSearch .searchGroup .searchInput{border-left: 6px red solid;}.jimu-rtl .jimu-widget-directions-setting .arcgisSearch .searchGroup .searchInput{border-left: none; border-right: 6px green solid;}.jimu-rtl .jimu-widget-directions-setting .end-search .arcgisSearch .searchGroup .searchInput{border-left: none; border-right: 6px red solid;}.jimu-widget-directions-setting .arcgisSearch .searchBtn{border-radius: 0; border-left: 0; padding: 6px;}.jimu-widget-directions-setting .searchGroup .searchExpandContainer .searchBtn.searchToggle{display: none;}.jimu-rtl .jimu-widget-directions-setting .arcgisSearch .searchBtn{border-right: 0; border-left: 1px solid #57585A;}.jimu-widget-directions-setting .arcgisSearch .searchClear{display: none;}.jimu-widget-directions-setting .hide{display: none;}.jimu-widget-directions-setting .preset-des-error{color:red;}.jimu-widget-directions-setting .barrierLayersNode{padding: 5px 0;}.jimu-widget-directions-setting .barrierLayersNode \x3e table{background-color: transparent; width: 100%;}.search-config .group-label{display: inline-block; margin-bottom: 10px; font-weight: bold;}.search-config .instruction{font-size: 12px;}.search-config .dropdown-button {margin: 8px 0; display: inline-block; position: relative; padding-left: 16px; color: #518dca; background: url(images/add_icon.png) no-repeat left; cursor: pointer;}.jimu-rtl .search-config .dropdown-button{padding-left: 0; padding-right: 16px; background-position: right;}.search-config .dropdown-button .dropdown-menu{position: absolute; display: none; list-style-type: none; top: 16px; left: 0; margin: 0; padding: 0; background: #fafafa; color: #7989a0; z-index: 999;}.jimu-rtl .search-config .dropdown-button .dropdown-menu{right: 0; left: auto;}.search-config .dropdown-button:hover .dropdown-menu{display: inline-block;}.search-config .dropdown-menu .dropdown-item{white-space: nowrap; height: 30px; padding: 0 25px; line-height: 30px;}.search-config .dropdown-menu .dropdown-item:hover{background: #edf2f5; color: #15a4fa;}.search-config .sources{height: 366px;}.search-config .source-list{width: 270px; height: 100%;}.search-config .source-setting{width: 660px; position: relative; overflow: auto; padding-right: 5px;}.search-config .source-setting .source-tips{display: none; font-size: 12px; color: #999;}.search-config .source-setting .source-tips-show{display: block;}.search-config .source-table,.search-config .general-setting-table{width: 100%;}.search-config .search-fields-selector {display: inline-block; margin: 6px 0; width: 18px; height: 18px; background: url(images/selector.png) no-repeat center;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row td,.search-config .jimu-widget-search-locator-source-setting .source-details-section .local-search-row td{padding-bottom: 35px; position: relative;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .local-search-row .first{padding-left: 20px;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row a{text-decoration: none;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row .esri-icon-question{color: #485566; font-style: normal;}.jimu-rtl .search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row .esri-icon-question{transform: rotateY(180deg); display: inline-block;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row .example,.search-config .jimu-widget-search-locator-source-setting .source-details-section .local-search-row .example{position: absolute; top: 35px; left: 0; font-size: 12px; color: #999;}.jimu-rtl .search-config .jimu-widget-search-locator-source-setting .source-details-section .country-code-row .example{left: auto; right: 0;}.search-config .jimu-widget-search-locator-source-setting .source-details-section .hide-country-code-row,.search-config .jimu-widget-search-locator-source-setting .hide-local-search-table {display: none;}.search-config .source-url-section .source-table \x3e tbody \x3e tr:first-child \x3e td {padding-bottom: 5px;}.search-config .source-table \x3e tbody \x3e tr \x3e td{padding-bottom: 10px;}.search-config .source-table \x3e tbody \x3e tr \x3e .first{width: auto; text-align: left; padding-right: 10px; white-space: nowrap;}.search-config .source-table \x3e tbody \x3e tr \x3e .second{width:550px;}.search-config .source-table \x3e tbody \x3e tr \x3e .third{width: 70px; padding-left: 10px;}.jimu-rtl .search-config .source-table \x3e tbody \x3e tr \x3e .first{padding-left: 10px; padding-right: 0;}.jimu-rtl .search-config .source-table \x3e tbody \x3e tr \x3e .first{text-align: right; padding-left: 10px; padding-right: auto;}.jimu-rtl .search-config .source-table \x3e tbody \x3e tr \x3e .third{padding-left: 0; padding-right: 10px;}.jimu-widget-query-source-setting .source-url-section .source-table \x3e tbody \x3e tr \x3e .second {width: 455px;}.search-config .source-table .jimu-btn{padding: 0; line-height: 30px; width: 60px;}.search-config .source-table \x3e tbody \x3e tr \x3e .second .tip{font-size: 12px; color: #999; width: 100%; display: inline-block;}.search-config .source-table .error-message{color: #e84b4b !important;}.search-config .jimu-basic-service-chooser {width: auto;}.search-config .override-geocode-service-chooser-content {width: 580px !important; min-height: 150px !important;}.search-config .override-geocode-service-chooser-content .service-browser-container{display: none;}.direction-setting.jimu-widget-search-query-source-setting-fields .fields-checkbox{width: 167px; margin-bottom: 20px; color: #596679; font-size: 14px; margin-left: 30px;}.direction-setting.jimu-widget-search-query-source-setting-fields .fields-checkbox .label{width: 140px;}.jimu-rtl .direction-setting.jimu-widget-search-query-source-setting-fields .fields-checkbox{margin-right: 30px; margin-left: auto;}",
"*now":function(m){m(['dojo/i18n!*preload*widgets/Directions/setting/nls/Setting*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare dojo/_base/lang dojo/on dojo/_base/html dojo/_base/config dojo/Deferred dijit/_WidgetsInTemplateMixin jimu/BaseWidgetSetting jimu/utils jimu/portalUtils ./PresetDestinations ./SearchConfig/SearchConfig jimu/dijit/Message ../searchUtil ./BarrierLayers jimu/dijit/TabContainer jimu/dijit/CheckBox jimu/dijit/ServiceURLComboBox jimu/dijit/ServiceURLInput dijit/form/NumberSpinner dijit/form/ValidationTextBox dijit/form/Select".split(" "),function(m,k,l,t,u,f,e,c,n,r,v,a,y,w,x,
h){return m([c,e],{baseClass:"jimu-widget-directions-setting",_ROUTE_WORLD:"Route_World",_serviceUrlInputInvalidClass:"jimu-serviceurl-input-invalid",_routeTaskUrl:"http://route.arcgis.com/arcgis/rest/services/World/Route/NAServer/",_locatorUrl:"http://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer",_travelModesUrl:"http://logistics.arcgis.com/arcgis/rest/services/World/Utilities/GPServer",_trafficLayerUrl:"http://traffic.arcgis.com/arcgis/rest/services/World/Traffic/MapServer",postMixInProperties:function(){this.nls.complete||
(this.nls.complete="Complete");this.nls.completeNoEvents||(this.nls.completeNoEvents="Complete No Events");this.nls.instructionsOnly||(this.nls.instructionsOnly="Instructions Only");this.nls.standard||(this.nls.standard="Standard");this.nls.summaryOnly||(this.nls.summaryOnly="Summary Only");this.nls.travelModesUrl||(this.nls.travelModesUrl="Travel Modes URL");this.nls.example||(this.nls.example=this.nls.optional+" "+window.jimuNls.basicServiceChooser.example+" : ")},postCreate:function(){this.inherited(arguments);
this.portal=r.getPortal(this.appConfig.portalUrl);this.routeUrl.setProcessFunction(k.hitch(this,function(a){var c=!1;a&&a.data&&(c="esriNAServerRouteLayer"===a.data.layerType);if(!0===c)return c;this._setRouteUrl(a);a=this._getHandledUrlFromServiceUrlInput(this.routeUrl);return/\/rest\/services\/.+\/NAServer/i.test(a)}));this.travelModesUrl.setProcessFunction(k.hitch(this,function(){var a=this._getHandledUrlFromServiceUrlInput(this.travelModesUrl);return/\/rest\/services\/.+\/GPServer/gi.test(a)}),
k.hitch(this,function(){this.travelModesUrl.get("value")||t.removeClass(this.travelModesUrl.domNode,this._serviceUrlInputInvalidClass)}));this.trafficLayerUrl.setProcessFunction(k.hitch(this,function(){var a=this._getHandledUrlFromServiceUrlInput(this.trafficLayerUrl);return/\/rest\/services\/.+\/MapServer/gi.test(a)}),k.hitch(this,function(){this.trafficLayerUrl.get("value")||t.removeClass(this.trafficLayerUrl.domNode,this._serviceUrlInputInvalidClass)}));this.portal.loadSelfInfo().then(k.hitch(this,
function(a){var c=this._getRouteUrlFromPortalSelf(a);c&&this.routeUrl.set("placeHolder",c);(c=this._getTravelModesUrlFromPortalSelf(a))?this.travelModesUrl.set("placeHolder",this.nls.example+c):this.travelModesUrl.set("placeHolder",this.nls.example+this._travelModesUrl);(a=this._getTrafficLayerUrlFromPortalSelf(a))?this.trafficLayerUrl.set("placeHolder",this.nls.example+a):this.trafficLayerUrl.set("placeHolder",this.nls.example+this._trafficLayerUrl)}));this.barrierLayers=new x({nls:this.nls,map:this.map,
barrierLayers:this.config.barrierLayers},this.barrierLayersNode);this.barrierLayers.startup();this.presetDestinations=new v({nls:this.nls,map:this.map,defaultLocations:this.config.defaultLocations||[]},this.presetDestinations);this.presetDestinations.startup()},_getHandledUrlFromServiceUrlInput:function(a){a=a.get("value");return n.removeSuffixSlashes(a)},startup:function(){this.inherited(arguments);this.tabContainer=new h({tabs:[{title:this.nls.searchTabTitle,content:this.searchTabNode},{title:this.nls.routeTabTitle,
content:this.routeTabNode}],isNested:!0},this.content);this.tabContainer.startup();this.own(l(this.tabContainer,"tabChanged",k.hitch(this,function(a){a===this.nls.routeTabTitle&&this._setPresetDestinationsSources()})));this.searchConfig=new a({nls:this.nls,map:this.map,appConfig:this.appConfig,config:this.config},this.searchConfigNode);this.searchConfig.startup();this.own(l(this.searchConfig,"isConfigValid",k.hitch(this,function(a){"true"===a?this.settingPagePopup.enableButton(0):this.settingPagePopup.disableButton(0)})));
this.setConfig(this.config)},destroy:function(){this.directionsLengthUnits&&this.directionsLengthUnits.destroy&&(this.directionsLengthUnits.closeDropDown(),this.directionsLengthUnits.destroy());this.barrierLayers&&this.barrierLayers.destroy&&this.barrierLayers.destroy();this.inherited(arguments)},setConfig:function(a){if(this.config=a)(a=this.config.routeOptions)&&"object"===typeof a&&(this.directionsLanguage.set("value",a.directionsLanguage||u.locale||"en_us"),this.directionsLengthUnits.set("value",
a.directionsLengthUnits),this.impedanceAttribute.set("value",a.impedanceAttribute)),this._getRouteTaskUrl().then(k.hitch(this,function(a){this.routeUrl.set("value",a)})),this.config.travelModesUrl&&this.travelModesUrl.set("value",this.config.travelModesUrl),this.config.trafficLayerUrl&&this.trafficLayerUrl.set("value",this.config.trafficLayerUrl),this.config.barrierLayers&&this.barrierLayers.setValue(this.config.barrierLayers)},_getRouteTaskUrl:function(){var a=new f;this.config.routeTaskUrl?a.resolve(this.config.routeTaskUrl):
this.portal.loadSelfInfo().then(k.hitch(this,function(c){(c=this._getRouteUrlFromPortalSelf(c))?a.resolve(c):a.resolve(this._routeTaskUrl)}),k.hitch(this,function(c){console.error(c);a.resolve(this._routeTaskUrl)}));return a},_suffixWithSlant:function(a,c){return a=this._endsWith(a,"/")?a+c:a+("/"+c)},_endsWith:function(a,c){return-1!==a.indexOf(c,a.length-c.length)},_getRouteUrlFromPortalSelf:function(a){var c="";a&&a.helperServices&&(a=a.helperServices.route)&&a.url&&(c=a.url);return c},_getTravelModesUrlFromPortalSelf:function(a){var c=
"";a&&a.helperServices&&(a=a.helperServices.routingUtilities)&&a.url&&(c=a.url);return c},_getTrafficLayerUrlFromPortalSelf:function(a){var c="";a&&a.helperServices&&(a=a.helperServices.traffic)&&a.url&&(c=a.url);return c},getConfig:function(){if("valid"!==this.routeUrl.getStatus())return this._showValidationErrorTip(this.routeUrl),this._showParametersTip(),!1;if(this.travelModesUrl.get("value")&&"valid"!==this.travelModesUrl.getStatus())return this._showValidationErrorTip(this.travelModesUrl),this._showParametersTip(),
!1;if(this.trafficLayerUrl.get("value")&&"valid"!==this.trafficLayerUrl.getStatus())return this._showValidationErrorTip(this.trafficLayerUrl),this._showParametersTip(),!1;if(!this.directionsLanguage.validate())return this._showValidationErrorTip(this.directionsLanguage),this._showParametersTip(),!1;if(!this.barrierLayers.validate())return this._showValidationErrorTip(this.barrierLayers),this._showParametersTip(),!1;if(this.presetDestinations&&!1===this.presetDestinations.validate()||!1===this.searchConfig.validate())return!1;
var a=this.searchConfig.getConfig();this.config={routeTaskUrl:this._getHandledUrlFromServiceUrlInput(this.routeUrl),travelModesUrl:this._getHandledUrlFromServiceUrlInput(this.travelModesUrl),trafficLayerUrl:this._getHandledUrlFromServiceUrlInput(this.trafficLayerUrl),routeOptions:{directionsLanguage:this.directionsLanguage.get("value"),directionsLengthUnits:this.directionsLengthUnits.get("value"),impedanceAttribute:this.impedanceAttribute.get("value")},searchOptions:a,defaultLocations:this.presetDestinations.getValue(),
barrierLayers:this.barrierLayers.getValue()};w.version.upgradeConfig(this.config);return this.config},_showValidationErrorTip:function(a){!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),setTimeout(k.hitch(this,function(){a.focusNode.blur()}),100))},_showParametersTip:function(){new y({message:this.nls.parametersTip})},_setRouteUrl:function(a){if(a&&a.data&&a.data.routeLayers){for(var c=this.routeUrl.getValue(),d=!1,e=0,b=a.data.routeLayers.length;e<b;e++){var f=a.data.routeLayers[e],h=
{id:f,name:this._suffixWithSlant(c,f),value:this._suffixWithSlant(c,f)};f===this._ROUTE_WORLD&&(d=!0);this.routeUrl.store.put(h)}d&&this.routeUrl.setValue(this._suffixWithSlant(c,this._ROUTE_WORLD))}},_setPresetDestinationsSources:function(){var a=this.searchConfig.getConfig();this.presetDestinations.setSources(a)}})});