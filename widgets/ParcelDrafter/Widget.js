// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/ParcelDrafter/PlanSettings":function(){define("dojo/_base/declare dojo/_base/array jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./PlanSettings.html dojo/_base/lang dojo/Evented dojo/dom-class dojo/query ./utils jimu/utils libs/storejs/store jimu/dijit/formSelect".split(" "),function(l,a,b,h,f,g,m,d,q,u,p,k){return l([b,h,m],{baseClass:"jimu-widget-ParcelDrafter-PlanSettings",templateString:f,selectedPlanSettings:{},planSettingsOptions:g.clone(u.planSettingsOptions),
planSettingsKey:null,constructor:function(b){g.mixin(this,b)},startup:function(){var b=this._retriveFromLocalCache();b||(b={areaUnits:this.planSettingsOptions.areaUnits[1],circularCurveParameters:this.planSettingsOptions.circularCurveParameters[0],directionOrAngleType:this.planSettingsOptions.directionOrAngleType[0],directionOrAngleUnits:this.planSettingsOptions.directionOrAngleUnits[0],distanceAndLengthUnits:this.planSettingsOptions.distanceAndLengthUnits[1]});this._loadOptionsForDropDown(this.directionOrAngleType,
this.planSettingsOptions.directionOrAngleType,b.directionOrAngleType);this._loadOptionsForDropDown(this.directionOrAngleUnits,this.planSettingsOptions.directionOrAngleUnits,b.directionOrAngleUnits);this._loadOptionsForDropDown(this.distanceAndLengthUnits,this.planSettingsOptions.distanceAndLengthUnits,b.distanceAndLengthUnits);this._loadOptionsForDropDown(this.areaUnits,this.planSettingsOptions.areaUnits,b.areaUnits);this._loadOptionsForDropDown(this.circularCurveParameters,this.planSettingsOptions.circularCurveParameters,
b.circularCurveParameters);this.onPlansettingsChanged()},postCreate:function(){this.inherited(arguments);this.planSettingsKey=this.getKey();this.selectedPlanSettings={};this.planSettingsOptions=g.clone(u.planSettingsOptions);d.add(this.domNode,"esriCTPlanSettingsContainer esriCTFullWidth");setTimeout(g.hitch(this,this._setBackgroundColorForDartTheme),500)},postMixInProperties:function(){this.inherited(arguments);this.isRenderIdForAttrs=!0},_setBackgroundColorForDartTheme:function(){var b,a,g;if("DartTheme"===
this.appConfig.theme.name)for(b=q(".dijitSelect .dijitButtonContents",this.planSettingsNode),g=q(".dijitSelect .dijitArrowButton",this.planSettingsNode),a=0;a<b.length&&a<g.length;a++)d.add(b[a],"dijitButtonContentsDartTheme"),d.add(g[a],"dijitArrowButtonDartTheme")},_loadOptionsForDropDown:function(b,d,k){var f=[],n;a.forEach(d,g.hitch(this,function(b){n={value:b,label:this.nls.planSettings[b]||window.jimuNls.units[b]};k===b&&(n.selected=!0);f.push(n)}));b.addOption(f)},_isSettingsChanged:function(){var b=
!1;this.selectedPlanSettings.directionOrAngleType!==this.directionOrAngleType.get("value")?b=!0:this.selectedPlanSettings.directionOrAngleUnits!==this.directionOrAngleUnits.get("value")?b=!0:this.selectedPlanSettings.distanceAndLengthUnits!==this.distanceAndLengthUnits.get("value")?b=!0:this.selectedPlanSettings.areaUnits!==this.areaUnits.get("value")?b=!0:this.selectedPlanSettings.circularCurveParameters!==this.circularCurveParameters.get("value")&&(b=!0);return b},onClose:function(){if(this._isSettingsChanged())this.onPlansettingsChanged()},
onPlansettingsChanged:function(){this.selectedPlanSettings={directionOrAngleType:this.directionOrAngleType.get("value"),directionOrAngleUnits:this.directionOrAngleUnits.get("value"),distanceAndLengthUnits:this.distanceAndLengthUnits.get("value"),areaUnits:this.areaUnits.get("value"),circularCurveParameters:this.circularCurveParameters.get("value")};this._saveToLocalCache(this.selectedPlanSettings);this.emit("planSettingsChanged",this.selectedPlanSettings)},_saveToLocalCache:function(b){try{k.set(this.planSettingsKey,
b)}catch(y){console.log("ParcelDrafter: Error in storeing settings to local cache.")}},_retriveFromLocalCache:function(){var b=null;try{b=k.get(this.planSettingsKey)}catch(y){console.log("ParcelDrafter: Error in retriving settings from local cache.")}return b},getKey:function(){return"ParcelDrafterPlanSettings."+encodeURIComponent(p.getAppIdFromUrl())+"."+this.widgetId},updateLastNodeInPlanSetting:function(){p.initLastFocusNode(this.widgetDomNode,this.circularCurveParameters.domNode)}})})},"widgets/ParcelDrafter/utils":function(){define([],
function(){var l={bearingFieldPlaces:2,planSettingsOptions:{directionOrAngleType:["northAzimuth","southAzimuth","quadrantBearing"],directionOrAngleUnits:["decimalDegree","degreeMinuteSeconds"],distanceAndLengthUnits:["uSSurveyFeet","feet","meters"],areaUnits:["squareUSSurveyFeet","squareFeet","acres","squareMeters"],circularCurveParameters:["radiusAndChordLength","radiusAndArcLength"]},getQuadrant:function(a){return{"-1":"NE","-2":"SE","-3":"SW","-4":"NW"}[a]},getQuadrantShortcut:function(a){a=a.toUpperCase();
return{NE:"-1",SE:"-2",SW:"-3",NW:"-4"}[a]},getQuadrantShortcutFromDD:function(a){var b;0<=a&&90>=a?b="-1":90<a&&180>=a?b="-2":180<a&&270>a?b="-3":270<=a&&360>a&&(b="-4");return b},getQuadrantAngleFromNADD:function(a){a=l.getQuadrantAngleAndShortcut(a);return a.quadrant.charAt(0)+a.quadrantAngle+a.quadrant.charAt(1)},getSouthAzimuthFromNorthAzimuth:function(a){var b;180<a?b=a-180:180>a?b=a+180:180===a&&(b=0);return b},DMStoDD:function(a){var b,h,f;b=Math.abs(parseFloat(a.degree));h=parseFloat(a.minutes);
f=parseFloat(a.seconds);b=b+h/60+f/3600;a.isNegative&&(b*=-1);return b},DDtoDMS:function(a){var b,h;b=3600*a.angle;a=Math.round(b%60);a=60==a?0:a;h=(b-a)/60;b=Math.round(h%60);b=60==b?0:b;return{degree:Math.round((h-b)/60),minutes:b,seconds:a}},getBearingObjForFormat0:function(a){var b,h;b={};b.degree=parseInt(a[1],10);b.minutes=parseInt(a[2]||0,10);b.seconds=parseInt(a[3]||0,10);b.quadrant=l.getQuadrant("-"+a[4]);b.quadrantShortcut="-"+a[4];"string"===typeof a[1]&&(h="-"===a[1].charAt(0));b.decimalDegrees=
l.DMStoDD({degree:b.degree,minutes:b.minutes,seconds:b.seconds,isNegative:h});return b},getBearingObjForFormat1:function(a){var b,h;b={};b.degree=parseInt(a[2],10);b.minutes=parseInt(a[3]||0,10);b.seconds=parseInt(a[4]||0,10);b.quadrant=a[1]+a[5];b.quadrantShortcut=l.getQuadrantShortcut(a[1]+a[5]);"string"===typeof a[2]&&(h="-"===a[2].charAt(0));b.decimalDegrees=l.DMStoDD({degree:b.degree,minutes:b.minutes,seconds:b.seconds,isNegative:h});return b},getBearingObjForFormat2:function(a){var b,h;b={};
b.degree=parseInt(a[2],10);b.minutes=parseInt(a[3]||0,10);b.seconds=parseInt(a[4]||0,10);b.quadrant=a[1]+a[5];b.quadrantShortcut=l.getQuadrantShortcut(a[1]+a[5]);"string"===typeof a[2]&&(h="-"===a[2].charAt(0));b.decimalDegrees=l.DMStoDD({degree:b.degree,minutes:b.minutes,seconds:b.seconds,isNegative:h});return b},getBearingObjForFormat3:function(a){var b,h;b={};b.degree=parseInt(a[1],10);b.minutes=parseInt(a[2]||0,10);b.seconds=parseInt(a[3]||0,10);"string"===typeof a[1]&&(h="-"===a[1].charAt(0));
b.decimalDegrees=l.DMStoDD({degree:b.degree,minutes:b.minutes,seconds:b.seconds,isNegative:h});b.quadrantShortcut=l.getQuadrantShortcutFromDD(b.decimalDegrees);b.quadrant=l.getQuadrant(b.quadrantShortcut);return b},getBearingObjForFormat4:function(a){var b,h;b=l.DDtoDMS({angle:a[1]});h={};h.degree=b.degree;h.minutes=b.minutes;h.seconds=b.seconds;h.decimalDegrees=a[1];h.quadrantShortcut=l.getQuadrantShortcutFromDD(h.decimalDegrees);h.quadrant=l.getQuadrant(h.quadrantShortcut);return h},getBearingObjForFormat5:function(a){var b,
h;b={};b.degree=parseInt(a[1],10);b.minutes=parseInt(a[2]||0,10);b.seconds=parseInt(a[3]||0,10);"string"===typeof a[1]&&(h="-"===a[1].charAt(0));b.decimalDegrees=l.DMStoDD({degree:b.degree,minutes:b.minutes,seconds:b.seconds,isNegative:h});b.quadrantShortcut=l.getQuadrantShortcutFromDD(b.decimalDegrees);b.quadrant=l.getQuadrant(b.quadrantShortcut);return b},getBearingObjForFormat6:function(a){var b,h;b={};b.degree=parseInt(a[1],10);b.minutes=parseInt(a[2]||0,10);b.seconds=parseInt(a[3]||0,10);b.quadrantShortcut=
a[4];b.quadrant=l.getQuadrant(b.quadrantShortcut);"string"===typeof a[1]&&(h="-"===a[1].charAt(0));b.decimalDegrees=l.DMStoDD({degree:b.degree,minutes:b.minutes,seconds:b.seconds,isNegative:h});return b},getBearingObjForFormat7:function(a){var b,h;b={};b.decimalDegrees=a[2];h=l.DDtoDMS({angle:b.decimalDegrees});b.degree=parseInt(h.degree,10);b.minutes=parseInt(h.minutes||0,10);b.seconds=parseInt(h.seconds||0,10);b.quadrant=a[1]+a[3];b.quadrantShortcut=l.getQuadrantShortcut(b.quadrant);return b},getBearingObjForFormat8:function(a){var b,
h;b={};b.decimalDegrees=a[1];h=l.DDtoDMS({angle:b.decimalDegrees});b.degree=parseInt(h.degree,10);b.minutes=parseInt(h.minutes||0,10);b.seconds=parseInt(h.seconds||0,10);b.quadrantShortcut=a[2];b.quadrant=l.getQuadrant(b.quadrantShortcut);return b},getQuadrantAngleAndShortcut:function(a){var b={};0<=a&&90>=a?(b.quadrantAngle=a,b.quadrant="NE"):90<a&&180>=a?(b.quadrantAngle=180-a,b.quadrant="SE"):180<a&&270>a?(b.quadrantAngle=a-180,b.quadrant="SW"):270<=a&&360>a&&(b.quadrantAngle=360-a,b.quadrant=
"NW");return b},roundSeconds:function(a){a=Number(a);return 10>a?"0"+a:a},showFixedPlacesAfterDecimal:function(a,b){var h=0;b||(b=2);a=a.toString();h=a.indexOf(".");0<h&&(a=a.slice(0,h+b+1));return Number(a)},honourPopupRounding:function(a,b){var h;if(isNaN(a)||null===a)a=4;h=Math.pow(10,a);b=Math.round(b*h)/h;return b=b.toFixed(a)},convertBearingToOutputFormats:function(a){var b,h,f,g,m;b={};h={};360===a.degree&&(a.degree=0);b=a.decimalDegrees;360===b&&(b=0);h.naDD=b;h.naDDRound=l.honourPopupRounding(l.bearingFieldPlaces,
b);360===Number(h.naDDRound)&&(h.naDDRound=0);f=10>a.minutes?"0"+a.minutes:a.minutes;g=a.seconds;0<Number(f)&&0<Number(l.roundSeconds(g))?h.naDMS=a.degree+"-"+f+"-"+l.roundSeconds(g):0===Number(f)&&0<Number(l.roundSeconds(g))?h.naDMS=a.degree+"-"+f+"-"+l.roundSeconds(g):0<Number(f)&&0===Number(l.roundSeconds(g))?h.naDMS=a.degree+"-"+f+"-00":0===Number(f)&&0===Number(l.roundSeconds(g))&&(h.naDMS=a.degree+"-00-00");a=l.getQuadrantAngleAndShortcut(b);h.qb3DD=a.quadrant.charAt(0)+a.quadrantAngle+a.quadrant.charAt(1);
h.qb3DDRound=a.quadrant.charAt(0)+l.honourPopupRounding(l.bearingFieldPlaces,a.quadrantAngle)+a.quadrant.charAt(1);f=l.DDtoDMS({angle:a.quadrantAngle});g=10>f.minutes?"0"+f.minutes:f.minutes;m=f.seconds;0<Number(g)&&0<Number(l.roundSeconds(m))?h.qb3DMS=a.quadrant.charAt(0)+f.degree+"-"+g+"-"+l.roundSeconds(m)+a.quadrant.charAt(1):0===Number(g)&&0<Number(l.roundSeconds(m))?h.qb3DMS=a.quadrant.charAt(0)+f.degree+"-"+g+"-"+l.roundSeconds(m)+a.quadrant.charAt(1):0<Number(g)&&0===Number(l.roundSeconds(m))?
h.qb3DMS=a.quadrant.charAt(0)+f.degree+"-"+g+"-00"+a.quadrant.charAt(1):0===Number(g)&&0===Number(l.roundSeconds(m))&&(h.qb3DMS=a.quadrant.charAt(0)+f.degree+"-00-00"+a.quadrant.charAt(1));b=l.getSouthAzimuthFromNorthAzimuth(b);360===b&&(b=0);h.saDD=b;h.saDDRound=l.honourPopupRounding(l.bearingFieldPlaces,b);360===Number(h.saDDRound)&&(h.saDDRound=0);b=l.DDtoDMS({angle:b});360===b.degree&&(b.degree=0);a=10>b.minutes?"0"+b.minutes:b.minutes;f=b.seconds;0<Number(a)&&0<Number(l.roundSeconds(f))?h.saDMS=
b.degree+"-"+a+"-"+l.roundSeconds(f):0===Number(a)&&0<Number(l.roundSeconds(f))?h.saDMS=b.degree+"-"+a+"-"+l.roundSeconds(f):0<Number(a)&&0===Number(l.roundSeconds(f))?h.saDMS=b.degree+"-"+a+"-00":0===Number(a)&&0===Number(l.roundSeconds(f))&&(h.saDMS=b.degree+"-00-00");return h},getBearingDetailsOfRequiredFormat:function(a,b){var h={};switch(b){case 0:h=l.getBearingObjForFormat0(a);break;case 1:h=l.getBearingObjForFormat1(a);break;case 2:h=l.getBearingObjForFormat2(a);break;case 3:h=l.getBearingObjForFormat3(a);
break;case 4:h=l.getBearingObjForFormat4(a);break;case 5:h=l.getBearingObjForFormat5(a);break;case 6:h=l.getBearingObjForFormat6(a);break;case 7:h=l.getBearingObjForFormat7(a);break;case 8:h=l.getBearingObjForFormat8(a)}return l.convertBearingToOutputFormats(h)},getBearingFormatArr:function(){var a=[];a.push({regex:/^((?:\-)?(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0))(?:\-(0|[0-5]?\d)\-(0|[0-5]\d))?\-([1-4])$/,type:"degreeMinuteSeconds"});a.push({regex:/^([nNsS])((?:\-)?(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0))(?:\-(0|[0-5]?\d)\-(0|[0-5]\d))?([eEwW])$/,
type:"degreeMinuteSeconds"});a.push({regex:/^([nNsS])((?:\-)?(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0))(?:\.([0-5]\d)(?:([0-5]\d))?)?([eEwW])$/,type:"degreeMinuteSeconds"});a.push({regex:/^((?:\-)?(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0))(?:\.([0-5]\d)(?:([0-5]\d))?)?$/,type:"degreeMinuteSeconds"});a.push({regex:/^((?:(?:\-?)(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0)(?:\.\d+)?)|(?:\-?)(?:\.\d+))$/,type:"decimalDegree"});a.push({regex:/^((?:\-)?(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0))(?:\-(0|[0-5]?\d)\-((?:[0-5]\d)))?$/,type:"degreeMinuteSeconds"});
a.push({regex:/^((?:\-)?(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0))(?:\.([0-5]\d)(?:([0-5]\d))?)?(\-[1-4])$/,type:"degreeMinuteSeconds"});a.push({regex:/^([nNsS])((?:(?:\-?)(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0)(?:\.\d+)?)|(?:\-?)(?:\.\d+))([eEwW])$/,type:"decimalDegree"});a.push({regex:/^((?:(?:\-?)(?:3[0-5]\d|[12]\d{2}|[0-9]\d?|0)(?:\.\d+)?)|(?:\-?)(?:\.\d+))(\-[1-4])$/,type:"decimalDegree"});return a},getNorthAzimuthAngle:function(a,b){b=b.toUpperCase();a=Number(a);switch(b){case "-1":case "NE":return(a+360)%
360;case "-2":case "SE":return(540-a)%360;case "-3":case "SW":return(540+a)%360;case "-4":case "NW":return(360-a)%360}},convertBearingToNorthAzimuth:function(a,b,h){switch(b){case 0:b=l.getBearingObjForFormat0(a);b=l.getNorthAzimuthAngle(b.decimalDegrees,"-"+a[4]);b=l.DDtoDMS({angle:b});a[1]=b.degree;a[2]=b.minutes;a[3]=b.seconds;break;case 1:b=l.getBearingObjForFormat1(a);b=l.getNorthAzimuthAngle(b.decimalDegrees,a[1]+a[5]);b=l.DDtoDMS({angle:b});a[2]=b.degree;a[3]=b.minutes;a[4]=b.seconds;break;
case 2:b=l.getBearingObjForFormat2(a);b=l.getNorthAzimuthAngle(b.decimalDegrees,a[1]+a[5]);b=l.DDtoDMS({angle:b});a[2]=b.degree;a[3]=b.minutes;a[4]=b.seconds;break;case 3:"northAzimuth"===h.directionOrAngleType||"quadrantBearing"===h.directionOrAngleType?(b=l.getBearingObjForFormat3(a),b=l.getNorthAzimuthAngle(b.decimalDegrees,"-1"),b=l.DDtoDMS({angle:b}),a[1]=b.degree,a[2]=b.minutes,a[3]=b.seconds):"southAzimuth"===h.directionOrAngleType&&(b=l.getBearingObjForFormat3(a),b=l.getNorthAzimuthAngle(b.decimalDegrees,
"-3"),b=l.DDtoDMS({angle:b}),a[1]=b.degree,a[2]=b.minutes,a[3]=b.seconds);break;case 4:"northAzimuth"===h.directionOrAngleType||"quadrantBearing"===h.directionOrAngleType?a[1]=l.getNorthAzimuthAngle(a[1],"-1"):"southAzimuth"===h.directionOrAngleType&&(a[1]=l.getNorthAzimuthAngle(a[1],"-3"));break;case 5:"northAzimuth"===h.directionOrAngleType?(b=l.getBearingObjForFormat5(a),b=l.getNorthAzimuthAngle(b.decimalDegrees,"-1"),b=l.DDtoDMS({angle:b}),a[1]=b.degree,a[2]=b.minutes,a[3]=b.seconds):"southAzimuth"===
h.directionOrAngleType?(b=l.getBearingObjForFormat5(a),b=l.getNorthAzimuthAngle(b.decimalDegrees,"-3"),b=l.DDtoDMS({angle:b}),a[1]=b.degree,a[2]=b.minutes,a[3]=b.seconds):"quadrantBearing"===h.directionOrAngleType&&(a=null);break;case 6:b=l.getBearingObjForFormat6(a);b=l.getNorthAzimuthAngle(b.decimalDegrees,a[4]);b=l.DDtoDMS({angle:b});a[1]=b.degree;a[2]=b.minutes;a[3]=b.seconds;break;case 7:a[2]=l.getNorthAzimuthAngle(a[2],a[1]+a[3]);break;case 8:a[1]=l.getNorthAzimuthAngle(a[1],a[2])}return a},
categorizeBearingFormat:function(a,b){var h,f,g;a=a.toString();h=l.getBearingFormatArr();for(g=0;g<h.length;g++)if(h[g].type===b.directionOrAngleUnits&&(f=h[g].regex.exec(a.trim()))&&0<f.length){f=l.convertBearingToNorthAzimuth(f,g,b);break}if(!f)for(g=0;g<h.length;g++)if(h[g].type!==b.directionOrAngleUnits&&(f=h[g].regex.exec(a.trim()))&&0<f.length){f=l.convertBearingToNorthAzimuth(f,g,b);break}return f?l.getBearingDetailsOfRequiredFormat(f,g):null},metersToUSSurveyFeet:function(a){a=Number(a);return 3.28083333333*
a},usSurveyFeetToMeters:function(a){a=Number(a);return.304800609601*a},feetToUSSurveyFeet:function(a){a=Number(a);return l.metersToUSSurveyFeet(.3048*a)},feetToMeters:function(a){a=Number(a);return.3048*a},usSurveyFeetToFeet:function(a){a=Number(a);return 1.000001999999281*a},metersToFeet:function(a){a=Number(a);return 3.280839895*a},getLengthObjForFormat0:function(a,b){var h;h={};"feet"===b?(h.feet=Number(a[0]),h.feetRound=Math.round(1E4*h.feet)/1E4,h.uSSurveyFeet=l.feetToUSSurveyFeet(a[0]),h.uSSurveyFeetRound=
Math.round(1E4*h.uSSurveyFeet)/1E4,h.meters=l.feetToMeters(a[0]),h.metersRound=Math.round(1E4*h.meters)/1E4):"uSSurveyFeet"===b?(h.uSSurveyFeet=Number(a[0]),h.uSSurveyFeetRound=Math.round(1E4*h.uSSurveyFeet)/1E4,h.meters=l.usSurveyFeetToMeters(a[0]),h.metersRound=Math.round(1E4*h.meters)/1E4,h.feet=l.usSurveyFeetToFeet(h.uSSurveyFeet),h.feetRound=Math.round(1E4*h.feet)/1E4):"meters"===b&&(h.uSSurveyFeet=l.metersToUSSurveyFeet(a[0]),h.uSSurveyFeetRound=Math.round(1E4*h.uSSurveyFeet)/1E4,h.meters=Number(a[0]),
h.metersRound=Math.round(1E4*h.meters)/1E4,h.feet=l.metersToFeet(h.meters),h.feetRound=Math.round(1E4*h.feet)/1E4);return h},getLengthObjForFormat3:function(a){var b;b={};b.uSSurveyFeet=Number(a[2]);b.uSSurveyFeetRound=Math.round(1E4*b.uSSurveyFeet)/1E4;b.meters=l.usSurveyFeetToMeters(a[2]);b.metersRound=Math.round(1E4*b.meters)/1E4;b.feet=l.usSurveyFeetToFeet(b.uSSurveyFeet);b.feetRound=Math.round(1E4*b.feet)/1E4;return b},getLengthObjForFormat2:function(a){var b;b={};b.uSSurveyFeet=l.metersToUSSurveyFeet(a[2]);
b.uSSurveyFeetRound=Math.round(1E4*b.uSSurveyFeet)/1E4;b.meters=Number(a[2]);b.metersRound=Math.round(1E4*b.meters)/1E4;b.feet=l.metersToFeet(b.meters);b.feetRound=Math.round(1E4*b.feet)/1E4;return b},getLengthObjForFormat1:function(a){var b;b={};b.feet=Number(a[2]);b.feetRound=Math.round(1E4*b.feet)/1E4;b.uSSurveyFeet=l.feetToUSSurveyFeet(a[2]);b.uSSurveyFeetRound=Math.round(1E4*b.uSSurveyFeet)/1E4;b.meters=l.feetToMeters(a[2]);b.metersRound=Math.round(1E4*b.meters)/1E4;return b},categorizeLengthFormat:function(a,
b){var h,f,g;h=[];a=a.toString();h.push(/^((\-?)((0?|([1-9]\d*))(\.\d+)?))$/);h.push(/^(((\-?)((0?|([1-9]\d*))(\.\d+)?))(ft|FT|fT|Ft))$/);h.push(/^(((\-?)((0?|([1-9]\d*))(\.\d+)?))(m|M))$/);h.push(/^(((\-?)((0?|([1-9]\d*))(\.\d+)?))(FTUS|FTUs|FTuS|FTus|FtUS|FtUs|FtuS|Ftus|fTUS|fTUs|fTuS|fTus|ftUS|ftUs|ftuS|ftus))$/);for(g=0;g<h.length&&!((f=h[g].exec(a.trim()))&&0<f.length);g++);f?(a=l.getLengthOfRequiredFormat(f,g,b))&&isNaN(a.meters)&&(a=null):a=null;return a},getLengthOfRequiredFormat:function(a,
b,h){var f={};switch(b){case 0:f=l.getLengthObjForFormat0(a,h);break;case 1:f=l.getLengthObjForFormat1(a);break;case 2:f=l.getLengthObjForFormat2(a);break;case 3:f=l.getLengthObjForFormat3(a)}return f}};return l})},"widgets/ParcelDrafter/XYInput":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./XYInput.html dojo/on dojo/_base/lang dojo/Evented esri/geometry/Point dojo/keys jimu/utils dojo/dom-attr dojo/dom-class dijit/form/ValidationTextBox".split(" "),
function(l,a,b,h,f,g,m,d,q,u,p,k){return l([a,b,m],{baseClass:"jimu-widget-ParcelDrafter-XYInput",templateString:h,constructor:function(b){g.mixin(this,b)},postCreate:function(){this.inherited(arguments);this.spatialReference=this.map.getLayer(this.config.polygonLayer.id).spatialReference;this.xRowWrapper.title=this.nls.xyInput.explanation;this.yRowWrapper.title=this.nls.xyInput.explanation;p.set(this.newTraverseX,"aria-label","x"+this.xRowWrapper.title);p.set(this.newTraverseY,"aria-label","y"+this.yRowWrapper.title);
this.own(f(this.newTraverseX,"change",g.hitch(this,function(){this._onTextBoxValueChanged()})));this.own(f(this.newTraverseY,"change",g.hitch(this,function(){this._onTextBoxValueChanged()})));this.own(f(this.xyStartButton,"click",g.hitch(this,function(){k.contains(this.xyStartButton,"jimu-state-disabled")||this.emit("newPoint",this.project(this.newTraverseX.value,this.newTraverseY.value))})));this.own(f(this.xyStartButton,"keydown",g.hitch(this,function(b){if(b.keyCode===q.ENTER||b.keyCode===q.SPACE)k.contains(this.xyStartButton,
"jimu-state-disabled")||this.emit("newPoint",this.project(this.newTraverseX.value,this.newTraverseY.value))})))},project:function(b,a){return new d(b,a,this.spatialReference)},_updateLastFocusNode:function(){k.contains(this.xyStartButton,"jimu-state-disabled")?(k.add(this.xyStartButton,"jimu-state-disabled"),p.set(this.xyStartButton,"tabIndex","-1"),u.initLastFocusNode(this.widgetDomNode,this.newTraverseY.domNode)):(k.remove(this.xyStartButton,"jimu-state-disabled"),p.set(this.xyStartButton,"tabIndex",
"0"),u.initLastFocusNode(this.widgetDomNode,this.xyStartButton))},_onTextBoxValueChanged:function(){this.newTraverseX.isValid()&&this.newTraverseY.isValid()?k.remove(this.xyStartButton,"jimu-state-disabled"):k.add(this.xyStartButton,"jimu-state-disabled");this._updateLastFocusNode()},resetXYTextBoxes:function(){this.newTraverseX.reset();this.newTraverseY.reset()}})})},"widgets/ParcelDrafter/NewTraverse":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/Evented dojo/text!./NewTraverse.html dojo/_base/lang dojo/_base/array dojo/dom-class dojo/dom-construct dojo/dom-style dojo/dnd/Source dojo/on dijit/form/ValidationTextBox ./SymbolSelector ./MiscloseDetails ./ParcelTools ./PlanInfo ./geometryUtils ./utils esri/graphic esri/symbols/jsonUtils esri/layers/GraphicsLayer esri/graphicsUtils dojo/dom-attr dojo/query esri/SpatialReference dojo/keys dijit/focus dijit/TooltipDialog dijit/popup dojo/Deferred esri/geometry/Extent esri/geometry/Point dojo/dom-geometry".split(" "),
function(l,a,b,h,f,g,m,d,q,u,p,k,n,y,r,K,t,z,C,A,E,x,G,F,H,w,B,D,J,I,c,v,M,N){return l([a,b,h],{baseClass:"jimu-widget-ParcelDrafter",templateString:f,parcelLinesGraphicsLayer:null,parcelPointsGraphicsLayer:null,parcelPolygonGraphicsLayer:null,lineLayerSpatialReference:null,polygonLayerSpatialReference:null,_itemList:[],_nodes:[],_dndContainer:null,startPoint:null,_startPointForNextLine:null,_planSettings:null,_arrayOfAllBoundaryLines:[],_rotationAngle:0,_scaleValue:1,polygonDeleteArr:[],polylineDeleteArr:[],
_popupDialog:null,_popupCoords:null,_setExtentTimer:null,numberFieldTypes:["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"],lengthFieldPlaces:2,radiusFieldPlaces:2,miscloseDistanceFieldPlaces:2,postCreate:function(){this.numberFieldTypes=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble"];this.polygonDeleteArr=[];this.polylineDeleteArr=[];this._arrayOfAllBoundaryLines=[];this._nodes=[];this._itemList=[];this._setExtentTimer=
null;d.add(this.domNode,"esriCTNewTraverseGrid");this._addGraphicsLayer();this._createTraverseGrid();this._setValidatorForInitialRow();this._handleEventsOnInitialRow();this._symbolSelector=this._createLineSelector(this.lineSymbolNode,null);this.own(k(this.screenDigitizationNode,"click",g.hitch(this,this._onDigitizationButtonClicked)));this.own(k(this.screenDigitizationNode,"keydown",g.hitch(this,function(e){if(e.keyCode===B.ENTER||e.keyCode===B.SPACE)e.preventDefault(),this._onDigitizationButtonClicked()})));
this.own(k(this.updateRotationPointNode,"click",g.hitch(this,this._onUpdateRotationPointButtonClicked)));this.own(k(this.updateRotationPointNode,"keydown",g.hitch(this,function(e){if(e.keyCode===B.ENTER||e.keyCode===B.SPACE)e.preventDefault(),this._onUpdateRotationPointButtonClicked()})));this.own(k(this.zoomToNode,"click",g.hitch(this,this._onZoomButtonClicked)));this.own(k(this.zoomToNode,"keydown",g.hitch(this,function(e){if(e.keyCode===B.ENTER||e.keyCode===B.SPACE)e.preventDefault(),this._onZoomButtonClicked()})));
this.own(k(this.expandCollapseNode,"click",g.hitch(this,this._onExpandCollapseClicked)));this.own(k(this.expandCollapseNode,"keydown",g.hitch(this,function(e){if(e.keyCode===B.ENTER||e.keyCode===B.SPACE)e.preventDefault(),this._onExpandCollapseClicked()})));this.own(k(this.addButton,"click",g.hitch(this,function(){this._addNewItem(!1)})));this.own(k(this.addButton,"keydown",g.hitch(this,function(e){e.keyCode!==B.ENTER&&e.keyCode!==B.SPACE||this._addNewItem(!1)})));this._createMiscloseDetails();this._createParcelTools();
this._createPlanInfo();this._createTooltip();this.config.polylineLayer&&this.config.polylineLayer.popupInfo&&this.config.polylineLayer.popupInfo.fieldInfos&&m.forEach(this.config.polylineLayer.popupInfo.fieldInfos,g.hitch(this,function(e){e.fieldName===this.config.polylineLayer.bearing.name&&e.format&&(C.bearingFieldPlaces=e.format.places);e.fieldName===this.config.polylineLayer.distance.name&&e.format&&(this.lengthFieldPlaces=e.format.places);e.fieldName===this.config.polylineLayer.radius.name&&
e.format&&(this.radiusFieldPlaces=e.format.places)}));this.config.polygonLayer&&this.config.polygonLayer.popupInfo&&this.config.polygonLayer.popupInfo.fieldInfos&&m.forEach(this.config.polygonLayer.popupInfo.fieldInfos,g.hitch(this,function(e){e.fieldName===this.config.polygonLayer.miscloseDistance.name&&e.format&&(this.miscloseDistanceFieldPlaces=e.format.places)}))},_addGraphicsLayer:function(){this.parcelPolygonGraphicsLayer=new x;this.parcelLinesGraphicsLayer=new x;this.parcelPointsGraphicsLayer=
new x;this.rotationPointsGraphicsLayer=new x;this.own(k(this.parcelPointsGraphicsLayer,"click",g.hitch(this,function(e){d.contains(this.updateRotationPointNode,"esriCTEnableButton")&&(this._setRotationPoint(e.graphic.attributes.rowIndex,e.graphic.geometry),this._showRotationPoint())})));this.map.addLayer(this.parcelPolygonGraphicsLayer);this.map.addLayer(this.parcelLinesGraphicsLayer);this.map.addLayer(this.parcelPointsGraphicsLayer);this.map.addLayer(this.rotationPointsGraphicsLayer)},_setValidatorForInitialRow:function(){this.bearingNode.validator=
g.hitch(this,function(e){return this._bearingValidator(e,["*","*tb"])});this.bearingNode.invalidMessage=this.nls.newTraverse.invalidBearingMessage;this.lengthNode.validator=g.hitch(this,function(e){if("*"===e&&this._itemList&&0<this._itemList.length)return!0;if(""===this.radiusNode.get("value")&&0>parseFloat(e))return this.lengthNode.invalidMessage=this.nls.newTraverse.negativeLengthMessage,!1;this.lengthNode.invalidMessage=this.nls.newTraverse.invalidLengthMessage;return this._lengthValidator(e)});
this.lengthNode.invalidMessage=this.nls.newTraverse.invalidLengthMessage;this.radiusNode.validator=g.hitch(this,function(e){var c;if("*"===e&&this._itemList&&0<this._itemList.length)return!0;c=this._radiusValidator(e);if(""!==e)if((e=this.lengthNode.isValid())&&c){if(!this._validateLengthRadiusProportion(c,e))return null;c&&(e=this.lengthNode.value,this.lengthNode.reset(),this.lengthNode.set("value",e))}else c=null;return c});this.radiusNode.invalidMessage=this.nls.newTraverse.invalidRadiusMessage},
_bearingValidator:function(e,c){return-1!==c.indexOf(e)&&this._itemList&&0<this._itemList.length?!0:this._validateBearing(e,c)},_lengthValidator:function(e,c){return""===e||"0"===e||0===e?!1:this._validateLength(e,c)},_radiusValidator:function(e,c){return""===e?!0:this._validateLength(e,c)},_handleEventsOnInitialRow:function(){this.own(k(this.bearingNode,"keypress",g.hitch(this,this._bearingValueEntered)));this.own(k(this.lengthNode,"keypress",g.hitch(this,this._lengthValueEntered)));this.own(k(this.radiusNode,
"keypress",g.hitch(this,this._radiusValueEntered)))},_copyPrevValue:function(e){switch(e){case "Bearing":e=this.bearingNode.get("value");"*"===e&&0<this._itemList.length&&(e=this._itemList[this._itemList.length-1].BearingConversions?this._getBearingAccordingToPlanSettings(this._itemList[this._itemList.length-1].BearingConversions):this._itemList[this._itemList.length-1].Bearing,this.bearingNode.set("value",e));break;case "Length":e=this.lengthNode.get("value");"*"===e&&0<this._itemList.length&&(e=
"radiusAndArcLength"===this._planSettings.circularCurveParameters&&this._itemList[this._itemList.length-1].ArcLengthConversions?this._itemList[this._itemList.length-1].ArcLengthConversions[this._planSettings.distanceAndLengthUnits]:this._itemList[this._itemList.length-1].LengthConversions?this._itemList[this._itemList.length-1].LengthConversions[this._planSettings.distanceAndLengthUnits]:this._itemList[this._itemList.length-1].Length,this.lengthNode.set("value",e));break;case "Radius":e=this.radiusNode.get("value"),
"*"===e&&0<this._itemList.length&&(e=this._itemList[this._itemList.length-1].RadiusConversions?this._itemList[this._itemList.length-1].RadiusConversions[this._planSettings.distanceAndLengthUnits]:this._itemList[this._itemList.length-1].Radius,this.radiusNode.set("value",e))}},_bearingValueEntered:function(e){e=e.charCode||e.keyCode;e===B.ENTER||e===B.TAB?(this.bearingNode.get("value"),this._copyPrevValue("Bearing"),e===B.ENTER&&this.bearingNode.isValid()?D.focus(this.lengthNode.focusNode):this.bearingNode.validate(!1)):
setTimeout(g.hitch(this,function(){this.bearingNode.validate(!1)}),100)},_lengthValueEntered:function(e){e=e.charCode||e.keyCode;e===B.ENTER||e===B.TAB?(this.lengthNode.get("value"),this._copyPrevValue("Length"),e===B.ENTER&&this.lengthNode.isValid()?D.focus(this.radiusNode.focusNode):this.lengthNode.validate(!1)):setTimeout(g.hitch(this,function(){this.lengthNode.validate(!1)}),100)},_radiusValueEntered:function(e){(e.charCode||e.keyCode)===B.ENTER?(e=this.radiusNode.get("value"),this._copyPrevValue("Radius"),
""===e||this.radiusNode.isValid()?this.bearingNode.isValid()?this.lengthNode.isValid()?(this._addNewItem(),D.focus(this.bearingNode.focusNode)):(this.lengthNode.validate(!1),D.focus(this.lengthNode.focusNode)):(this.bearingNode.validate(!1),D.focus(this.bearingNode.focusNode)):this.radiusNode.validate(!1)):setTimeout(g.hitch(this,function(){this.radiusNode.validate(!1)}),100)},_validateBearing:function(e){return(e=C.categorizeBearingFormat(e,this._planSettings))?e:null},_validateLength:function(e,
c){switch(c){case "feet":e=C.categorizeLengthFormat(e,"feet");break;case "meters":e=C.categorizeLengthFormat(e,"meters");break;case "uSSurveyFeet":e=C.categorizeLengthFormat(e,"uSSurveyFeet");break;default:e=C.categorizeLengthFormat(e,this._planSettings.distanceAndLengthUnits)}return e?e:null},_validateLengthRadiusProportion:function(e,c){return e&&c&&(e=e[this._planSettings.distanceAndLengthUnits],c=c[this._planSettings.distanceAndLengthUnits],0!==e&&(e=2*parseFloat(Math.abs(e)),"radiusAndArcLength"===
this._planSettings.circularCurveParameters&&(e*=Math.PI),e<parseFloat(Math.abs(c))))?null:!0},_getValidatedValues:function(e,c,b){var a={},d;e?(a=e,c&&("Bearing"!==c&&a.BearingConversions&&(a.Bearing=this._getBearingAccordingToPlanSettings(a.BearingConversions)),"Length"!==c&&a.LengthConversions&&(a.Length=a.LengthConversions[this._planSettings.distanceAndLengthUnits]),"Radius"!==c&&a.RadiusConversions&&(a.Radius=a.RadiusConversions[this._planSettings.distanceAndLengthUnits]),"Bearing"===c&&"*tb"===
a.Bearing.toString().toLowerCase()&&0<this._itemList.length&&0!==b&&(a.isTB=!0))):(this._copyPrevValue("Bearing"),this._copyPrevValue("Length"),this._copyPrevValue("Radius"),a.LineSymbol=this._symbolSelector.selectedSymbol,a.Bearing=this.bearingNode.get("value"),a.Length=this.lengthNode.get("value"),a.Radius=this.radiusNode.get("value"),"*tb"===a.Bearing.toString().toLowerCase()&&0<this._itemList.length?a.isTB=!0:a.isTB=!1);if(""!==g.trim(a.Bearing.toString())&&""!==g.trim(a.Length.toString())&&((c=
this._validateBearing(a.Bearing))||a.isTB)){a.BearingConversions=c;if(""===g.trim(a.Length.toString())&&""===g.trim(a.Radius.toString()))return null;if(""!==g.trim(a.Length.toString()))if((c=this._validateLength(a.Length))&&0!==c.meters){if(""!==g.trim(a.Radius.toString()))if(d=this._validateLength(a.Radius)){if(!this._validateLengthRadiusProportion(d,c))return null;a.RadiusConversions=d}else return null;else{if(0>parseInt(c.meters,10))return null;a.RadiusConversions=null}a.LengthConversions=c}else return null;
a.RadiusConversions&&(a=this._createValuesForArc(a));a.isTB&&(e=e&&!isNaN(b)?this._itemList[b-1]:this._itemList[this._itemList.length-1],a=this._setTangentBearing(a,e))}else return null;return a},_setTangentBearing:function(e,c){var a,b;b=g.clone(this._planSettings);b.directionOrAngleType="northAzimuth";b.directionOrAngleUnits="decimalDegree";a=c.BearingConversions.naDD;c.RadiusConversions&&0!==c.RadiusConversions.meters&&(a=z.chordBearingToTangentBearing(a,c.RadiusConversions.meters,c.ChordLengthConversions.meters));
e.RadiusConversions&&0!==e.RadiusConversions.meters?(a=z.tangentBearingToChordBearing(a,e.RadiusConversions.meters,e.ChordLengthConversions.meters),e.Bearing=a,e.BearingConversions=C.categorizeBearingFormat(e.Bearing,b)):c.RadiusConversions&&0!==c.RadiusConversions.meters?(e.Bearing=a,e.BearingConversions=C.categorizeBearingFormat(e.Bearing,b)):(e.Bearing=c.Bearing,e.BearingConversions=g.clone(c.BearingConversions));return e},_updateTBFromIndex:function(e){var c;for(c=!1;e<this._itemList.length;e++)if(this._itemList[e]&&
this._itemList[e].isTB)this._itemList[e]=this._setTangentBearing(this._itemList[e],this._itemList[e-1]),c=!0;else break;return c},_onZoomButtonClicked:function(){this._setExtentToLayer(this.parcelLinesGraphicsLayer,!0)},_onExpandCollapseClicked:function(){d.toggle(this.traverseGrid,"esriCTHidden");d.contains(this.expandCollapseNode,"esriCTExpand")?(F.set(this.expandCollapseNode,"title",this.nls.planSettings.collapseGridTooltipText),d.replace(this.expandCollapseNode,"esriCTCollapse","esriCTExpand"),
F.set(this.expandCollapseNode,"aria-expanded",!0)):(F.set(this.expandCollapseNode,"title",this.nls.planSettings.expandGridTooltipText),d.replace(this.expandCollapseNode,"esriCTExpand","esriCTCollapse"),F.set(this.expandCollapseNode,"aria-expanded",!1))},setRotation:function(e){var c,a,b;b=this.startPoint;this._rotationPointInfo&&this._rotationPointInfo.rotationPoint&&(b=this._rotationPointInfo.rotationPoint);var d=new w(4326);z.getProjectedGeometry(e,d,this.geometryService).then(g.hitch(this,function(e){c=
z.getRotationAngleBetweenPoints(b,e);0<this._itemList.length&&(a=0,this._rotationPointInfo&&this._rotationPointInfo.rotationPointIndex<this._itemList.length&&(a=this._rotationPointInfo.rotationPointIndex),c-=this._itemList[a].BearingConversions.naDDRound);360===c&&(c=0);this._parcelToolInstance.setRotation(c)}))},setScaling:function(e){e=z.getScaleDistanceBetweenPoints(this.startPoint,e);this.distance?(e/=this.distance,.1>e&&(e=.1),this._parcelToolInstance.setScale(e)):this.distance=e},_addNewItem:function(e){var c,
a;(c=this._getValidatedValues())?(e&&this._rotationAngle&&(a=c.BearingConversions.naDD-this._rotationAngle,a=this.getAngleFromDDTOQB(360<=a?a%360:a),c.Bearing=a,c.BearingConversions=this._validateBearing(a)),a=g.trim(c.Radius.toString()),c.rowIndex=this._itemList.length,this._itemList.push(c),this._createRow(c,this._itemList.length-1),D.focus(this.bearingNode.focusNode),this._resetEntryRow(e),""===a||"0"===a||0===a?this._drawStraightLine(c,!0):this._drawArc(c,!0),this._showHideTraverseTools(),this.appliedCompassRule&&
this.setParcelClosure()):this.bearingNode.isValid()?""!==this.lengthNode.get("value")&&this.lengthNode.isValid()?""===this.radiusNode.get("value")||this.radiusNode.isValid()||(D.focus(this.radiusNode.focusNode),this.radiusNode.validate(!1)):(D.focus(this.lengthNode.focusNode),this.lengthNode.validate(!1)):(D.focus(this.bearingNode.focusNode),this.bearingNode.validate(!1))},_createValuesForArc:function(e){var c;e.RadiusConversions?(c=e.RadiusConversions.meters,"radiusAndArcLength"===this._planSettings.circularCurveParameters?
(e.ArcLength=e.LengthConversions.meters,e.ArcLengthConversions=g.clone(e.LengthConversions),e.ChordLength=z.getChordLengthFromArcLength(e.ArcLength,c),e.ChordLengthConversions=this._validateLength(e.ChordLength,"meters")):(e.ChordLength=e.LengthConversions.meters,e.ChordLengthConversions=g.clone(e.LengthConversions),e.ArcLength=z.getArcLengthFromChordLength(e.ChordLength,c),e.ArcLengthConversions=this._validateLength(e.ArcLength,"meters"))):("radiusAndArcLength"===this._planSettings.circularCurveParameters&&
e.ArcLengthConversions&&(e.Length=e.ArcLength,e.LengthConversions=g.clone(e.ArcLengthConversions)),e.ChordLength=0,e.ChordLengthConversions=null,e.ArcLength=0,e.ArcLengthConversions=null);return e},_onDigitizationButtonClicked:function(){d.toggle(this.screenDigitizationNode,"esriCTEnableButton");d.contains(this.screenDigitizationNode,"esriCTEnableButton")?(F.set(this.screenDigitizationNode,"aria-pressed","true"),this.emit("activateDigitizationTool"),this.deActivateUpdateRotationPointTool()):(F.set(this.screenDigitizationNode,
"aria-pressed","false"),this.emit("deActivateDigitizationTool"))},_onUpdateRotationPointButtonClicked:function(){d.toggle(this.updateRotationPointNode,"esriCTEnableButton");d.contains(this.updateRotationPointNode,"esriCTEnableButton")?(F.set(this.updateRotationPointNode,"aria-pressed","true"),this.emit("activateUpdateRotationPointTool"),this.deActivateDigitizationTool()):(F.set(this.updateRotationPointNode,"aria-pressed","false"),this.emit("deActivateUpdateRotationPointTool"))},_createMiscloseDetails:function(){this._misCloseDetailsInstance=
new r({nls:this.nls,config:this.config,appConfig:this.appConfig,numberFieldTypes:this.numberFieldTypes,validateNumericField:this.validateNumericField},q.create("div",{},this.misCloseDetailsNode));this._misCloseDetailsInstance.setMiscloseDetails(null)},_createParcelTools:function(){this._parcelToolInstance=new K({nls:this.nls,config:this.config,canProjectLocally:z.canProjectLocally(this.map.spatialReference)},q.create("div",{},this.parcelToolsNode));this.own(this._parcelToolInstance.on("rotateGeometries",
g.hitch(this,function(e){e!==this._rotationAngle&&(this._rotationAngle=e,this._rotationPointInfo&&this._rotationPointInfo.rotationPoint?this._updateStartPointFromRotationPoint():this._itemList&&0<this._itemList.length&&this.setStartPoint(this.startPoint))})));this.own(this._parcelToolInstance.on("scaleGeometries",g.hitch(this,function(e){e!==this._scaleValue&&(this._scaleValue=e,this._rotationPointInfo&&this._rotationPointInfo.rotationPoint?this._updateStartPointFromRotationPoint():this._itemList&&
0<this._itemList.length&&this.setStartPoint(this.startPoint))})));this.own(this._parcelToolInstance.on("toggleRotating",g.hitch(this,function(e){this.emit("toggleRotating",e)})));this.own(this._parcelToolInstance.on("toggleScaling",g.hitch(this,function(e){this.emit("toggleScaling",e)})))},_createPlanInfo:function(){this._planInfoInstance=new t({map:this.map,nls:this.nls,config:this.config,loading:this.loading,numberFieldTypes:this.numberFieldTypes,validateNumericField:this.validateNumericField,geometryService:this.geometryService,
parcelPolygonGraphicsLayer:this.parcelPolygonGraphicsLayer,parcelLinesGraphicsLayer:this.parcelLinesGraphicsLayer,polylineLayerUnit:z.getUnitValueForSR(this.lineLayerSpatialReference),polygonLayerUnit:z.getUnitValueForSR(this.polygonLayerSpatialReference),widgetDomNode:this.widgetDomNode},q.create("div",{},this.planInfoNode));this.own(this._planInfoInstance.on("cancelTraversedParcel",g.hitch(this,function(){this.emit("cancelTraverse")})));this.own(this._planInfoInstance.on("showMessage",g.hitch(this,
function(e){this._showMessage(e)})));this.own(this._planInfoInstance.on("showParcelSavedAndDeleteMsg",g.hitch(this,function(e){this._showParcelSavedAndDeleteMsg(e)})));this.own(this._planInfoInstance.on("saveTraversedParcel",g.hitch(this,function(){var e;this.closePopup();if(this._itemList&&0<this._itemList.length){var c;c=this._misCloseDetailsInstance.traverseStatedArea.get("value").trim();e=this._planInfoInstance.validateParcelDetails(c);e.status?(""===this._misCloseDetailsInstance.traverseStatedArea.get("value")&&
(c=null),e={},e.itemList=this._itemList,e.statedArea=c,e.rotation=this._rotationAngle,e.scale=this._scaleValue,e.appliedCompassRule=this.appliedCompassRule,e.miscloseDetails=this._misCloseDetailsInstance.getMiscloseDetails(),e.polygonDeleteArr=this.polygonDeleteArr,e.polylineDeleteArr=this.polylineDeleteArr,e.planSettings=this._planSettings,this._planInfoInstance.saveData(e)):e.message&&this._showMessage(e.message)}else this._showMessage(this.nls.newTraverse.enterValidParcelInfoMessage)})));this.own(this._planInfoInstance.on("displayMainPageAfterSave",
g.hitch(this,function(){this.emit("displayMainPageAfterSave",!1)})))},_createTraverseGrid:function(){var e;this._nodes=[];q.empty(this.traverseGrid);this._dndContainer=new p(this.traverseGrid,{skipForm:!0,singular:!0});this._dndContainer.copyState=function(){return!1};for(e=0;e<this._itemList.length;e++)this._createRow(this._itemList[e],e);this.own(this._dndContainer.on("DndDrop",g.hitch(this,this._onDndDrop)));this._dndContainer.insertNodes(!1,this._nodes)},_createFieldInputs:function(e,c,a,b){var d=
new n({value:c,"class":a?a:""});d.placeAt(e);"esriCTBearingRow"===a?(F.set(d,"aria-label",this.nls.traverseSettings.bearingLabel),d.validator=g.hitch(this,function(e){"*tb"!==e&&"*"===e.charAt(0)&&(e=e.slice(1));return this._bearingValidator(e,["*tb"])}),d.invalidMessage=this.nls.newTraverse.invalidBearingMessage):"esriCTLengthRow"===a?(F.set(d,"aria-label",this.nls.traverseSettings.lengthLabel),d.validator=g.hitch(this,this._lengthValidator),d.invalidMessage=this.nls.newTraverse.invalidLengthMessage):
"esriCTRadiusRow"===a&&(F.set(d,"aria-label",this.nls.traverseSettings.radiusLabel),d.validator=g.hitch(this,this._radiusValidator),d.invalidMessage=this.nls.newTraverse.invalidRadiusMessage);this.own(k(d,"blur",g.hitch(this,function(){var c=parseInt(F.get(e,"rowIndex"),10);this._updateParcelValues(d,c,b)})));this.own(k(d,"keypress",g.hitch(this,function(c){(c.charCode||c.keyCode)===B.ENTER&&(c=parseInt(F.get(e,"rowIndex"),10),this._updateParcelValues(d,c,b));setTimeout(g.hitch(this,function(){d.validate(!1)}),
100)})))},_createRow:function(e,c){var a,b;a=q.create("div",{"class":"dojoDndItem esriCTRow",rowIndex:c});b=q.create("div",{rowIndex:c},a);this._createLineSelector(b,e.LineSymbol,c);b=this._getBearingAccordingToPlanSettings(e.BearingConversions);e.isTB&&(b="*"+b);this._createFieldInputs(a,b,"esriCTBearingRow");e.RadiusConversions?(b=this._getRoundedValue(e.RadiusConversions,"Radius"),e="radiusAndArcLength"===this._planSettings.circularCurveParameters?this._getRoundedValue(e.ArcLengthConversions,"Length"):
this._getRoundedValue(e.ChordLengthConversions,"Length")):(b="",e=this._getRoundedValue(e.LengthConversions,"Length"));this._createFieldInputs(a,e,"esriCTLengthRow");this._createFieldInputs(a,b,"esriCTRadiusRow");this._createDeleteButton(a,c);this._nodes.push(a);this._dndContainer.clearItems();this._dndContainer.insertNodes(!1,this._nodes)},_createLineSelector:function(e,c,a){var b;b=new y({hideOnSelect:!0,symbolData:this.config.lineTypes,tabindex:"0","aria-label":this.nls.newTraverse.lineTypeLabel,
role:"button","aria-haspopup":"true"},e);d.add(b.domNode,"esriCTSymbolContainer");c?(b.selectSymbol(c),F.set(b.domNode,"rowIndex",a),b.onSelect=g.hitch(this,function(e){var c;c=parseInt(F.get(b.domNode,"rowIndex"),10);this._itemList[c].LineSymbol=e;this.setStartPoint(this.startPoint)})):b.setDefault();return b},_createDeleteButton:function(e,c){var a;a=q.create("div",{"class":"esriCTDeleteRow"},e);c=q.create("div",{"class":"esriCTDeleteIcon",rowIndex:c,title:this.nls.traverseSettings.deleteButtonTitle,
tabindex:"0",role:"button","aria-label":this.nls.traverseSettings.deleteButtonTitle},a);this.own(k(c,"click",g.hitch(this,function(c){c=parseInt(F.get(c.currentTarget,"rowIndex"),10);this._deleteRow(e,c)})));this.own(k(c,"keydown",g.hitch(this,function(c){if(c.keyCode===B.ENTER||c.keyCode===B.SPACE)c=parseInt(F.get(c.currentTarget,"rowIndex"),10),this._deleteRow(e,c),D.focus(this.bearingNode.focusNode)})))},_deleteRow:function(c,a){var e;if(this._itemList.length){this._dndContainer.delItem(c.id);
q.destroy(c);this._nodes.splice(a,1);this._itemList.splice(a,1);this._dndContainer.sync();this._updateRowIndexes();if(this._itemList[a]&&this._itemList[a].isTB){if(1===this._itemList.length||0===a)this._itemList[0].isTB=!1,a++;1<this._itemList.length&&(e=this._updateTBFromIndex(a))}this.appliedCompassRule?this.setParcelClosure(!0,!0):this.setStartPoint(this.startPoint,!0);e&&this._reGenerateTraverseGrid();this._showHideTraverseTools()}},_updateRowIndexes:function(){var c;c=H(".esriCTRow",this.traverseGrid);
m.forEach(c,g.hitch(this,function(c,e){var a;this._itemList[e].rowIndex=e;F.set(c,"rowIndex",e);(a=H(".esriCTDeleteIcon",c)[0])&&F.set(a,"rowIndex",e);(c=H(".esriCTSymbolContainer",c)[0])&&F.set(c,"rowIndex",e)}))},_onDndDrop:function(){var c,a=[],b;this._dndContainer.sync();c=this._dndContainer.getAllNodes();c.forEach(g.hitch(this,function(c,e){c=parseInt(F.get(c,"rowIndex"),10);a.push(this._itemList[c])}));this._nodes=c;this._itemList=[];this._itemList=a;this._updateRowIndexes();for(c=0;c<this._itemList.length;c++)0===
c&&this._itemList[c].isTB&&(this._itemList[c].isTB=!1,b=!0),this._itemList[c]&&this._itemList[c].isTB&&(this._itemList[c]=this._setTangentBearing(this._itemList[c],this._itemList[c-1]),b=!0);this.setStartPoint(this.startPoint,!0);b&&this._reGenerateTraverseGrid()},_updateParcelValues:function(c,a,b){var e,v,k,f=!1,r;if(e=this._itemList[a])if(k=(k=c.get("value"))?g.trim(k.toString()):"",d.contains(c.domNode,"esriCTBearingRow")&&String(this._getBearingAccordingToPlanSettings(e.BearingConversions))!==
k?(v="Bearing",e.Bearing=k,f=!0,-1===k.indexOf("*")&&(e.isTB=!1)):d.contains(c.domNode,"esriCTLengthRow")&&String(this._getRoundedValue(e.LengthConversions,"Length"))!==k?(v="Length",e.Length=k,f=!0):d.contains(c.domNode,"esriCTRadiusRow")&&String(e.Radius)!==k&&(e.RadiusConversions?String(this._getRoundedValue(e.RadiusConversions,"Radius"))!==k&&(v="Radius",e.Radius=k,f=!0):(v="Radius",e.Radius=k,f=!0)),f)if(k=this._getValidatedValues(e,v,a)){if("Bearing"===v?(v=this._getBearingAccordingToPlanSettings(k.BearingConversions),
e.Bearing=this._getBearingAccordingToPlanSettings(k.BearingConversions,!0),e.isTB&&(v="*"+v),c.set("value",v),r=this._updateTBFromIndex(a+1)):"Length"===v?(v=this._getRoundedValue(e.LengthConversions,"Length"),e.Length=e.LengthConversions[this._planSettings.distanceAndLengthUnits],e.RadiusConversions&&(e=this._createValuesForArc(e)),c.set("value",v),r=this._updateTBFromIndex(a)):"Radius"===v&&(e.RadiusConversions?(e.Radius=e.RadiusConversions[this._planSettings.distanceAndLengthUnits],v=this._getRoundedValue(e.RadiusConversions,
"Radius")):v=e.Radius="",e=this._createValuesForArc(e),c.set("value",v),r=this._updateTBFromIndex(a)),this.appliedCompassRule?this.setParcelClosure(!0,!0):this.setStartPoint(this.startPoint,!0),r||b)this._reGenerateTraverseGrid(),b&&this._popupCoords&&this._openPopup(this._popupCoords)}else this._updateValues(e,v,c)},_updateValues:function(c,a,b){var e;"Bearing"===a?(c.Bearing=this._getBearingAccordingToPlanSettings(c.BearingConversions,!0),e=this._getBearingAccordingToPlanSettings(c.BearingConversions)):
"Length"===a?(c.Length=c.LengthConversions[this._planSettings.distanceAndLengthUnits],e=this._getRoundedValue(c.LengthConversions,"Length")):"Radius"===a&&(c.RadiusConversions?(c.Radius=c.RadiusConversions[this._planSettings.distanceAndLengthUnits],e=this._getRoundedValue(c.RadiusConversions,"Radius")):e=c.Radius="");b.set("value",e)},_showHideTraverseTools:function(){this._itemList&&0<this._itemList.length?(d.remove(this.expandCollapseNode,"esriCTHidden"),d.remove(this.zoomToNode,"esriCTHidden")):
(d.add(this.expandCollapseNode,"esriCTHidden"),d.add(this.zoomToNode,"esriCTHidden"))},_getBearingAccordingToPlanSettings:function(c,a){if("northAzimuth"===this._planSettings.directionOrAngleType&&"decimalDegree"===this._planSettings.directionOrAngleUnits)return a?c.naDD:c.naDDRound;if("northAzimuth"===this._planSettings.directionOrAngleType&&"degreeMinuteSeconds"===this._planSettings.directionOrAngleUnits)return c.naDMS;if("southAzimuth"===this._planSettings.directionOrAngleType&&"decimalDegree"===
this._planSettings.directionOrAngleUnits)return a?c.saDD:c.saDDRound;if("southAzimuth"===this._planSettings.directionOrAngleType&&"degreeMinuteSeconds"===this._planSettings.directionOrAngleUnits)return c.saDMS;if("quadrantBearing"===this._planSettings.directionOrAngleType&&"decimalDegree"===this._planSettings.directionOrAngleUnits)return a?c.qb3DD:c.qb3DDRound;if("quadrantBearing"===this._planSettings.directionOrAngleType&&"degreeMinuteSeconds"===this._planSettings.directionOrAngleUnits)return c.qb3DMS},
_getRoundedValue:function(c,a){var e;c=c[this._planSettings.distanceAndLengthUnits];switch(a){case "Length":e=this.lengthFieldPlaces;break;case "Radius":e=this.radiusFieldPlaces;break;case "MiscloseDistance":e=this.miscloseDistanceFieldPlaces}return C.honourPopupRounding(e,c)},_resetEntryRow:function(c){this.bearingNode.set("value","");this.lengthNode.set("value","");this.radiusNode.set("value","");this.bearingNode.reset();this.lengthNode.reset();this.radiusNode.reset();0<this._itemList.length&&(c=
this._itemList[this._itemList.length-1].isTB?"*tb":c?this._getBearingAccordingToPlanSettings(this._itemList[this._itemList.length-1].BearingConversions):this._itemList[this._itemList.length-1].Bearing,this.bearingNode.set("value",c),this.bearingNode.textbox.setSelectionRange(0,c.length))},_reGenerateTraverseGrid:function(){this._dndContainer&&(this._dndContainer.destroy(),this._dndContainer=null);q.empty(this.traverseGrid);this._createTraverseGrid()},_showRotationPoint:function(){var c,a,b=this.startPoint;
this.config.startOrRotaionSymbol?a=E.fromJson(this.config.startOrRotaionSymbol):(c={color:[136,136,136,255],size:11.25,angle:0,xoffset:0,yoffset:0,type:"esriSMS",style:"esriSMSCircle",outline:{color:[29,29,53,255],width:.75,type:"esriSLS",style:"esriSLSSolid"}},a=E.fromJson(c));this._rotationPointInfo&&this._rotationPointInfo.rotationPoint&&(b=this._rotationPointInfo.rotationPoint);4326!==this.map.spatialReference.wkid?z.getProjectedGeometry(b,this.map.spatialReference,this.geometryService).then(g.hitch(this,
function(c){c&&(c=new A(c),c.setSymbol(a),this.rotationPointsGraphicsLayer.clear(),this.rotationPointsGraphicsLayer.add(c))})):(c=new A(b),c.setSymbol(a),this.rotationPointsGraphicsLayer.clear(),this.rotationPointsGraphicsLayer.add(c))},resetRotationPoint:function(c){this._setRotationPoint(0,c)},_setRotationPoint:function(c,a){var e=a;a=new w(4326);z.getProjectedGeometry(e,a,this.geometryService).then(g.hitch(this,function(a){e=a;this._rotationPointInfo={rotationPointIndex:c,rotationPoint:e}}))},
_updateStartPointFromRotationPoint:function(){var c=this._rotationPointInfo.rotationPoint,a=this._rotationPointInfo.rotationPointIndex;if(null!==this._rotationAngle){for(--a;0<=a;a--){var b,d;d=this._itemList[a];var v=Number(d.BearingConversions.naDD)+this._rotationAngle;b=d.LengthConversions.meters;this._scaleValue&&(b*=this._scaleValue);v=C.getSouthAzimuthFromNorthAzimuth(v);""===d.Radius||"0"===d.Radius||0===d.Radius?c=z.getDestinationPoint(c,v,b):(b=d.RadiusConversions.meters,d=d.ChordLengthConversions.meters,
this._scaleValue&&(b*=this._scaleValue,d*=this._scaleValue),c=this.getArcInfo(c,v,b,d),c=c.endPoint)}this.setStartPoint(c)}},_reDrawParcel:function(){this.parcelLinesGraphicsLayer.clear();this.parcelPointsGraphicsLayer.clear();this._arrayOfAllBoundaryLines=[];this._drawPoint(this.startPoint);m.forEach(this._itemList,g.hitch(this,function(c){""===c.Radius||"0"===c.Radius||0===c.Radius?this._drawStraightLine(c,!1):this._drawArc(c,!1)}));this._setExtentToLayer(this.parcelLinesGraphicsLayer);this.setParcelClosure()},
setStartPoint:function(c,a,b,d){var e=new w(4326);z.getProjectedGeometry(c,e,this.geometryService).then(g.hitch(this,function(e){b&&this._rotationPointInfo?(this._setRotationPoint(this._rotationPointInfo.rotationPointIndex,e),this._updateStartPointFromRotationPoint()):(this.startPoint=e,a&&this.resetRotationPoint(this.startPoint),this._showRotationPoint(),this._startPointForNextLine=g.clone(e),this._orgStartPointForNextLine=g.clone(e),this.appliedCompassRule=!1,0<this._itemList.length?this._reDrawParcel():
(this.parcelPointsGraphicsLayer.clear(),this.parcelLinesGraphicsLayer.clear(),this._arrayOfAllBoundaryLines=[],this._drawPoint(c,d)))}))},_addProjectedGraphic:function(c,a,b,d){var e,v={},k=b.setExtentToLayer,f=b.setParcelClosure,r=b.startNewTraverseBtnClick;v.rowIndex=d?d.rowIndex:c.graphics.length;a.attributes=v;4326!==this.map.spatialReference.wkid?z.getProjectedGeometry(a.geometry,this.map.spatialReference,this.geometryService).then(g.hitch(this,function(b){b&&(e=new A(b),e.setAttributes(v),e.setSymbol(a.symbol),
c.add(e),d&&(d.graphic=e),r&&c.graphics&&0<c.graphics.length&&this.map.centerAt(c.graphics[0].geometry),k&&(this._setExtentToLayer(c),f&&this.setParcelClosure()))})):(c.add(a),r&&c.graphics&&0<c.graphics.length&&this.map.centerAt(c.graphics[0].geometry),k&&(this._setExtentToLayer(c),f&&this.setParcelClosure()))},_drawPoint:function(c,a){c=new A(c,E.fromJson(this.config.pointSymbol));this._addProjectedGraphic(this.parcelPointsGraphicsLayer,c,{setExtentToLayer:!1,setParcelClosure:!1,startNewTraverseBtnClick:a})},
_drawLineAndEndPoint:function(c,a,b,d){var e;e=!0;c?(a=z.getLineBetweenPoints(a))?(a=new A(a,E.fromJson(b.LineSymbol.symbol)),this._addProjectedGraphic(this.parcelLinesGraphicsLayer,a,{setExtentToLayer:d,setParcelClosure:!0,startNewTraverseBtnClick:!1},b),this._startPointForNextLine=g.clone(c),this.appliedCompassRule&&this.parcelLinesGraphicsLayer.graphics.length===this._itemList.length&&(e=!1),e&&this._drawPoint(c)):this._showMessage(this.nls.newTraverse.unableToDrawLineMessage):this._showMessage(this.nls.newTraverse.invalidEndPointMessage)},
setInfoForCalculatingMisclose:function(c,a,b){c.startPoint=g.clone(this._orgStartPointForNextLine);c.endpoint=g.clone(a);b=z.getLineBetweenPoints(b);if(c.LineSymbol.type===this.config.BoundaryLineType)for(var e=0;e<b.paths.length;e++)this._arrayOfAllBoundaryLines.push(b.paths[e]);this._orgStartPointForNextLine=g.clone(a);return c},getArcInfo:function(c,a,b,d){var e,v,g;e=z.getDestinationPoint(c,a,Math.abs(d));v=Math.abs(d)/2;g=z.getDestinationPoint(c,a,v);c={distance:d,radius:b,initBearing:a,chordMidPoint:g,
centerAndChordDistance:Math.sqrt(Math.abs(b*b-v*v)),chordEndPoint:e,chordStartPoint:c};a=z.getArcParam(c);a.startAngle=a.startAngle>a.endAngle?a.startAngle-360:a.startAngle;a=z.getPointsForArc(a.startAngle,a.endAngle,a.centerPoint,b);0===a.length&&(a.push(c.chordStartPoint),a.push(c.chordEndPoint));0>b&&a.reverse();return{endPoint:e,arcGeometryPointsArray:a}},_drawStraightLine:function(c,a){var e,b,d;e=c.BearingConversions.naDD;b=c.LengthConversions.meters;if(c.adjustedValues&&this.adjustPoints){e=
c.adjustedValues.adjustedBearing;if("S"===c.BearingConversions.qb3DDRound.charAt(0)||0>c.adjustedValues.lat)e=c.adjustedValues.adjustedBearingNADD;b=c.adjustedValues.adjustedLength;this.appliedCompassRule=!0}this._rotationAngle&&(e=Number(e)+this._rotationAngle);this._scaleValue&&(b*=this._scaleValue);d=z.getDestinationPoint(this._orgStartPointForNextLine,c.BearingConversions.naDD,c.LengthConversions.meters);e=z.getDestinationPoint(this._startPointForNextLine,e,b);c=this.setInfoForCalculatingMisclose(c,
d,[this._orgStartPointForNextLine,d]);this._drawLineAndEndPoint(e,[this._startPointForNextLine,e],c,a)},_drawArc:function(c,a){var e,b,d,v;d=c.BearingConversions.naDD;e=c.RadiusConversions.meters;b=c.ChordLengthConversions.meters;if(c.adjustedValues&&this.adjustPoints){d=c.adjustedValues.adjustedBearing;if("S"===c.BearingConversions.qb3DDRound.charAt(0)||0>c.adjustedValues.lat)d=c.adjustedValues.adjustedBearingNADD;b=c.adjustedValues.adjustedLength;0>c.ChordLengthConversions.meters&&(b*=-1);this.appliedCompassRule=
!0}this._rotationAngle&&(d=Number(d)+this._rotationAngle);this._scaleValue&&(b*=this._scaleValue,e*=this._scaleValue);v=this.getArcInfo(this._orgStartPointForNextLine,c.BearingConversions.naDD,c.RadiusConversions.meters,c.ChordLengthConversions.meters);c=this.setInfoForCalculatingMisclose(c,v.endPoint,v.arcGeometryPointsArray);e=this.getArcInfo(this._startPointForNextLine,d,e,b);this._drawLineAndEndPoint(e.endPoint,e.arcGeometryPointsArray,c,a)},_setExtentToLayer:function(c,a){this._setExtentTimer&&
clearTimeout(this._setExtentTimer);this._setExtentTimer=setTimeout(g.hitch(this,function(){var e;0<c.graphics.length&&(e=G.graphicsExtent(c.graphics),!a&&this.map.extent.contains(e)||this.map.setExtent(e.expand(1.5)))}),200)},_showMessage:function(c){this.emit("showMessage",c)},updateAccordingToPlanSettings:function(c){this._planSettings=c;this.bearingNode.set("placeHolder",this._getAbbreviatedUnits(c.directionOrAngleUnits));this.lengthNode.set("placeHolder",this._getAbbreviatedUnits(c.distanceAndLengthUnits));
this.radiusNode.set("placeHolder",this._getAbbreviatedUnits(c.distanceAndLengthUnits));this._reGenerateTraverseGrid();this._misCloseDetailsInstance&&(c=this._misCloseDetailsInstance.getMiscloseDetails())&&(c=this._getMiscloseDetailsAccordingToPlanSettings(c),this._misCloseDetailsInstance.updateAccordingToPlanSettings(c))},deActivateUpdateRotationPointTool:function(){d.remove(this.updateRotationPointNode,"esriCTEnableButton");F.set(this.updateRotationPointNode,"aria-pressed","false")},deActivateDigitizationTool:function(){d.remove(this.screenDigitizationNode,
"esriCTEnableButton");F.set(this.screenDigitizationNode,"aria-pressed","false")},pointAddedFromDigitization:function(c){var e,a,b,d;d=new w(4326);z.getProjectedGeometry(c,d,this.geometryService).then(g.hitch(this,function(c){e=z.getAngleBetweenPoints(this._startPointForNextLine,c);360===e&&(e=0);a=z.getDistanceBetweenPoints(this._startPointForNextLine,c);b=this.getAngleFromDDTOQB(e);this.bearingNode.set("value",b);"uSSurveyFeet"===this._planSettings.distanceAndLengthUnits?a=C.metersToUSSurveyFeet(a):
"feet"===this._planSettings.distanceAndLengthUnits&&(a=C.metersToFeet(a));0<this._scaleValue&&(a/=this._scaleValue);this.lengthNode.set("value",a);this.radiusNode.set("value","");this._addNewItem(!0)}))},getParcelCloseDetails:function(){var c,a,b,d,v,k,f,r,n;d={isClosed:!1,compassStartPoint:null,compassEndPoint:null};v=!0;a=c=b=0;m.forEach(this._itemList,g.hitch(this,function(e,d){e.LineSymbol.type===this.config.BoundaryLineType?(0===b?k=e.startPoint:f=e.endpoint,b++,c+=Math.cos(e.BearingConversions.naDD/
180*Math.PI)*e.LengthConversions.meters,a+=Math.sin(e.BearingConversions.naDD/180*Math.PI)*e.LengthConversions.meters):0<d&&0!==b&&(v=!1)}));1<b&&v&&(r=Math.sqrt(c*c+a*a),r=z.removeNegativeExponents(r),k.x=C.showFixedPlacesAfterDecimal(k.x,6),k.y=C.showFixedPlacesAfterDecimal(k.y,6),f.x=C.showFixedPlacesAfterDecimal(f.x,6),f.y=C.showFixedPlacesAfterDecimal(f.y,6),n=z.getAngleBetweenPoints(f,k),d.isClosed=!0,d.compassStartPoint=k,d.compassEndPoint=f,d.miscloseDistance=r,d.miscloseBearing=n);return d},
setParcelClosure:function(c,a){var e;e=this.getParcelCloseDetails();if(e.isClosed)e=this.getCalculatedMiscloseDetails(e),this._misCloseDetailsInstance.setMiscloseDetails(e),e.adjustPoints?((this.adjustPoints=this._applyCompassRule(e))&&!this.appliedCompassRule||c)&&this.setStartPoint(this.startPoint,a):(this.adjustPoints=!1,(this.appliedCompassRule||c)&&this.setStartPoint(this.startPoint,a));else if(this._misCloseDetailsInstance.setMiscloseDetails(null),this.adjustPoints=!1,this.appliedCompassRule||
c)this.appliedCompassRule=!1,this.setStartPoint(this.startPoint,a)},_getMiscloseDetailsAccordingToPlanSettings:function(c){var a,e;a={};c.BearingConversions&&(a.miscloseBearing=this._getBearingAccordingToPlanSettings(c.BearingConversions));e=this._getRoundedValue(c.LengthConversions,"MiscloseDistance");a.miscloseDistance=e+" "+this._getAbbreviatedUnits(this._planSettings.distanceAndLengthUnits);c.AreaConversions?(c=c.AreaConversions[this._planSettings.areaUnits],isNaN(parseFloat(c))||(c=C.honourPopupRounding(2,
c.toFixed(1)))):c=0;c=c+" "+this._getAbbreviatedUnits(this._planSettings.areaUnits);a.calculatedArea=c;return a},getCalculatedMiscloseDetails:function(c){var a,e={},b=a=0,b=0,d=!1;a=c.compassStartPoint;if(c.compassEndPoint&&a){a=c.miscloseDistance;b=c.miscloseBearing;0===a&&(b=0);b=this.getAngleFromDDTOQB(b);if(c=C.categorizeBearingFormat(b,this._planSettings))e.BearingConversions=c;e.AreaConversions=this._getCalculatedArea();c=this._getMiscloseRatioInfo(a);b=c.miscloseRatio;e.miscloseValue=c.miscloseValue;
a=C.categorizeLengthFormat(a,"meters");e.LengthConversions=a;a=a[this.config.miscloseSnapDistanceUnit+"Round"];1E5<=b&&(d=!0);e.miscloseRatio=b;e.accuracy=d;e=g.mixin(e,this._getMiscloseDetailsAccordingToPlanSettings(e));if(0<a&&a<=this.config.miscloseSnapDistance||isFinite(b)&&b>=this.config.miscloseRatioSnap)e.adjustPoints=!0,e.compassCompleteLength=c.compassCompleteLength}return e},_getPolygonAtOrigin:function(){var c=new M(0,0,new w(4326)),a=[];m.forEach(this._itemList,g.hitch(this,function(e){var b,
d;if(e.LineSymbol.type===this.config.BoundaryLineType){if(""===e.Radius||"0"===e.Radius||0===e.Radius){if(e.adjustedValues&&this.adjustPoints){d=e.adjustedValues.adjustedBearing;if("S"===e.BearingConversions.qb3DDRound.charAt(0)||0>e.adjustedValues.lat)d=e.adjustedValues.adjustedBearingNADD;b=e.adjustedValues.adjustedLength}else d=e.BearingConversions.naDD,b=e.LengthConversions.meters;e=z.getDestinationPoint(c,d,b);b=z.getLineBetweenPoints([c,e])}else{if(e.adjustedValues&&this.adjustPoints){d=e.adjustedValues.adjustedBearing;
if("S"===e.BearingConversions.qb3DDRound.charAt(0)||0>e.adjustedValues.lat)d=e.adjustedValues.adjustedBearingNADD;b=e.adjustedValues.adjustedLength;0>e.ChordLengthConversions.meters&&(b*=-1)}else d=e.BearingConversions.naDD,b=e.ChordLengthConversions.meters;b=this.getArcInfo(c,d,e.RadiusConversions.meters,b);e=b.endPoint;b=z.getLineBetweenPoints(b.arcGeometryPointsArray)}c=e;for(e=0;e<b.paths.length;e++)a.push(b.paths[e])}}));return z.getPolygonFromPolyLines(a,!0)},_getCalculatedArea:function(){var c,
a;this._arrayOfAllBoundaryLines&&0<this._arrayOfAllBoundaryLines.length&&(a=this._getPolygonAtOrigin())&&(c=new A(a),this.parcelPolygonGraphicsLayer.clear(),this.parcelPolygonGraphicsLayer.add(c),c=z.getAreaOfGeometry(a));return c},_applyCompassRule:function(c){var a,e,b,d,v,g;v=d=0;g={};for(b=0;b<this._itemList.length;b++)e=this._itemList[b],e.LineSymbol.type===this.config.BoundaryLineType&&(""===e.Radius||"0"===e.Radius||0===e.Radius?a=e.LengthConversions.meters:e.ChordLengthConversions&&(a=e.ChordLengthConversions.meters),
a=Math.abs(a),e.lat=a*Math.cos(Math.PI/180*e.BearingConversions.naDD),e.dep=a*Math.sin(Math.PI/180*e.BearingConversions.naDD),d+=e.lat,v+=e.dep);g.sumOfLat=d;g.sumOfDep=v;g.sumOfAllLinesLength=c.compassCompleteLength;for(b=0;b<this._itemList.length;b++)e=this._itemList[b],""===e.Radius||"0"===e.Radius||0===e.Radius?a=e.LengthConversions.meters:e.ChordLengthConversions&&(a=e.ChordLengthConversions.meters),a=Math.abs(a),e.LineSymbol.type===this.config.BoundaryLineType&&(e.adjustedValues=this._adjustBearingAndDistance(e.lat,
e.dep,a,g));for(b=a=c=0;b<this._itemList.length;b++)e=this._itemList[b],e.LineSymbol.type===this.config.BoundaryLineType&&(c+=parseFloat(e.adjustedValues.lat.toFixed(2)),a+=parseFloat(e.adjustedValues.dep.toFixed(2)),c=parseFloat(c.toFixed(2)),a=parseFloat(a.toFixed(2)));return 0===parseInt(c,10)&&0===parseInt(a,10)?!0:!1},_adjustBearingAndDistance:function(c,a,b,d){var e,v;e={};c=parseFloat(c.toFixed(6));a=parseFloat(a.toFixed(6));b=parseFloat(b.toFixed(6));v=-d.sumOfLat/d.sumOfAllLinesLength*b;
b*=-d.sumOfDep/d.sumOfAllLinesLength;v=parseFloat(v.toFixed(6));b=parseFloat(b.toFixed(6));a+=b;c=parseFloat((c+v).toFixed(6));a=parseFloat(a.toFixed(6));v=Math.sqrt(Math.pow(c,2)+Math.pow(a,2));b=Math.atan(a/c);b=parseFloat(b.toFixed(6));e.lat=c;e.dep=a;e.adjustedLength=v;e.adjustedBearing=180/Math.PI*b;c=C.categorizeBearingFormat(e.adjustedBearing,{directionOrAngleType:"southAzimuth",directionOrAngleUnits:"decimalDegree"});e.adjustedBearingNADD=c.naDD;return e},_getMiscloseRatioInfo:function(c){var a,
e=a=0,b;b=0;this._arrayOfAllBoundaryLines&&0<this._arrayOfAllBoundaryLines.length&&(a=z.getPolyLineFromPaths(this._arrayOfAllBoundaryLines),a=z.getLengthOfGeometry(a),0<a&&(e=1/(c/a),10>e?e=0:1E5>e&&(b=parseInt(e,10),e="1:"+parseInt(e,10))));return{miscloseRatio:e,miscloseValue:b,compassCompleteLength:a}},getAngleFromDDTOQB:function(c){var a,e;e=g.clone(this._planSettings);e.directionOrAngleType="northAzimuth";e.directionOrAngleUnits="decimalDegree";(c=C.categorizeBearingFormat(c,e))&&(a="degreeMinuteSeconds"===
this._planSettings.directionOrAngleUnits?c.qb3DMS:c.qb3DD);return a},initEditing:function(c,a,b){var e,d,v,k,f;this._planInfoInstance.setParcelInformation(this.polygonDeleteArr,a.features);e=this.polygonDeleteArr[0].attributes[this.config.polygonLayer.rotation.name];(v=this.polygonDeleteArr[0].attributes[this.config.polygonLayer.scale.name])||(v=1);d=this.polygonDeleteArr[0].attributes[this.config.polygonLayer.statedArea.name];this._parcelToolInstance.setRotation(e);this._parcelToolInstance.setScale(v);
null!==d&&void 0!==d&&this._misCloseDetailsInstance.traverseStatedArea.set("value",d);v=[];k=z.getUnitValueForSR(b);f=g.clone(this._planSettings);f.directionOrAngleType="northAzimuth";f.directionOrAngleUnits="decimalDegree";for(b=0;b<a.features.length;b++)if(e={},e.Bearing=a.features[b].attributes[this.config.polylineLayer.bearing.name],null!==e.Bearing&&void 0!==e.Bearing&&""!==e.Bearing){e.BearingConversions=C.categorizeBearingFormat(e.Bearing,f);e.Bearing=this._getBearingAccordingToPlanSettings(e.BearingConversions,
!0);e.Length=a.features[b].attributes[this.config.polylineLayer.distance.name];null!==e.Length&&""!==e.Length&&(e.LengthConversions=this._validateLength(e.Length,k),e.Length=e.LengthConversions[this._planSettings.distanceAndLengthUnits]);if(d=this.getLineSymbolForType(a.features[b].attributes[this.config.polylineLayer.lineType.name]))e.LineSymbol=d;e.Radius=a.features[b].attributes[this.config.polylineLayer.radius.name];null!==e.Radius&&""!==e.Radius?(e.RadiusConversions=this._validateLength(e.Radius,
k),e.Radius=e.RadiusConversions[this._planSettings.distanceAndLengthUnits],e.ArcLength=a.features[b].attributes[this.config.polylineLayer.arcLength.name],null!==e.ArcLength&&""!==e.ArcLength&&(e.ArcLengthConversions=this._validateLength(e.ArcLength,k),e.ArcLength=e.ArcLengthConversions[this._planSettings.distanceAndLengthUnits]),e.ChordLength=a.features[b].attributes[this.config.polylineLayer.chordLength.name],null!==e.ChordLength&&""!==e.ChordLength&&(e.ChordLengthConversions=this._validateLength(e.ChordLength,
k),e.ChordLength=e.ChordLengthConversions[this._planSettings.distanceAndLengthUnits]),"radiusAndArcLength"===this._planSettings.circularCurveParameters?(e.Length=e.ArcLength,e.LengthConversions=g.clone(e.ArcLengthConversions)):(e.Length=e.ChordLength,e.LengthConversions=g.clone(e.ChordLengthConversions))):(e.Radius="",e.RadiusConversions=null);e.rowIndex=v.length;v.push(e)}this._itemList=v;this._reGenerateTraverseGrid();this._showHideTraverseTools();this.setStartPoint(c,!0);this.setBoundaryLineSymbol()},
setBoundaryLineSymbol:function(){this._symbolSelector&&m.some(this.config.lineTypes,g.hitch(this,function(c){if(this.config.BoundaryLineType===c.type)return this._symbolSelector.selectSymbol(c),!1}))},getLineSymbolForType:function(c){var e;m.some(this.config.lineTypes,g.hitch(this,function(a){if(a.type===c)return e=g.clone(a),!0}));return e},deactivateParcelTools:function(){this._parcelToolInstance.disableRotating();this._parcelToolInstance.disableScaling()},clearAll:function(){this.parcelLinesGraphicsLayer.clear();
this.parcelPointsGraphicsLayer.clear();this.parcelPolygonGraphicsLayer.clear();this.rotationPointsGraphicsLayer.clear();this._resetEntryRow();this._dndContainer.clearItems();q.empty(this.traverseGrid);this._itemList=[];this._nodes=[];this._showHideTraverseTools();this._orgStartPointForNextLine=this._startPointForNextLine=this.startPoint=null;this._rotationAngle=0;this._scaleValue=1;this._symbolSelector.setDefault();d.remove(this.screenDigitizationNode,"esriCTEnableButton");d.remove(this.updateRotationPointNode,
"esriCTEnableButton");this._parcelToolInstance.resetTools();this.deactivateParcelTools();this._misCloseDetailsInstance.setMiscloseDetails(null);this._arrayOfAllBoundaryLines=[];this.polygonDeleteArr=[];this.polylineDeleteArr=[];this.domNode.scrollTop=0;this._planInfoInstance.resetValues();this._misCloseDetailsInstance.traverseStatedArea.set("value",null);this._rotationPointInfo=null;this.closePopup()},_showParcelPopup:function(e){var a,b,d=[];a=new c;b=this._pointToExtent(e.mapPoint,8);d=m.filter(this.parcelLinesGraphicsLayer.graphics,
function(c){return b.intersects(c.geometry)});d[0]?(this._createPopupContent(e,d[0]),a.resolve(!0)):(this.closePopup(),a.resolve(!1));return a},_getAbbreviatedUnits:function(c){return window.jimuNls.units[c+"Abbr"]},_pointToExtent:function(c,a){var e;e=this.map.extent.getWidth()/this.map.width;a*=e;return new v(c.x-a,c.y-a,c.x+a,c.y+a,this.map.spatialReference)},_createPopupContent:function(c,a){var e,b,d;if(d=this._itemList[a.attributes.rowIndex])e=q.create("div",{"class":"esriCTParcelInfoPopup "+
this.baseClass},null),b=q.create("div",{"class":"esriCTLabelRows"},e),this._createFieldLabels(b,this.nls.traverseSettings.bearingLabel),this._createFieldLabels(b,this.nls.traverseSettings.lengthLabel),this._createFieldLabels(b,this.nls.traverseSettings.radiusLabel),a=q.create("div",{"class":"esriCTRowContainer esriCTRow",rowIndex:a.attributes.rowIndex},e),this._createFieldInputs(a,this._getBearingAccordingToPlanSettings(d.BearingConversions),"esriCTBearingRow",!0),(b=d.RadiusConversions)?(b=this._getRoundedValue(d.RadiusConversions,
"Radius"),d="radiusAndArcLength"===this._planSettings.circularCurveParameters?this._getRoundedValue(d.ArcLengthConversions,"Length"):this._getRoundedValue(d.ChordLengthConversions,"Length")):(b="",d=this._getRoundedValue(d.LengthConversions,"Length")),this._createFieldInputs(a,d,"esriCTLengthRow",!0),this._createFieldInputs(a,b,"esriCTRadiusRow",!0),N.position(this.traverseEntryNode)&&N.position(this.traverseEntryNode).w&&(d=N.position(this.traverseEntryNode).w-42,u.set(this._popupDialog.domNode,
"width",d+"px")),this._popupDialog.setContent(e),this._popupCoords={pageX:c.pageX,pageY:c.pageY},this._openPopup(c)},_openPopup:function(c){u.set(this._popupDialog.domNode,"opacity",.9);I.open({popup:this._popupDialog,x:c.pageX,y:c.pageY})},closePopup:function(){this._popupDialog&&I.close(this._popupDialog)},_createFieldLabels:function(c,a){q.create("div",{innerHTML:a,title:a,"class":"esriCTParcelInfoLabels"},c)},_createTooltip:function(){this._popupDialog=new J({"class":"esriCTEditParcelDialog"});
this._popupDialog.startup()},validateNumericField:function(c,a){var e,b=/^[-+]?[0-9]+\.[0-9]+$/,d=/^[-+]?[0-9]+$/;c=g.trim(c);switch(a){case "esriFieldTypeSmallInteger":a=parseInt(c,10);e=c.match(d)&&-32768<=a&&32767>=a&&0!==c.length?!0:!1;break;case "esriFieldTypeInteger":a=parseInt(c,10);e=c.match(d)&&-2147483648<=a&&2147483647>=a&&0!==c.length?!0:!1;break;case "esriFieldTypeSingle":a=parseFloat(c);e=(c.match(d)||c.match(b))&&a>=-3.4*Math.pow(10,38)&&a<=1.2*Math.pow(10,38)&&0!==c.length?!0:!1;break;
case "esriFieldTypeDouble":a=parseFloat(c),e=(c.match(d)||c.match(b))&&a>=-2.2*Math.pow(10,308)&&a<=1.8*Math.pow(10,38)&&0!==c.length?!0:!1}return e},updateLastNodeInTraversePanel:function(){this._planInfoInstance.setPlanInfoCancelBtnAsLastNode()},_showParcelSavedAndDeleteMsg:function(c){this.emit("showParcelSavedAndDeleteMsg",c)}})})},"widgets/ParcelDrafter/SymbolSelector":function(){define("dojo/_base/declare jimu/BaseWidget dojo/_base/lang dojo/on dojo/dom-construct dojo/_base/array jimu/symbolUtils esri/symbols/jsonUtils dijit/popup dijit/TooltipDialog dojo/_base/html dojo/keys dojo/query dijit/focus".split(" "),
function(l,a,b,h,f,g,m,d,q,u,p,k,n,y){return l([a],{_tooltipDialog:null,selectedSymbol:null,symbolData:[],constructor:function(a){b.mixin(this,a)},postCreate:function(){this.symbolData||(this.symbolData=[]);this._createSelectedSymbolNode();this._hideTooltipDialog();this.symbolData&&0<this.symbolData.length&&(this._createTooltipDialog(),this.symbolData[1].isDefault?this.selectSymbol(this.symbolData[1]):this.selectSymbol(this.symbolData[0]));this.own(h(document.body,"click",b.hitch(this,function(a){this.isPartOfPopup(a.target||
a.srcElement)||this._hideTooltipDialog()})))},setDefault:function(){this.symbolData&&1<this.symbolData.length&&this.symbolData[1].isDefault?this.selectSymbol(this.symbolData[1]):this.selectSymbol(this.symbolData[0])},_createSelectedSymbolNode:function(){var a=f.create("div",{},this.domNode);this.selectedSymbolNode=f.create("div",{"class":"esriCTSelectedSymbol"},a)},_createTooltipDialog:function(){var a=this._createSymbolListMenu();this._tooltipDialog=new u({content:a,"class":"esriCTSymbolPopup"});
this.own(h(this.domNode,"click",b.hitch(this,function(a){a.stopPropagation();a.preventDefault();this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(h(this.domNode,"keydown",b.hitch(this,function(a){if(a.keyCode===k.ENTER||a.keyCode===k.SPACE)this._isTooltipDialogOpened?this._hideTooltipDialog():this._showTooltipDialog()})));this.own(h(document.body,"click",b.hitch(this,function(a){this.isPartOfPopup(a.target||a.srcElement)||this._hideTooltipDialog()})))},_createSymbolListMenu:function(){var a,
d;a=f.create("div",{"class":"esriCTSymbolListContainer"},null);d=f.create("div",{"class":"esriCTSymbolListContent",role:"menu"},a);g.forEach(this.symbolData,b.hitch(this,function(a){var b,g;b=f.create("div",{"class":"esriCTSymbolOption",title:a.label,tabindex:"0",role:"menuitem","aria-label":a.label},d);this._attachRowClick(b,a);g=f.create("div",{"class":"esriCTSymbolIcon"},b);f.create("div",{"class":"esriCTSymbolName",innerHTML:a.label},b);b=f.create("div",{},g);this._createSymbol(a,b)}));return a},
_attachRowClick:function(a,d){this.own(h(a,"click",b.hitch(this,function(){this.selectSymbol(d);this.hideOnSelect&&this._hideTooltipDialog()})));this.own(h(a,"keydown",b.hitch(this,function(a){if(a.keyCode===k.ENTER||a.keyCode===k.SPACE||a.keyCode===k.ESCAPE)this.selectSymbol(d),this.hideOnSelect&&(this._hideTooltipDialog(),y.focus(this.domNode))})))},_createSymbol:function(a,b){a&&(a=d.fromJson(a.symbol),(a=m.createSymbolNode(a))||(a=f.create("div")),f.place(a,b))},selectSymbol:function(a){f.empty(this.selectedSymbolNode);
this.selectedSymbol={label:a.label||a.type,type:a.type,symbol:a.symbol};this._createSymbol(this.selectedSymbol,this.selectedSymbolNode);this.onSelect(a)},destroy:function(){q.close(this._tooltipDialog);this._tooltipDialog.destroy();this.inherited(arguments)},isPartOfPopup:function(a){var b;b=this._tooltipDialog.domNode;return a===b||p.isDescendant(a,b)},onSelect:function(a){return a},_showTooltipDialog:function(){q.open({parent:this.getParent(),popup:this._tooltipDialog,around:this.domNode,"class":"esriCTSymbolPopup"});
this._isTooltipDialogOpened=!0;this.focusFirstSymbolOption()},_hideTooltipDialog:function(){q.close(this._tooltipDialog);this._isTooltipDialogOpened=!1},focusFirstSymbolOption:function(){var a=n(".esriCTSymbolOption",this._tooltipDialog.domNode);y.focus(a[0])}})})},"widgets/ParcelDrafter/MiscloseDetails":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./MiscloseDetails.html dojo/_base/lang dojo/Evented dojo/dom-class dojo/dom-attr".split(" "),function(l,
a,b,h,f,g,m,d){return l([a,b,g],{baseClass:"jimu-widget-ParcelDrafter-MisclosedDetails",templateString:h,details:null,constructor:function(a){f.mixin(this,a)},postCreate:function(){this.inherited(arguments);m.add(this.domNode,"esriCTFullWidth");this.config.polygonLayer.statedArea&&this.config.polygonLayer.statedArea.hasOwnProperty("name")&&(m.remove(this.traverseStatedAreaNode,"esriCTHidden"),this.traverseStatedArea.trim=!0,this.config.polygonLayer.statedArea.nullable||(this.traverseStatedArea.required=
!0),0<=this.numberFieldTypes.indexOf(this.config.polygonLayer.statedArea.type)&&(this.traverseStatedArea.validator=f.hitch(this,function(a){return!this.config.polygonLayer.statedArea.nullable&&(null===a||""===a)||""!==a&&!this.validateNumericField(a,this.config.polygonLayer.statedArea.type)?!1:!0})));this._setBackgroundColorForDartTheme()},_setBackgroundColorForDartTheme:function(){"DartTheme"===this.appConfig.theme.name&&m.add(this.traverseDetailsContainer,"esriCTMiscloseHeaderDiv")},getMiscloseDetails:function(){return this.details},
updateAccordingToPlanSettings:function(a){d.set(this.miscloseBearingNode,"innerHTML",a.miscloseBearing);d.set(this.miscloseDistanceNode,"innerHTML",a.miscloseDistance);d.set(this.calculatedAreaNode,"innerHTML",a.calculatedArea)},setMiscloseDetails:function(a){(this.details=a)?(d.set(this.miscloseBearingNode,"innerHTML",a.miscloseBearing),d.set(this.miscloseDistanceNode,"innerHTML",a.miscloseDistance),0!==a.miscloseRatio?(m.remove(this.traverseMiscloseRatioNode,"esriCTHidden"),d.set(this.miscloseRatioNode,
"innerHTML",a.miscloseRatio)):m.add(this.traverseMiscloseRatioNode,"esriCTHidden"),a.accuracy?(m.add(this.traverseMiscloseRatioNode,"esriCTHidden"),m.remove(this.traverseAccuracyNode,"esriCTHidden")):m.add(this.traverseAccuracyNode,"esriCTHidden"),a.calculatedArea?(d.set(this.calculatedAreaNode,"innerHTML",a.calculatedArea),m.remove(this.traverseCalculatedAreaNode,"esriCTHidden")):m.add(this.traverseCalculatedAreaNode,"esriCTHidden"),m.add(this.noMiscloseCalculated,"esriCTHidden"),m.remove(this.miscloseDetailsContainer,
"esriCTHidden")):(m.add(this.miscloseDetailsContainer,"esriCTHidden"),m.remove(this.noMiscloseCalculated,"esriCTHidden"))}})})},"widgets/ParcelDrafter/ParcelTools":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./ParcelTools.html dojo/_base/lang dojo/Evented dojo/dom-class dojo/dom-attr dojo/on dojo/keys dijit/form/NumberTextBox".split(" "),function(l,a,b,h,f,g,m,d,q,u){return l([a,b,g],{baseClass:"jimu-widget-ParcelDrafter-ParcelTools",templateString:h,
rotationAngle:0,scaledValue:1,constructor:function(a){f.mixin(this,a)},postCreate:function(){this.inherited(arguments);m.add(this.domNode,"esriCTFullWidth");this.rotationTxt.constraints={min:-360,max:360,places:3};this.scaleTxt.constraints={min:.1,places:3};this.rotationTxt.set("value",this.rotationAngle);this.scaleTxt.set("value",this.scaledValue);this.own(q(this.rotationTxt,"blur",f.hitch(this,function(){this.setRotation(this.rotationTxt.displayedValue)})));this.own(q(this.scaleTxt,"blur",f.hitch(this,
function(){this.setScale(this.scaleTxt.displayedValue)})));this.canProjectLocally?(this.own(q(this.rotateButton,"click",f.hitch(this,function(){this._toggleRotating()}))),this.own(q(this.rotateButton,"keydown",f.hitch(this,function(a){if(a.keyCode===u.ENTER||a.keyCode===u.SPACE)a.preventDefault(),this._toggleRotating()}))),this.own(q(this.scaleButton,"click",f.hitch(this,function(){this._toggleScaling()}))),this.own(q(this.scaleButton,"keydown",f.hitch(this,function(a){if(a.keyCode===u.ENTER||a.keyCode===
u.SPACE)a.preventDefault(),this._toggleScaling()})))):(m.add(this.rotateButton,"esriCTDisabledParcelToolButton"),d.set(this.rotateButton,"tabindex","-1"),m.add(this.scaleButton,"esriCTDisabledParcelToolButton"),d.set(this.scaleButton,"tabindex","-1"));this.own(q(this.rotationTxt,"keypress",f.hitch(this,function(a){(a.charCode||a.keyCode)===u.ENTER&&this.setRotation(this.rotationTxt.displayedValue)})));this.own(q(this.scaleTxt,"keypress",f.hitch(this,function(a){(a.charCode||a.keyCode)===u.ENTER&&
this.setScale(this.scaleTxt.displayedValue)})))},setScale:function(a){var b=this.scaledValue;isNaN(Number(a))||(this.scaleTxt.set("value",Number(a)),this.scaleTxt.set("value",Number(this.scaleTxt.displayedValue)));this.scaleTxt.isValid()?this.scaleGeometries():(this.scaleTxt.set("value",Number(b)),this.scaleTxt.set("value",Number(this.scaleTxt.displayedValue)))},scaleGeometries:function(){var a;a=Number(this.scaleTxt.get("value"));isNaN(a)||(this.scaledValue=a,this.emit("scaleGeometries",a))},setRotation:function(a){var b=
this.rotationAngle;isNaN(Number(a))||(this.rotationTxt.set("value",Number(a)),this.rotationTxt.set("value",Number(this.rotationTxt.displayedValue)));this.rotationTxt.isValid()?this.rotateGeometries():(this.rotationTxt.set("value",Number(b)),this.rotationTxt.set("value",Number(this.rotationTxt.displayedValue)))},rotateGeometries:function(){var a;a=Number(this.rotationTxt.get("value"));isNaN(a)||(this.rotationAngle=a,this.emit("rotateGeometries",a))},resetTools:function(){this.rotationAngle=0;this.scaledValue=
1;this.rotationTxt.set("value",Number(0));this.scaleTxt.set("value",Number(1))},_toggleRotating:function(){m.contains(this.rotateButton.parentElement,"esriCTDisableButton")?(m.remove(this.rotateButton.parentElement,"esriCTDisableButton"),d.set(this.rotateButton,"aria-pressed","true"),this.disableScaling(),this.emit("toggleRotating",!0)):(this.disableRotating(),this.emit("toggleRotating",!1))},_toggleScaling:function(){m.contains(this.scaleButton.parentElement,"esriCTDisableButton")?(m.remove(this.scaleButton.parentElement,
"esriCTDisableButton"),d.set(this.scaleButton,"aria-pressed","true"),this.disableRotating(),this.emit("toggleScaling",!0)):(this.disableScaling(),this.emit("toggleScaling",!1))},disableRotating:function(){m.add(this.rotateButton.parentElement,"esriCTDisableButton");d.set(this.rotateButton,"aria-pressed","false")},disableScaling:function(){m.add(this.scaleButton.parentElement,"esriCTDisableButton");d.set(this.scaleButton,"aria-pressed","false")}})})},"widgets/ParcelDrafter/PlanInfo":function(){define("dojo/_base/declare jimu/BaseWidget dijit/_WidgetsInTemplateMixin dojo/text!./PlanInfo.html dojo/_base/lang dojo/_base/array dojo/Evented dojo/dom-attr dojo/dom-construct dojo/dom-class dojo/dom-style dojo/query dijit/registry dijit/form/ValidationTextBox dojo/store/Memory dijit/form/ComboBox dojo/on esri/geometry/Polyline esri/graphic esri/tasks/query esri/tasks/QueryTask esri/dijit/AttributeInspector esri/layers/FeatureLayer jimu/dijit/Message ./geometryUtils jimu/utils jimu/LayerInfos/LayerInfos dojo/keys dojo/aspect".split(" "),
function(l,a,b,h,f,g,m,d,q,u,p,k,n,y,r,K,t,z,C,A,E,x,G,F,H,w,B,D,J){return l([a,b,m],{baseClass:"jimu-widget-ParcelDrafter-PlanInfo",templateString:h,_itemList:null,_polygonLayer:null,parcelNameTextBox:null,planNameTextBox:null,documentTypeControl:null,planSettings:null,_savedPolygonObjectId:null,_savedPolyLines:null,fieldInfosForPolygonLayer:null,constructor:function(a){f.mixin(this,a)},postCreate:function(){this.inherited(arguments);B.getInstance(this.map,this.map.itemInfo).then(f.hitch(this,function(a){this._layerInfosObj=
a;this._init()}))},_init:function(){if(0<this._getFieldInfosForPolygonLayer().length)if(this._addGraphicToLocalLayer(),this.config.polygonLayer.attributeListTitle){var a=w.sanitizeHTML(this.config.polygonLayer.attributeListTitle);d.set(this.attributeListTitle,"innerHTML",a)}else a=this._layerInfosObj.getLayerInfoById(this.config.polygonLayer.id),d.set(this.attributeListTitle,"innerHTML",a.layerObject.name);else u.add(this.expandCollapseParentNode,"esriCTHidden");u.add(this.domNode,"esriCTFullWidth");
this.own(t(this.planInfoCancelButton,"click",f.hitch(this,function(){this.emit("cancelTraversedParcel")})));this.own(t(this.planInfoCancelButton,"keydown",f.hitch(this,function(c){c.keyCode!==D.ENTER&&c.keyCode!==D.SPACE||this.emit("cancelTraversedParcel")})));this.own(t(this.planInfoSaveButton,"click",f.hitch(this,function(){this.emit("saveTraversedParcel")})));this.own(t(this.planInfoSaveButton,"keydown",f.hitch(this,function(c){c.keyCode!==D.ENTER&&c.keyCode!==D.SPACE||this.emit("saveTraversedParcel")})));
this.own(t(this.planInfoDeleteButton,"click",f.hitch(this,this.deleteParcel)));this.own(t(this.planInfoDeleteButton,"keydown",f.hitch(this,function(c){c.keyCode!==D.ENTER&&c.keyCode!==D.SPACE||this.deleteParcel()})));this.own(t(this.expandCollapseNode,"click",f.hitch(this,this._onExpandCollapseClicked)));this.own(t(this.expandCollapseNode,"keydown",f.hitch(this,function(c){if(c.keyCode===D.ENTER||c.keyCode===D.SPACE)c.preventDefault(),this._onExpandCollapseClicked()})))},_onExpandCollapseClicked:function(){u.toggle(this.expandCollapseNode,
"esriCTCollapsedParceLayer");u.toggle(this.attributeListNode,"esriCTHidden");var a=this.nls.planInfo.showAttributeList;u.contains(this.expandCollapseNode,"esriCTCollapsedParceLayer")&&(a=this.nls.planInfo.hideAttributeList);d.set(this.expandCollapseNode,"aria-label",a);d.set(this.expandCollapseNode,"title",a)},resetValues:function(){u.contains(this.expandCollapseNode,"esriCTCollapsedParceLayer")&&this._onExpandCollapseClicked();this._addGraphicToLocalLayer();this.parcelNameTextBox&&this.parcelNameTextBox.set("value",
"");this.planNameTextBox&&this.planNameTextBox.set("value","");this.documentTypeControl&&(this.config.polygonLayer.documentType.domain?this.documentTypeControl.set("item",null):this.documentTypeControl.set("value",""));u.add(this.planInfoDeleteButton,"esriCTHidden")},_showMessage:function(a){this.emit("showMessage",a)},_createDocumentTypeControl:function(){this.config.polygonLayer.documentType.domain?(this.documentTypeControl=this._createFieldSelect(this.config.polygonLayer.documentType,this.documentType,
this.nls.planInfo.parcelDocumentTypeText,!this.config.polygonLayer.documentType.nullable),this.own(t(this.documentTypeControl,"change",f.hitch(this,function(a){""===a||null===a||void 0===a||this.documentTypeControl.store.data.some(function(c){return c.name===a})||(this.documentTypeControl.set("item",null),this._showMessage(this.nls.planInfo.enterValidDocumentTypeMessage))})))):this.documentTypeControl=this._createFieldInputs(this.config.polygonLayer.documentType,this.documentType,this.nls.planInfo.parcelDocumentTypeText,
!this.config.polygonLayer.documentType.nullable)},_createFieldInputs:function(a,c,b,d){a.alias&&(b=a.alias);b=d?b+" "+this.nls.planInfo.requiredText:b+" "+this.nls.planInfo.optionalText;b=new y({placeHolder:b,"class":"esriCTFullWidth",required:d,"aria-label":b});0<=this.numberFieldTypes.indexOf(a.type)&&(b.validator=f.hitch(this,function(c){return""===c||this.validateNumericField(c,a.type)?!0:!1}));b.placeAt(c);return b},_createFieldSelect:function(a,c,b,g){var v;v=this._createDocTypeDataArr();v=
new r({data:v});a&&a.alias&&(b=a.alias);b=g?b+" "+this.nls.planInfo.requiredText:b+" "+this.nls.planInfo.optionalText;this.selectBox=new K({placeHolder:b,"class":"esriCTFullWidth",required:g,store:v},c);d.set(this.selectBox.domNode,"aria-label",b);d.set(this.selectBox.domNode,"role","combobox");d.set(this.selectBox.domNode,"aria-expanded","false");J.after(this.selectBox,"loadAndOpenDropDown",f.hitch(this,function(){d.set(this.selectBox.domNode,"aria-expanded","true")}));J.after(this.selectBox,"closeDropDown",
f.hitch(this,function(){d.set(this.selectBox.domNode,"aria-expanded","false")}));return this.selectBox},_createDocTypeDataArr:function(){var a=[];this.config.polygonLayer.documentType.domain.codedValues&&g.forEach(this.config.polygonLayer.documentType.domain.codedValues,f.hitch(this,function(c){a.push({name:c.name,id:c.code})}));return a},saveData:function(a){if(a.miscloseDetails&&(0===a.miscloseDetails.LengthConversions.meters||a.appliedCompassRule))this._saveParcel(a);else{var c;c=new F({message:this.nls.planInfo.saveNonClosedParcelConfirmationMessage,
type:"question",buttons:[{label:this.nls.common.yes,onClick:f.hitch(this,function(){c.close();this._saveParcel(a)})},{label:this.nls.common.no}]})}},_saveParcel:function(a){this._itemList=a.itemList;this.planSettings=a.planSettings;a.miscloseDetails&&(0===a.miscloseDetails.LengthConversions.meters||a.appliedCompassRule)?0===a.polygonDeleteArr.length?this._createPolygonData(a):this._deletePolygonBeforeSaving(a):0<a.polygonDeleteArr.length?this._deletePolygonBeforeSaving(a):this._createPolylineData(null)},
_createParcelPolygon:function(){var a,c,b,d,g;b=[];d=this.parcelLinesGraphicsLayer.graphics;for(a=0;a<this._itemList.length;a++)if(this._itemList[a].LineSymbol.type===this.config.BoundaryLineType)for(c=0;c<this._itemList[a].graphic.geometry.paths.length;c++)b.push(this._itemList[a].graphic.geometry.paths[c]);0<b.length&&(g=H.getPolygonFromPolyLines(b,!1,!0,d[0].geometry.spatialReference))&&(this.parcelPolygonGraphicsLayer.clear(),a=new C(g),this.parcelPolygonGraphicsLayer.add(a),g=this.parcelPolygonGraphicsLayer.graphics[0].geometry);
return g},_createPolygonData:function(a){var c,b,d,g;a.miscloseDetails&&(0===a.miscloseDetails.LengthConversions.meters||a.appliedCompassRule)?(this.loading.show(),c=[],b={},g=this.polygonLayerUnit,this.documentTypeControl&&(this.config.polygonLayer.documentType.domain?this.documentTypeControl.hasOwnProperty("item")&&this.documentTypeControl.item&&this.documentTypeControl.item.hasOwnProperty("id"):""!==this.documentTypeControl.get("value")&&this.documentTypeControl.get("value")),(d=this._createParcelPolygon())?
(this._currentFeatureDetails&&this._currentFeatureDetails.attributes&&(b=f.clone(this._currentFeatureDetails.attributes)),b[this.config.polygonLayer.rotation.name]=a.rotation,b[this.config.polygonLayer.scale.name]=a.scale,b[this.config.polygonLayer.miscloseRatio.name]=a.miscloseDetails.miscloseValue,b[this.config.polygonLayer.miscloseDistance.name]=this._getValueAccToFeatureLayerUnit(g,a.miscloseDetails,"LengthConversions"),this.config.polygonLayer.statedArea.hasOwnProperty("name")&&(b[this.config.polygonLayer.statedArea.name]=
a.statedArea),a=new C(d,null,b),c.push(a),this._saveParcelPolygon(c)):this._showMessage(this.nls.planInfo.unableToCreatePolygonParcel)):this._createPolylineData(null)},setParcelInformation:function(a,c){var b=this.map.getLayer(this.config.polygonLayer.id).objectIdField;this._savedPolygonObjectId=a[0].attributes[b];var d=f.clone(a[0].attributes);d[b]=d[b]?d[b]:0;this._addGraphicToLocalLayer(d);this._savedPolyLines=c;u.remove(this.planInfoDeleteButton,"esriCTHidden");this.parcelNameTextBox&&this.parcelNameTextBox.set("value",
a[0].attributes[this.config.polygonLayer.parcelName.name]);this.planNameTextBox&&this.planNameTextBox.set("value",a[0].attributes[this.config.polygonLayer.planName.name]);this.documentTypeControl&&(a=a[0].attributes[this.config.polygonLayer.documentType.name],null!==a&&""!==a&&void 0!==a&&(this.config.polygonLayer.documentType.domain?this.documentTypeControl.set("item",this.documentTypeControl.store.get(a)):this.documentTypeControl.set("value",a)))},_rollbackSavedPolygon:function(){var a,c,b;c={attributes:{}};
(a=this.map.getLayer(this.config.polygonLayer.id))&&null!==this._savedPolygonObjectId&&(c.attributes[a.objectIdField]=this._savedPolygonObjectId,b=a.applyEdits(null,null,[c]));return b},_rollbackSavedPolyLines:function(a){var c,b,d,k;b=[];c=this.map.getLayer(this.config.polylineLayer.id);g.forEach(a,f.hitch(this,function(a){d={attributes:{}};a.hasOwnProperty("objectId")?(d.attributes[c.objectIdField]=a.objectId,b.push(d)):a.attributes.hasOwnProperty(c.objectIdField)&&(d.attributes[c.objectIdField]=
a.attributes[c.objectIdField],b.push(d))}));c&&0<b.length&&(k=c.applyEdits(null,null,b));return k},_deletePolygonBeforeSaving:function(a){(this._polygonLayer=this.map.getLayer(this.config.polygonLayer.id))?this._polygonLayer.applyEdits(null,null,a.polygonDeleteArr,f.hitch(this,function(){this._deleteLinesBeforeSaving(a)}),f.hitch(this,function(){this._showMessage(this.nls.planInfo.unableToSavePolygonParcel)})):this._showMessage(this.nls.planInfo.unableToSavePolygonParcel)},_deleteLinesBeforeSaving:function(a){var c;
(c=this.map.getLayer(this.config.polylineLayer.id))?c.applyEdits(null,null,a.polylineDeleteArr,f.hitch(this,function(){this._createPolygonData(a)}),f.hitch(this,function(){this._showMessage(this.nls.planInfo.unableToUpdateParcelLines)})):this._showMessage(this.nls.planInfo.unableToUpdateParcelLines)},_saveParcelPolygon:function(a){(this._polygonLayer=this.map.getLayer(this.config.polygonLayer.id))?(this._savedPolygonObjectId=null,this._polygonLayer.applyEdits(a,null,null,f.hitch(this,function(c){c&&
0<c.length&&c[0].success?(this._savedPolygonObjectId=c[0].objectId,this._polygonLayer.refresh(),c=new A,c.objectIds=[this._savedPolygonObjectId],c.returnGeometry=!1,c.outFields=[this.config.polygonLayer.relatedGUID.name],(new E(this._polygonLayer.url)).execute(c,f.hitch(this,function(c){this.loading.hide();this._createPolylineData(c.features[0].attributes[this.config.polygonLayer.relatedGUID.name])}),f.hitch(this,function(){this.loading.hide();this._showMessage(this.nls.planInfo.unableToSaveParcelLines)}))):
(this.loading.hide(),this._showMessage(this.nls.planInfo.unableToSavePolygonParcel))}),f.hitch(this,function(){this.loading.hide();this._showMessage(this.nls.planInfo.unableToSavePolygonParcel)}))):(this.loading.hide(),this._showMessage(this.nls.planInfo.unableToSavePolygonParcel))},_getValueAccToFeatureLayerUnit:function(a,c,b){if(c.hasOwnProperty(b)&&c[b])switch(a){case "meters":case "degrees":return c[b].meters;case "feet":return c[b].feet;case "uSSurveyFeet":return c[b].uSSurveyFeet;default:return null}else return null},
_getCurrentLineFeatures:function(){for(var a=[],c=0;c<this._itemList.length;c++)a.push(this._itemList[c].graphic);return a},_createPolylineData:function(a){var c,b,d,g,e,k;this.loading.show();e=this._getCurrentLineFeatures();d=this.polylineLayerUnit;k=this._itemList;g=[];for(var f=0;f<e.length;f++)c={},b=k[f],c[this.config.polylineLayer.bearing.name]=b.BearingConversions.naDD,c[this.config.polylineLayer.distance.name]=this._getValueAccToFeatureLayerUnit(d,b,"LengthConversions"),c[this.config.polylineLayer.lineType.name]=
b.LineSymbol.type,c[this.config.polylineLayer.radius.name]=this._getValueAccToFeatureLayerUnit(d,b,"RadiusConversions"),null!==c[this.config.polylineLayer.radius.name]&&""!==c[this.config.polylineLayer.radius.name]&&void 0!==c[this.config.polylineLayer.radius.name]?(c[this.config.polylineLayer.arcLength.name]=this._getValueAccToFeatureLayerUnit(d,b,"ArcLengthConversions"),b=this._getValueAccToFeatureLayerUnit(d,b,"ChordLengthConversions"),c[this.config.polylineLayer.chordLength.name]=b,c[this.config.polylineLayer.distance.name]=
b):(c[this.config.polylineLayer.arcLength.name]=null,c[this.config.polylineLayer.chordLength.name]=null),c[this.config.polylineLayer.relatedGUID.name]=a,c[this.config.polylineLayer.sequenceId.name]=f,b=e[f].geometry.toJson(),b=new z(b),c=new C(b,null,c,null),g.push(c);this._saveParcelLines(g)},_saveParcelLines:function(a){var c;(c=this.map.getLayer(this.config.polylineLayer.id))?c.applyEdits(a,null,null,f.hitch(this,function(c){var b=[],d=[];g.forEach(c,function(c){c.success?d.push(c):b.push(c)});
0<b.length?(this._rollbackSavedPolygon(),0<d.length&&b.length!==a.length&&this._rollbackSavedPolyLines(d),this._showMessage(this.nls.planInfo.unableToSaveParcelLines)):(this._showParcelSavedAndDeleteMsg(this.nls.planInfo.parcelSavedSuccessMessage),this._savedPolygonObjectId=null,this.emit("displayMainPageAfterSave",!1));this.loading.hide()}),f.hitch(this,function(){this._rollbackSavedPolygon();this.loading.hide();this._showMessage(this.nls.planInfo.unableToSaveParcelLines)})):(this._rollbackSavedPolygon(),
this.loading.hide(),this._showMessage(this.nls.planInfo.unableToSaveParcelLines))},_validateRequiredFields:function(){var a=[],c=this._currentFeatureDetails;if(!c)return a;var b=c.getLayer(),b=g.filter(b.fields,f.hitch(this,function(c){return!1===c.nullable&&!0===c.editable}));g.forEach(b,f.hitch(this,function(b){if(c.attributes.hasOwnProperty(b.name))if("undefined"===c.attributes[b.name])a.push(b.name);else if(null===c.attributes[b.name])a.push(b.name);else switch(b.type){case "esriFieldTypeString":(""===
c.attributes[b.name]||c.attributes[b.name]&&""===c.attributes[b.name].trim())&&a.push(b.name)}else a.push(b.name)}));return a},_validateAttributes:function(){var a=[],c,a=this._validateRequiredFields(),b=k("td.atiLabel",this._attributeInspector.domNode),m=[];this._clonedProjectPolygonLayerObject.globalIdField&&m.push(this._clonedProjectPolygonLayerObject.globalIdField);this._clonedProjectPolygonLayerObject.objectIdField&&m.push(this._clonedProjectPolygonLayerObject.objectIdField);b&&g.forEach(b,f.hitch(this,
function(b){var e=d.get(b,"data-fieldname");-1===m.indexOf(e)&&(e=this._getAttrInspectorRowInfo(b))&&(0>a.indexOf(e[1])?e[0].isValid&&!e[0].isValid()?(a.push(e[1]),c||(c=e[0])):1<b.parentNode.childNodes[1].childNodes.length&&(b=b.parentNode.childNodes[1].childNodes[1],b=n.getEnclosingWidget(b),b.isValid&&!b.isValid()&&(a.push(e[1]),c||(c=b))):c||(c=e[0]))}));c&&(u.contains(this.expandCollapseNode,"esriCTCollapsedParceLayer")||this._onExpandCollapseClicked(),c.focus());return a},validateParcelDetails:function(a){var c=
{};if(this._attributeInspector){var b=this._validateAttributes();if(b&&0<b.length)return c.status=!1,c.message="",c}if(this.config.polygonLayer.statedArea&&this.config.polygonLayer.statedArea.hasOwnProperty("name")&&(!this.config.polygonLayer.statedArea.nullable&&(null===a||""===a)||null!==a&&""!==a&&-1<this.numberFieldTypes.indexOf(this.config.polygonLayer.statedArea.type)&&!this.validateNumericField(a,this.config.polygonLayer.statedArea.type)))return c.status=!1,c.message=this.nls.planInfo.enterValidStatedAreaNameMessage,
c;c.status=!0;return c},deleteParcel:function(){this.loading.show();this._rollbackSavedPolygon().then(f.hitch(this,function(){this._rollbackSavedPolyLines(this._savedPolyLines).then(f.hitch(this,function(){this.loading.hide();this._showParcelSavedAndDeleteMsg(this.nls.planInfo.parcelDeletedSuccessMessage);this._savedPolygonObjectId=null;this.emit("displayMainPageAfterSave",!1)}),f.hitch(this,function(){this.loading.hide();this._savedPolygonObjectId=null;this._showParcelSavedAndDeleteMsg(this.nls.planInfo.parcelDeleteErrorMessage);
this.emit("displayMainPageAfterSave",!1)}))}),f.hitch(this,function(){this.loading.hide();this._savedPolygonObjectId=null;this._showParcelSavedAndDeleteMsg(this.nls.planInfo.parcelDeleteErrorMessage);this.emit("displayMainPageAfterSave",!1)}))},setPlanInfoCancelBtnAsLastNode:function(){w.initLastFocusNode(this.widgetDomNode,this.planInfoCancelButton)},_showParcelSavedAndDeleteMsg:function(a){this.emit("showParcelSavedAndDeleteMsg",a)},mergeFirstToLast:function(){for(var a={},c=arguments.length-1,
b;0<=c;c--)for(b in arguments[c])arguments[c].hasOwnProperty(b)&&(a[b]=arguments[c][b]);return a},_getFieldInfosFromLayer:function(a){var c=[];a&&a.layerObject&&g.forEach(a.layerObject.fields,function(a){var b=w.getDefaultPortalFieldInfo(a),b=this.mergeFirstToLast(b,a);b.format&&b.format.dateFormat&&b.format.dateFormat.toLowerCase()&&0<=b.format.dateFormat.toLowerCase().indexOf("time")&&(b.format.time=!0);b.visible=!0;c.push(b)},this);return c},_createFieldsDetailsObject:function(a){var c={};g.forEach(a,
f.hitch(this,function(a){c[a.name]=a.type}));return c},getFieldInfoByFieldName:function(a,c){var b={};g.some(a,function(a){if(a.name===c)return f.mixin(b,a),!0});return b},_getFieldInfosForPolygonLayer:function(){if(this.fieldInfosForPolygonLayer)return this.fieldInfosForPolygonLayer;var a,c,b=[],d=[this.config.polygonLayer.rotation.name,this.config.polygonLayer.scale.name,this.config.polygonLayer.miscloseRatio.name,this.config.polygonLayer.miscloseDistance.name,this.config.polygonLayer.statedArea.name],
k=this._layerInfosObj.getLayerInfoById(this.config.polygonLayer.id),e=this._createFieldsDetailsObject(k.layerObject.fields);c=this._getFieldInfosFromLayer(k);if(this.config.hasOwnProperty("useFieldInfosFromWebmap")&&this.config.useFieldInfosFromWebmap&&k.controlPopupInfo&&k.controlPopupInfo.enablePopup&&k.controlPopupInfo.infoTemplate)c=f.clone(k.controlPopupInfo.infoTemplate.info.fieldInfos);else if(this.config.polygonLayer.hasOwnProperty("additionalFieldsInfo")&&0<this.config.polygonLayer.additionalFieldsInfo.length){var n=
[];g.forEach(this.config.polygonLayer.additionalFieldsInfo,function(a){var b=this.getFieldInfoByFieldName(c,a.fieldName),b=f.mixin(b,a);!b.nullable&&b.editable&&(b.visible=!0,b.isEditable=!0);n.push(b)},this);c=n}else this.config.polygonLayer.documentType.hasOwnProperty("name")&&b.push(this.config.polygonLayer.documentType.name),this.config.polygonLayer.parcelName.hasOwnProperty("name")&&b.push(this.config.polygonLayer.parcelName.name),this.config.polygonLayer.planName.hasOwnProperty("name")&&b.push(this.config.polygonLayer.planName.name);
a=[];g.forEach(c,f.hitch(this,function(c){b&&0<b.length&&0>b.indexOf(c.fieldName)&&(c.visible=!1);-1<d.indexOf(c.fieldName)&&(c.visible=!1);c.visible&&e[c.fieldName]&&"esriFieldTypeRaster"!==e[c.fieldName]&&"esriFieldTypeBlob"!==e[c.fieldName]&&"esriFieldTypeXML"!==e[c.fieldName]&&(c.format&&c.format.dateFormat&&c.format.dateFormat.toLowerCase()&&0<=c.format.dateFormat.toLowerCase().indexOf("time")&&(c.format.time=!0),a.push(c))}));return this.fieldInfosForPolygonLayer=a},_clearAttributeInspectorData:function(){this._attributeInspector&&
(this._attributeInspector.layerInfos&&g.forEach(this._attributeInspector.layerInfos,function(a){a=a.featureLayer;a.clearSelection();a.refresh()}),this._attributeInspector.destroy())},_add508SupportToATI:function(){var a;this._attributeInspector&&this._attributeInspector.domNode&&(a=k("td.atiLabel",this._attributeInspector.domNode))&&g.forEach(a,f.hitch(this,function(c){var a=this._getAttrInspectorRowInfo(c);a&&(a[0].set("aria-label",a[1]),1<c.parentNode.childNodes[1].childNodes.length&&(c=c.parentNode.childNodes[1].childNodes[1],
c=n.getEnclosingWidget(c),c.set("aria-label",a[1])))}))},_getAttrInspectorRowInfo:function(a){try{if(a&&a.parentNode){var c=a.parentNode.childNodes[1].childNodes[0];return[n.getEnclosingWidget(c),a.childNodes[0].data,c]}return null}catch(v){return console.log(v),null}},_getCurrentFieldDijit:function(a){var c;g.some(this._attributeInspector._currentLInfo.fieldInfos,f.hitch(this,function(b){if(b.name===a||b.field&&b.field.name===a||b.fieldName===a)return c=b.dijit,!0}));return c},_addGraphicToLocalLayer:function(a){var c,
b,g,k,e,n;(n=this._getFieldInfosForPolygonLayer())&&0!=n.length&&(this._clearAttributeInspectorData(),this._removeClonedProjectPolygonLayer(),b=this.map.getLayer(this.config.polygonLayer.id),this._clonedProjectPolygonLayerObject=this._cloneProjectPolygonLayer(b,n),g=this.own(t(this._clonedProjectPolygonLayerObject,"load",f.hitch(this,function(){g&&g[0]&&g[0].remove();c=this._layerInfosObj.getLayerInfoById(this._clonedProjectPolygonLayerObject.originalLayerId);c.featureLayer=this._clonedProjectPolygonLayerObject;
this._createAttributeInspector(n);k=new C(null,null,a?a:{},null);k.preEditAttrs=JSON.parse(JSON.stringify(k.attributes));this._clonedProjectPolygonLayerObject.applyEdits([k],null,null,f.hitch(this,function(c){e=new A;e.objectIds=[c[0].objectId];this._clonedProjectPolygonLayerObject.selectFeatures(e,G.SELECTION_NEW,f.hitch(this,function(){var c=this._attributeInspector.attributeTable.childNodes[0];d.set(c,"cellspacing","5");d.set(c,"cellpadding","5");this._currentFeatureDetails=k;this._add508SupportToATI();
this._attributeInspector.attachmentEditor&&p.set(this._attributeInspector.attachmentEditor,"display","none");this._attributeInspector.editorTrackingInfoDiv&&p.set(this._attributeInspector.editorTrackingInfoDiv,"display","none");if(c=this._clonedProjectPolygonLayerObject.objectIdField){var a=this._getCurrentFieldDijit(c);a&&k.preEditAttrs[c]&&a.set("value",k.preEditAttrs[c])}}),f.hitch(this,function(){}))}),f.hitch(this,function(){}))}),f.hitch(this,function(){}))))},_removeClonedProjectPolygonLayer:function(){this._clonedProjectPolygonLayerObject&&
null!==this._clonedProjectPolygonLayerObject&&(this._clonedProjectPolygonLayerObject.clearSelection(),this._clonedProjectPolygonLayerObject.clear(),this.map.removeLayer(this._clonedProjectPolygonLayerObject),this._clonedProjectPolygonLayerObject=null)},_filterFields:function(a,c){var b=[];g.forEach(c,f.hitch(this,function(c){c.visible&&g.forEach(a.fields,f.hitch(this,function(a){a.hasOwnProperty("name")&&c.hasOwnProperty("fieldName")&&a.name===c.fieldName&&b.push(a)}))}));a.fields=b},_cloneProjectPolygonLayer:function(a,
c){var b;b=w.getFeatureLayerDefinition(a);this._filterFields(b,c);b.id="clonedPolygonLayer"+this.id;b.name=a.name+this.id;c={layerDefinition:b};b=a.fields.map(function(c){return c.name});c=new G(c,{outFields:b});c.visible=!0;c.renderer=a.renderer;c.originalLayerId=a.id;c._wabProperties={isTemporaryLayer:!0};this.map.addLayer(c);return c},_processLayerFields:function(a){g.forEach(a,function(c){void 0!==c.domain&&null!==c.domain&&void 0!==c.domain.type&&null!==c.domain.type&&"range"===c.domain.type&&
!1===c.domain.hasOwnProperty("range")&&(c.domain.range=[c.domain.minValue,c.domain.maxValue])});return a},_createAttributeInspector:function(a){q.empty(this.attributeInspectorContainer);this._attributeInspector=new (l([x],{constructor:function(){this._aiConnects=[];this._selection=[];this._toolTips=[]}}))({layerInfos:[{featureLayer:this._clonedProjectPolygonLayerObject,fieldInfos:a}]},q.create("div",{"class":"esriCTAttributeInspectorWidgetContainer"}));this.own(t(this._attributeInspector,"attribute-change",
f.hitch(this,function(c){this._currentFeatureDetails&&(this._currentFeatureDetails.attributes[c.fieldName]=c.fieldValue)})));this._attributeInspector.startup();this.attributeInspectorContainer.appendChild(this._attributeInspector.domNode)}})})},"esri/dijit/AttributeInspector":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/sniff dojo/_base/kernel dojo/has dojo/dom-style dojo/dom-construct ../kernel ../lang ../domUtils ../layers/InheritedDomain ../layers/FeatureLayer dojo/i18n!../nls/jsapi dojo/fx dojox/gfx dijit/_Widget dijit/_Templated dijit/Editor dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/TextColor ./_EventedWidget ./editing/AttachmentEditor ./editing/Util ../tasks/query dijit/form/DateTextBox dijit/form/TextBox dijit/form/NumberTextBox dijit/form/FilteringSelect dijit/form/NumberSpinner dijit/form/Button dijit/form/SimpleTextarea dijit/form/ValidationTextBox dijit/form/TimeTextBox dijit/Tooltip dojo/data/ItemFileReadStore dojox/date/islamic dojox/date/islamic/Date dojox/date/islamic/locale dojo/text!./templates/AttributeInspector.html".split(" "),
function(l,a,b,h,f,g,m,d,q,u,p,k,n,y,r,K,t,z,C,A,E,x,G,F,H,w,B,D,J,I,c,v,M,N,e,O,P,Q,S,T,R){var L=l([G,z,C],{declaredClass:"esri.dijit.AttributeInspector",widgetsInTemplate:!0,templateString:R,onUpdate:function(){},onDelete:function(){},onAttributeChange:function(){},onNext:function(){},onReset:function(){},onCancel:function(){},_navMessage:"( ${idx} ${of} ${numFeatures} )",_currentAttributeFieldName:null,_aiConnects:[],_selection:[],_toolTips:[],_numFeatures:0,_featureIdx:0,_currentLInfo:null,_currentFeature:null,
_rollbackInfo:null,_eventMap:{update:!0,"delete":["feature"],"attribute-change":["feature","fieldName","fieldValue"],next:["feature"],reset:!0,cancel:!0},_defaultRichTextPlugins:"bold italic underline foreColor hiliteColor | justifyLeft justifyCenter justifyRight justifyFull | insertOrderedList insertUnorderedList indent outdent | createLink".split(" "),css:{label:"atiLabel",field:"atiField",textArea:"atiTextAreaField",richText:"atiRichTextField",attachmentEditor:"atiAttachmentEditor",red:"atiRequiredField"},
constructor:function(c,e){a.mixin(this,r.widgets.attributeInspector);c=c||{};c.featureLayer||c.layerInfos||console.error("esri.AttributeInspector: please provide correct parameter in the constructor");this._datePackage=this._getDatePackage(c);this._layerInfos=c.layerInfos||[{featureLayer:c.featureLayer,options:c.options||[]}];this._layerInfos=b.filter(this._layerInfos,function(c){return!c.disableAttributeUpdate});this._hideNavButtons=c.hideNavButtons||!1},postCreate:function(){if(b.every(this._layerInfos,
function(c){return c.featureLayer.loaded}))this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature();else{var c=this._layerInfos.length;b.forEach(this._layerInfos,function(a){a=a.featureLayer;if(a.loaded)c--;else var b=h.connect(a,"onLoad",this,function(a){h.disconnect(b);b=null;c--;c||(this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature())})},this)}},destroy:function(){this._destroyAttributeTable();b.forEach(this._aiConnects,h.disconnect);delete this._aiConnects;
this._attachmentEditor&&(this._attachmentEditor.destroy(),delete this._attachmentEditor);delete this._layerInfos;this._selection=this._currentFeature=this._currentLInfo=this._attributes=this._layerInfos=null;this.inherited(arguments)},refresh:function(){this._updateSelection()},first:function(){this.onFirstFeature()},last:function(){this.onLastFeature()},next:function(){this.onNextFeature()},previous:function(){this.onPreviousFeature()},showFeature:function(c,a){a&&(this._createOnlyFirstTime=!0);
this._updateSelection([c],a);this._updateUI()},onLayerSelectionChange:function(c,a,b){this._createOnlyFirstTime=!1;this._featureIdx=b===y.SELECTION_NEW?0:this._featureIdx;this._updateSelection();this._updateUI()},onLayerSelectionClear:function(){!this._selection||0>=this._selection.length||(this._featureIdx=this._numFeatures=0,this._selection=[],this._currentLInfo=this._currentFeature=null,this._updateUI())},onLayerUpdateEnd:function(c,a,b,e){},onLayerError:function(c,a,b,e){},onLayerEditsError:function(c,
a,b,e){},onLayerEditsComplete:function(c,e,d,g){g=g||[];if(g.length){var k=this._selection,f=c.featureLayer.objectIdField;b.forEach(g,a.hitch(this,function(c){b.some(k,a.hitch(this,function(a,b){if(a.attributes[f]!==c.objectId)return!1;this._selection.splice(b,1);return!0}))}))}e=e||[];e.length&&(this._selection=H.findFeatures(e,c.featureLayer),this._featureIdx=0);g=this._numFeatures=(this._selection=H.sortFeaturesById(this._layerInfos,this._selection))?this._selection.length:0;if(e.length){if(e=
g?this._selection[this._featureIdx]:null)g=e.getLayer().getEditCapabilities(),g.canCreate&&!g.canUpdate||this._showFeature(e);this._updateUI()}d=d||[];if(d.length){var n=this._rollbackInfo;b.forEach(d,function(a){var e=H.findFeatures(d,c.featureLayer)[0];if(!a.success&&e.attributes[c.featureLayer.objectIdField]===a.objectId&&n){var g=n.field;a=n.graphic.attributes[g.name];var k=b.filter(this._currentLInfo.fieldInfos,function(c){return c.fieldName===g.name},this)[0].dijit;e.attributes[g.name]=a;"esriFieldTypeDate"===
g.type&&(a=new Date(a));this._setValue(k,a)}},this)}this._rollbackInfo=null},onFieldValueChange:function(c,a){var e=c.field,d=c.dijit,g=this._currentFeature,k=this._currentLInfo,f=e.name;c=this._isFieldRequired(e,c);if(""===d.displayedValue||"dijit.form.ValidationTextBox"!==d.declaredClass||d.isValid())if(""!==d.displayedValue&&d.displayedValue!==a&&d.isValid&&!d.isValid())this._setValue(d,g.attributes[e.name]);else{var n=!("esriFieldTypeInteger"!==e.type&&"esriFieldTypeSmallInteger"!==e.type&&"esriFieldTypeSingle"!==
e.type&&"esriFieldTypeDouble"!==e.type);if(c&&(null===a||""===a||"undefined"===typeof a||n&&isNaN(a))){f=g.attributes[e.name];if("esriFieldTypeDate"===e.type&&(f=new Date(f),d instanceof Array)){this._setValue(d[0],f);this._setValue(d[1],f);return}this._setValue(d,f)}else{if(n){if(isNaN(a)||""===a)a=null;n&&null!==a&&(a=Number(a))}"esriFieldTypeDate"===e.type&&(d instanceof Array?(a=d[0].getValue(),d=d[1].getValue(),a=a&&d?new Date(a.getFullYear(),a.getMonth(),a.getDate(),d.getHours(),d.getMinutes(),
d.getSeconds(),d.getMilliseconds()):a||d||null):(a=d.getValue(),e.domain&&(a=Number(a))),a=a&&a.getTime?a.getTime():a&&a.toGregorian?a.toGregorian().getTime():a);if(this._currentFeature.attributes[e.name]!==a){if(f===k.typeIdField){var v=this._findFirst(k.types,"id",a);b.forEach(k.fieldInfos,function(a){(e=a.field)&&e.name!==k.typeIdField&&(a=a.dijit,this._setFieldDomain(a,v,e)&&a&&(this._setValue(a,g.attributes[e.name]+""),!1===a.isValid()&&this._setValue(a,null)))},this)}this.onAttributeChange(g,
f,a)}}}else this._setValue(d,g.attributes[e.name])},onDeleteBtn:function(a){this._deleteFeature()},onNextFeature:function(a){this._onNextFeature(1)},onPreviousFeature:function(a){this._onNextFeature(-1)},onFirstFeature:function(a){this._onNextFeature(-1*this._featureIdx)},onLastFeature:function(a){this._onNextFeature(this._numFeatures-1-this._featureIdx)},_initLayerInfos:function(){var a=this._layerInfos;this._editorTrackingInfos={};b.forEach(a,this._initLayerInfo,this)},_initLayerInfo:function(c){var e=
c.featureLayer,d,g;this._userIds={};g=e.id;e.credential&&(this._userIds[g]=e.credential.userId);c.userId&&(this._userIds[g]=c.userId);this._connect(e,"onSelectionComplete",a.hitch(this,"onLayerSelectionChange",c));this._connect(e,"onSelectionClear",a.hitch(this,"onLayerSelectionClear",c));this._connect(e,"onEditsComplete",a.hitch(this,"onLayerEditsComplete",c));this._connect(e,"error",a.hitch(this,"onLayerError",c));this._connect(e,"onUpdateEnd",a.hitch(this,"onLayerUpdateEnd",c));c.showAttachments=
e.hasAttachments?p.isDefined(c.showAttachments)?c.showAttachments:!0:!1;c.hideFields=c.hideFields||[];c.htmlFields=c.htmlFields||[];c.isEditable=e.isEditable()?p.isDefined(c.isEditable)?c.isEditable:!0:!1;c.typeIdField=e.typeIdField;c.layerId=e.id;c.types=e.types;e.globalIdField&&((d=this._findFirst(c.fieldInfos,"fieldName",e.globalIdField))||c.showGlobalID||c.hideFields.push(e.globalIdField));(g=this._findFirst(c.fieldInfos,"fieldName",e.objectIdField))||c.showObjectID||c.hideFields.push(e.objectIdField);
var k=this._getFields(c.featureLayer);if(k){var f=c.fieldInfos||[],f=b.map(f,function(c){return a.mixin({},c)});f.length?c.fieldInfos=b.filter(b.map(f,a.hitch(this,function(b){var e=b.stringFieldOption||(this._isInFields(b.fieldName,c.htmlFields)?L.STRING_FIELD_OPTION_RICHTEXT:L.STRING_FIELD_OPTION_TEXTBOX);return a.mixin(b,{field:this._findFirst(k,"name",b.fieldName),stringFieldOption:e})})),"return item.field;"):(k=b.filter(k,a.hitch(this,function(a){return!this._isInFields(a.name,c.hideFields)})),
c.fieldInfos=b.map(k,a.hitch(this,function(a){var b=this._isInFields(a.name,c.htmlFields)?L.STRING_FIELD_OPTION_RICHTEXT:L.STRING_FIELD_OPTION_TEXTBOX;return{fieldName:a.name,field:a,stringFieldOption:b}})));c.showGlobalID&&!d&&f.push(this._findFirst(k,"name",e.globalIdField));c.showObjectID&&!g&&f.push(this._findFirst(k,"name",e.objectIdField));d=[];e.editFieldsInfo&&(e.editFieldsInfo.creatorField&&d.push(e.editFieldsInfo.creatorField),e.editFieldsInfo.creationDateField&&d.push(e.editFieldsInfo.creationDateField),
e.editFieldsInfo.editorField&&d.push(e.editFieldsInfo.editorField),e.editFieldsInfo.editDateField&&d.push(e.editFieldsInfo.editDateField));this._editorTrackingInfos[e.id]=d}},_createAttachmentEditor:function(){this._attachmentEditor=null;var c=b.filter(this._layerInfos,function(c){return c.showAttachments});c&&c.length&&(this._attachmentEditor=new F({"class":this.css.attachmentEditor},this.attachmentEditor),this._attachmentEditor.startup())},_setCurrentLInfo:function(c){var a=this._currentLInfo?this._currentLInfo.featureLayer:
null,b=c.featureLayer;if(a&&a.id===b.id&&!a.ownershipBasedAccessControlForFeatures&&(a=b.getEditCapabilities(),!a.canCreate||a.canUpdate))return;this._currentLInfo=c;this._createTable()},_updateSelection:function(c,a){this._selection=c||[];b.forEach(this._layerInfos,this._getSelection,this);this._selection=H.sortFeaturesById(this._layerInfos,this._selection);this._numFeatures=this._selection.length;this._showFeature(this._numFeatures?this._selection[this._featureIdx]:null,a)},_getSelection:function(c){c=
c.featureLayer.getSelectedFeatures();this._selection=this._selection.concat(c)},_updateUI:function(){var c=this._numFeatures,a=this._currentLInfo;this.layerName.innerHTML=a&&0!==c?a.featureLayer?a.featureLayer.name:"":this.NLS_noFeaturesSelected;d.set(this.attributeTable,"display",c?"":"none");d.set(this.editButtons,"display",c?"":"none");d.set(this.navButtons,"display",!this._hideNavButtons&&1<c?"":"none");this.navMessage.innerHTML=p.substitute({idx:this._featureIdx+1,of:this.NLS_of,numFeatures:this._numFeatures},
this._navMessage);this._attachmentEditor&&d.set(this._attachmentEditor.domNode,"display",a&&a.showAttachments&&c?"":"none");d.set(this.deleteBtn.domNode,"display",a&&!1===a.showDeleteButton||!this._canDelete?"none":"");this.domNode.parentNode&&0<this.domNode.parentNode.scrollTop&&(this.domNode.parentNode.scrollTop=0)},_onNextFeature:function(c){this._featureIdx+=c;0>this._featureIdx?this._featureIdx=this._numFeatures-1:this._featureIdx>=this._numFeatures&&(this._featureIdx=0);c=this._selection.length?
this._selection[this._featureIdx]:null;this._showFeature(c);this._updateUI();this.onNext(c)},_deleteFeature:function(){this.onDelete(this._currentFeature)},_showFeature:function(c,e){if(c){this._currentFeature=c;e=e?e:c.getLayer();var d=e.getEditCapabilities({feature:c,userId:this._userIds[e.id]});this._canUpdate=d.canUpdate;this._canDelete=d.canDelete;if(d=this._getLInfoFromFeatureLayer(e)){this._setCurrentLInfo(d);var g=c.attributes,f=this._findFirst(d.types,"id",g[d.typeIdField]),n=null;b.forEach(d.fieldInfos,
function(c){n=c.field;var e=[];c.dijit&&1<c.dijit.length?b.forEach(c.dijit,function(c){e.push(c)}):e.push(c.dijit);b.forEach(e,a.hitch(this,function(c){if(c){var a=this._setFieldDomain(c,f,n),b=g[n.name],b=b&&a&&a.codedValues&&a.codedValues.length?a.codedValues[b]?a.codedValues[b].name:b:b;p.isDefined(b)||(b="");"dijit.form.DateTextBox"===c.declaredClass||"dijit.form.TimeTextBox"===c.declaredClass?b=""===b?null:new Date(b):"dijit.form.FilteringSelect"===c.declaredClass&&(c._lastValueReported=null,
b=g[n.name]+"");try{this._setValue(c,b),"dijit.form.FilteringSelect"===c.declaredClass&&!1===c.isValid()&&this._setValue(c,null)}catch(U){c.set("displayedValue",this.NLS_errorInvalid,!1)}}}))},this);this._attachmentEditor&&d.showAttachments&&this._attachmentEditor.showAttachments(this._currentFeature,e);(c=e.getEditSummary(c))?(this.editorTrackingInfoDiv.innerHTML=c,k.show(this.editorTrackingInfoDiv)):k.hide(this.editorTrackingInfoDiv)}}},_setFieldDomain:function(c,a,e){if(!c)return null;var d=e.domain;
a&&a.domains&&a.domains[e.name]&&!1===a.domains[e.name]instanceof n&&(d=a.domains[e.name]);if(!d)return null;d.codedValues&&0<d.codedValues.length?(c.set("store",this._toStore(b.map(d.codedValues,function(c){return{id:c.code+="",name:c.name}}))),this._setValue(c,d.codedValues[0].code)):(c.constraints={min:p.isDefined(d.minValue)?d.minValue:Number.MIN_VALUE,max:p.isDefined(d.maxValue)?d.maxValue:Number.MAX_VALUE},this._setValue(c,c.constraints.min));return d},_setValue:function(c,a){c.set&&(c._onChangeActive=
!1,c.set("value",a,!0),c._onChangeActive=!0)},_getFields:function(c){var e=c._getOutFields();if(!e)return null;c=c.fields;return"*"==e?c:b.filter(b.map(e,a.hitch(this,"_findFirst",c,"name")),p.isDefined)},_isInFields:function(c,a){return c&&(a||a.length)?b.some(a,function(a){return a.toLowerCase()===c.toLowerCase()}):!1},_isFieldNullable:function(c,a){return!(!1===c.nullable||a.field&&!1===a.field.nullable)},_isFieldRequired:function(c,a){return!1!==c.editable&&!1!==a.isEditable&&!this._isFieldNullable(c,
a)},_findFirst:function(c,a,e){return(c=b.filter(c,function(c){return c.hasOwnProperty(a)&&c[a]===e}))&&c.length?c[0]:null},_getLInfoFromFeatureLayer:function(c){return this._findFirst(this._layerInfos,"layerId",c?c.id:null)},_createTable:function(){this._destroyAttributeTable();this.attributeTable.innerHTML="";this._attributes=q.create("table",{cellspacing:"0",cellpadding:"0"},this.attributeTable);var c=q.create("tbody",null,this._attributes),e=this._currentLInfo,d=this._findFirst(e.types,"id",this._currentFeature.attributes[e.typeIdField]);
b.forEach(e.fieldInfos,a.hitch(this,"_createField",d,c),this);this._createOnlyFirstTime=!1},_createField:function(c,b,e){var d=this._currentLInfo,g=e.field;if(!this._isInFields(g.name,d.hideFields)&&!this._isInFields(g.name,this._editorTrackingInfos[d.featureLayer.id])){var k=!1,f,n,v;b=q.create("tr",null,b);f=q.create("td",{innerHTML:e.label||g.alias||g.name,"class":this.css.label,"data-fieldname":g.name},b);this._isFieldRequired(g,e)&&q.create("span",{"class":this.css.red,innerHTML:" *"},f);b=q.create("td",
null,b);if(e.customField)q.place(e.customField.domNode||e.customField,q.create("div",null,b),"first"),n=e.customField;else if(!1===d.isEditable||!1===g.editable||!1===e.isEditable||"esriFieldTypeOID"===g.type||"esriFieldTypeGlobalID"===g.type||!this._canUpdate&&!this._createOnlyFirstTime)k=!0;d=d.typeIdField&&g.name.toLowerCase()==d.typeIdField.toLowerCase();f=!!this._getDomainForField(g,c);!n&&d?n=this._createTypeField(g,e,b):!n&&f&&(n=this._createDomainField(g,e,c,b));if(!n)switch(g.type){case "esriFieldTypeString":n=
this._createStringField(g,e,b);break;case "esriFieldTypeDate":n=this._createDateField(g,e,b);e.format&&e.format.time&&(v=this._createTimeField(g,e,b));break;case "esriFieldTypeInteger":case "esriFieldTypeSmallInteger":n=this._createIntField(g,e,b);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":n=this._createFltField(g,e,b);break;default:n=this._createStringField(g,e,b)}e.tooltip&&e.tooltip.length&&this._toolTips.push(new O({connectId:[n.id],label:e.tooltip}));n.onChange=a.hitch(this,
"onFieldValueChange",e);n.set("disabled",k);v?(e.dijit=[n,v],v.onChange=a.hitch(this,"onFieldValueChange",e),v.set("disabled",k)):e.dijit=n}},_createTypeField:function(c,a,e){e=q.create("div",null,e);var d=c.domain;return d&&"range"===d.type&&d.minValue===d.maxValue?new N({"class":this.css.field,trim:!0,maxLength:c.length,name:c.alias||c.name,required:this._isFieldRequired(c,a)},e):new I({"class":this.css.field,name:c.alias||c.name,required:this._isFieldRequired(c,a),store:this._toStore(b.map(this._currentLInfo.types,
function(c){return{id:c.id,name:c.name}})),searchAttr:"name"},e)},_getDomainForField:function(c,a){var b=c.domain;(c=c.name)&&a&&a.domains&&a.domains[c]&&!1===a.domains[c]instanceof n&&(b=a.domains[c]);return b||null},_createDomainField:function(a,b,e,d){e=this._getDomainForField(a,e);d=q.create("div",null,d);return e.codedValues?new I({"class":this.css.field,name:a.alias||a.name,searchAttr:"name",required:this._isFieldRequired(a,b)},d):new c({"class":this.css.field},d)},_createStringField:function(c,
a,b){b=q.create("div",null,b);var e={trim:!0,maxLength:c.length,required:this._isFieldRequired(c,a)};if(a.stringFieldOption===L.STRING_FIELD_OPTION_TEXTAREA)return e["class"]=this.css.field+" "+this.css.textArea,new M(e,b);if(a.stringFieldOption===L.STRING_FIELD_OPTION_RICHTEXT)return e["class"]=this.css.field+" "+this.css.richText,e.height="100%",e.width="100%",e.plugins=a.richTextPlugins||this._defaultRichTextPlugins,b=new A(e,b),b.startup(),b;var d=this;e.validator=function(b,e){this._maskValidSubsetError=
!1;this._hasBeenBlurred=!0;return d._isFieldNullable(c,a)||!(""===b||null===b)};return new N(e,b)},_createTimeField:function(c,a,b){b=q.create("div",null,b);c={"class":this.css.field,trim:!0,required:this._isFieldRequired(c,a),constraints:{formatLength:"medium"}};this._datePackage&&(c.datePackage=this._datePackage);return new e(c,b)},_createDateField:function(c,a,b){b=q.create("div",null,b);c={"class":this.css.field,trim:!0,required:this._isFieldRequired(c,a)};this._datePackage&&(c.datePackage=this._datePackage);
return new B(c,b)},_createIntField:function(c,a,b){b=q.create("div",null,b);return new J({"class":this.css.field,constraints:"esriFieldTypeSmallInteger"===c.type?{min:-32768,max:32767,places:0}:{places:0},trim:!0,invalidMessage:this.NLS_validationInt,required:this._isFieldRequired(c,a)},b)},_createFltField:function(c,a,b){b=q.create("div",null,b);return new J({"class":this.css.field,constraints:{max:Infinity,min:-Infinity,places:"0,20"},trim:!0,invalidMessage:this.NLS_validationFlt,required:this._isFieldRequired(c,
a)},b)},_toStore:function(c){return new P({data:{identifier:"id",label:"name",items:c}})},_connect:function(c,a,b){this._aiConnects.push(h.connect(c,a,b))},_getDatePackage:function(c){return null===c.datePackage?null:c.datePackage?c.datePackage:"ar"===g.locale?"dojox.date.islamic":null},_destroyAttributeTable:function(){b.forEach(this._layerInfos,function(c){b.forEach(c.fieldInfos,function(c){var e=c.dijit;if(e){e._onChangeHandle=null;if(c.customField)return;e instanceof Array?b.forEach(e,a.hitch(this,
function(c){c.destroyRecursive?c.destroyRecursive():c.destroy&&c.destroy();c._onChangeHandle=null})):e.destroyRecursive?e.destroyRecursive():e.destroy&&e.destroy()}c.dijit=null},this)},this);b.forEach(this._toolTips,function(c){c.destroy()});this._toolTips=[];this._attributes&&q.destroy(this._attributes)}});a.mixin(L,{STRING_FIELD_OPTION_RICHTEXT:"richtext",STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_TEXTBOX:"textbox"});m("extend-esri")&&a.setObject("dijit.AttributeInspector",L,u);
return L})},"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),function(l,a,b,h,f,g,m,d,
q,u,p,k,n,y,r,K,t,z,C,A,E,x,G,F,H){function w(a){return new A({command:a.name})}function B(a){return new A({buttonClass:C,command:a.name})}b=b("dijit.Editor",F,{plugins:null,extraPlugins:null,constructor:function(){p.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",E]);this._plugins=[];this._editInterval=
1E3*this.editActionInterval;if(k("ie")||k("trident")||k("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new h;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);p.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=f.getLocalization("dijit._editor","commands",this.lang);
k("webkit")&&q.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new K({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));a.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);m.add(this.iframe.parentNode,"dijitEditorIFrameContainer");m.add(this.iframe,"dijitEditorIFrame");g.set(this.iframe,"allowTransparency",!0);this.toolbar.startup();
this.onNormalizedDisplayChanged()},destroy:function(){a.forEach(this._plugins,function(a){a&&a.destroy&&a.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(a,b){var d=p.isString(a)?{name:a}:p.isFunction(a)?{ctor:a}:a;if(!d.setEditor){var c={args:d,plugin:null,editor:this};d.name&&(A.registry[d.name]?c.plugin=A.registry[d.name](d):y.publish(H._scopeName+".Editor.getPlugin",c));if(!c.plugin)try{var g=d.ctor||p.getObject(d.name)||
l(d.name);g&&(c.plugin=new g(d))}catch(M){throw Error(this.id+": cannot find plugin ["+d.name+"]");}if(!c.plugin)throw Error(this.id+": cannot find plugin ["+d.name+"]");a=c.plugin}1<arguments.length?this._plugins[b]=a:this._plugins.push(a);a.setEditor(this);p.isFunction(a.setToolbar)&&a.setToolbar(this.toolbar)},resize:function(a){a&&z.prototype.resize.apply(this,arguments)},layout:function(){var a=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+d.getPadBorderExtents(this.iframe.parentNode).h+
d.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=a+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(a){var b,d=this.document.body,c=d.clientWidth,g=d.clientHeight,k=d.clientLeft,f=d.offsetWidth,e=d.offsetHeight,n=d.offsetLeft;/^rtl$/i.test(d.dir||"")?c<f&&a.x>c&&a.x<f&&(b=!0):a.x<k&&a.x>n&&(b=!0);b||g<e&&a.y>g&&a.y<e&&(b=!0);b||(delete this._cursorToStart,delete this._savedSelection,"BODY"==a.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(a){this.customUndo&&this.endEditing(!0);"BODY"!=a.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(a){this._inEditing||(this._inEditing=!0,this._beginEditing(a));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(a){if(!this.customUndo||
"undo"!=a&&"redo"!=a){this.customUndo&&(this.endEditing(),this._beginEditing());var b=this.inherited(arguments);this.customUndo&&this._endEditing();return b}return this[a]()},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(a){var b;try{if(b=this.document.execCommand(a,!1,null),k("webkit")&&!b)throw{};}catch(I){b=n.substitute,alert(b(this.commands.systemShortcut,
[this.commands[a],b(this.commands[k("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[a]])])),b=!1}return b},queryCommandEnabled:function(a){return!this.customUndo||"undo"!=a&&"redo"!=a?this.inherited(arguments):"undo"==a?1<this._steps.length:0<this._undoedSteps.length},_moveToBookmark:function(b){var d=b.mark,g=b.mark;b=b.isCollapsed;var c,f,n;g&&(9>k("ie")||9===k("ie")&&k("quirks")?p.isArray(g)?(d=[],a.forEach(g,function(c){d.push(G.getNode(c,this.editNode))},this),this.selection.moveToBookmark({mark:d,
isCollapsed:b})):g.startContainer&&g.endContainer&&(n=G.getSelection(this.window))&&n.removeAllRanges&&(n.removeAllRanges(),b=G.create(this.window),c=G.getNode(g.startContainer,this.editNode),f=G.getNode(g.endContainer,this.editNode),c&&f&&(b.setStart(c,g.startOffset),b.setEnd(f,g.endOffset),n.addRange(b))):(n=G.getSelection(this.window))&&n.removeAllRanges&&(n.removeAllRanges(),b=G.create(this.window),c=G.getNode(g.startContainer,this.editNode),f=G.getNode(g.endContainer,this.editNode),c&&f&&(b.setStart(c,
g.startOffset),b.setEnd(f,g.endOffset),n.addRange(b))))},_changeToStep:function(a,b){this.setValue(b.text);(a=b.bookmark)&&this._moveToBookmark(a)},undo:function(){var a=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._steps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(b,this._steps[this._steps.length-1]),this._undoedSteps.push(b),this.onDisplayChanged(),delete this._undoRedoActive,a=!0);delete this._undoRedoActive}return a},redo:function(){var a=
!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var b=this._undoedSteps.pop();b&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],b),this._steps.push(b),this.onDisplayChanged(),a=!0);delete this._undoRedoActive}return a},endEditing:function(a){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(a),this._inEditing=!1)},_getBookmark:function(){var b=this.selection.getBookmark(),d=[];if(b&&b.mark){var g=
b.mark;if(9>k("ie")||9===k("ie")&&k("quirks")){var c=G.getSelection(this.window);if(p.isArray(g))a.forEach(b.mark,function(c){d.push(G.getIndex(c,this.editNode).o)},this),b.mark=d;else if(c){var f;c.rangeCount&&(f=c.getRangeAt(0));b.mark=f?f.cloneRange():this.selection.getBookmark()}}try{b.mark&&b.mark.startContainer&&(d=G.getIndex(b.mark.startContainer,this.editNode).o,b.mark={startContainer:d,startOffset:b.mark.startOffset,endContainer:b.mark.endContainer===b.mark.startContainer?d:G.getIndex(b.mark.endContainer,
this.editNode).o,endOffset:b.mark.endOffset})}catch(M){b.mark=null}}return b},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:x.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var a=x.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:a,bookmark:this._getBookmark()})},onKeyDown:function(a){k("ie")||this.iframe||a.keyCode!=u.TAB||this.tabIndent||this._saveSelection();if(this.customUndo){var b=a.keyCode;if(a.ctrlKey&&
!a.shiftKey&&!a.altKey){if(90==b||122==b){a.stopPropagation();a.preventDefault();this.undo();return}if(89==b||121==b){a.stopPropagation();a.preventDefault();this.redo();return}}this.inherited(arguments);switch(b){case u.ENTER:case u.BACKSPACE:case u.DELETE:this.beginEditing();break;case 88:case 86:if(a.ctrlKey&&!a.altKey&&!a.metaKey){this.endEditing();88==a.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!a.ctrlKey&&!a.altKey&&!a.metaKey&&(a.keyCode<
u.F1||a.keyCode>u.F15)){this.beginEditing();break}case u.ALT:this.endEditing();break;case u.UP_ARROW:case u.DOWN_ARROW:case u.LEFT_ARROW:case u.RIGHT_ARROW:case u.HOME:case u.END:case u.PAGE_UP:case u.PAGE_DOWN:this.endEditing(!0);case u.CTRL:case u.SHIFT:case u.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(D){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(a){this.customUndo?this.isClosed?this.setValue(a):(this.beginEditing(),a||(a="\x26#160;"),this.setValue(a),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(b){this.setValueDeferred.then(p.hitch(this,function(){!this.disabled&&b||!this._buttonEnabledPlugins&&b?
a.forEach(this._plugins,function(a){a.set("disabled",!0)}):this.disabled&&!b&&a.forEach(this._plugins,function(a){a.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&(q.set(this.document.body,"color",q.get(this.iframe,"color")),q.set(this.document.body,"background-color",q.get(this.iframe,"background-color")))}catch(D){}}});p.mixin(A.registry,{undo:w,redo:w,cut:w,copy:w,paste:w,insertOrderedList:w,insertUnorderedList:w,
indent:w,outdent:w,justifyCenter:w,justifyFull:w,justifyLeft:w,justifyRight:w,"delete":w,selectAll:w,removeFormat:w,unlink:w,insertHorizontalRule:w,bold:B,italic:B,underline:B,strikethrough:B,subscript:B,superscript:B,"|":function(){return new A({setEditor:function(a){this.editor=a;this.button=new t({ownerDocument:a.ownerDocument})}})}});return b})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),
function(l,a,b,h,f,g,m,d){b("dijit-legacy-requires")&&f(0,function(){l(["dijit/ToolbarSeparator"])});return a("dijit.Toolbar",[g,d,m],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],
function(l,a,b,h){return l("dijit.ToolbarSeparator",[b,h],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',buildRendering:function(){this.inherited(arguments);a.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(l,a,b,h,f){a=a("dijit._editor._Plugin",h,{constructor:function(a){this.params=
a||{};b.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:f,disabled:!1,getLabel:function(a){return this.editor.commands[a]},_initButton:function(){if(this.command.length){var a=this.getLabel(this.command),f=this.editor,d=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(a=b.mixin({label:a,ownerDocument:f.ownerDocument,dir:f.dir,
lang:f.lang,showLabel:!1,iconClass:d,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete a.name,this.button=new this.buttonClass(a))}this.get("disabled")&&this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();this.inherited(arguments)},connect:function(a,b,d){this.own(l.connect(a,b,this,d))},updateState:function(){var a=this.editor,b=this.command,d,f;if(a&&a.isLoaded&&b.length){var h=this.get("disabled");if(this.button)try{var p=
a._implCommand(b);f=!h&&(this[p]?this[p](b):a.queryCommandEnabled(b));this.enabled!==f&&(this.enabled=f,this.button.set("disabled",!f));f&&"boolean"==typeof this.button.checked&&(d=a.queryCommandState(b),this.checked!==d&&(this.checked=d,this.button.set("checked",a.queryCommandState(b))))}catch(k){console.log(k)}}},setEditor:function(a){this.editor=a;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",b.hitch(this.editor,
"execCommand",this.command,this.commandArg))):this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",b.hitch(this,"updateState")))},setToolbar:function(a){this.button&&a.addChild(this.button)},set:function(a,b){if("object"===typeof a){for(var d in a)this.set(d,a[d]);return this}d=this._getAttrNames(a);if(this[d.s])var g=this[d.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(a,b);return g||this},get:function(a){var b=this._getAttrNames(a);
return this[b.g]?this[b.g]():this[a]},_setDisabledAttr:function(a){this._set("disabled",a);this.updateState()},_getAttrNames:function(a){var b=this._attrPairNames;if(b[a])return b[a];var d=a.charAt(0).toUpperCase()+a.substr(1);return b[a]={s:"_set"+d+"Attr",g:"_get"+d+"Attr"}},_set:function(a,b){this[a]=b}});a.registry={};return a})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),
function(l,a,b,h,f,g,m,d,q,u,p){return l("dijit._editor.plugins.EnterKeyHandling",q,{blockNodeForEnter:"BR",constructor:function(a){a&&("blockNodeForEnter"in a&&(a.blockNodeForEnter=a.blockNodeForEnter.toUpperCase()),h.mixin(this,a))},setEditor:function(a){if(this.editor!==a)if(this.editor=a,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,a.onLoadDeferred.then(h.hitch(this,function(d){this.own(f(a.document,"keydown",h.hitch(this,function(a){if(a.keyCode==b.ENTER){var d=h.mixin({},a);d.shiftKey=
!0;this.handleEnterKey(d)||(a.stopPropagation(),a.preventDefault())}})));9<=g("ie")&&10>=g("ie")&&this.own(f(a.document,"paste",h.hitch(this,function(a){setTimeout(h.hitch(this,function(){var a=this.editor.document.selection.createRange();a.move("character",-1);a.select();a.move("character",1);a.select()}),0)})));return d}));else if(this.blockNodeForEnter){var d=h.hitch(this,"handleEnterKey");a.addKeyHandler(13,0,0,d);a.addKeyHandler(13,0,1,d);this.own(this.editor.on("KeyPressed",h.hitch(this,"onKeyPressed")))}},
onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var a=this.editor.selection.getAncestorElement("LI");if(a){g("mozilla")&&"LI"==a.parentNode.parentNode.nodeName&&(a=a.parentNode.parentNode);var b=a.firstChild;!b||1!=b.nodeType||"UL"!=b.nodeName&&"OL"!=b.nodeName||(a.insertBefore(b.ownerDocument.createTextNode("\u00a0"),b),b=p.create(this.editor.window),b.setStart(a.firstChild,0),a=p.getSelection(this.editor.window,!0),a.removeAllRanges(),a.addRange(b))}else u.prototype.execCommand.call(this.editor,
"formatblock",this.blockNodeForEnter),(a=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?(a.innerHTML=this.bogusHtmlContent,9>=g("ie")&&(a=this.editor.document.selection.createRange(),a.move("character",-1),a.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",
blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(b){var f,k,r,m,h=this.editor.document,q,l,A;if(b.shiftKey){b=this.editor.selection.getParentElement();if(m=p.getAncestor(b,this.blockNodes)){if("LI"==m.tagName)return!0;b=p.getSelection(this.editor.window);f=b.getRangeAt(0);f.collapsed||(f.deleteContents(),b=p.getSelection(this.editor.window),f=b.getRangeAt(0));if(p.atBeginningOfContainer(m,f.startContainer,f.startOffset))q=h.createElement("br"),f=p.create(this.editor.window),m.insertBefore(q,
m.firstChild),f.setStartAfter(q),b.removeAllRanges(),b.addRange(f);else if(p.atEndOfContainer(m,f.startContainer,f.startOffset))f=p.create(this.editor.window),q=h.createElement("br"),m.appendChild(q),m.appendChild(h.createTextNode("\u00a0")),f.setStart(m.lastChild,0),b.removeAllRanges(),b.addRange(f);else return(l=f.startContainer)&&3==l.nodeType?(A=l.nodeValue,k=h.createTextNode(A.substring(0,f.startOffset)),r=h.createTextNode(A.substring(f.startOffset)),m=h.createElement("br"),""==r.nodeValue&&
g("webkit")&&(r=h.createTextNode("\u00a0")),a.place(k,l,"after"),a.place(m,k,"after"),a.place(r,m,"after"),a.destroy(l),f=p.create(this.editor.window),f.setStart(r,0),b.removeAllRanges(),b.addRange(f),!1):!0}else b=p.getSelection(this.editor.window),b.rangeCount?(f=b.getRangeAt(0))&&f.startContainer&&(f.collapsed||(f.deleteContents(),b=p.getSelection(this.editor.window),f=b.getRangeAt(0)),(l=f.startContainer)&&3==l.nodeType?(m=f.startOffset,l.length<m&&(r=this._adjustNodeAndOffset(l,m),l=r.node,m=
r.offset),A=l.nodeValue,k=h.createTextNode(A.substring(0,m)),r=h.createTextNode(A.substring(m)),m=h.createElement("br"),r.length||(r=h.createTextNode("\u00a0")),k.length?a.place(k,l,"after"):k=l,a.place(m,k,"after"),a.place(r,m,"after"),a.destroy(l)):(0<=f.startOffset&&(q=l.childNodes[f.startOffset]),m=h.createElement("br"),r=h.createTextNode("\u00a0"),q?(a.place(m,q,"before"),a.place(r,m,"after")):(l.appendChild(m),l.appendChild(r))),f=p.create(this.editor.window),f.setStart(r,0),f.setEnd(r,r.length),
b.removeAllRanges(),b.addRange(f),this.editor.selection.collapse(!0)):u.prototype.execCommand.call(this.editor,"inserthtml","\x3cbr\x3e");return!1}var E=!0;b=p.getSelection(this.editor.window);f=b.getRangeAt(0);f.collapsed||(f.deleteContents(),b=p.getSelection(this.editor.window),f=b.getRangeAt(0));q=p.getBlockAncestor(f.endContainer,null,this.editor.editNode);var x=q.blockNode;if(this._checkListLater=x&&("LI"==x.nodeName||"LI"==x.parentNode.nodeName))return g("mozilla")&&(this._pressedEnterInBlock=
x),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(x.innerHTML)&&(x.innerHTML="",g("webkit")&&(f=p.create(this.editor.window),f.setStart(x,0),b.removeAllRanges(),b.addRange(f)),this._checkListLater=!1),!0;if(!q.blockNode||q.blockNode===this.editor.editNode){try{u.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(G){}q={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),
blockContainer:this.editor.editNode};if(q.blockNode){if(q.blockNode!=this.editor.editNode&&!(q.blockNode.textContent||q.blockNode.innerHTML).replace(/^\s+|\s+$/g,"").length)return this.removeTrailingBr(q.blockNode),!1}else q.blockNode=this.editor.editNode;b=p.getSelection(this.editor.window);f=b.getRangeAt(0)}x=h.createElement(this.blockNodeForEnter);x.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(q.blockNode);r=f.endOffset;E=f.endContainer;E.length<r&&(r=this._adjustNodeAndOffset(E,r),E=
r.node,r=r.offset);if(p.atEndOfContainer(q.blockNode,E,r))q.blockNode===q.blockContainer?q.blockNode.appendChild(x):a.place(x,q.blockNode,"after"),E=!1,f=p.create(this.editor.window),f.setStart(x,0),b.removeAllRanges(),b.addRange(f),this.editor.height&&d.scrollIntoView(x);else if(p.atBeginningOfContainer(q.blockNode,f.startContainer,f.startOffset))a.place(x,q.blockNode,q.blockNode===q.blockContainer?"first":"before"),x.nextSibling&&this.editor.height&&(f=p.create(this.editor.window),f.setStart(x.nextSibling,
0),b.removeAllRanges(),b.addRange(f),d.scrollIntoView(x.nextSibling)),E=!1;else{q.blockNode===q.blockContainer?q.blockNode.appendChild(x):a.place(x,q.blockNode,"after");E=!1;q.blockNode.style&&x.style&&q.blockNode.style.cssText&&(x.style.cssText=q.blockNode.style.cssText);if((l=f.startContainer)&&3==l.nodeType){r=f.endOffset;l.length<r&&(r=this._adjustNodeAndOffset(l,r),l=r.node,r=r.offset);A=l.nodeValue;k=h.createTextNode(A.substring(0,r));r=h.createTextNode(A.substring(r,A.length));a.place(k,l,
"before");a.place(r,l,"after");a.destroy(l);for(f=k.parentNode;f!==q.blockNode;){A=h.createElement(f.tagName);f.style&&A.style&&f.style.cssText&&(A.style.cssText=f.style.cssText);"FONT"===f.tagName&&(f.color&&(A.color=f.color),f.face&&(A.face=f.face),f.size&&(A.size=f.size));for(;r;)l=r.nextSibling,A.appendChild(r),r=l;a.place(A,f,"after");k=f;r=A;f=f.parentNode}if(1==r.nodeType||3==r.nodeType&&r.nodeValue)x.innerHTML="";for(k=r;r;)l=r.nextSibling,x.appendChild(r),r=l}f=p.create(this.editor.window);
h=k;if("BR"!==this.blockNodeForEnter){for(;h;)m=h,h=l=h.firstChild;m&&m.parentNode?(x=m.parentNode,f.setStart(x,0),b.removeAllRanges(),b.addRange(f),this.editor.height&&d.scrollIntoView(x),g("mozilla")&&(this._pressedEnterInBlock=q.blockNode)):E=!0}else f.setStart(x,0),b.removeAllRanges(),b.addRange(f),this.editor.height&&d.scrollIntoView(x),g("mozilla")&&(this._pressedEnterInBlock=q.blockNode)}return E},_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3==a.nextSibling.nodeType;)b-=
a.length,a=a.nextSibling;return{node:a,offset:b}},removeTrailingBr:function(b){if(b=/P|DIV|LI/i.test(b.tagName)?b:this.editor.selection.getParentOfType(b,["P","DIV","LI"]))b.lastChild&&(1<b.childNodes.length&&3==b.lastChild.nodeType&&/^[\s\xAD]*$/.test(b.lastChild.nodeValue)||"BR"==b.lastChild.tagName)&&a.destroy(b.lastChild),b.childNodes.length||(b.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(l,a,b,h,f,g,m,d,q,u,p,k,n,y,r,K,t,z,C,A,E,x,G,F,H,w,B,D,J){var I=b("dijit._editor.RichText",[G,F],{constructor:function(a){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};a&&n.isString(a.value)&&(this.value=a.value);this.onLoadDeferred=new h},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[n.trim,n.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);t("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));t("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(t("ie")||t("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[n.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[n.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);C.publish(J._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var a=n.hitch(this,function(a,c){return function(){return!this.execCommand(a,c)}}),b={b:a("bold"),i:a("italic"),u:a("underline"),a:a("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:a("formatblock",
"h1"),2:a("formatblock","h2"),3:a("formatblock","h3"),4:a("formatblock","h4"),"\\":a("insertunorderedlist")};t("ie")||(b.Z=a("redo"));for(var d in b)this.addKeyHandler(d,!0,!1,b[d])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(I._editorCommandsLocalized)this._local2NativeFormatNames=I._local2NativeFormatNames,this._native2LocalFormatNames=I._native2LocalFormatNames;else{I._editorCommandsLocalized=!0;I._local2NativeFormatNames={};
I._native2LocalFormatNames={};this._local2NativeFormatNames=I._local2NativeFormatNames;this._native2LocalFormatNames=I._native2LocalFormatNames;for(var a="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),b="",f,g=0;f=a[g++];)b="l"!==f.charAt(1)?b+("\x3c"+f+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+f+"\x3e\x3cbr/\x3e"):b+("\x3c"+f+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+f+"\x3e\x3cbr/\x3e");var e=d.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:.01},innerHTML:b});this.ownerDocumentBody.appendChild(e);
a=n.hitch(this,function(){for(var a=e.firstChild;a;)try{this.selection.selectElement(a.firstChild);var c=a.tagName.toLowerCase();this._local2NativeFormatNames[c]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[c]]=c;a=a.nextSibling.nextSibling}catch(Q){}d.destroy(e)});this.defer(a)}},open:function(c){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new h;this.isClosed||this.close();C.publish(J._scopeName+"._editor.RichText::open",
this);1===arguments.length&&c.nodeName&&(this.domNode=c);var b=this.domNode,k;if(n.isString(this.value))k=this.value,b.innerHTML="";else if(b.nodeName&&"textarea"==b.nodeName.toLowerCase()){var r=this.textarea=b;this.name=r.name;k=r.value;b=this.domNode=this.ownerDocument.createElement("div");b.setAttribute("widgetId",this.id);r.removeAttribute("widgetId");b.cssText=r.cssText;b.className+=" "+r.className;d.place(b,r,"before");var e=n.hitch(this,function(){u.set(r,{display:"block",position:"absolute",
top:"-1000px"});if(t("ie")){var a=r.style;this.__overflow=a.overflow;a.overflow="hidden"}});t("ie")?this.defer(e,10):e();if(r.form){var q=r.value;this.reset=function(){this.getValue()!==q&&this.replaceValue(q)};y(r.form,"submit",n.hitch(this,function(){g.set(r,"disabled",this.disabled);r.value=this.getValue()}))}}else k=B.getChildrenHtml(b),b.innerHTML="";this.value=k;b.nodeName&&"LI"===b.nodeName&&(b.innerHTML=" \x3cbr\x3e");this.header=b.ownerDocument.createElement("div");b.appendChild(this.header);
this.editingArea=b.ownerDocument.createElement("div");b.appendChild(this.editingArea);this.footer=b.ownerDocument.createElement("div");b.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!a.useXDomain||a.allowXdRichTextSave)){if((k=f.byId(J._scopeName+"._editor.RichText.value"))&&""!==k.value)for(var e=k.value.split(this._SEPARATOR),p=0,l;l=e[p++];)if(l=l.split(this._NAME_CONTENT_SEP),l[0]===this.name){this.value=l[1];e=e.splice(p,1);k.value=e.join(this._SEPARATOR);
break}I._globalSaveHandler||(I._globalSaveHandler={},A.addOnUnload(function(){for(var a in I._globalSaveHandler){var c=I._globalSaveHandler[a];n.isFunction(c)&&c()}}));I._globalSaveHandler[this.id]=n.hitch(this,"_saveContent")}this.isClosed=!1;k=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");k.id=this.id+"_iframe";k.style.border="none";k.style.width="100%";this._layoutMode?k.style.height="100%":7<=t("ie")?(this.height&&(k.style.height=this.height),this.minHeight&&(k.style.minHeight=
this.minHeight)):k.style.height=this.height?this.height:this.minHeight;k.frameBorder=0;k._loadFunc=n.hitch(this,function(a){this.window=a;this.document=a.document;this.selection=new H.SelectionManager(a);t("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});e=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");e=11>t("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+e+"');document.close()":"javascript: '"+
e+"'";this.editingArea.appendChild(k);k.src=e;"LI"===b.nodeName&&(b.lastChild.style.marginTop="-1.2em");m.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var a=u.getComputedStyle(this.domNode),b;if(this["aria-label"])b=this["aria-label"];else{var d=r('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||f.byId(this["aria-labelledby"],this.ownerDocument);d&&(b=d.textContent||d.innerHTML||"")}var d="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(b?" aria-label\x3d'"+z.escape(b)+"'":"")+"\x3e\x3c/div\x3e",g=[a.fontWeight,a.fontSize,a.fontFamily].join(" "),e=a.lineHeight,e=0<=e.indexOf("px")?parseFloat(e)/parseFloat(a.fontSize):0<=e.indexOf("em")?parseFloat(e):"normal",k="",m=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(a){a=a.replace(/^;/ig,"")+";";var c=a.split(":")[0];if(c){var c=n.trim(c),c=c.toLowerCase(),b,e="";for(b=0;b<c.length;b++){var d=c.charAt(b);switch(d){case "-":b++,d=c.charAt(b).toUpperCase();default:e+=
d}}u.set(m.domNode,e,"")}k+=a+";"});this.iframe.setAttribute("title",b);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||p.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",b?"\x3ctitle\x3e"+z.escape(b)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",g,";\n",this.height||t("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",e,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",t("ie")||t("trident")||t("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",b?" aria-label\x3d'"+z.escape(b)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+k+"'\x3e",d,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var a=[];this.styleSheets&&(a=this.styleSheets.split(";"),this.styleSheets=
"");a=a.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var b="",d=0,f,e=x.get(this.ownerDocument);f=a[d++];)f=(new E(e.location,f)).toString(),this.editingAreaStyleSheets.push(f),b+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+f+'"/\x3e';return b},addStyleSheet:function(a){var c=a.toString(),b=x.get(this.ownerDocument);if("."===c.charAt(0)||"/"!==c.charAt(0)&&!a.host)c=(new E(b.location,c)).toString();-1<l.indexOf(this.editingAreaStyleSheets,c)||(this.editingAreaStyleSheets.push(c),
this.onLoadDeferred.then(n.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(c);else{var a=this.document.getElementsByTagName("head")[0],b=this.document.createElement("link");b.rel="stylesheet";b.type="text/css";b.href=c;a.appendChild(b)}})))},removeStyleSheet:function(a){var c=a.toString(),b=x.get(this.ownerDocument);if("."===c.charAt(0)||"/"!==c.charAt(0)&&!a.host)c=(new E(b.location,c)).toString();a=l.indexOf(this.editingAreaStyleSheets,c);-1!==a&&(delete this.editingAreaStyleSheets[a],
r('link[href\x3d"'+c+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(a){a=!!a;this._set("disabled",a);if(this.isLoaded){var c=t("ie")&&(this.isLoaded||!this.focusOnLoad);c&&(this.editNode.unselectable="on");this.editNode.contentEditable=!a;this.editNode.tabIndex=a?"-1":this.tabIndex;c&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(t("mozilla")&&!a&&this._mozSettingProps){a=this._mozSettingProps;for(var b in a)if(a.hasOwnProperty(b))try{this.document.execCommand(b,
!1,a[b])}catch(N){}}this._disabledOK=!0}},onLoad:function(a){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=D.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var c=this;this.beforeIframeNode=d.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=d.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){c.editNode.focus()};this.focusNode=
this.editNode;var b=this.events.concat(this.captureEvents),f=this.iframe?this.document:this.editNode;this.own.apply(this,l.map(b,function(a){var c=a.toLowerCase().replace(/^on/,"");return y(f,c,n.hitch(this,a))},this));this.own(y(f,"mouseup",n.hitch(this,"onClick")));t("ie")&&(this.own(y(this.document,"mousedown",n.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);t("webkit")&&(this._webkitListener=this.own(y(this.document,"mouseup",n.hitch(this,"onDisplayChanged")))[0],this.own(y(this.document,
"mousedown",n.hitch(this,function(a){a=a.target;!a||a!==this.document.body&&a!==this.document||this.defer("placeCursorAtEnd")}))));if(t("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(e){}this.isLoaded=!0;this.set("disabled",this.disabled);b=n.hitch(this,function(){this.setValue(a);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&K(n.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(b):b()},onKeyDown:function(a){if(a.keyCode===k.SHIFT||a.keyCode===k.ALT||a.keyCode===k.META||a.keyCode===k.CTRL)return!0;a.keyCode===k.TAB&&this.isTabIndent&&(a.stopPropagation(),a.preventDefault(),this.queryCommandEnabled(a.shiftKey?"outdent":"indent")&&this.execCommand(a.shiftKey?"outdent":"indent"));if(a.keyCode==k.TAB&&!this.isTabIndent&&!a.ctrlKey&&!a.altKey)return a.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>t("ie")&&a.keyCode===k.BACKSPACE&&"Control"===this.document.selection.type&&(a.stopPropagation(),a.preventDefault(),this.execCommand("delete"));t("ff")&&(a.keyCode===k.PAGE_UP||a.keyCode===k.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&a.preventDefault();var c=this._keyHandlers[a.keyCode],b=arguments;c&&!a.altKey&&l.some(c,function(c){if(!(c.shift^a.shiftKey||c.ctrl^(a.ctrlKey||a.metaKey)))return c.handler.apply(this,b)||a.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(a){p.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",a)},_setValueAttr:function(a){this.setValue(a)},_setDisableSpellCheckAttr:function(a){this.document?g.set(this.document.body,"spellcheck",!a):this.onLoadDeferred.then(n.hitch(this,function(){g.set(this.document.body,"spellcheck",!a)}));this._set("disableSpellCheck",a)},addKeyHandler:function(a,b,d,f){"string"==
typeof a&&(a=a.toUpperCase().charCodeAt(0));n.isArray(this._keyHandlers[a])||(this._keyHandlers[a]=[]);this._keyHandlers[a].push({shift:d||!1,ctrl:b||!1,handler:f})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(a){this.onDisplayChanged(a)},_onIEMouseDown:function(){this.focused||this.disabled||this.focus()},_onBlur:function(a){(t("ie")||t("trident"))&&this.defer(function(){D.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var c=this.getValue(!0);if(c!==this.value)this.onChange(c);
this._set("value",c)},_onFocus:function(a){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!t("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>t("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(a,b){a=a.toLowerCase();"formatblock"===a?t("safari")&&void 0===b&&(a="heading"):"hilitecolor"!==a||t("mozilla")||(a="backcolor");return a},_implCommand:function(a){return"_"+this._normalizeCommand(a)+"EnabledImpl"},_qcaCache:{},
queryCommandAvailable:function(a){var c=this._qcaCache[a];return void 0!==c?c:this._qcaCache[a]=this._queryCommandAvailable(a)},_queryCommandAvailable:function(a){switch(a.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return t("ie")||t("trident")||t("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!t("webkit");default:return!1}},execCommand:function(a,b){var c;this.focused&&this.focus();a=this._normalizeCommand(a,b);if(void 0!==b){if("heading"===a)throw Error("unimplemented");"formatblock"===
a&&(t("ie")||t("trident"))&&(b="\x3c"+b+"\x3e")}var d="_"+a+"Impl";if(this[d])c=this[d](b);else if((b=1<arguments.length?b:null)||"createlink"!==a)c=this.document.execCommand(a,!1,b);this.onDisplayChanged();return c},queryCommandEnabled:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);var c=this._implCommand(a);return this[c]?this[c](a):this._browserQueryCommandEnabled(a)},queryCommandState:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);
try{return this.document.queryCommandState(a)}catch(v){return!1}},queryCommandValue:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);if(t("ie")&&"formatblock"===a)a=this._native2LocalFormatNames[this.document.queryCommandValue(a)];else if(t("mozilla")&&"hilitecolor"===a){var c;try{c=this.document.queryCommandValue("styleWithCSS")}catch(M){c=!1}this.document.execCommand("styleWithCSS",!1,!0);a=this.document.queryCommandValue(a);this.document.execCommand("styleWithCSS",
!1,c)}else a=this.document.queryCommandValue(a);return a},_sCall:function(a,b){return this.selection[a].apply(this.selection,b)},placeCursorAtStart:function(){this.focus();var a=!1;if(t("mozilla"))for(var b=this.editNode.firstChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){var a=!0,d=b.tagName?b.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(d)?this.selection.selectElement(b):
this.selection.selectElementChildren(b);break}b=b.nextSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var a=!1;if(t("mozilla"))for(var b=this.editNode.lastChild;b;){if(3===b.nodeType){if(0<b.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(b);break}}else if(1===b.nodeType){a=!0;this.selection.selectElement(b.lastChild||b);break}b=b.previousSibling}else a=!0,this.selection.selectElementChildren(this.editNode);
a&&this.selection.collapse(!1)},getValue:function(a){return!this.textarea||!this.isClosed&&this.isLoaded?this.isLoaded?this._postFilterContent(null,a):this.value:this.textarea.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(a){if(this.isLoaded){if(!this.textarea||!this.isClosed&&this.isLoaded){a=this._preFilterContent(a);var c=this.isClosed?this.domNode:this.editNode;c.innerHTML=a;this._preDomFilterContent(c)}else this.textarea.value=a;this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(n.hitch(this,function(){this.setValue(a)}))},replaceValue:function(a){this.isClosed?this.setValue(a):this.window&&this.window.getSelection&&!t("mozilla")?this.setValue(a):this.window&&this.window.getSelection?(a=this._preFilterContent(a),this.execCommand("selectall"),this.execCommand("inserthtml",a),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(a);this._set("value",this.getValue(!0))},_preFilterContent:function(a){var c=
a;l.forEach(this.contentPreFilters,function(a){a&&(c=a(c))});return c},_preDomFilterContent:function(a){a=a||this.editNode;l.forEach(this.contentDomPreFilters,function(c){c&&n.isFunction(c)&&c(a)},this)},_postFilterContent:function(a,b){var c;n.isString(a)?c=a:(a=a||this.editNode,this.contentDomPostFilters.length&&(b&&(a=n.clone(a)),l.forEach(this.contentDomPostFilters,function(c){a=c(a)})),c=B.getChildrenHtml(a));n.trim(c.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(c="");l.forEach(this.contentPostFilters,
function(a){c=a(c)});return c},_saveContent:function(){var a=f.byId(J._scopeName+"._editor.RichText.value");a&&(a.value&&(a.value+=this._SEPARATOR),a.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(a,b){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");b||(a=a.replace(/'/gm,"\x26#39;"));return a},getNodeHtml:function(a){p.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return B.getNodeHtml(a)},getNodeChildrenHtml:function(a){p.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return B.getChildrenHtml(a)},close:function(a){if(!this.isClosed){arguments.length||(a=!0);a&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);t("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var b=this.textarea.style;b.position="";b.left=b.top="";t("ie")&&(b.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;d.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;m.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);I._globalSaveHandler&&delete I._globalSaveHandler[this.id]},_removeMozBogus:function(a){return a.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(a){a=a.replace(/\sclass="webkit-block-placeholder"/gi,"");a=a.replace(/\sclass="apple-style-span"/gi,
"");return a=a.replace(/<meta charset=\"utf-8\" \/>/gi,"")},_normalizeFontStyle:function(a){return a.replace(/<(\/)?strong([ \>])/gi,"\x3c$1b$2").replace(/<(\/)?em([ \>])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(a){return a.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(a){if(!a)return!1;
if(t("ie")||t("trident")||t("edge"))return this.focused&&!this.disabled;var b=9>t("ie")?this.document.selection.createRange():this.document;try{return b.queryCommandEnabled(a)}catch(M){return!1}},_createlinkEnabledImpl:function(){var a=!0;return a=t("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var a=!0;return a=t("mozilla")||t("webkit")||t("ie")||t("trident")||t("edge")?
this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var a=!0;return a=t("mozilla")||t("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var a=!0;t("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("cut");return a},_copyEnabledImpl:function(){var a=!0;t("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("copy");
return a},_pasteEnabledImpl:function(){var a=!0;return t("webkit")?!0:a=this._browserQueryCommandEnabled("paste")},_inserthorizontalruleImpl:function(a){return t("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,a)},_unlinkImpl:function(a){return this.queryCommandEnabled("unlink")&&(t("mozilla")||t("webkit"))?(a=this.selection.getAncestorElement("a"),this.selection.selectElement(a),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",
!1,a)},_hilitecolorImpl:function(a){var b;this._handleTextColorOrProperties("hilitecolor",a)||(t("mozilla")?(this.document.execCommand("styleWithCSS",!1,!0),console.log("Executing color command."),b=this.document.execCommand("hilitecolor",!1,a),this.document.execCommand("styleWithCSS",!1,!1)):b=this.document.execCommand("hilitecolor",!1,a));return b},_backcolorImpl:function(a){t("ie")&&(a=a?a:null);var b=this._handleTextColorOrProperties("backcolor",a);b||(b=this.document.execCommand("backcolor",
!1,a));return b},_forecolorImpl:function(a){t("ie")&&(a=a?a:null);var b=!1;(b=this._handleTextColorOrProperties("forecolor",a))||(b=this.document.execCommand("forecolor",!1,a));return b},_inserthtmlImpl:function(a){a=this._preFilterContent(a);var b=!0;if(9>t("ie")){var c=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var f=c.item(0);c.length;)c.remove(c.item(0));f.outerHTML=a}else c.pasteHTML(a);c.select()}else if(8>t("trident")){var e=w.getSelection(this.window);
if(e&&e.rangeCount&&e.getRangeAt){c=e.getRangeAt(0);c.deleteContents();var g=d.create("div");g.innerHTML=a;for(var k,f=this.document.createDocumentFragment();a=g.firstChild;)k=f.appendChild(a);c.insertNode(f);k&&(c=c.cloneRange(),c.setStartAfter(k),c.collapse(!1),e.removeAllRanges(),e.addRange(c))}}else t("mozilla")&&!a.length?this.selection.remove():b=this.document.execCommand("inserthtml",!1,a);return b},_boldImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("bold");
b||(b=this.document.execCommand("bold",!1,a));return b},_italicImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("italic");b||(b=this.document.execCommand("italic",!1,a));return b},_underlineImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("underline");b||(b=this.document.execCommand("underline",!1,a));return b},_strikethroughImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),
b=this._adaptIEFormatAreaAndExec("strikethrough");b||(b=this.document.execCommand("strikethrough",!1,a));return b},_superscriptImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("superscript");b||(b=this.document.execCommand("superscript",!1,a));return b},_subscriptImpl:function(a){var b=!1;if(t("ie")||t("trident"))this._adaptIESelection(),b=this._adaptIEFormatAreaAndExec("subscript");b||(b=this.document.execCommand("subscript",!1,a));return b},
_fontnameImpl:function(a){var b;if(t("ie")||t("trident"))b=this._handleTextColorOrProperties("fontname",a);b||(b=this.document.execCommand("fontname",!1,a));return b},_fontsizeImpl:function(a){var b;if(t("ie")||t("trident"))b=this._handleTextColorOrProperties("fontsize",a);b||(b=this.document.execCommand("fontsize",!1,a));return b},_insertorderedlistImpl:function(a){var b=!1;if(t("ie")||t("trident")||t("edge"))b=this._adaptIEList("insertorderedlist",a);b||(b=this.document.execCommand("insertorderedlist",
!1,a));return b},_insertunorderedlistImpl:function(a){var b=!1;if(t("ie")||t("trident")||t("edge"))b=this._adaptIEList("insertunorderedlist",a);b||(b=this.document.execCommand("insertunorderedlist",!1,a));return b},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(a){var b=0;if(a&&a.childNodes){var c;for(c=0;c<a.childNodes.length;c++)var d=q.position(a.childNodes[c]),
b=b+d.h}return b},_isNodeEmpty:function(a,b){return 1===a.nodeType?0<a.childNodes.length?this._isNodeEmpty(a.childNodes[0],b):!0:3===a.nodeType?""===a.nodeValue.substring(b):!1},_removeStartingRangeFromRange:function(a,b){if(a.nextSibling)b.setStart(a.nextSibling,0);else{for(a=a.parentNode;a&&null==a.nextSibling;)a=a.parentNode;a&&b.setStart(a.nextSibling,0)}return b},_adaptIESelection:function(){var a=w.getSelection(this.window);if(a&&a.rangeCount&&!a.isCollapsed){for(var b=a.getRangeAt(0),d=b.startContainer,
f=b.startOffset;3===d.nodeType&&f>=d.length&&d.nextSibling;)f-=d.length,d=d.nextSibling;for(var e=null;this._isNodeEmpty(d,f)&&d!==e;)e=d,b=this._removeStartingRangeFromRange(d,b),d=b.startContainer,f=0;a.removeAllRanges();a.addRange(b)}},_adaptIEFormatAreaAndExec:function(a){var b=w.getSelection(this.window),c=this.document,f,e,g,k,m,r,h;if(a&&b&&b.isCollapsed){if(this.queryCommandValue(a)){a=this._tagNamesForCommand(a);g=b.getRangeAt(0);k=g.startContainer;3===k.nodeType&&(e=g.endOffset,k.length<
e&&(e=this._adjustNodeAndOffset(f,e),k=e.node,e=e.offset));for(;k&&k!==this.editNode;){f=k.tagName?k.tagName.toLowerCase():"";if(-1<l.indexOf(a,f)){h=k;break}k=k.parentNode}if(h&&(f=g.startContainer,a=c.createElement(h.tagName),d.place(a,h,"after"),f&&3===f.nodeType)){e=g.endOffset;f.length<e&&(e=this._adjustNodeAndOffset(f,e),f=e.node,e=e.offset);k=f.nodeValue;g=c.createTextNode(k.substring(0,e));var n=k.substring(e,k.length);n&&(m=c.createTextNode(n));d.place(g,f,"before");m&&(r=c.createElement("span"),
r.className="ieFormatBreakerSpan",d.place(r,f,"after"),d.place(m,r,"after"),m=r);d.destroy(f);e=g.parentNode;for(f=[];e!==h;){k=e.tagName;g={tagName:k};f.push(g);k=c.createElement(k);e.style&&k.style&&e.style.cssText&&(k.style.cssText=e.style.cssText,g.cssText=e.style.cssText);"FONT"===e.tagName&&(e.color&&(k.color=e.color,g.color=e.color),e.face&&(k.face=e.face,g.face=e.face),e.size&&(k.size=e.size,g.size=e.size));e.className&&(k.className=e.className,g.className=e.className);if(m)for(;m;)g=m.nextSibling,
k.appendChild(m),m=g;k.tagName==e.tagName?(r=c.createElement("span"),r.className="ieFormatBreakerSpan",d.place(r,e,"after"),d.place(k,r,"after")):d.place(k,e,"after");g=e;m=k;e=e.parentNode}if(m){if(1===m.nodeType||3===m.nodeType&&m.nodeValue)a.innerHTML="";for(;m;)g=m.nextSibling,a.appendChild(m),m=g}if(f.length){g=f.pop();m=c.createElement(g.tagName);g.cssText&&m.style&&(m.style.cssText=g.cssText);g.className&&(m.className=g.className);"FONT"===g.tagName&&(g.color&&(m.color=g.color),g.face&&(m.face=
g.face),g.size&&(m.size=g.size));for(d.place(m,a,"before");f.length;)g=f.pop(),h=c.createElement(g.tagName),g.cssText&&h.style&&(h.style.cssText=g.cssText),g.className&&(h.className=g.className),"FONT"===g.tagName&&(g.color&&(h.color=g.color),g.face&&(h.face=g.face),g.size&&(h.size=g.size)),m.appendChild(h),m=h;h=c.createTextNode(".");r.appendChild(h);m.appendChild(h)}else r=c.createElement("span"),r.className="ieFormatBreakerSpan",h=c.createTextNode("."),r.appendChild(h),d.place(r,a,"before");m=
w.create(this.window);m.setStart(h,0);m.setEnd(h,h.length);b.removeAllRanges();b.addRange(m);this.selection.collapse(!1);h.parentNode.innerHTML="";a.firstChild||d.destroy(a);return!0}return!1}g=b.getRangeAt(0);if((f=g.startContainer)&&3===f.nodeType)return e=g.startOffset,f.length<e&&(e=this._adjustNodeAndOffset(f,e),f=e.node,e=e.offset),k=f.nodeValue,g=c.createTextNode(k.substring(0,e)),n=k.substring(e),""!==n&&(m=c.createTextNode(k.substring(e))),r=c.createElement("span"),h=c.createTextNode("."),
r.appendChild(h),g.length?d.place(g,f,"after"):g=f,d.place(r,g,"after"),m&&d.place(m,r,"after"),d.destroy(f),m=w.create(this.window),m.setStart(h,0),m.setEnd(h,h.length),b.removeAllRanges(),b.addRange(m),c.execCommand(a),d.place(r.firstChild,r,"before"),d.destroy(r),m.setStart(h,0),m.setEnd(h,h.length),b.removeAllRanges(),b.addRange(m),this.selection.collapse(!1),h.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(a){var b=w.getSelection(this.window);if(b.isCollapsed&&b.rangeCount&&
!this.queryCommandValue(a)){var c=b.getRangeAt(0),f=c.startContainer;if(f&&3==f.nodeType&&!c.startOffset)return c="ul","insertorderedlist"===a&&(c="ol"),a=this.document.createElement(c),c=d.create("li",null,a),d.place(a,f,"before"),c.appendChild(f),d.create("br",null,a,"after"),a=w.create(this.window),a.setStart(f,0),a.setEnd(f,f.length),b.removeAllRanges(),b.addRange(a),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(a,b){var c=w.getSelection(this.window),f=this.document,
e,g,k,m,h;b=b||null;if(a&&c&&c.isCollapsed&&c.rangeCount&&(g=c.getRangeAt(0),(e=g.startContainer)&&3===e.nodeType)){h=g.startOffset;e.length<h&&(g=this._adjustNodeAndOffset(e,h),e=g.node,h=g.offset);k=e.nodeValue;g=f.createTextNode(k.substring(0,h));""!==k.substring(h)&&(m=f.createTextNode(k.substring(h)));k=f.createElement("span");h=f.createTextNode(".");k.appendChild(h);f=f.createElement("span");k.appendChild(f);g.length?d.place(g,e,"after"):g=e;d.place(k,g,"after");m&&d.place(m,k,"after");d.destroy(e);
e=w.create(this.window);e.setStart(h,0);e.setEnd(h,h.length);c.removeAllRanges();c.addRange(e);if(t("webkit")){c="color";if("hilitecolor"===a||"backcolor"===a)c="backgroundColor";u.set(k,c,b);this.selection.remove();d.destroy(f);k.innerHTML="\x26#160;";this.selection.selectElement(k);this.focus()}else this.execCommand(a,b),d.place(k.firstChild,k,"before"),d.destroy(k),e.setStart(h,0),e.setEnd(h,h.length),c.removeAllRanges(),c.addRange(e),this.selection.collapse(!1),h.parentNode.removeChild(h);return!0}return!1},
_adjustNodeAndOffset:function(a,b){for(;a.length<b&&a.nextSibling&&3===a.nextSibling.nodeType;)b-=a.length,a=a.nextSibling;return{node:a,offset:b}},_tagNamesForCommand:function(a){return"bold"===a?["b","strong"]:"italic"===a?["i","em"]:"strikethrough"===a?["s","strike"]:"superscript"===a?["sup"]:"subscript"===a?["sub"]:"underline"===a?["u"]:[]},_stripBreakerNodes:function(a){if(this.isLoaded)return r(".ieFormatBreakerSpan",a).forEach(function(a){for(;a.firstChild;)d.place(a.firstChild,a,"before");
d.destroy(a)}),a},_stripTrailingEmptyNodes:function(a){function b(a){return/^(p|div|br)$/i.test(a.nodeName)&&0==a.children.length&&/^[\s\xA0]*$/.test(a.textContent||a.innerText||"")||3===a.nodeType&&/^[\s\xA0]*$/.test(a.nodeValue)}for(;a.lastChild&&b(a.lastChild);)d.destroy(a.lastChild);return a},_setTextDirAttr:function(a){this._set("textDir",a);this.onLoadDeferred.then(n.hitch(this,function(){this.editNode.dir=a}))}});return I})},"dijit/_editor/range":function(){define(["dojo/_base/array","dojo/_base/declare",
"dojo/_base/lang"],function(l,a,b){var h={getIndex:function(a,b){for(var d=[],f=[],g=a,k,m;a!=b;){var h=0;for(k=a.parentNode;m=k.childNodes[h++];)if(m===a){--h;break}d.unshift(h);f.unshift(h-k.childNodes.length);a=k}if(0<d.length&&3==g.nodeType){for(m=g.previousSibling;m&&3==m.nodeType;)d[d.length-1]--,m=m.previousSibling;for(m=g.nextSibling;m&&3==m.nodeType;)f[f.length-1]++,m=m.nextSibling}return{o:d,r:f}},getNode:function(a,d){if(!b.isArray(a)||0==a.length)return d;var f=d;l.every(a,function(a){if(0<=
a&&a<f.childNodes.length)f=f.childNodes[a];else return f=null,!1;return!0});return f},getCommonAncestor:function(a,b,f){f=f||a.ownerDocument.body;var d=function(a){for(var b=[];a;)if(b.unshift(a),a!==f)a=a.parentNode;else break;return b};a=d(a);b=d(b);for(var d=Math.min(a.length,b.length),g=a[0],k=1;k<d;k++)if(a[k]===b[k])g=a[k];else break;return g},getAncestor:function(a,b,f){for(f=f||a.ownerDocument.body;a&&a!==f;){var d=a.nodeName.toUpperCase();if(b.test(d))return a;a=a.parentNode}return null},
BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(a,b,f){f=f||a.ownerDocument.body;b=b||h.BlockTagNames;for(var d=null,g;a&&a!==f;){var k=a.nodeName.toUpperCase();!d&&b.test(k)&&(d=a);!g&&/^(?:BODY|TD|TH|CAPTION)$/.test(k)&&(g=a);a=a.parentNode}return{blockNode:d,blockContainer:g||a.ownerDocument.body}},atBeginningOfContainer:function(a,b,f){var d=!1,g=0==f;g||3!=b.nodeType||/^[\s\xA0]+$/.test(b.nodeValue.substr(0,f))&&(g=!0);if(g)for(d=!0;b&&b!==a;){if(b.previousSibling){d=
!1;break}b=b.parentNode}return d},atEndOfContainer:function(a,b,f){var d=!1,g=f==(b.length||b.childNodes.length);g||3!=b.nodeType||/^[\s\xA0]+$/.test(b.nodeValue.substr(f))&&(g=!0);if(g)for(d=!0;b&&b!==a;){if(b.nextSibling){d=!1;break}b=b.parentNode}return d},adjacentNoneTextNode:function(a,b){var d=a;a=0-a.length||0;for(b=b?"nextSibling":"previousSibling";d&&3==d.nodeType;)a+=d.length,d=d[b];return[d,a]},create:function(a){a=a||window;return a.getSelection?a.document.createRange():new g},getSelection:function(a,
b){if(a.getSelection)return a.getSelection();a=new f.selection(a);b||a._getCurrentSelection();return a}};if(!window.getSelection)var f=h.ie={cachedSelection:{},selection:function(a){this._ranges=[];this.addRange=function(a,b){this._ranges.push(a);b||a._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0};this.getRangeAt=function(a){return this._ranges[a]};this._getCurrentSelection=function(){this.removeAllRanges();var b;b=a.document.selection.createRange();
b="CONTROL"==a.document.selection.type.toUpperCase()?new g(f.decomposeControlRange(b)):new g(f.decomposeTextRange(b));this.addRange(b,!0),this.isCollapsed=b.collapsed}},decomposeControlRange:function(a){var b=a.item(0),f=a.item(a.length-1);a=b.parentNode;var g=f.parentNode,b=h.getIndex(b,a).o[0],f=h.getIndex(f,g).o[0]+1;return[a,b,g,f]},getEndPoint:function(a,b){var d=a.duplicate();d.collapse(!b);var f="EndTo"+(b?"End":"Start"),g=d.parentElement(),k,m,y;0<g.childNodes.length?l.every(g.childNodes,
function(b,n){var r;if(3!=b.nodeType)if(d.moveToElementText(b),0<d.compareEndPoints(f,a))if(y&&3==y.nodeType)k=y,r=!0;else return k=g,m=n,!1;else{if(n==g.childNodes.length-1)return k=g,m=g.childNodes.length,!1}else n==g.childNodes.length-1&&(k=b,r=!0);if(r&&k)return k=(b=h.adjacentNoneTextNode(k)[0])?b.nextSibling:g.firstChild,n=h.adjacentNoneTextNode(k),b=n[0],n=n[1],b?(d.moveToElementText(b),d.collapse(!1)):d.moveToElementText(g),d.setEndPoint(f,a),m=d.text.length-n,!1;y=b;return!0}):(k=g,m=0);
b||1!=k.nodeType||m!=k.childNodes.length||(b=k.nextSibling)&&3==b.nodeType&&(k=b,m=0);return[k,m]},setEndPoint:function(a,b,f){a=a.duplicate();var d;if(3!=b.nodeType)if(0<f){if(d=b.childNodes[f-1])if(3==d.nodeType)b=d,f=d.length;else if(d.nextSibling&&3==d.nextSibling.nodeType)b=d.nextSibling,f=0;else{a.moveToElementText(d.nextSibling?d:b);var g=d.parentNode;d=g.insertBefore(d.ownerDocument.createTextNode(" "),d.nextSibling);a.collapse(!1);g.removeChild(d)}}else a.moveToElementText(b),a.collapse(!0);
3==b.nodeType&&(d=h.adjacentNoneTextNode(b),g=d[0],d=d[1],g?(a.moveToElementText(g),a.collapse(!1),"inherit"!=g.contentEditable&&d++):(a.moveToElementText(b.parentNode),a.collapse(!0),a.move("character",1),a.move("character",-1)),f+=d,0<f&&a.move("character",f)!=f&&console.error("Error when moving!"));return a},decomposeTextRange:function(a){var b=f.getEndPoint(a),g=b[0],h=b[1],m=b[0],b=b[1];a.htmlText.length&&(a.htmlText==a.text?b=h+a.text.length:(b=f.getEndPoint(a,!0),m=b[0],b=b[1]));return[g,h,
m,b]},setRange:function(a,b,g,h,l,k){b=f.setEndPoint(a,b,g);a.setEndPoint("StartToStart",b);if(!k)var d=f.setEndPoint(a,h,l);a.setEndPoint("EndToEnd",d||b);return a}},g=h.W3CRange=a(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=null,this.startOffset=0,this.endContainer=null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=
this.startContainer!==this.endContainer?h.getCommonAncestor(this.startContainer,this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(a,b){b=parseInt(b);if(this.startContainer!==a||this.startOffset!=b)delete this._cachedBookmark,this.startContainer=a,this.startOffset=b,this.endContainer?this._updateInternal():this.setEnd(a,b)},setEnd:function(a,b){b=parseInt(b);if(this.endContainer!==a||this.endOffset!=b)delete this._cachedBookmark,
this.endContainer=a,this.endOffset=b,this.startContainer?this._updateInternal():this.setStart(a,b)},setStartAfter:function(a,b){this._setPoint("setStart",a,b,1)},setStartBefore:function(a,b){this._setPoint("setStart",a,b,0)},setEndAfter:function(a,b){this._setPoint("setEnd",a,b,1)},setEndBefore:function(a,b){this._setPoint("setEnd",a,b,0)},_setPoint:function(a,b,f,g){f=h.getIndex(b,b.parentNode).o;this[a](b.parentNode,f.pop()+g)},_getIERange:function(){var a=(this._body||this.endContainer.ownerDocument.body).createTextRange();
f.setRange(a,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return a},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var a=this.startContainer,b=this._getIERange();3!==a.nodeType||this.startOffset||this.setStartBefore(a);b.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var a=new g([this.startContainer,
this.startOffset,this.endContainer,this.endOffset]);a._body=this._body;return a},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});b.setObject("dijit.range",h);return h})},"dijit/_editor/html":function(){define(["dojo/_base/array","dojo/_base/lang","dojo/sniff"],function(l,a,b){var h={};a.setObject("dijit._editor.html",h);var f=h.escapeXml=function(a,b){a=a.replace(/&/gm,"\x26amp;").replace(/</gm,
"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");b||(a=a.replace(/'/gm,"\x26#39;"));return a};h.getNodeHtml=function(a){var b=[];h.getNodeHtmlHelper(a,b);return b.join("")};h.getNodeHtmlHelper=function(a,m){switch(a.nodeType){case 1:var d=a.nodeName.toLowerCase();if(!d||"/"==d.charAt(0))return"";m.push("\x3c",d);var g=[],u={},p;if(b("dom-attributes-explicit")||b("dom-attributes-specified-flag"))for(var k=0;p=a.attributes[k++];){var n=p.name;"_dj"===n.substr(0,3)||b("dom-attributes-specified-flag")&&
!p.specified||n in u||(p=p.value,("src"==n||"href"==n)&&a.getAttribute("_djrealurl")&&(p=a.getAttribute("_djrealurl")),8===b("ie")&&"style"===n&&(p=p.replace("HEIGHT:","height:").replace("WIDTH:","width:")),g.push([n,p]),u[n]=p)}else{var y=(/^input$|^img$/i.test(a.nodeName)?a:a.cloneNode(!1)).outerHTML,u=y.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi),y=y.substr(0,y.indexOf("\x3e"));l.forEach(u,function(b){if(b){var f=b.indexOf("\x3d");if(0<f&&(b=b.substring(0,f),"_dj"!=b.substr(0,3)))if("src"!=b&&"href"!=
b||!a.getAttribute("_djrealurl")){var k;switch(b){case "style":k=a.style.cssText.toLowerCase();break;case "class":k=a.className;break;case "width":if("img"===d){(f=/width=(\S+)/i.exec(y))&&(k=f[1]);break}case "height":if("img"===d){(f=/height=(\S+)/i.exec(y))&&(k=f[1]);break}default:k=a.getAttribute(b)}null!=k&&g.push([b,k.toString()])}else g.push([b,a.getAttribute("_djrealurl")])}},this)}g.sort(function(a,b){return a[0]<b[0]?-1:a[0]==b[0]?0:1});for(u=0;p=g[u++];)m.push(" ",p[0],'\x3d"',"string"===
typeof p[1]?f(p[1],!0):p[1],'"');switch(d){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":m.push(" /\x3e");break;case "script":m.push("\x3e",a.innerHTML,"\x3c/",d,"\x3e");break;default:m.push("\x3e"),a.hasChildNodes()&&h.getChildrenHtmlHelper(a,m),m.push("\x3c/",d,"\x3e")}break;case 4:case 3:m.push(f(a.nodeValue,!0));break;case 8:m.push("\x3c!--",f(a.nodeValue,!0),"--\x3e");break;default:m.push("\x3c!-- Element not recognized - Type: ",a.nodeType," Name: ",
a.nodeName,"--\x3e")}};h.getChildrenHtml=function(a){var b=[];h.getChildrenHtmlHelper(a,b);return b.join("")};h.getChildrenHtmlHelper=function(a,f){if(a)for(var d=a.childNodes||a,g=!b("ie")||d!==a,m,l=0;m=d[l++];)g&&m.parentNode!=a||h.getNodeHtmlHelper(m,f)};return h})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),function(l,
a,b,h,f,g,m,d,q,u,p,k){var n=a("dijit._editor.plugins.LinkDialog",u,{buttonClass:p,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=f.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(a){l("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),f.hitch(this,function(b,d,k){var r=this;this.tag="insertImage"==this.command?"img":"a";b=f.delegate(b.getLocalization("dijit","common",this.lang),b.getLocalization("dijit._editor",
"LinkDialog",this.lang));var m=this.dropDown=this.button.dropDown=new d({title:b[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:f.hitch(this,"setValue"),onOpen:function(){r._onOpenDialog();d.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(f.hitch(r,"_onCloseDialog"),0)}});b.urlRegExp=this.urlRegExp;b.id=k.getUniqueId(this.editor.id);this._uniqueId=b.id;this._setContent(m.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
q.substitute(this.linkDialogTemplate,b));m.startup();this._urlInput=k.byId(this._uniqueId+"_urlInput");this._textInput=k.byId(this._uniqueId+"_textInput");this._setButton=k.byId(this._uniqueId+"_setButton");this.own(k.byId(this._uniqueId+"_cancelButton").on("click",f.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",f.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",f.hitch(this,"_checkAndFixInput")));this._urlRegExp=new RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=new RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=f.hitch(this,function(){var a=this._urlInput.get("value");return this._urlRegExp.test(a)||this._emailRegExp.test(a)});this.own(g(m.domNode,"keydown",f.hitch(this,f.hitch(this,function(a){!a||a.keyCode!=h.ENTER||a.shiftKey||a.metaKey||a.ctrlKey||a.altKey||this._setButton.get("disabled")||(m.onExecute(),m.execute(m.get("value")))}))));a()}))},_checkAndFixInput:function(){var a=this,b=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var d=b,g=!1,k=!1;d&&1<d.length&&(d=f.trim(d),0!==d.indexOf("mailto:")&&(0<d.indexOf("/")?-1===d.indexOf("://")&&"/"!==d.charAt(0)&&d.indexOf("./")&&0!==d.indexOf("../")&&a._hostRxp.test(d)&&(g=!0):a._userAtRxp.test(d)&&(k=!0)));g&&a._urlInput.set("value","http://"+d);k&&a._urlInput.set("value","mailto:"+d);a._setButton.set("disabled",!a._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(f.hitch(this,
function(){this.own(g(this.editor.editNode,"mouseup",f.hitch(this,"_onMouseUp")));this.own(g(this.editor.editNode,"dblclick",f.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(a){this.dropDown.set({parserScope:"dojo",content:a})},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));return a},_createlinkEnabledImpl:function(){return!0},setValue:function(a){this._onCloseDialog();
if(9>m("ie")){var f=k.getSelection(this.editor.window).getRangeAt(0).endContainer;3===f.nodeType&&(f=f.parentNode);f&&f.nodeName&&f.nodeName.toLowerCase()!==this.tag&&(f=this.editor.selection.getSelectedElement(this.tag));f&&f.nodeName&&f.nodeName.toLowerCase()===this.tag&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(f),this.editor.execCommand("unlink"))}a=this._checkValues(a);this.editor.execCommand("inserthtml",q.substitute(this.htmlTemplate,a));d("a",
this.editor.document).forEach(function(a){a.innerHTML||b.has(a,"name")||a.parentNode.removeChild(a)},this)},_onCloseDialog:function(){this.editor.focused&&this.editor.focus()},_getCurrentValues:function(a){var b,d,f;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("href"),f=a.getAttribute("target")||"_self",d=a.textContent||a.innerText,this.editor.selection.selectElement(a,!0)):d=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:d||"",targetSelect:f||
""}},_onOpenDialog:function(){var a,b;if(m("ie")){if(b=k.getSelection(this.editor.window),b.rangeCount){var d=b.getRangeAt(0);a=d.endContainer;3===a.nodeType&&(a=a.parentNode);a&&a.nodeName&&a.nodeName.toLowerCase()!==this.tag&&(a=this.editor.selection.getSelectedElement(this.tag));if(!a||a.nodeName&&a.nodeName.toLowerCase()!==this.tag)(b=this.editor.selection.getAncestorElement(this.tag))&&b.nodeName&&b.nodeName.toLowerCase()==this.tag?(a=b,this.editor.selection.selectElement(a)):d.startContainer===
d.endContainer&&(b=d.startContainer.firstChild)&&b.nodeName&&b.nodeName.toLowerCase()==this.tag&&(a=b,this.editor.selection.selectElement(a))}}else a=this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(a))},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&b.get(a,"href"))){var d=this.editor;this.editor.selection.selectElement(a);d.onDisplayChanged();
d._updateTimer&&(d._updateTimer.remove(),delete d._updateTimer);d.onNormalizedDisplayChanged();var f=this.button;setTimeout(function(){f.set("disabled",!1);f.loadAndOpenDropDown().then(function(){f.dropDown.focus&&f.dropDown.focus()})},10)}},_onMouseUp:function(){if(m("ff")){var a=this.editor.selection.getAncestorElement(this.tag);if(a){var b=k.getSelection(this.editor.window).getRangeAt(0);if(b.collapsed&&a.childNodes.length){var d=b.cloneRange();d.selectNodeContents(a.childNodes[a.childNodes.length-
1]);d.setStart(a.childNodes[0],0);1!==b.compareBoundaryPoints(d.START_TO_START,d)?b.setStartBefore(a):-1!==b.compareBoundaryPoints(d.END_TO_START,d)&&b.setStartAfter(a)}}}}}),y=a("dijit._editor.plugins.ImgLinkDialog",[n],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(a){var b,d;a&&a.tagName.toLowerCase()===this.tag?(b=a.getAttribute("_djrealurl")||a.getAttribute("src"),d=a.getAttribute("alt"),this.editor.selection.selectElement(a,!0)):d=this.editor.selection.getSelectedText();return{urlInput:b||"",textInput:d||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(f.hitch(this,
function(){this.own(g(this.editor.editNode,"mousedown",f.hitch(this,"_selectTag")))}))},_selectTag:function(a){a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(a))},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));a&&a.textInput&&(a.textInput=a.textInput.replace(/"/g,"\x26quot;"));return a},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&b.get(a,
"src"))){var d=this.editor;this.editor.selection.selectElement(a);d.onDisplayChanged();d._updateTimer&&(d._updateTimer.remove(),delete d._updateTimer);d.onNormalizedDisplayChanged();var f=this.button;setTimeout(function(){f.set("disabled",!1);f.loadAndOpenDropDown().then(function(){f.dropDown.focus&&f.dropDown.focus()})},10)}}});u.registry.createLink=function(){return new n({command:"createLink"})};u.registry.insertImage=function(){return new y({command:"insertImage"})};n.ImgLinkDialog=y;return n})},
"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),function(l,a,b,h,f,g){var m=b("dijit._editor.plugins.TextColor",f,{buttonClass:g,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var a=this;this.button.loadDropDown=function(b){function d(d){a.button.dropDown=new d({dir:a.editor.dir,ownerDocument:a.editor.ownerDocument,
value:a.value,onChange:function(b){a.editor.execCommand(a.command,b)},onExecute:function(){a.editor.execCommand(a.command,this.get("value"))}});b()}"string"==typeof a.colorPicker?l([a.colorPicker],d):d(a.colorPicker)}},updateState:function(){var b=this.editor,f=this.command;if(b&&b.isLoaded&&f.length){if(this.button){var g=this.get("disabled");this.button.set("disabled",g);if(g)return;var h;try{h=b.queryCommandValue(f)||""}catch(k){h=""}}""==h&&(h="#000000");"transparent"==h&&(h="#ffffff");"string"==
typeof h?-1<h.indexOf("rgb")&&(h=a.fromRgb(h).toHex()):(h=((h&255)<<16|h&65280|(h&16711680)>>>16).toString(16),h="#000000".slice(0,7-h.length)+h);this.value=h;(b=this.button.dropDown)&&b.get&&h!==b.get("value")&&b.set("value",h,!1)}}});f.registry.foreColor=function(a){return new m(a)};f.registry.hiliteColor=function(a){return new m(a)};return m})},"esri/dijit/editing/AttachmentEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/io-query dojo/dom-attr dijit/_Widget dijit/_Templated dijit/ProgressBar ../../kernel ../../lang ../../domUtils dojo/text!./templates/AttachmentEditor.html dojo/i18n!../../nls/jsapi dojo/NodeList-dom".split(" "),
function(l,a,b,h,f,g,m,d,q,u,p,k,n,y,r,K,t){l=l([u,p],{declaredClass:"esri.dijit.editing.AttachmentEditor",widgetsInTemplate:!0,templateString:K,_listHtml:"\x3cspan id\x3d'node_${oid}_${attid}' style\x3d'display: flex;'\x3e\x3ca href\x3d'${href}' target\x3d'_blank'\x3e${name}\x3c/a\x3e",_deleteBtnHtml:"\x3cspan style\x3d'cursor:pointer;color:red;font-weight:bold;padding:0 2px;' class\x3d'deleteAttachment' id\x3d'${attid}');'\x3eX\x3c/span\x3e",_endHtml:"\x3cbr/\x3e\x3c/span\x3e",_aeConnects:[],_layerEditingCapChecked:{},
_layerEditingCap:{},constructor:function(b,d){a.mixin(this,t.widgets.attachmentEditor)},startup:function(){this.inherited(arguments);this._uploadField_connect=b.connect(this._uploadField,"onchange",this,function(){0<this._uploadField.value.length&&this._addAttachment()});this._uploadFieldFocus_connect=b.connect(this._uploadField,"onfocus",a.hitch(this,function(a){r.hide(this._attachmentError)}))},destroy:function(){h.forEach(this._aeConnects,b.disconnect);b.disconnect(this._uploadField_connect);b.disconnect(this._uploadFieldFocus_connect);
this.inherited(arguments)},showAttachments:function(a,b){this._attachmentList.innerHTML=this.NLS_none;this._uploadField.value="";h.forEach(this.domNode.children,function(a,b){r.show(a)});r.hide(this._attachmentError);a&&(this._featureLayer=a.getLayer()||b)&&("esri.layers.FeatureLayer"===this._featureLayer.declaredClass&&this._featureLayer.getEditCapabilities?(this._currentLayerId=this._featureLayer.id,this._layerEditingCapChecked[this._currentLayerId]||(this._layerEditingCap[this._currentLayerId]=
this._featureLayer.getEditCapabilities(),this._layerEditingCapChecked[this._currentLayerId]=!0),this._featureCanUpdate=this._featureLayer.getEditCapabilities({feature:a}).canUpdate,this._oid=a.attributes[this._featureLayer.objectIdField],this._getAttachments(a)):b&&b.getEditCapabilities()||(r.hide(this._uploadForm),h.forEach(this.domNode.children,function(a,b){r.hide(a)})))},_getAttachments:function(b){this._featureLayer&&this._featureLayer.queryAttachmentInfos&&this._featureLayer.queryAttachmentInfos(this._oid,
a.hitch(this,"_onQueryAttachmentInfosComplete"))},_addAttachment:function(){r.hide(this._attachmentError);this._featureLayer&&this._featureLayer.addAttachment?(r.show(this._attachmentProgress),this._featureLayer.addAttachment(this._oid,this._uploadForm,a.hitch(this,"_onAddAttachmentComplete"),a.hitch(this,"_onAddAttachmentError"))):this._tempUpload=this._uploadForm},_chainAttachment:function(b,d){this._tempUpload&&(r.show(this._attachmentProgress),d.addAttachment(b,this._tempUpload,a.hitch(this,"_onAddAttachmentComplete"),
a.hitch(this,"_onAddAttachmentError")));this._tempUpload=null},_deleteAttachment:function(b,d){r.show(this._attachmentProgress);this._featureLayer.deleteAttachments(b,[d],a.hitch(this,"_onDeleteAttachmentComplete"))},_onQueryAttachmentInfosComplete:function(b){var d=this._listHtml+this._deleteBtnHtml+this._endHtml;this._uploadForm.style.display="block";!this._featureCanUpdate&&this._layerEditingCap[this._currentLayerId].canUpdate||!this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate?
(d=this._listHtml+this._endHtml,this._uploadForm.style.display="none"):this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(d=this._listHtml+this._endHtml);var f=this._attachmentList;b=h.map(b,a.hitch(this,function(a){return y.substitute({href:a.url,name:a.name,oid:a.objectId,attid:a.id},d)}));f.innerHTML=b.join("")||this.NLS_none;this._updateConnects()},_onAddAttachmentComplete:function(a){r.hide(this._attachmentProgress.domNode);var b=this._attachmentList,
f=this._uploadField,g=f.value,k=g.lastIndexOf("\\");-1<k&&(g=g.substring(k+1,g.length));var g=g.replace(/\ /g,"_"),k=d.objectToQuery({gdbVersion:this._featureLayer.gdbVersion,token:this._featureLayer._getToken()}),h=this._listHtml+this._deleteBtnHtml+this._endHtml;this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(h=this._listHtml+this._endHtml);a=y.substitute({href:this._featureLayer._url.path+"/"+a.objectId+"/attachments/"+a.attachmentId+
(k?"?"+k:""),name:g,oid:a.objectId,attid:a.attachmentId},h);b.innerHTML=b.innerHTML==this.NLS_none?a:b.innerHTML+a;this._updateConnects();f.value=""},_onAddAttachmentError:function(a){r.hide(this._attachmentProgress.domNode);if(a&&y.isDefined(a.code)){var b=this._attachmentError;q.set(b,"innerHTML",(400===a.code?this.NLS_fileNotSupported:a.message||a.details&&a.details.length&&a.details[0])||this.NLS_error);r.show(b)}},_onDeleteAttachmentComplete:function(a){r.hide(this._attachmentProgress.domNode);
var b=this._attachmentList;h.every(a,function(a){return a.success})&&(f.query("#node_"+a[0].objectId+"_"+a[0].attachmentId).orphan(),b.children&&b.children.length||(b.innerHTML=this.NLS_none))},_updateConnects:function(){h.forEach(this._aeConnects,b.disconnect);f.query(".deleteAttachment").forEach(function(d){this._aeConnects.push(b.connect(d,"onclick",a.hitch(this,"_deleteAttachment",this._oid,d.id)))},this)}});g("extend-esri")&&a.setObject("dijit.editing.AttachmentEditor",l,n);return l})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),
function(l,a,b,h,f,g,m,d){return a("dijit.ProgressBar",[g,m],{progress:"0",value:"",maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:d,_indeterminateHighContrastImagePath:l.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());
this.update()},_setDirAttr:function(a){var d="rtl"==a.toLowerCase();b.toggle(this.domNode,"dijitProgressBarRtl",d);b.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&d);this.inherited(arguments)},update:function(a){h.mixin(this,a||{});a=this.internalProgress;var d=this.domNode,f=1;this.indeterminate?d.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(f=Math.min(parseFloat(this.progress)/100,1),this.progress=f*this.maximum):(this.progress=Math.min(this.progress,
this.maximum),f=this.maximum?this.progress/this.maximum:0),d.setAttribute("aria-valuenow",this.progress));d.setAttribute("aria-labelledby",this.labelNode.id);d.setAttribute("aria-valuemin",0);d.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(f);b.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);b.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());a.style.width=100*f+"%";this.onChange()},_setValueAttr:function(a){this._set("value",
a);Infinity==a?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:a})},_setLabelAttr:function(a){this._set("label",a);this.update()},_setIndeterminateAttr:function(a){this._set("indeterminate",a);this.update()},report:function(a){return this.label?this.label:this.indeterminate?"\x26#160;":f.format(a,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"esri/dijit/editing/Util":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../../kernel"],
function(l,a,b,h){var f={},f={findFeatures:function(b,f,d){var g=f.objectIdField;f=a.filter(f.graphics,function(d){return a.some(b,function(a){return d.attributes[g]===a.objectId})});if(d)d(f);else return f},getSelection:function(b){var f=[];a.forEach(b,function(b){b=b.getSelectedFeatures();a.forEach(b,function(a){f.push(a)})});return f},sortFeaturesById:function(b,f){var d=a.map(b,function(a){return a.featureLayer});f.sort(function(b,f){var g=b.getLayer(),k=f.getLayer();if(!g)return-1;if(!k)return 1;
var h=a.indexOf(d,g),k=a.indexOf(d,k),h=h-k;h||(g=g.objectIdField,h=b.attributes[g]-f.attributes[g]);return h});return f}};b("extend-esri")&&l.setObject("dijit.editing.Util.LayerHelper",f,h);return f})},"dojox/date/islamic":function(){define(["dojox/main","dojo/_base/lang","dojo/date","./islamic/Date"],function(l,a,b,h){var f=a.getObject("date.islamic",!0,l);f.getDaysInMonth=function(a){return a.getDaysInIslamicMonth(a.getMonth(),a.getFullYear())};f.compare=function(a,f,d){a instanceof h&&(a=a.toGregorian());
f instanceof h&&(f=f.toGregorian());return b.compare.apply(null,arguments)};f.add=function(a,b,d){var f=new h(a);switch(b){case "day":f.setDate(a.getDate()+d);break;case "weekday":var g=a.getDay();if(5>g+d&&0<g+d)f.setDate(a.getDate()+d);else{var m=b=0;5==g?(g=4,m=0<d?-1:1):6==g&&(g=4,m=0<d?-2:2);var g=0<d?5-g-1:-g,k=d-g,n=parseInt(k/5);0!=k%5&&(b=0<d?2:-2);b=b+7*n+k%5+g;f.setDate(a.getDate()+b+m)}break;case "year":f.setFullYear(a.getFullYear()+d);break;case "week":d*=7;f.setDate(a.getDate()+d);break;
case "month":a=a.getMonth();f.setMonth(a+d);break;case "hour":f.setHours(a.getHours()+d);break;case "minute":f._addMinutes(d);break;case "second":f._addSeconds(d);break;case "millisecond":f._addMilliseconds(d)}return f};f.difference=function(a,b,d){b=b||new h;d=d||"day";var g=b.getFullYear()-a.getFullYear(),m=1;switch(d){case "weekday":g=Math.round(f.difference(a,b,"day"));m=parseInt(f.difference(a,b,"week"));if(0==g%7)g=5*m;else{d=0;var l=a.getDay(),k=b.getDay(),m=parseInt(g/7);b=g%7;a=new h(a);
a.setDate(a.getDate()+7*m);a=a.getDay();if(0<g)switch(!0){case 5==l:d=-1;break;case 6==l:d=0;break;case 5==k:d=-1;break;case 6==k:d=-2;break;case 5<a+b:d=-2}else if(0>g)switch(!0){case 5==l:d=0;break;case 6==l:d=1;break;case 5==k:d=2;break;case 6==k:d=1;break;case 0>a+b:d=2}g=g+d-2*m}m=g;break;case "year":m=g;break;case "month":d=b.toGregorian()>a.toGregorian()?b:a;l=b.toGregorian()>a.toGregorian()?a:b;m=d.getMonth();k=l.getMonth();if(0==g)m=d.getMonth()-l.getMonth();else for(m=12-k+m,g=l.getFullYear()+
1,d=d.getFullYear(),g;g<d;g++)m+=12;b.toGregorian()<a.toGregorian()&&(m=-m);break;case "week":m=parseInt(f.difference(a,b,"day")/7);break;case "day":m/=24;case "hour":m/=60;case "minute":m/=60;case "second":m/=1E3;case "millisecond":m*=b.toGregorian().getTime()-a.toGregorian().getTime()}return Math.round(m)};return f})},"dojox/date/islamic/Date":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/date"],function(l,a,b){var h=a("dojox.date.islamic.Date",null,{_date:0,_month:0,_year:0,_hours:0,
_minutes:0,_seconds:0,_milliseconds:0,_day:0,_GREGORIAN_EPOCH:1721425.5,_ISLAMIC_EPOCH:1948439.5,constructor:function(){var a=arguments.length;a?1==a?(a=arguments[0],"number"==typeof a&&(a=new Date(a)),a instanceof Date?this.fromGregorian(a):""==a?this._date=new Date(""):(this._year=a._year,this._month=a._month,this._date=a._date,this._hours=a._hours,this._minutes=a._minutes,this._seconds=a._seconds,this._milliseconds=a._milliseconds)):3<=a&&(this._year+=arguments[0],this._month+=arguments[1],this._date+=
arguments[2],this._hours+=arguments[3]||0,this._minutes+=arguments[4]||0,this._seconds+=arguments[5]||0,this._milliseconds+=arguments[6]||0):this.fromGregorian(new Date)},getDate:function(){return this._date},getMonth:function(){return this._month},getFullYear:function(){return this._year},getDay:function(){return this.toGregorian().getDay()},getHours:function(){return this._hours},getMinutes:function(){return this._minutes},getSeconds:function(){return this._seconds},getMilliseconds:function(){return this._milliseconds},
setDate:function(a){a=parseInt(a);if(!(0<a&&a<=this.getDaysInIslamicMonth(this._month,this._year))){var b;if(0<a)for(b=this.getDaysInIslamicMonth(this._month,this._year);a>b;a-=b,b=this.getDaysInIslamicMonth(this._month,this._year))this._month++,12<=this._month&&(this._year++,this._month-=12);else for(b=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:this._year-1);0>=a;b=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:
this._year-1))this._month--,0>this._month&&(this._year--,this._month+=12),a+=b}this._date=a;return this},setFullYear:function(a){this._year=+a},setMonth:function(a){this._year+=Math.floor(a/12);this._month=0<a?Math.floor(a%12):Math.floor((a%12+12)%12)},setHours:function(){var a=arguments.length,b=0;1<=a&&(b=parseInt(arguments[0]));2<=a&&(this._minutes=parseInt(arguments[1]));3<=a&&(this._seconds=parseInt(arguments[2]));4==a&&(this._milliseconds=parseInt(arguments[3]));for(;24<=b;)this._date++,a=this.getDaysInIslamicMonth(this._month,
this._year),this._date>a&&(this._month++,12<=this._month&&(this._year++,this._month-=12),this._date-=a),b-=24;this._hours=b},_addMinutes:function(a){a+=this._minutes;this.setMinutes(a);this.setHours(this._hours+parseInt(a/60));return this},_addSeconds:function(a){a+=this._seconds;this.setSeconds(a);this._addMinutes(parseInt(a/60));return this},_addMilliseconds:function(a){a+=this._milliseconds;this.setMilliseconds(a);this._addSeconds(parseInt(a/1E3));return this},setMinutes:function(a){this._minutes=
a%60;return this},setSeconds:function(a){this._seconds=a%60;return this},setMilliseconds:function(a){this._milliseconds=a%1E3;return this},toString:function(){if(isNaN(this._date))return"Invalidate Date";var a=new Date;a.setHours(this._hours);a.setMinutes(this._minutes);a.setSeconds(this._seconds);a.setMilliseconds(this._milliseconds);return this._month+" "+this._date+" "+this._year+" "+a.toTimeString()},toGregorian:function(){var a=this._year,a=Math.floor(this._date+Math.ceil(29.5*this._month)+354*
(a-1)+Math.floor((3+11*a)/30)+this._ISLAMIC_EPOCH-1-.5)+.5,g=a-this._GREGORIAN_EPOCH,h=Math.floor(g/146097),d=this._mod(g,146097),g=Math.floor(d/36524),l=this._mod(d,36524),d=Math.floor(l/1461),l=this._mod(l,1461),l=Math.floor(l/365),h=400*h+100*g+4*d+l;4!=g&&4!=l&&h++;g=a-(this._GREGORIAN_EPOCH+365*(h-1)+Math.floor((h-1)/4)-Math.floor((h-1)/100)+Math.floor((h-1)/400));d=this._GREGORIAN_EPOCH-1+365*(h-1)+Math.floor((h-1)/4)-Math.floor((h-1)/100)+Math.floor((h-1)/400)+Math.floor(739/12+(b.isLeapYear(new Date(h,
3,1))?-1:-2)+1);d=a<d?0:b.isLeapYear(new Date(h,3,1))?1:2;g=Math.floor((12*(g+d)+373)/367);d=this._GREGORIAN_EPOCH-1+365*(h-1)+Math.floor((h-1)/4)-Math.floor((h-1)/100)+Math.floor((h-1)/400)+Math.floor((367*g-362)/12+(2>=g?0:b.isLeapYear(new Date(h,g-1,1))?-1:-2)+1);return new Date(h,g-1,a-d+1,this._hours,this._minutes,this._seconds,this._milliseconds)},fromGregorian:function(a){a=new Date(a);var f=a.getFullYear(),h=a.getMonth(),d=a.getDate(),f=this._GREGORIAN_EPOCH-1+365*(f-1)+Math.floor((f-1)/4)+
-Math.floor((f-1)/100)+Math.floor((f-1)/400)+Math.floor((367*(h+1)-362)/12+(2>=h+1?0:b.isLeapYear(a)?-1:-2)+d),f=Math.floor(f)+.5,f=f-this._ISLAMIC_EPOCH,h=Math.floor((30*f+10646)/10631),d=Math.ceil((f-29-this._yearStart(h))/29.5),d=Math.min(d,11);this._date=Math.ceil(f-this._monthStart(h,d))+1;this._month=d;this._year=h;this._hours=a.getHours();this._minutes=a.getMinutes();this._seconds=a.getSeconds();this._milliseconds=a.getMilliseconds();this._day=a.getDay();return this},valueOf:function(){return this.toGregorian().valueOf()},
_yearStart:function(a){return 354*(a-1)+Math.floor((3+11*a)/30)},_monthStart:function(a,b){return Math.ceil(29.5*b)+354*(a-1)+Math.floor((3+11*a)/30)},_civilLeapYear:function(a){return 11>(14+11*a)%30},getDaysInIslamicMonth:function(a,b){var f=0,f=29+(a+1)%2;11==a&&this._civilLeapYear(b)&&f++;return f},_mod:function(a,b){return a-b*Math.floor(a/b)}});h.getDaysInIslamicMonth=function(a){return(new h).getDaysInIslamicMonth(a.getMonth(),a.getFullYear())};return h})},"dojox/date/islamic/locale":function(){define("dojox/main dojo/_base/lang dojo/_base/array dojo/date dojo/i18n dojo/regexp dojo/string ./Date dojo/i18n!dojo/cldr/nls/islamic".split(" "),
function(l,a,b,h,f,g,m,d,q){function u(a,b,d,f,g){return g.replace(/([a-z])\1*/ig,function(d){var f,k,n=d.charAt(0);d=d.length;var l=["abbr","wide","narrow"];switch(n){case "G":f=b.eraAbbr[0];break;case "y":f=String(a.getFullYear());break;case "M":f=a.getMonth();3>d?(f+=1,k=!0):(n=["months-format",l[d-3]].join("-"),f=b[n][f]);break;case "d":f=a.getDate(!0);k=!0;break;case "E":f=a.getDay();3>d?(f+=1,k=!0):(n=["days-format",l[d-3]].join("-"),f=b[n][f]);break;case "a":f=12>a.getHours()?"am":"pm";f=b["dayPeriods-format-wide-"+
f];break;case "h":case "H":case "K":case "k":k=a.getHours();switch(n){case "h":f=k%12||12;break;case "H":f=k;break;case "K":f=k%12;break;case "k":f=k||24}k=!0;break;case "m":f=a.getMinutes();k=!0;break;case "s":f=a.getSeconds();k=!0;break;case "S":f=Math.round(a.getMilliseconds()*Math.pow(10,d-3));k=!0;break;case "z":if(f=h.getTimezoneName(a.toGregorian()))break;d=4;case "Z":f=a.toGregorian().getTimezoneOffset();f=[0>=f?"+":"-",m.pad(Math.floor(Math.abs(f)/60),2),m.pad(Math.abs(f)%60,2)];4==d&&(f.splice(0,
0,"GMT"),f.splice(3,0,":"));f=f.join("");break;default:throw Error("dojox.date.islamic.locale.formatPattern: invalid pattern char: "+g);}k&&(f=m.pad(f,d));return f})}function p(a,d,f,g){var k=function(a){return a};d=d||k;f=f||k;g=g||k;var h=a.match(/(''|[^'])+/g),n="'"==a.charAt(0);b.forEach(h,function(a,b){a?(h[b]=(n?f:d)(a),n=!n):h[b]=""});return g(h.join(""))}function k(a,b,d,k){k=g.escapeString(k);f.normalizeLocale(d.locale);return k.replace(/([a-z])\1*/ig,function(f){var g;g=f.charAt(0);var k=
f.length,h="";d.strict?1<k&&(h="0{"+(k-1)+"}"):h="0?";switch(g){case "y":g="\\d+";break;case "M":g=2<k?"\\S+ ?\\S+":h+"[1-9]|1[0-2]";break;case "d":g="[12]\\d|"+h+"[1-9]|3[01]";break;case "E":g="\\S+";break;case "h":g=h+"[1-9]|1[0-2]";break;case "k":g=h+"\\d|1[01]";break;case "H":g=h+"\\d|1\\d|2[0-3]";break;case "K":g=h+"[1-9]|1\\d|2[0-4]";break;case "m":case "s":g=h+"\\d|[0-5]\\d";break;case "S":g="\\d{"+k+"}";break;case "a":k=d.am||b["dayPeriods-format-wide-am"];h=d.pm||b["dayPeriods-format-wide-pm"];
d.strict?g=k+"|"+h:(g=k+"|"+h,k!=k.toLowerCase()&&(g+="|"+k.toLowerCase()),h!=h.toLowerCase()&&(g+="|"+h.toLowerCase()));break;default:g=".*"}a&&a.push(f);return"("+g+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var n=a.getObject("date.islamic.locale",!0,l);n.format=function(b,d){d=d||{};var g=f.normalizeLocale(d.locale),k=d.formatLength||"short",h=n._getIslamicBundle(g),m=[],g=a.hitch(this,u,b,h,g,d.fullYear);if("year"==d.selector)return b.getFullYear();"time"!=d.selector&&(b=d.datePattern||h["dateFormat-"+
k])&&m.push(p(b,g));"date"!=d.selector&&(d=d.timePattern||h["timeFormat-"+k])&&m.push(p(d,g));return m.join(" ")};n.regexp=function(a){return n._parseInfo(a).regexp};n._parseInfo=function(b){b=b||{};var d=f.normalizeLocale(b.locale),d=n._getIslamicBundle(d),g=b.formatLength||"short",h=b.datePattern||d["dateFormat-"+g],g=b.timePattern||d["timeFormat-"+g],m=[];return{regexp:p("date"==b.selector?h:"time"==b.selector?g:"undefined"==typeof g?h:h+" "+g,a.hitch(this,k,m,d,b)),tokens:m,bundle:d}};n.parse=
function(a,g){a=a.replace(/[\u200E\u200F\u202A\u202E]/g,"");g||(g={});var k=n._parseInfo(g),h=k.tokens,m=k.bundle,k=k.regexp.replace(/[\u200E\u200F\u202A\u202E]/g,"");a=(new RegExp("^"+k+"$")).exec(a);f.normalizeLocale(g.locale);if(!a)return null;var l=[1389,0,1,0,0,0,0],r="",q=["abbr","wide","narrow"];b.every(a,function(a,d){if(!d)return!0;d=h[d-1];var f=d.length;switch(d.charAt(0)){case "y":l[0]=Number(a);break;case "M":if(2<f){if(d=m["months-format-"+q[f-3]].concat(),g.strict||(a=a.replace(".",
"").toLowerCase(),d=b.map(d,function(a){return a?a.replace(".","").toLowerCase():a})),a=b.indexOf(d,a),-1==a)return!1}else a--;l[1]=Number(a);break;case "D":l[1]=0;case "d":l[2]=Number(a);break;case "a":d=g.am||m["dayPeriods-format-wide-am"];f=g.pm||m["dayPeriods-format-wide-pm"];if(!g.strict){var k=/\./g;a=a.replace(k,"").toLowerCase();d=d.replace(k,"").toLowerCase();f=f.replace(k,"").toLowerCase()}if(g.strict&&a!=d&&a!=f)return!1;r=a==f?"p":a==d?"a":"";break;case "K":24==a&&(a=0);case "h":case "H":case "k":l[3]=
Number(a);break;case "m":l[4]=Number(a);break;case "s":l[5]=Number(a);break;case "S":l[6]=Number(a)}return!0});a=+l[3];"p"===r&&12>a?l[3]=a+12:"a"===r&&12==a&&(l[3]=0);return new d(l[0],l[1],l[2],l[3],l[4],l[5],l[6])};var y=[];n.addCustomFormats=function(a,b){y.push({pkg:a,name:b})};n._getIslamicBundle=function(d){var g={};b.forEach(y,function(b){b=f.getLocalization(b.pkg,b.name,d);g=a.mixin(g,b)},this);return g};n.addCustomFormats("dojo.cldr","islamic");n.getNames=function(a,b,d,f,g){var k;f=n._getIslamicBundle(f);
a=[a,d,b];"standAlone"==d&&(d=a.join("-"),k=f[d],1==k[0]&&(k=void 0));a[1]="format";return(k||f[a.join("-")]).concat()};n.weekDays=n.getNames("days","wide","format");n.months=n.getNames("months","wide","format");return n})},"widgets/ParcelDrafter/geometryUtils":function(){define("esri/geometry/Point esri/geometry/Polyline esri/geometry/Polygon esri/geometry/webMercatorUtils dojo/Deferred dojo/_base/array dojo/_base/lang esri/geometry/geometryEngine esri/SpatialReference esri/geometry/scaleUtils".split(" "),
function(l,a,b,h,f,g,m,d,q,u){var p={canProjectLocally:function(a){a=new l({x:0,y:0,spatialReference:a});return h.canProject(a,new q(4326))?!0:!1},getProjectedGeometry:function(a,b,d){var g,k;g=new f;h.canProject(a,b)?(k=h.project(a,b),g.resolve(k)):d.project([a],b,function(a){k=a[0];g.resolve(k)});return g.promise},getDestinationPoint:function(a,b,d){var f=a.x*Math.PI/180,g=b*Math.PI/180;b=Math.sin(g);var g=Math.cos(g),k=.9966471893352243*Math.tan(a.y*Math.PI/180);a=1/Math.sqrt(1+k*k);var h=k*a,
n=Math.atan2(k,g),k=a*b,m=1-k*k,p=2.7233160610984375E11*m/4.040829998465916E13,u=1+p/16384*(4096+p*(-768+p*(320-175*p))),G=p/1024*(256+p*(-128+p*(74-47*p))),y,H,w,B=d/(6356752.314245*u),D,J=0;do p=Math.cos(2*n+B),y=Math.sin(B),H=Math.cos(B),w=G*y*(p+G/4*(H*(-1+2*p*p)-G/6*p*(-3+4*y*y)*(-3+4*p*p))),D=B,B=d/(6356752.314245*u)+w;while(1E-12<Math.abs(B-D)&&200>++J);if(200<=J)return console.log("Formula failed to converge"),null;d=h*y-a*H*g;d=Math.atan2(h*H+a*y*g,.9966471893352243*Math.sqrt(k*k+d*d));m=
2.0955066654848088E-4*m*(4+.003352810664775694*(4-3*m));f=(f+(Math.atan2(y*b,a*H-h*y*g)-.003352810664775694*(1-m)*k*(B+m*y*(p+m*H*(-1+2*p*p))))+3*Math.PI)%(2*Math.PI)-Math.PI;d=180*d/Math.PI;f=180*f/Math.PI;return new l(f,d,new q(4326))},getInverseCalculations:function(a,b){var d=b.x*Math.PI/180-a.x*Math.PI/180,f=.9966471893352243*Math.tan(a.y*Math.PI/180);a=1/Math.sqrt(1+f*f);var f=f*a,g=.9966471893352243*Math.tan(b.y*Math.PI/180);b=1/Math.sqrt(1+g*g);var g=g*b,k,h,m,n,l,p,q,u,H,w=d,B,D=0;do{k=Math.sin(w);
h=Math.cos(w);m=b*k*b*k+(a*g-f*b*h)*(a*g-f*b*h);m=Math.sqrt(m);if(0==m)return{distance:0,initialBearing:0,finalBearing:0};n=f*g+a*b*h;l=Math.atan2(m,n);p=a*b*k/m;q=1-p*p;u=n-2*f*g/q;isNaN(u)&&(u=0);H=2.0955066654848088E-4*q*(4+.003352810664775694*(4-3*q));B=w;w=d+.003352810664775694*(1-H)*p*(l+H*m*(u+H*n*(-1+2*u*u)))}while(1E-12<Math.abs(w-B)&&200>++D);if(200<=D)return null;w=2.7233160610984375E11*q/4.040829998465916E13;D=w/1024*(256+w*(-128+w*(74-47*w)));d=Math.atan2(b*k,a*g-f*b*h);a=Math.atan2(a*
k,-f*b+a*g*h);d=(d+2*Math.PI)%(2*Math.PI);a=(a+2*Math.PI)%(2*Math.PI);f=Number((6356752.314245*(1+w/16384*(4096+w*(-768+w*(320-175*w))))*(l-D*m*(u+D/4*(n*(-1+2*u*u)-D/6*u*(-3+4*m*m)*(-3+4*u*u))))).toFixed(3));d=180*d/Math.PI;a=180*a/Math.PI;return{distance:f,initialBearing:d,finalBearing:a}},getLineBetweenPoints:function(b){var d,f=[];g.forEach(b,m.hitch(this,function(a){f.push([p.removeNegativeExponents(a.x),p.removeNegativeExponents(a.y)])}));0<f.length&&(d=new a({paths:[f],spatialReference:{wkid:4326}}));
return d},getAngleBetweenPoints:function(a,b){a=p.getInverseCalculations(a,b);return null===a?0:a.initialBearing},getDistanceBetweenPoints:function(a,b){a=p.getInverseCalculations(a,b);return null===a?0:a.distance},getLengthOfGeometry:function(a){return(a=d.simplify(a))?d.geodesicLength(a,9001):0},getAreaOfGeometry:function(a){var b;a=d.simplify(a);b={};a?(b.acres=d.geodesicArea(a,109402),b.squareMeters=d.geodesicArea(a,109404),b.squareFeet=d.geodesicArea(a,109405),b.squareUSSurveyFeet=d.geodesicArea(a,
109406)):(b.acres=0,b.squareMeters=0,b.squareFeet=0,b.squareUSSurveyFeet=0);return b},getPolyLineFromPaths:function(b){var d,f;d=new a(new q({wkid:4326}));for(f=0;f<b.length;f++)d.addPath(b[f]);return d},getPolygonFromPolyLines:function(a,d,f,g){var h,k,l;h=[];g=g?new b(new q(g)):new b(new q({wkid:4326}));for(k=0;k<a.length;k++)for(l=0;l<a[k].length;l++)h.push(a[k][l]);d?h.push(m.clone(h[0])):f&&(h[h.length-1][0]=h[0][0],h[h.length-1][1]=h[0][1]);g.isClockwise(h)||h.reverse();g.addRing(h);return g},
getPointsForArc:function(a,b,d,f){var g,h=[],k,m;g=b-a;b=parseInt(g,10);0>=b&&(b=1);k=Math.abs(g)/Math.abs(b);if(0<k)for(g=0;g<Math.abs(b)+1;g++)m=a+k*g,(m=p.getDestinationPoint(d,m,Math.abs(f)))&&h.push(m);return h},getArcParam:function(a){var b;b={};0>a.distance?0>a.radius?(b.bearing=a.initBearing+90,b.centerPoint=p.getDestinationPoint(a.chordMidPoint,b.bearing,a.centerAndChordDistance),b.startAngle=p.getAngleBetweenPoints(b.centerPoint,a.chordEndPoint),b.endAngle=p.getAngleBetweenPoints(b.centerPoint,
a.chordStartPoint)):(b.bearing=a.initBearing-90,b.centerPoint=p.getDestinationPoint(a.chordMidPoint,b.bearing,a.centerAndChordDistance),b.startAngle=p.getAngleBetweenPoints(b.centerPoint,a.chordStartPoint),b.endAngle=p.getAngleBetweenPoints(b.centerPoint,a.chordEndPoint)):0<a.radius?(b.bearing=a.initBearing+90,b.centerPoint=p.getDestinationPoint(a.chordMidPoint,b.bearing,a.centerAndChordDistance),b.startAngle=p.getAngleBetweenPoints(b.centerPoint,a.chordStartPoint),b.endAngle=p.getAngleBetweenPoints(b.centerPoint,
a.chordEndPoint)):(b.bearing=a.initBearing-90,b.centerPoint=p.getDestinationPoint(a.chordMidPoint,b.bearing,a.centerAndChordDistance),b.startAngle=p.getAngleBetweenPoints(b.centerPoint,a.chordEndPoint),b.endAngle=p.getAngleBetweenPoints(b.centerPoint,a.chordStartPoint));return b},removeNegativeExponents:function(a){return 1<a.toString().toLowerCase().split("e-").length?0:a},getChordLengthFromArcLength:function(a,b){var d;a=Math.abs(a);d=Math.PI*Math.abs(b);b=Math.abs(b)*Math.sin(Math.abs(a)/Math.abs(b)/
2);return a<=d?2*b:-2*b},getArcLengthFromChordLength:function(a,b){var d;d=Math.abs(a);b=Math.abs(b);d=2*Math.asin(d/(2*b))*b;0>a&&(d=2*Math.PI*b-d);return d},chordBearingToTangentBearing:function(a,b,d){var f;f=180/Math.PI*Math.acos(Math.abs(d)/2/Math.abs(b));b/=Math.abs(b);a=a+90*b-d/Math.abs(d)*b*f;return p.removeNegativeExponents(0>a?a+360:360<=a?a%360:a)},tangentBearingToChordBearing:function(a,b,d){var f;f=180/Math.PI*Math.acos(Math.abs(d)/2/Math.abs(b));b/=Math.abs(b);a=a+90*b-d/Math.abs(d)*
b*f;return p.removeNegativeExponents(0>a?a+360:360<=a?a%360:a)},getUnitValueForSR:function(a){switch(u.getUnitValueForSR(a)){case 1:return"meters";case 111194.87428468118:return"meters";case .3048:return"feet";case .3048006096:case .3048006096012192:return"uSSurveyFeet"}},getRotationAngleBetweenPoints:function(a,b){var d,f;a=h.project(a,new q(102100));b=h.project(b,new q(102100));d=b.x-a.x;a=b.y-a.y;b=180*Math.atan2(Math.abs(d),Math.abs(a))/Math.PI;f=180*Math.atan2(Math.abs(a),Math.abs(d))/Math.PI;
d=p.removeNegativeExponents(d);a=p.removeNegativeExponents(a);b=p.removeNegativeExponents(b);f=p.removeNegativeExponents(f);if(0===a){if(0===d)return 0;if(0<d)return 90;if(0>d)return 270}else if(0<a){if(0===d)return 0;if(0<d)return b;if(0>d)return 270+f}else if(0>a){if(0===d)return 180;if(0<d)return 90+f;if(0>d)return 180+b}},getScaleDistanceBetweenPoints:function(a,b){a=h.project(a,new q(102100));b=h.project(b,new q(102100));a=d.distance(a,b,9001);return p.removeNegativeExponents(a)}};return p})},
"widgets/ParcelDrafter/MapTooltipHandler":function(){define("dojo/_base/declare dijit/_WidgetBase dojo/_base/lang dojo/Evented dojo/dom-style dojo/dom-construct dojo/on".split(" "),function(l,a,b,h,f,g,m){return l([a,h],{baseClass:"jimu-widget-ParcelDrafter-MapTooltipHandler",map:null,handleClickFor:null,_mapTooltip:null,_mapMoveHandler:null,_mapClickHandler:null,_mouseDragHandler:null,constructor:function(a){b.mixin(this,a)},startup:function(){this.handleClickFor||(this.handleClickFor=this.map);
this._createTooltip()},connectEventHandler:function(a){a&&this.updateTooltip(a);this._disableWebMapPopup();this._mapClickHandler=this.own(m(this.handleClickFor,"click",b.hitch(this,function(a){this._clicked(a)})))[0];"ontouchstart"in document.documentElement?f.set(this._mapTooltip,"display","none"):(this._mapMoveHandler=this.own(this.map.on("mouse-move",b.hitch(this,this._onMapMouseMove)))[0],this.own(this.map.on("mouse-out",b.hitch(this,function(){f.set(this._mapTooltip,"display","none")}))))},disconnectEventHandler:function(){this._enableWebMapPopup();
this._mapClickHandler&&this._mapClickHandler.remove();this._mapMoveHandler&&(this._mapMoveHandler.remove(),this._mapTooltip.style.display="none");this.disconnectMouseDragHandler()},connectMouseDragHandler:function(a){a&&this.updateTooltip(a);this._disableWebMapPopup();this._mapClickHandler&&this._mapClickHandler.remove();this.map.disableMapNavigation();this._mouseDragHandler=this.own(this.map.on("mouse-drag",b.hitch(this,function(a){this._onDragging(a)})))[0]},disconnectMouseDragHandler:function(){this._mouseDragHandler&&
(this._mouseDragHandler.remove(),this._mapTooltip.style.display="none");this.map.enableMapNavigation()},_createTooltip:function(){this._mapTooltip=g.create("div",{"class":"esriCTMapTooltip",innerHTML:this.toolTipText},this.map.container);f.set(this._mapTooltip,"position","fixed");f.set(this._mapTooltip,"display","none")},_enableWebMapPopup:function(){this.map&&(this.map.infoWindow.hide(),this.map.setInfoWindowOnClick(!0))},_disableWebMapPopup:function(){this.map&&(this.map.infoWindow.hide(),this.map.setInfoWindowOnClick(!1))},
_onMapMouseMove:function(a){var b,d;a.clientX||a.pageY?(b=a.clientX,d=a.clientY):(b=a.clientX+document.body.scrollLeft-document.body.clientLeft,d=a.clientY+document.body.scrollTop-document.body.clientTop);f.set(this._mapTooltip,"display","none");f.set(this._mapTooltip,{left:b+15+"px",top:d+"px"});f.set(this._mapTooltip,"display","");this._onMoving(a)},_clicked:function(a){this.emit("clicked",a)},_onDragging:function(a){this.emit("dragging",a)},_onMoving:function(a){this.emit("moving",a)},updateTooltip:function(a){this.toolTipText=
a;this._mapTooltip.innerHTML=this.toolTipText}})})},"widgets/ParcelDrafter/layerUtils":function(){define(["dojo/_base/declare","dijit/_WidgetBase","dojo/_base/array","dojo/_base/lang"],function(l,a,b,h){return l([a],{map:null,getPopupInfo:!0,getRenderer:!0,postCreate:function(){},getLayerDetailsFromMap:function(a,g,m){var d={},f;this.map&&this.map.webMapResponse&&this.map.webMapResponse.itemInfo&&this.map.webMapResponse.itemInfo.itemData&&this.map.webMapResponse.itemInfo.itemData.operationalLayers&&
b.forEach(this.map.webMapResponse.itemInfo.itemData.operationalLayers,h.hitch(this,function(l){l.layerObject&&("ArcGISMapServiceLayer"===l.layerType||"ArcGISTiledMapServiceLayer"===l.layerType?(f=m&&m.substring(0,m.lastIndexOf("_")),f&&l.id!==f||(d.isMapServer=!0,a.substring(0,a.length-1)===l.url&&(b.forEach(l.resourceInfo.layers,h.hitch(this,function(a){a.id===parseInt(g,10)&&(d.title=a.name)})),b.forEach(l.layers,h.hitch(this,function(a){a.id===parseInt(g,10)&&(a.name&&(d.title=a.name),this.getPopupInfo&&
(d.popupInfo=a.popupInfo),a.layerDefinition&&(a.layerDefinition.definitionExpression&&(d.definitionExpression=a.layerDefinition.definitionExpression),this.getRenderer&&a.layerDefinition.drawingInfo&&a.layerDefinition.drawingInfo.renderer&&(d.renderer=a.layerDefinition.drawingInfo.renderer)))}))))):m&&l.id!==m||l.url.replace(/.*?:\/\//g,"").toLowerCase()!==(a+g).replace(/.*?:\/\//g,"").toLowerCase()||l.id!==m||(d.isMapServer=!1,d.title=l.title,this.getPopupInfo&&(d.popupInfo=l.popupInfo),l.layerDefinition&&
(l.layerDefinition.definitionExpression&&(d.definitionExpression=l.layerDefinition.definitionExpression),this.getRenderer&&l.layerDefinition.drawingInfo&&l.layerDefinition.drawingInfo.renderer&&(d.renderer=l.layerDefinition.drawingInfo.renderer))))}));return d}})})},"widgets/ParcelDrafter/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:widgets/ParcelDrafter/PlanSettings.html":'\x3cdiv\x3e\r\n    \x3c!-- Direction or Angle Type Selector --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis" title\x3d"${nls.planSettings.directionOrAngleTypeLabel}"\r\n        data-a11y-label-id\x3d"directionOrAngleTypeLabel"\x3e\r\n            ${nls.planSettings.directionOrAngleTypeLabel}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"directionOrAngleType" style\x3d"width: 100%" data-dojo-type\x3d"jimu/dijit/formSelect"\r\n        data-a11y-label-by\x3d"directionOrAngleTypeLabel"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Direction or Angle Units Selector --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis" title\x3d"${nls.planSettings.directionOrAngleUnitsLabel}"\r\n        data-a11y-label-id\x3d"directionOrAngleUnitsLabel"\x3e\r\n            ${nls.planSettings.directionOrAngleUnitsLabel}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"directionOrAngleUnits" style\x3d"width: 100%" data-dojo-type\x3d"jimu/dijit/formSelect"\r\n        data-a11y-label-by\x3d"directionOrAngleUnitsLabel"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Distance and Length Units Selector --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis" title\x3d"${nls.planSettings.distanceAndLengthUnitsLabel}"\r\n        data-a11y-label-id\x3d"distanceAndLengthUnitsLabel"\x3e\r\n            ${nls.planSettings.distanceAndLengthUnitsLabel}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"distanceAndLengthUnits" style\x3d"width: 100%" data-dojo-type\x3d"jimu/dijit/formSelect"\r\n        data-a11y-label-by\x3d"distanceAndLengthUnitsLabel"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Area Units Selector--\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis" title\x3d"${nls.planSettings.areaUnitsLabel}"\r\n        data-a11y-label-id\x3d"areaUnitsLabel"\x3e\r\n            ${nls.planSettings.areaUnitsLabel}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"areaUnits" style\x3d"width: 100%" data-dojo-type\x3d"jimu/dijit/formSelect"\r\n        data-a11y-label-by\x3d"areaUnitsLabel"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Circular Curve Parameters Selector --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow"\x3e\r\n        \x3cdiv class\x3d"esriCTDropdownLabel esriCTEllipsis " title\x3d"${nls.planSettings.circularCurveParameters}"\r\n        data-a11y-label-id\x3d"circularCurveParameters"\x3e\r\n            ${nls.planSettings.circularCurveParameters}\x3c/div\x3e\r\n        \x3cselect data-dojo-attach-point\x3d"circularCurveParameters" style\x3d"width: 100%" data-dojo-type\x3d"jimu/dijit/formSelect"\r\n        data-a11y-label-by\x3d"circularCurveParameters"\x3e\r\n        \x3c/select\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/XYInput.html":'\x3cdiv class\x3d"esriCTAlignCenter" data-dojo-attach-point\x3d"newTraverseXYInputNode"\x3e\r\n  \x3cdiv class\x3d"xyRowWrapper" data-dojo-attach-point\x3d"xRowWrapper"\x3e\r\n    X:\r\n    \x3cdiv data-dojo-attach-point\x3d"newTraverseX" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n      data-dojo-props\x3d"intermediateChanges:true,regExp:\'^[+-]?\\\\d+(\\\\.\\\\d+)?$\'" trim\x3d"true" required\x3d"true"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"xyRowWrapper" data-dojo-attach-point\x3d"yRowWrapper"\x3e\r\n    Y:\r\n    \x3cdiv data-dojo-attach-point\x3d"newTraverseY" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n      data-dojo-props\x3d"intermediateChanges:true,regExp:\'^[+-]?\\\\d+(\\\\.\\\\d+)?$\'" trim\x3d"true" required\x3d"true"\x3e\x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"jimu-btn jimu-trailing-margin1 jimu-state-disabled" title\x3d"${nls.newTraverseButtonLabel}"\r\n    data-dojo-attach-point\x3d"xyStartButton" tabindex\x3d"-1" role\x3d"button" aria-label\x3d"${nls.newTraverseButtonLabel}"\x3e\r\n    ${nls.newTraverseButtonLabel}\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/NewTraverse.html":'\x3cdiv\x3e\r\n    \x3c!-- Traverse grid container--\x3e\r\n    \x3cdiv class\x3d"esriCTNewTraverseContainer"\x3e\r\n        \x3c!-- Traverse grid title--\x3e\r\n        \x3cdiv class\x3d"esriCTNewTraverseLabelDiv"\x3e\r\n            \x3cdiv class\x3d"esriCTGridEmptyLabel"\x3e\r\n                \x26nbsp\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTGridLabels esriCTEllipsis esriCTGridBearingLabel" title\x3d"${nls.traverseSettings.bearingLabel}"\x3e\r\n                ${nls.traverseSettings.bearingLabel}\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTGridLabels esriCTEllipsis" title\x3d"${nls.traverseSettings.lengthLabel}"\x3e\r\n                ${nls.traverseSettings.lengthLabel}\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTGridLabels esriCTEllipsis" title\x3d"${nls.traverseSettings.radiusLabel}"\x3e\r\n                ${nls.traverseSettings.radiusLabel}\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Traverse grid items--\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"traverseGrid" class\x3d"esriCTTraverseGrid"\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Traverse grid initial entry row--\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"traverseEntryNode" class\x3d"esriCTEntrtyNodeContent esriCTRow"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"lineSymbolNode" class\x3d"esriCTSymbolContainer"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"bearingNode" class\x3d"esriCTBearingRow" data-dojo-type\x3d"dijit/form/ValidationTextBox" aria-label\x3d"${nls.traverseSettings.bearingLabel}"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"lengthNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" aria-label\x3d"${nls.traverseSettings.lengthLabel}"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"radiusNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" aria-label\x3d"${nls.traverseSettings.radiusLabel}"\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTAddRow"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"addButton" class\x3d"esriCTAddIcon"\r\n                title\x3d"${nls.traverseSettings.addButtonTitle}" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.traverseSettings.addButtonTitle}"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Traverse grid tools container--\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseTool"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseToolContainer"\x3e\r\n                \x3c!-- Update rotation point tool--\x3e\r\n                \x3cdiv class\x3d"esriCTTraverseToolIcons ecriCTUpdateRotationPointIcon esriCTCursorPointer" title\x3d"${nls.planSettings.updateRotationPointTooltipText}"\r\n                    data-dojo-attach-point\x3d"updateRotationPointNode" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.planSettings.updateRotationPointTooltipText}" aria-pressed\x3d"false"\x3e\r\n                \x3c/div\x3e\r\n                \x3c!-- Screen digitization tool--\x3e\r\n                \x3cdiv class\x3d"esriCTTraverseToolIcons ecriCTLocationIcon esriCTCursorPointer" title\x3d"${nls.planSettings.onScreenDigitizationTooltipText}"\r\n                    data-dojo-attach-point\x3d"screenDigitizationNode" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.planSettings.onScreenDigitizationTooltipText}" aria-pressed\x3d"false"\x3e\r\n                \x3c/div\x3e\r\n                \x3c!-- Zoom tool--\x3e\r\n                \x3cdiv class\x3d"esriCTHidden esriCTTraverseToolIcons ecriCTZoomToIcon esriCTCursorPointer" title\x3d"${nls.planSettings.zoomToLocationTooltipText}"\r\n                    data-dojo-attach-point\x3d"zoomToNode" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.planSettings.zoomToLocationTooltipText}"\x3e\r\n                \x3c/div\x3e\r\n                \x3c!-- Expand/Collapse grid tool--\x3e\r\n                \x3cdiv class\x3d"esriCTHidden  esriCTTraverseToolIcons esriCTCollapse esriCTCursorPointer" title\x3d"${nls.planSettings.collapseGridTooltipText}"\r\n                    data-dojo-attach-point\x3d"expandCollapseNode" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.planSettings.collapseGridTooltipText}"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Misclose details container--\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"misCloseDetailsNode"\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Parcel tools (rotation/scale) container--\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"parcelToolsNode"\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Parcel info (polygon layer fields) \x26 save/cancle button container--\x3e\r\n    \x3cdiv class\x3d"esriCTPlanInfoNode" data-dojo-attach-point\x3d"planInfoNode"\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/MiscloseDetails.html":'\x3cdiv class\x3d"esriCTTraverseDetailContainer esriCTFullWidth" data-dojo-attach-point\x3d"traverseDetailsContainer"\x3e\r\n    \x3c!-- Message div shown when misclose is not calculated --\x3e\r\n    \x3cdiv class\x3d"esriCTTraverseResultContainer esriCTEllipsis"\r\n    data-dojo-attach-point\x3d"noMiscloseCalculated"\x3e\r\n        ${nls.traverseSettings.noMiscloseCalculated}\r\n    \x3c/div\x3e\r\n    \x3c!-- Misclose details container --\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth esriCTHidden" data-dojo-attach-point\x3d"miscloseDetailsContainer"\x3e\r\n        \x3c!-- Misclose Bearing Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseMiscloseBearingNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseMiscloseBearing}"\x3e\r\n                ${nls.traverseSettings.traverseMiscloseBearing}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv  esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"miscloseBearingNode"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Misclose Distance Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseDistanceNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseDistance}"\x3e\r\n                ${nls.traverseSettings.traverseDistance}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"miscloseDistanceNode"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Misclose Ratio Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseMiscloseRatioNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseMiscloseRatio}"\x3e\r\n                ${nls.traverseSettings.traverseMiscloseRatio}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"miscloseRatioNode"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Accuracy Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseAccuracyNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseAccuracy}"\x3e\r\n                ${nls.traverseSettings.traverseAccuracy}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"accuracyNode"\x3e\r\n                ${nls.traverseSettings.accuracyHigh}\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Stated Area Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer esriCTHidden" data-dojo-attach-point\x3d"traverseStatedAreaNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseStatedArea}"\x3e\r\n                ${nls.traverseSettings.traverseStatedArea}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv"\x3e\r\n                \x3cdiv data-dojo-attach-point\x3d"traverseStatedArea" style\x3d"font-weight:normal; width: 100px; height: 25px;" data-dojo-type\x3d"dijit/form/ValidationTextBox" aria-label\x3d"${nls.traverseSettings.traverseStatedArea}"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Calculated Area Container --\x3e\r\n        \x3cdiv class\x3d"esriCTTraverseResultContainer" data-dojo-attach-point\x3d"traverseCalculatedAreaNode"\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis" title\x3d"${nls.traverseSettings.traverseCalculatedArea}"\x3e\r\n                ${nls.traverseSettings.traverseCalculatedArea}:\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseResultsDiv esriCTEllipsis esriCTTraversedValueDiv" data-dojo-attach-point\x3d"calculatedAreaNode"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/ParcelTools.html":'\x3cdiv class\x3d"esriCTFullWidth"\x3e\r\n    \x3c!-- Rotation tool container--\x3e\r\n    \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n        \x3cdiv class\x3d"esriCTRotationButton esriCTButtonIcon esriCTParcelToolButtonIcon esriCTCursorPointer" title\x3d"${nls.parcelTools.rotationToolLabel}"\r\n            data-dojo-attach-point\x3d"rotateButton" tabindex\x3d"0" role\x3d"button"  aria-pressed\x3d"false" aria-label\x3d"${nls.parcelTools.rotationToolLabel}"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTParcelToolButtonLabel esriCTEllipsis" title\x3d"${nls.parcelTools.rotationToolLabel}"\x3e\r\n            ${nls.parcelTools.rotationToolLabel}\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTParcelToolInputNode" data-dojo-type\x3d"dijit/form/NumberTextBox" trim\x3d"true" required\x3d"true" data-dojo-attach-point\x3d"rotationTxt" aria-label\x3d"${nls.parcelTools.rotationToolLabel}"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Scale tool container--\x3e\r\n    \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n        \x3cdiv class\x3d"esriCTScaleButton esriCTButtonIcon esriCTParcelToolButtonIcon esriCTCursorPointer" title\x3d"${nls.parcelTools.scaleToolLabel}"\r\n            data-dojo-attach-point\x3d"scaleButton" tabindex\x3d"0" role\x3d"button" aria-pressed\x3d"false" aria-label\x3d"${nls.parcelTools.scaleToolLabel}"\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTParcelToolButtonLabel esriCTEllipsis" title\x3d"${nls.parcelTools.scaleToolLabel}"\x3e\r\n            ${nls.parcelTools.scaleToolLabel}\x3c/div\x3e\r\n        \x3cdiv class\x3d"esriCTParcelToolInputNode" data-dojo-type\x3d"dijit/form/NumberTextBox" trim\x3d"true" required\x3d"true" data-dojo-attach-point\x3d"scaleTxt" aria-label\x3d"${nls.parcelTools.scaleToolLabel}"\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/ParcelDrafter/PlanInfo.html":'\x3cdiv class\x3d"esriCTFullWidth"\x3e\r\n    \x3c!-- Parcel Layer Attribute list Parent--\x3e\r\n    \x3cdiv class\x3d"esriCTFullWidth" data-dojo-attach-point\x3d"parcelLayerRowNode"\x3e\r\n        \x3c!-- Parcel layer attribute list toggle node --\x3e\r\n        \x3cdiv class\x3d"esriCTParcelLayerParent" data-dojo-attach-point\x3d"expandCollapseParentNode"\x3e\r\n            \x3cdiv class\x3d"esriCTParcelLayerContainer esriCTEllipsis" data-dojo-attach-point\x3d"attributeListTitle"\x3e\x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTExpandCollapseParceLayer" data-dojo-attach-point\x3d"expandCollapseNode" tabindex\x3d"0"\r\n                role\x3d"button" aria-label\x3d"${nls.planInfo.showAttributeList}" title\x3d"${nls.planInfo.showAttributeList}"\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Parcel Layer Attribute List Section--\x3e\r\n        \x3cdiv class\x3d"esriCTParcelAttributeList esriCTHidden" data-dojo-attach-point\x3d"attributeListNode"\x3e\r\n            \x3c!-- Attribute Inspector --\x3e\r\n            \x3cdiv class\x3d"esriCTAttributeInspectorContainer" data-dojo-attach-point\x3d"attributeInspectorContainer"\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Parcel name input container --\x3e\r\n            \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow esriCTHidden" data-dojo-attach-point\x3d"parcelNameRow"\x3e\r\n                \x3cdiv class\x3d"esriCTFullWidth" data-dojo-attach-point\x3d"parcelName"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- DocumentType input container --\x3e\r\n            \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow esriCTHidden" data-dojo-attach-point\x3d"documentTypeRow"\x3e\r\n                \x3cdiv class\x3d"esriCTFullWidth" data-dojo-attach-point\x3d"documentType"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3c!-- Plan name input container --\x3e\r\n            \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingRow esriCTHidden" data-dojo-attach-point\x3d"planNameRow"\x3e\r\n                \x3cdiv class\x3d"esriCTFullWidth" data-dojo-attach-point\x3d"planName"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!-- Save/Cancle button container --\x3e\r\n        \x3cdiv class\x3d"esriCTPlanInfoNode"\x3e\r\n            \x3cdiv class\x3d"esriCTPlanInfoButton jimu-btn jimu-trailing-margin1" title\x3d"${nls.common.save}"\r\n                data-dojo-attach-point\x3d"planInfoSaveButton" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.common.save}"\x3e\r\n                ${nls.common.save}\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTPlanInfoButton jimu-btn jimu-trailing-margin1 esriCTHidden"\r\n                title\x3d"${nls.common.deleteText}" data-dojo-attach-point\x3d"planInfoDeleteButton" tabindex\x3d"0"\r\n                role\x3d"button" aria-label\x3d"${nls.common.deleteText}"\x3e\r\n                ${nls.common.deleteText}\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTPlanInfoButton jimu-btn" title\x3d"${nls.common.cancel}"\r\n                data-dojo-attach-point\x3d"planInfoCancelButton" tabindex\x3d"0" role\x3d"button"\r\n                aria-label\x3d"${nls.common.cancel}"\x3e\r\n                ${nls.common.cancel}\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\r\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\r\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\r\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\r\n\x3e\x3c/div\x3e\r\n',
"url:esri/dijit/editing/templates/AttachmentEditor.html":"\x3cdiv class\x3d\"attachmentEditor\"\x3e\r\n    \x3cbr /\x3e\r\n    \x3cdiv\x3e\r\n        \x3cb\x3e${NLS_attachments}\x3c/b\x3e\r\n        \x3chr /\x3e\r\n        \x3cdiv dojoAttachPoint\x3d\"_attachmentError\" style\x3d'color:red;display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e\r\n        \x3cspan dojoAttachPoint\x3d'_attachmentList' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cdiv data-dojo-type\x3d\"dijit/ProgressBar\" dojoAttachPoint\x3d\"_attachmentProgress\" indeterminate\x3d\"true\" style\x3d'display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e        \r\n        \x3cform dojoAttachPoint\x3d'_uploadForm'\x3e ${NLS_add}:\x26nbsp;\x26nbsp;\x3cinput type\x3d'file' name\x3d'attachment' dojoAttachPoint\x3d'_uploadField' /\x3e \x3c/form\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e",
"url:esri/dijit/templates/AttributeInspector.html":'\x3cdiv class\x3d"esriAttributeInspector"\x3e\r\n    \x3cdiv class\x3d"atiLayerName" dojoAttachPoint\x3d"layerName"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiAttributes" dojoAttachPoint\x3d"attributeTable"\x3e\x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"attachmentEditor"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiEditorTrackingInfo" dojoAttachPoint\x3d"editorTrackingInfoDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiButtons" dojoAttachPoint\x3d"editButtons"\x3e\r\n        \x3cbutton  dojoType\x3d"dijit.form.Button" class\x3d"atiButton atiDeleteButton"  dojoAttachPoint\x3d"deleteBtn" dojoAttachEvent\x3d"onClick: onDeleteBtn" showLabel\x3d"true" type\x3d"button"\x3e${NLS_deleteFeature}\x3c/button\x3e\r\n        \x3cdiv class\x3d"atiNavButtons" dojoAttachPoint\x3d"navButtons"\x3e\r\n            \x3cdiv class\x3d"atiNavMessage" dojoAttachPoint\x3d"navMessage"\x3e\x3c/div\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiFirstIcon" dojoAttachPoint\x3d"firstFeatureButton" dojoAttachEvent\x3d"onClick: onFirstFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_first}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiPrevIcon" dojoAttachPoint\x3d"prevFeatureButton" dojoAttachEvent\x3d"onClick: onPreviousFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_previous}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiNextIcon" dojoAttachPoint\x3d"nextFeatureButton" dojoAttachEvent\x3d"onClick: onNextFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_next}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiLastIcon" dojoAttachPoint\x3d"lastFeatureButton" dojoAttachEvent\x3d"onClick: onLastFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_last}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/ParcelDrafter/Widget.html":'\x3cdiv style\x3d"height: calc(100% - 10px);" class\x3d"esriCTFullHeight" data-dojo-attach-point\x3d"mainNode"\x3e\r\n    \x3cdiv class\x3d"esriCTFullHeight esriCTFullWidth" data-dojo-attach-point\x3d"widgetMainNode"\x3e\r\n        \x3c!--Main Page Node--\x3e\r\n        \x3cdiv class\x3d"esirCTMainPage" data-dojo-attach-point\x3d"mainPageNode"\x3e\r\n            \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n                \x3cdiv class\x3d"esriCTButtonLabel esriCTEllipsis" title\x3d"${nls.newTraverseButtonLabel}"\x3e\r\n                    ${nls.newTraverseButtonLabel}\x3c/div\x3e\r\n                    \x3c!-- code for accessibility --\x3e\r\n                \x3cdiv class\x3d"esriCTNewTraverseButton esriCTButtonIcon esriCTCursorPointer" title\x3d"${nls.newTraverseButtonLabel}" data-dojo-attach-point\x3d"newTraverseButton"\r\n                tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.newTraverseButtonLabel}" aria-pressed\x3d"false"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTMainPageRow"\x3e\r\n                \x3cdiv class\x3d"esriCTButtonLabel esriCTEllipsis" title\x3d"${nls.editTraverseButtonLabel}"\x3e\r\n                    ${nls.editTraverseButtonLabel}\x3c/div\x3e\r\n                    \x3c!-- code for accessibility --\x3e\r\n                \x3cdiv class\x3d"esriCTEditTraverseButton esriCTButtonIcon esriCTCursorPointer" title\x3d"${nls.editTraverseButtonLabel}" data-dojo-attach-point\x3d"editTraverseButton"\r\n                tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.editTraverseButtonLabel}" aria-pressed\x3d"false"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"newTraverseSelectMessageNodeWrapper" class\x3d"esriCTHidden"\x3e\r\n              \x3cdiv class\x3d"esriCTMainPageRow esriCTAlignCenter" data-dojo-attach-point\x3d"newTraverseSelectMessageNode"\x3e\r\n              \x3c/div\x3e\r\n              \x3c!-- XYInput Widget get inserted here --\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!--Traverse Page Node--\x3e\r\n        \x3cdiv class\x3d"esriCTFullHeight esriCTHidden" data-dojo-attach-point\x3d"traversePageNode"\x3e\r\n            \x3cdiv class\x3d"esriCTFullWidth esriCTNewTraverseHeader"\x3e\r\n                \x3cdiv class\x3d"esriCTBackButton esriCTCursorPointer"\x3e\r\n                    \x3cdiv class\x3d"esriCTItemLeftArrow" title\x3d"${nls.common.back}" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.common.back}" data-dojo-attach-point\x3d"traversePanelBackButton"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTTitleDiv esriCTEllipsis" title\x3d"${nls.newTraverseTitle}"  data-dojo-attach-point\x3d"traverseTitleNode"\x3e\r\n                    ${nls.newTraverseTitle}\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTPlanSettingsIcon esriCTCursorPointer" title\x3d"${nls.planSettings.planSettingsTitle}" data-dojo-attach-point\x3d"planSettingsButton" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.planSettings.planSettingsTitle}"\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTTraverseNode" data-dojo-attach-point\x3d"traverseNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3c!--Plan Settings Node--\x3e\r\n        \x3cdiv class\x3d"esriCTHidden esriCTFullHeight" data-dojo-attach-point\x3d"planSettingsPageNode"\x3e\r\n            \x3cdiv class\x3d"esriCTFullWidth esriCTPlanSettingHeader"\x3e\r\n                \x3cdiv class\x3d"esriCTBackButton esriCTCursorPointer"\x3e\r\n                    \x3cdiv class\x3d"esriCTItemLeftArrow" title\x3d"${nls.common.back}" tabindex\x3d"0" role\x3d"button" aria-label\x3d"${nls.common.back}" data-dojo-attach-point\x3d"planSettingsPanelBackButton"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv class\x3d"esriCTTitleDiv esriCTEllipsis" title\x3d"${nls.planSettings.planSettingsTitle}"\x3e\r\n                    ${nls.planSettings.planSettingsTitle}\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n            \x3cdiv class\x3d"esriCTPlanSettingsNode" data-dojo-attach-point\x3d"planSettingsNode"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"esriCTWidgetErrorNode esriCTHidden" data-dojo-attach-point\x3d"widgetErrorNode"\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/ParcelDrafter/css/style.css":".esriCTMainContainer{min-width: 222px; height: 100%; -webkit-overflow-scrolling: touch; overflow: hidden;}.esriCTOverridePanelStyle{padding: 15px 0 0 0 !important;}.esriCTMapTooltip{width: 100px; word-wrap: break-word; border: 1px solid #7EABCD; background-color: white; padding: 5px; font-size: 9pt; z-index: 9999; -o-border-radius: 4px; -moz-border-radius: 4px; -webkit-border-radius: 4px; border-radius: 4px;}.jimu-widget-ParcelDrafter .esriCTWidgetErrorNode{padding: 0px 20px;}.jimu-widget-ParcelDrafter .esriCTFullHeight{height: 100%;}.jimu-widget-ParcelDrafter .esriCTFullWidth{width: 100%;}.jimu-widget-ParcelDrafter .esriCTEllipsis{overflow: hidden; text-overflow: ellipsis; white-space: nowrap;}.jimu-widget-ParcelDrafter .esriCTCursorPointer{cursor: pointer;}.jimu-widget-ParcelDrafter .esriCTCursorDefault{cursor: pointer;}.jimu-widget-ParcelDrafter .esriCTAlignCenter{text-align: center;}.jimu-widget-ParcelDrafter .esriCTMainPageRow{width: calc(100% - 40px); margin: 20px 20px 20px 20px; display: inline-block;}.jimu-widget-ParcelDrafter .esriCTButtonLabel{float: left; width: calc(100% - 45px); line-height: 35px; padding: 5px 5px 5px 0;}.jimu-widget-ParcelDrafter .esriCTEditTraverseButton{background: url(\"../images/edit-traverse.png\") no-repeat;}.jimu-widget-ParcelDrafter .esriCTNewTraverseButton{background: url(\"../images/new-traverse.png\") no-repeat;}.jimu-widget-ParcelDrafter .esriCTNewTraverseActive{background: url(\"../images/new-traverse-selected.png\") no-repeat; background-color: #8e8e8e;}.jimu-widget-ParcelDrafter .esriCTEditTraverseActive{background: url(\"../images/edit-traverse-selected.png\") no-repeat; background-color: #8e8e8e;}.jimu-widget-ParcelDrafter .esriCTButtonIcon{height: 45px; width: 45px; float: right; background-size: 45px;}.jimu-widget-ParcelDrafter .esriCTParcelToolButtonIcon{height: 45px; width: 45px; float: left; background-size: 45px 45px; background-color: #8e8e8e;}.jimu-widget-ParcelDrafter .esriCTDisabledParcelToolButton{background-color: #e8e8e8 !important; cursor: not-allowed;}.esriRtl .jimu-widget-ParcelDrafter .esriCTButtonIcon{float: left;}.jimu-widget-ParcelDrafter .esriCTTraverseTool{float: left; padding: 5px 5px 0 0; width: calc(100% - 20px);}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseTool{float: right; padding: 5px 0 0 5px;}.jimu-widget-ParcelDrafter .esriCTTraverseToolContainer{float: right;}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseToolContainer {float: left;}.jimu-widget-ParcelDrafter .esriCTTraverseToolIcons{height: 24px; width: 24px; background-size: 24px; float: left; background-repeat: no-repeat; margin: 5px 0px 5px 20px;}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseToolIcons{float: right; margin: 5px 20px 5px 0px;}.jimu-widget-ParcelDrafter .ecriCTLocationIcon{background-image: url('../images/digitization.png');}.jimu-widget-ParcelDrafter .ecriCTUpdateRotationPointIcon{background-image: url('../images/update-rotation.png');}.jimu-widget-ParcelDrafter .ecriCTLocationIcon.esriCTEnableButton{background-image: url('../images/digitization-selected.png'); background-color: #8e8e8e;}.jimu-widget-ParcelDrafter .ecriCTUpdateRotationPointIcon.esriCTEnableButton{background-image: url('../images/update-rotation-selected.png'); background-color: #8e8e8e;}.jimu-widget-ParcelDrafter .ecriCTZoomToIcon{background-image: url('../images/zoom.png');}.jimu-widget-ParcelDrafter .esriCTCollapse{background-image: url('../images/collapse.png');}.jimu-widget-ParcelDrafter .esriCTExpand{background-image: url('../images/expand.png');}.jimu-widget-ParcelDrafter .esriCTNewTraverseHeader{float: left; height: 30px; border-bottom: 1px solid #464646; padding: 0px 10px;}.jimu-widget-ParcelDrafter .esriCTPlanSettingsIcon{background-image: url('../images/settings.png'); height: 20px; width: 20px; background-size: 20px; float: right; background-repeat: no-repeat;}.jimu-widget-ParcelDrafter .esriCTTraverseDetailContainer{float: left; border-top: 1px solid #464646; border-bottom: 1px solid #464646; margin-top: 20px; background-color: #E4E4ED;}.jimu-widget-ParcelDrafter .esriCTMiscloseHeaderDiv{background-color: rgba(0,0,0,0.5);}.jimu-widget-ParcelDrafter .esriCTTraverseResultContainer{width: 100%; height: 25px; line-height: 25px; padding: 0 10px; float: left; text-align: left;}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseResultContainer{text-align: right;}.jimu-widget-ParcelDrafter .esriCTParcelLayerContainer {width: calc(100% - 40px); height: 40px; line-height: 40px; padding: 0 10px; float: left; text-align: left;}.esriRtl .jimu-widget-ParcelDrafter .esriCTParcelLayerContainer {text-align: right; float: right;}.jimu-widget-ParcelDrafter .esriCTExpandCollapseParceLayer {background-image: url(../images/right-arrow.png); height: 40px; width: 40px; line-height: 40px; float: right; background-repeat: no-repeat; transform: rotate(90deg); background-position: center center; cursor: pointer;}.jimu-widget-ParcelDrafter .esriCTCollapsedParceLayer {transform: rotate(-90deg);}.jimu-widget-ParcelDrafter .esriCTParcelLayerParent {width: 100%; height: 40px; border-top: 1px solid #464646; border-bottom: 1px solid #464646;}.jimu-widget-ParcelDrafter .esriCTParcelAttributeList {margin: 5px;}.jimu-widget-ParcelDrafter .esriCTGridEmptyLabel {width: 50px; float: left; text-align: left;}.jimu-widget-ParcelDrafter .esriCTGridLabels{width: 70px; float: left; text-align: left; padding-left: 4px;}.jimu-widget-ParcelDrafter .esriCTGridBearingLabel{width: calc(100% - 210px);}.esriRtl .jimu-widget-ParcelDrafter .esriCTGridEmptyLabel{float: right; text-align: right;}.esriRtl .jimu-widget-ParcelDrafter .esriCTGridLabels{float: right; text-align: right; padding-right: 4px; padding-left: 0px;}.jimu-widget-ParcelDrafter .dijitTextBox .dijitInputInner{height: 21px;}.jimu-widget-ParcelDrafter .dijitTextBoxFocused .dijitInputContainer{background: transparent;}.jimu-widget-ParcelDrafter .esriCTTraverseResultsDiv{max-width: 49%; float: left; padding-right: 5px;}.jimu-widget-ParcelDrafter .esriCTTraversedValueDiv{font-weight: bold;}.jimu-widget-ParcelDrafter .esriCTNewTraverseGrid{height: calc(100% - 40px); overflow: auto;}.jimu-widget-ParcelDrafter .esriCTNewTraverseContainer{padding: 10px; width: 100%; display: inline-block;}.jimu-widget-ParcelDrafter .esriCTNewTraverseLabelDiv{display: inline-block; width: 100%;}.jimu-widget-ParcelDrafter .esriCTTraverseGrid{width: 100%; display: table; border-collapse: collapse;}.jimu-widget-ParcelDrafter .esriCTHidden{display: none;}::-ms-clear{display: none;}.jimu-widget-ParcelDrafter .esriCTRotationButton{background-image: url('../images/scale-rotation-active.png');}.jimu-widget-ParcelDrafter .esriCTScaleButton{background-image: url('../images/scale-active.png');}.jimu-widget-ParcelDrafter .esriCTDisableButton .esriCTParcelToolButtonIcon{background-color: inherit;}.jimu-widget-ParcelDrafter .esriCTDisableButton .esriCTRotationButton{background-image: url('../images/scale-rotation.png');}.jimu-widget-ParcelDrafter .esriCTDisableButton .esriCTScaleButton{background-image: url('../images/scale.png');}.jimu-widget-ParcelDrafter .esriCTParcelToolButtonLabel{float: left; max-width: calc(100% - 145px); line-height: 35px; padding: 5px 20px;}.jimu-widget-ParcelDrafter .esriCTParcelToolInputNode{width: 100px; height: 25px; margin-top: 10px; float: right;}.esriRtl .jimu-widget-ParcelDrafter .esriCTParcelToolButtonIcon{float: right;}.esriRtl .jimu-widget-ParcelDrafter .esriCTParcelToolInputNode{float: left;}.esriRtl .jimu-widget-ParcelDrafter .esriCTParcelToolButtonLabel{float: right;}.jimu-widget-ParcelDrafter .esriCTPlanInfoNode{margin: 0 4px; display: inline-block; width: calc(100% - 8px)}.jimu-widget-ParcelDrafter .esriCTPlanInfoButton{width: 80px; margin-top: 10px;}.jimu-widget-ParcelDrafter .esriCTPlanSettingsNode{width: 100%; height: calc(100% - 30px); display: inline-block; overflow-y: auto;}.jimu-widget-ParcelDrafter .esriCTPlanSettingsContainer{margin: 20px; display: inline-block; width: calc(100% - 40px);}.jimu-widget-ParcelDrafter .esriCTPlanSettingRow{padding-bottom: 20px;}.jimu-widget-ParcelDrafter .esriCTDropdownLabel{padding-bottom: 5px;}.jimu-widget-ParcelDrafter .esriCTPlanSettingHeader{float: left; height: 30px; border-bottom: 1px solid #464646; padding: 0px 10px;}.jimu-widget-ParcelDrafter .esriCTBackButton{width: 25%;}.jimu-widget-ParcelDrafter .esriCTTitleDiv{line-height: 10px; font-weight: bold; text-align: center; width: calc(100% - 50px); padding: 5px; display: inline-block;}.jimu-widget-ParcelDrafter .esriCTItemLeftArrow{background-image: url('../images/left-arrow.png'); float: left; margin: 0px 5px 0px 0px; width: 15px; height: 20px; background-repeat: no-repeat; background-position: center center;}.jimu-widget-ParcelDrafter .dijitSelect .dijitButtonContents{border-style: none none none none; background-color: #fafafc;}.jimu-widget-ParcelDrafter .dijitSelect .dijitButtonContentsDartTheme {background-color: inherit;}.jimu-widget-ParcelDrafter .dijitSelect .dijitArrowButton{background-color: #fafafc; background-image: none; border-color: #fafafc;}.jimu-widget-ParcelDrafter .dijitSelect .dijitArrowButtonDartTheme {background-color: rgba(0, 0, 0, 0.5) !important;}.jimu-widget-ParcelDrafter .dijitMenuItem{color: #7989a0;}.jimu-widget-ParcelDrafter .dijitSelect .dijitInputField{margin-right: 8px;}input[type\x3dtext]::-ms-clear{display: none;}.jimu-widget-ParcelDrafter .esriCTRow {clear: both; display: table-row; width: 100%;}.jimu-widget-ParcelDrafter .esriCTNewTraverseGrid{float: left; width: 100%; position: relative; text-align: center; margin: 10px 0px;}.jimu-widget-ParcelDrafter .dijitTextBox .dijitPlaceHolder{font-size: 12px;}.jimu-widget-ParcelDrafter .esriCTRow .dijitTextBox{margin: 0; width: 70px; display: table-cell;}.jimu-widget-ParcelDrafter .dijitTextBoxError {border-color: #d9dde0 !important; box-shadow: inset 0 0 0 2px #d46464;}.jimu-widget-ParcelDrafter .esriCTRow .dijitTextBoxHover{border-color: #d9dde0;}.jimu-widget-ParcelDrafter .esriCTRow .dijitTextBoxFocused{border-color: #d9dde0 !important; box-shadow: none; outline: none;}.jimu-widget-ParcelDrafter .esriCTBearingRow{width: calc(100% - 210px) !important;}.jimu-widget-ParcelDrafter .dojoDndItemAfter .esriCTSymbolContainer, .jimu-widget-ParcelDrafter .dojoDndItemBefore .esriCTSymbolContainer{background: #E4E4ED !important;}.jimu-widget-ParcelDrafter .dojoDndItem, .jimu-widget-demo .dojoDndItemAnchor, .jimu-widget-demo .dojoDndItemSelected, .dojoDndContainerOver, .dojoDndItemOver{background: none; border: none; padding: 0; cursor: move;}.jimu-widget-ParcelDrafter .esriCTDeleteRow, .jimu-widget-ParcelDrafter .esriCTAddRow{color: #CCC; display: table-cell; vertical-align: middle; font-size: 18px; width: 15px;}.jimu-widget-ParcelDrafter .esriCTDeleteIcon, .jimu-widget-ParcelDrafter .esriCTAddIcon{cursor: pointer; height: 30px; width: 15px; margin-left: 5px;}.esriRtl .jimu-widget-ParcelDrafter .esriCTDeleteIcon,.esriRtl .jimu-widget-ParcelDrafter .esriCTAddIcon{margin-right: 5px; margin-left: 0;}.jimu-widget-ParcelDrafter .esriCTDeleteIcon{background: url('../images/delete.png') no-repeat center center;}.jimu-widget-ParcelDrafter .esriCTAddIcon{background: url('../images/add.png') no-repeat center center;}.jimu-widget-ParcelDrafter .esriCTEntryNodeContainer{float: left; width: 100%;}.jimu-widget-ParcelDrafter .esriCTEntrtyNodeContent{width: 100%; display: table; border-collapse: collapse;}.esriCTSymbolContainer{border: 1px solid #dedede; width: 50px; height: 30px; padding: 0px 5px; vertical-align: middle; display: table-cell;}.esriCTSymbolPopup .dijitTooltipContainer{padding: 0px;}.esriCTSymbolListContainer{max-height: 150px; overflow: auto; margin: 6px 0px; width: 170px;}.esriCTSymbolListContent{margin: 0px 6px;}.esriCTSelectedSymbol{width: 30px; height: 25px; overflow: hidden; margin-top: 4px; cursor: pointer;}.esriCTSymbolIcon{width: 35px; vertical-align: middle; margin: 2px 3px 0px 3px; overflow: hidden; display: inline-block;}.esriCTSymbolOption{height: 25px; width: 100%; cursor: pointer; margin-top: 1px; margin-bottom: 1px;}.esriCTSymbolOption:hover{background-color: #edf2f5;}.esriCTSymbolName{display: inline-block; white-space: nowrap; margin-left: 5px; overflow: hidden; text-overflow: ellipsis; width: 95px; color: #7989a0; vertical-align: middle;}.esriRtl .jimu-widget-ParcelDrafter .esriCTButtonLabel{float: right; padding: 5px 0px 5px 5px;}.esriRtl .jimu-widget-ParcelDrafter .esriCTItemLeftArrow{float: right; margin: 0px 0px 00px 10px;}.esriRtl .jimu-widget-ParcelDrafter .esriCTPlanSettingsIcon{float: left;}.esriRtl .jimu-widget-ParcelDrafter .esriCTItemLeftArrow{background-image: url('../images/right-arrow.png');}.esriRtl .jimu-widget-ParcelDrafter .esriCTTraverseResultsDiv{float: right;}.esriRtl .jimu-widget-ParcelDrafter .dijitSelect .dijitInputField{margin-left: 8px; margin-right: 0;}.jimu-widget-ParcelDrafter .esriCTEditParcelDialog{position: absolute; width: 250px; z-index:100;}.jimu-widget-ParcelDrafter .esriCTParcelInfoPopup{display: table; border-collapse: collapse; width: 100%;}.jimu-widget-ParcelDrafter .esriCTParcelInfoLabels{height: 20px; display: table-cell; text-align: center; text-overflow: ellipsis; overflow: hidden; word-wrap: nowrap; margin-right: 5px;}.jimu-widget-ParcelDrafter .esriCTLabelRows{display: table-row;}.jimu-widget-ParcelDrafter .esriCTParcelInfoPopup .esriCTRowContainer{display: table-row;}.jimu-widget-ParcelDrafter .jimu-widget-ParcelDrafter-XYInput .xyRowWrapper {margin: 5px;}.jimu-widget-ParcelDrafter .atiButton, .jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .atiLayerName {display: none;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .atiButtons {display: none;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer td {display: block; clear: both; height: auto; width: 100%; float: left;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer table {width: 100%;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .atiField {width: 100%;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .atiLabel {margin-top: 6px !important; margin-bottom: 3px !important; text-align: left;}.jimu-rtl .jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .atiLabel {text-align: right;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .dijitTextBox {width: 100% !important;}.jimu-widget-ParcelDrafter .esriCTAttributeInspectorContainer .dijitTextArea {width: 100% !important; min-height: 70px; resize: vertical; overflow: auto; font-family: inherit; line-height: 20px !important; font-size: 14px;}.jimu-widget-ParcelDrafter .atiAttributes {height: 100%; padding-right: 2px;}.jimu-rtl .jimu-widget-ParcelDrafter .atiAttributes {padding-right: 0px; padding-left: 2px;}",
"*now":function(l){l(['dojo/i18n!*preload*widgets/ParcelDrafter/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidget dojo/_base/array dojo/_base/lang dojo/dom-class dojo/dom-attr dojo/dom-construct dojo/dom-style dojo/on ./PlanSettings ./XYInput ./NewTraverse ./MapTooltipHandler ./layerUtils esri/tasks/GeometryService jimu/dijit/Message jimu/dijit/LoadingIndicator esri/tasks/query esri/request jimu/utils dijit/focus dojo/keys".split(" "),function(l,a,b,h,f,g,m,d,q,u,p,k,n,y,r,K,t,z,C,A,E,x){return l([a],{baseClass:"jimu-widget-ParcelDrafter",_prevOpenPanel:"mainPage",_newTraverseInstance:null,
_planSettingsInstance:null,_mapTooltipHandler:null,_startPoint:null,geometryService:null,_lineLayerSpatialReference:null,_polygonLayerSpatialReference:null,_isUpdateStartPoint:null,_featureReductionEnabledLayers:[],postMixInProperties:function(){this.nls.common={};h.mixin(this.nls.common,window.jimuNls.common)},postCreate:function(){this.inherited(arguments);this.openAtStartAysn=!0;if(this.appConfig.geometryService){this.geometryService=new r(this.appConfig.geometryService);if(!this._isValidConfig())return this._showErrorInWidgetPanel(this.nls.invalidConfigMsg),
!1;this._layerUtils=new y({map:this.map,getPopupInfo:!0,getRenderer:!1});h.mixin(this.config.polylineLayer,this._layerUtils.getLayerDetailsFromMap(this.config.polylineLayer.baseURL,this.config.polylineLayer.layerId,this.config.polylineLayer.id));h.mixin(this.config.polygonLayer,this._layerUtils.getLayerDetailsFromMap(this.config.polygonLayer.baseURL,this.config.polygonLayer.layerId,this.config.polygonLayer.id));this._initLoading();this._getSpatialReferenceOfParcelLayers();this._setFirstLastNodeInWidget()}else this._showErrorInWidgetPanel(this.nls.geometryServiceURLNotFoundMSG)},
startup:function(){this.inherited(arguments);f.add(this.domNode.parentElement,"esriCTOverridePanelStyle");this._featureReductionEnabledLayers=[];b.forEach(this.config.snappingLayers,function(a){a=this.map.getLayer(a.id);a.isFeatureReductionEnabled&&a.isFeatureReductionEnabled()&&this._featureReductionEnabledLayers.push(a)},this)},onOpen:function(){this._mapTooltipHandler&&"mainPage"!==this._prevOpenPanel&&(this._isUpdateStartPoint=!0,this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForUpdateStartPoint),
this._toggleSnapping(!0));A.isAutoFocusFirstNodeWidget(this)&&A.focusFirstFocusNode(this.domNode)},onActive:function(){b.forEach(this._featureReductionEnabledLayers,function(a){a.disableFeatureReduction()})},onDeActive:function(){b.forEach(this._featureReductionEnabledLayers,function(a){a.enableFeatureReduction()})},onClose:function(){if("planSettingsPage"===this._prevOpenPanel)this._planSettingsInstance.onClose();this._mapTooltipHandler&&(this._toggleSnapping(!1),this._mapTooltipHandler.disconnectEventHandler(),
f.replace(this.newTraverseButton,"esriCTNewTraverseButton","esriCTNewTraverseActive"),f.replace(this.editTraverseButton,"esriCTEditTraverseButton","esriCTEditTraverseActive"),g.set(this.newTraverseButton,"aria-pressed","false"),g.set(this.editTraverseButton,"aria-pressed","false"),this.newTraverseSelectMessageNode.innerHTML="",f.add(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden"),this._newTraverseInstance.deActivateDigitizationTool(),this._newTraverseInstance.deactivateParcelTools(),this._newTraverseInstance.closePopup())},
destroy:function(){b.forEach(this._featureReductionEnabledLayers,function(a){a.enableFeatureReduction()});this.inherited(arguments)},_initWidgetWorkFlow:function(){this._handleClickEvents();this._createMapTooltipHandler();this._createNewTraverse();this._createPlanSettings();this._createXYInput()},_isValidConfig:function(){var a;a=!0;this.config?(this.config.polygonLayer&&this.map.getLayer(this.config.polygonLayer.id)||(a=!1),this.config.polylineLayer&&this.map.getLayer(this.config.polylineLayer.id)||
(a=!1)):a=!1;return a},_initLoading:function(){this.loading=new t({hidden:!0});this.loading.placeAt(this.domNode);this.loading.startup()},_getSpatialReferenceOfParcelLayers:function(){var a;this.loading.show();C({url:this.config.polylineLayer.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(h.hitch(this,function(b){this._lineLayerSpatialReference=b.extent.spatialReference;a=C({url:this.config.polygonLayer.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"});
a.then(h.hitch(this,function(a){this.loading.hide();this._polygonLayerSpatialReference=a.extent.spatialReference;this._initWidgetWorkFlow()}))}))},_newTraverseButtonClicked:function(){this._mapTooltipHandler.disconnectEventHandler();this._newTraverseInstance.clearAll();f.contains(this.newTraverseButton,"esriCTNewTraverseActive")?(this._toggleSnapping(!1),f.replace(this.newTraverseButton,"esriCTNewTraverseButton","esriCTNewTraverseActive"),g.set(this.newTraverseButton,"aria-pressed","false"),this.newTraverseSelectMessageNode.innerHTML=
"",f.add(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden")):(f.replace(this.editTraverseButton,"esriCTEditTraverseButton","esriCTEditTraverseActive"),f.replace(this.newTraverseButton,"esriCTNewTraverseActive","esriCTNewTraverseButton"),g.set(this.newTraverseButton,"aria-pressed","true"),g.set(this.editTraverseButton,"aria-pressed","false"),this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForStartNewTraverse),this._isUpdateStartPoint=!0,this._toggleSnapping(!0),this.newTraverseSelectMessageNode.innerHTML=
this.nls.mapTooltipForStartNewTraverse,f.remove(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden"),this._xyInputInstance.resetXYTextBoxes());this._setFirstLastNodeInWidget()},_editTraverseButtonClicked:function(){this._mapTooltipHandler.disconnectEventHandler();this._newTraverseInstance.clearAll();f.contains(this.editTraverseButton,"esriCTEditTraverseActive")?(f.replace(this.editTraverseButton,"esriCTEditTraverseButton","esriCTEditTraverseActive"),g.set(this.editTraverseButton,"aria-pressed",
"false"),this.newTraverseSelectMessageNode.innerHTML="",f.add(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden")):(f.replace(this.newTraverseButton,"esriCTNewTraverseButton","esriCTNewTraverseActive"),f.replace(this.editTraverseButton,"esriCTEditTraverseActive","esriCTEditTraverseButton"),g.set(this.editTraverseButton,"aria-pressed","true"),g.set(this.newTraverseButton,"aria-pressed","false"),this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForEditNewTraverse),this.newTraverseSelectMessageNode.innerHTML=
this.nls.mapTooltipForEditNewTraverse);this._setFirstLastNodeInWidget()},_handleClickEvents:function(){this.own(q(this.planSettingsButton,"click",h.hitch(this,function(){this._showPanel("planSettingsPage")})));this.own(q(this.planSettingsButton,"keydown",h.hitch(this,function(a){a.keyCode!==x.ENTER&&a.keyCode!==x.SPACE||this._showPanel("planSettingsPage")})));this.own(q(this.newTraverseButton,"click",h.hitch(this,this._newTraverseButtonClicked)));this.own(q(this.newTraverseButton,"keydown",h.hitch(this,
function(a){a.keyCode!==x.ENTER&&a.keyCode!==x.SPACE||this._newTraverseButtonClicked()})));this.own(q(this.editTraverseButton,"click",h.hitch(this,this._editTraverseButtonClicked)));this.own(q(this.editTraverseButton,"keydown",h.hitch(this,function(a){a.keyCode!==x.ENTER&&a.keyCode!==x.SPACE||this._editTraverseButtonClicked()})));this.own(q(this.planSettingsPanelBackButton,"click",h.hitch(this,function(){this._planSettingsInstance.onClose();this._showPanel("traversePage")})));this.own(q(this.planSettingsPanelBackButton,
"keydown",h.hitch(this,function(a){if(a.keyCode===x.ENTER||a.keyCode===x.SPACE)this._planSettingsInstance.onClose(),this._showPanel("traversePage"),E.focus(this.planSettingsButton)})));this.own(q(this.traversePanelBackButton,"click",h.hitch(this,this._confirmCancelTraverse)));this.own(q(this.traversePanelBackButton,"keydown",h.hitch(this,function(a){a.keyCode!==x.ENTER&&a.keyCode!==x.SPACE||this._confirmCancelTraverse()})))},_setSnappingLayers:function(){var a=[],b,d;if(this.config.snappingLayers&&
this.config.snappingLayers.length)for(d=0;d<this.config.snappingLayers.length;d++)(b=this.map.getLayer(this.config.snappingLayers[d].id))&&a.push({layer:b});this._isUpdateStartPoint||this._newTraverseInstance.parcelPointsGraphicsLayer&&a.push({layer:this._newTraverseInstance.parcelPointsGraphicsLayer});this.map.snappingManager&&this.map.snappingManager.setLayerInfos(a)},_toggleSnapping:function(a){this.map.snappingManager&&(this.map.snappingManager._deactivateSnapping(),this.map.disableSnapping());
a&&!this.map.snappingManager&&(this.map.enableSnapping({tolerance:this.config.snappingTolerance,snapToEdge:!0,snapToPoint:!0,snapToVertex:!0,alwaysSnap:!0}),this._setSnappingLayers(),this.map.snappingManager._setUpSnapping())},_confirmCancelTraverse:function(){var a;this._newTraverseInstance.closePopup();a=new K({message:this.nls.clearingDataConfirmationMessage,type:"question",buttons:[{label:this.nls.common.yes,onClick:h.hitch(this,function(){a.close();this._resetOnBackToMainPage(!0)})},{label:this.nls.common.no}]})},
_resetOnBackToMainPage:function(a){this._startPoint=null;f.replace(this.newTraverseButton,"esriCTNewTraverseButton","esriCTNewTraverseActive");f.replace(this.editTraverseButton,"esriCTEditTraverseButton","esriCTEditTraverseActive");g.set(this.newTraverseButton,"aria-pressed","false");g.set(this.editTraverseButton,"aria-pressed","false");this.newTraverseSelectMessageNode.innerHTML="";f.add(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden");this._toggleSnapping(!1);this._mapTooltipHandler.disconnectEventHandler();
this._newTraverseInstance.clearAll();this._showPanel("mainPage");a&&E.focus(this.newTraverseButton)},_createMapTooltipHandler:function(){this._mapTooltipHandler=new n({toolTipText:this.nls.mapTooltipForStartNewTraverse,map:this.map});this._isUpdateStartPoint=!0;this.own(this._mapTooltipHandler.on("clicked",h.hitch(this,function(a){var b;this.map&&this.map.snappingManager?(b=this.map.snappingManager.getSnappingPoint(a.screenPoint),b.then(h.hitch(this,function(b){this._onMapPointSelected(b?b:a.mapPoint)}))):
this._onMapPointSelected(a.mapPoint)})));this.own(this._mapTooltipHandler.on("dragging",h.hitch(this,function(a){this._startPoint&&(this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForRotate?this._newTraverseInstance.setRotation(a.mapPoint):this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForScale&&this._newTraverseInstance.setScaling(a.mapPoint))})));this.own(this._mapTooltipHandler.on("moving",h.hitch(this,function(a){this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForUpdateStartPoint&&
this._startPoint&&this._newTraverseInstance._showParcelPopup(a).then(h.hitch(this,function(a){a&&d.set(this._mapTooltipHandler._mapTooltip,"display","none")}))})));this._mapTooltipHandler.startup()},_onMapPointSelected:function(a,b){this._mapTooltipHandler.toolTipText!==this.nls.mapTooltipForUpdatingRotaionPoint&&(this._mapTooltipHandler.toolTipText===this.nls.mapTooltipForScreenDigitization?this._newTraverseInstance.pointAddedFromDigitization(a):(this._startPoint||(this._mapTooltipHandler.toolTipText===
this.nls.mapTooltipForEditNewTraverse?(this._startPoint=a,this._getPolygonForEdits(a)):(g.set(this.traverseTitleNode,"innerHTML",this.nls.newTraverseTitle),g.set(this.traverseTitleNode,"title",this.nls.newTraverseTitle),this._showPanel("traversePage"),E.focus(this.traversePanelBackButton),this._mapTooltipHandler.updateTooltip(this.nls.mapTooltipForUpdateStartPoint))),this._startPoint=a,this._newTraverseInstance.setStartPoint(this._startPoint,!0,!0,b),E.focus(this.traversePanelBackButton)))},_getPolygonForEdits:function(a){var b,
d;this.loading.show();d=(new Date).getTime();b=new z;b.geometry=a;b.outSpatialReference=this.map.spatialReference;b.returnGeometry=!1;b.outFields=["*"];b.where=d+"\x3d"+d;(a=this.map.getLayer(this.config.polygonLayer.id))?a.queryFeatures(b,h.hitch(this,function(a){this.loading.hide();if(a&&0<a.features.length)for(this._newTraverseInstance.polygonDeleteArr=a.features;0<a.features.length;){this._getLinesForEdits(a.features[0]);break}else this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelMessage)}),
h.hitch(this,function(){this.loading.hide();this._startPoint=null;this._showMessage(this.nls.unableToFetchParcelMessage)})):(this.loading.hide(),this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelMessage))},_sortFeatureAccToSequenceID:function(a){var b;b=this.config.polylineLayer.sequenceId.name;a.sort(function(a,d){return a.attributes[b]-d.attributes[b]});return a},_getLinesForEdits:function(a){var b;this.loading.show();b=a.attributes[this.config.polygonLayer.relatedGUID.name];a=
new z;a.outSpatialReference=this.map.spatialReference;a.returnGeometry=!0;a.outFields=["*"];a.where=this.config.polylineLayer.relatedGUID.name+"\x3d'"+b+"'";(b=this.map.getLayer(this.config.polylineLayer.id))?b.queryFeatures(a,h.hitch(this,function(a){this.loading.hide();a&&0<a.features.length?(a.features=this._sortFeatureAccToSequenceID(a.features),this._newTraverseInstance.polylineDeleteArr=a.features,this._startPoint=a.features[0].geometry.getPoint(0,0),g.set(this.traverseTitleNode,"innerHTML",
this.nls.editTraverseTitle),g.set(this.traverseTitleNode,"title",this.nls.editTraverseTitle),this._newTraverseInstance.initEditing(this._startPoint,a,this._lineLayerSpatialReference),this._toggleSnapping(!0),this._showPanel("traversePage"),E.focus(this.traversePanelBackButton),this._mapTooltipHandler.updateTooltip(this.nls.mapTooltipForUpdateStartPoint)):(this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelLinesMessage))}),h.hitch(this,function(){this.loading.hide();this._startPoint=
null;this._showMessage(this.nls.unableToFetchParcelLinesMessage)})):(this.loading.hide(),this._startPoint=null,this._showMessage(this.nls.unableToFetchParcelLinesMessage))},_createNewTraverse:function(){this._newTraverseInstance=new k({nls:this.nls,config:this.config,map:this.map,loading:this.loading,geometryService:this.geometryService,appConfig:this.appConfig,lineLayerSpatialReference:this._lineLayerSpatialReference,polygonLayerSpatialReference:this._polygonLayerSpatialReference,widgetDomNode:this.domNode},
this.traverseNode);this.own(this._newTraverseInstance.on("showMessage",h.hitch(this,this._showMessage)));this.own(this._newTraverseInstance.on("showParcelSavedAndDeleteMsg",h.hitch(this,this._showParcelSavedAndDeleteMsg)));this.own(this._newTraverseInstance.on("activateDigitizationTool",h.hitch(this,function(){this._onActivateDigitization()})));this.own(this._newTraverseInstance.on("deActivateDigitizationTool",h.hitch(this,function(){this._onDeactivateDigitization()})));this.own(this._newTraverseInstance.on("activateUpdateRotationPointTool",
h.hitch(this,function(){this._onActivateUpdateRotationPoint()})));this.own(this._newTraverseInstance.on("deActivateUpdateRotationPointTool",h.hitch(this,function(){this._onDeactivateUpdateRotationPoint()})));this.own(this._newTraverseInstance.on("cancelTraverse",h.hitch(this,function(){this._confirmCancelTraverse()})));this.own(this._newTraverseInstance.on("displayMainPageAfterSave",h.hitch(this,function(a){this._resetOnBackToMainPage(a)})));this.own(this._newTraverseInstance.on("toggleRotating",
h.hitch(this,function(a){this._toggleRotating(a)})));this.own(this._newTraverseInstance.on("toggleScaling",h.hitch(this,function(a){this._toggleScaling(a)})))},_toggleRotating:function(a){a?(this._mapTooltipHandler.connectMouseDragHandler(this.nls.mapTooltipForRotate),this._newTraverseInstance.deActivateDigitizationTool(),this._newTraverseInstance.deActivateUpdateRotationPointTool()):(this._isUpdateStartPoint=!0,this._mapTooltipHandler.disconnectEventHandler(),this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForUpdateStartPoint));
this._toggleSnapping(!a)},_toggleScaling:function(a){a?(this._mapTooltipHandler.connectMouseDragHandler(this.nls.mapTooltipForScale),this._newTraverseInstance.deActivateDigitizationTool(),this._newTraverseInstance.deActivateUpdateRotationPointTool()):(this._newTraverseInstance.distance=null,this._isUpdateStartPoint=!0,this._mapTooltipHandler.disconnectEventHandler(),this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForUpdateStartPoint));this._toggleSnapping(!a)},_onActivateDigitization:function(){this._mapTooltipHandler.disconnectEventHandler();
this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForScreenDigitization);this._newTraverseInstance.deactivateParcelTools();this._isUpdateStartPoint=!1;this._toggleSnapping(!0)},_onDeactivateDigitization:function(){this._mapTooltipHandler.updateTooltip(this.nls.mapTooltipForUpdateStartPoint);this._isUpdateStartPoint=!0;this._toggleSnapping(!0)},_onActivateUpdateRotationPoint:function(){this._mapTooltipHandler.disconnectEventHandler();this._mapTooltipHandler.connectEventHandler(this.nls.mapTooltipForUpdatingRotaionPoint);
this._newTraverseInstance.deactivateParcelTools();this._isUpdateStartPoint=!1;this._toggleSnapping(!0)},_onDeactivateUpdateRotationPoint:function(){this._mapTooltipHandler.updateTooltip(this.nls.mapTooltipForUpdateStartPoint);this._isUpdateStartPoint=!0;this._toggleSnapping(!0)},_createPlanSettings:function(){this._planSettingsInstance=new u({nls:this.nls,config:this.config,appConfig:this.appConfig,widgetId:this.id,widgetDomNode:this.domNode},m.create("div",{},this.planSettingsNode));this.own(this._planSettingsInstance.on("planSettingsChanged",
h.hitch(this,function(a){this._newTraverseInstance.updateAccordingToPlanSettings(a)})));this._planSettingsInstance.startup()},_createXYInput:function(){this._xyInputInstance=(new p({nls:this.nls,config:this.config,appConfig:this.appConfig,map:this.map,widgetDomNode:this.domNode})).placeAt(this.newTraverseSelectMessageNodeWrapper,"last");this.own(this._xyInputInstance.on("newPoint",h.hitch(this,function(a){this._onMapPointSelected(a,!0)})));this._xyInputInstance.startup()},_showPanel:function(a){var b;
this._prevOpenPanel&&(b=this._getNodeByName(this._prevOpenPanel),f.add(b,"esriCTHidden"));b=this._getNodeByName(a);f.remove(b,"esriCTHidden");this._prevOpenPanel=a;setTimeout(h.hitch(this,function(){this._setFirstLastNodeInWidget()}),100)},_showMessage:function(a){(new K({message:a,buttons:[{label:this.nls.common.ok}]})).message=a},_showErrorInWidgetPanel:function(a){g.set(this.widgetErrorNode,"innerHTML",a);f.add(this.widgetMainNode,"esriCTHidden");f.remove(this.widgetErrorNode,"esriCTHidden")},
_getNodeByName:function(a){var b;switch(a){case "mainPage":b=this.mainPageNode;break;case "traversePage":b=this.traversePageNode;break;case "planSettingsPage":b=this.planSettingsPageNode}return b},_setFirstLastNodeInWidget:function(){!f.contains(this.mainPageNode,"esriCTHidden")&&f.contains(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden")?(A.initFirstFocusNode(this.domNode,this.newTraverseButton),A.initLastFocusNode(this.domNode,this.editTraverseButton)):f.contains(this.mainPageNode,"esriCTHidden")||
f.contains(this.newTraverseSelectMessageNodeWrapper,"esriCTHidden")?f.contains(this.traversePageNode,"esriCTHidden")?f.contains(this.planSettingsPageNode,"esriCTHidden")||(A.initFirstFocusNode(this.domNode,this.planSettingsPanelBackButton),E.focus(this.planSettingsPanelBackButton),this._planSettingsInstance.updateLastNodeInPlanSetting()):(A.initFirstFocusNode(this.domNode,this.traversePanelBackButton),this._newTraverseInstance.updateLastNodeInTraversePanel()):(A.initFirstFocusNode(this.domNode,this.newTraverseButton),
this._xyInputInstance._updateLastFocusNode())},_showParcelSavedAndDeleteMsg:function(a){var b=new K({message:a,buttons:[{label:this.nls.common.ok,onClick:h.hitch(this,function(){b.close();setTimeout(h.hitch(this,function(){E.focus(this.newTraverseButton)}),100)})}]});b.message=a}})});