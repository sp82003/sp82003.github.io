// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"widgets/Print/Print":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin esri/tasks/PrintTask esri/tasks/PrintParameters esri/tasks/PrintTemplate esri/request esri/lang esri/arcgis/utils esri/SpatialReference dojo/_base/config dojo/_base/lang dojo/_base/array dojo/_base/html dojo/dom-style dojo/dom-construct dojo/dom-class dojo/promise/all dojo/Deferred jimu/portalUrlUtils dojo/text!./templates/Print.html dojo/text!./templates/PrintResult.html dojo/aspect dojo/query jimu/LayerInfos/LayerInfos jimu/dijit/LoadingIndicator jimu/dijit/Message jimu/utils jimu/SpatialReference/srUtils dojo/on dijit/popup dijit/form/ValidationTextBox dijit/form/Form dijit/form/Select dijit/form/NumberTextBox dijit/form/Button dijit/form/CheckBox dijit/ProgressBar dijit/form/DropDownButton dijit/TooltipDialog dijit/form/RadioButton dijit/form/SimpleTextarea esri/IdentityManager dojo/store/Memory".split(" "),
function(f,q,r,u,y,e,l,n,d,b,w,h,a,z,k,E,C,A,L,D,G,F,H,I,B,O,K,g,J,t,N,P,M){F=f([q,r,u],{widgetsInTemplate:!0,templateString:F,map:null,count:1,results:[],authorText:null,copyrightText:null,copyrightEditable:!0,defaultTitle:null,defaultFormat:null,defaultLayout:null,baseClass:"gis_PrintDijit",pdfIcon:require.toUrl("./widgets/Print/images/pdf.png"),imageIcon:require.toUrl("./widgets/Print/images/image.png"),printTaskURL:null,printTask:null,async:!1,_showSettings:!1,_currentTemplateInfo:null,postCreate:function(){this.inherited(arguments);
this.printTask=new y(this.printTaskURL,{async:this.async});this.printparams=new e;this.printparams.map=this.map;this.shelter=new K({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup();this.shelter.show();this.titleNode.set("value",this.defaultTitle);this.authorNode.set("value",this.defaultAuthor);this.copyrightNode.set("value",this.defaultCopyright);this.copyrightNode.set("readOnly",!this.copyrightEditable);t.loadResource().then(a.hitch(this,function(){var c;t.isValidWkid(this.map.spatialReference.wkid)?
(this.wkidInput.set("value",this.map.spatialReference.wkid),c=t.getSRLabel(this.map.spatialReference.wkid),this.wkidLabel.innerHTML=J.sanitizeHTML(c),this.wkidLabel.title=c):(this.wkidInput.set("value",""),this.wkidLabel.innerHTML="",this.wkidLabel.title="");this.wkidInput.set("invalidMessage",this.nls.invalidWkid);this.wkidInput.validator=function(c){return!c||""===c.trim()||t.isValidWkid(+c)}}));var c=G.setHttpProtocol(this.printTaskURL),m=G.getNewPrintUrl(this.appConfig.portalUrl);this._isNewPrintUrl=
c===m||/sharing\/tools\/newPrint$/.test(c);c=B("input",this.printWidgetMapScale.domNode)[0];m=B("input",this.printWidgetMapExtent.domNode)[0];J.combineRadioCheckBoxWithLabel(c,this.printWidgetMapScaleLabel);J.combineRadioCheckBoxWithLabel(m,this.printWidgetMapExtentLabel);"MAP_ONLY"===this.defaultLayout?k.setStyle(this.titleTr,"display","none"):k.setStyle(this.titleTr,"display","");this._hasLabelLayer()?(k.setStyle(this.labelsFormDijit.domNode,"display",""),k.setStyle(this.labelsTitleNode,"display",
"")):(k.setStyle(this.labelsFormDijit.domNode,"display","none"),k.setStyle(this.labelsTitleNode,"display","none"));O.getInstance(this.map,this.map.itemInfo).then(a.hitch(this,function(c){this.layerInfosObj=c;return L([this._getPrintTaskInfo(),this._getLayerTemplatesInfo()]).then(a.hitch(this,function(c){var m=c[0];(c=c[1])&&!c.error?(c=c&&c.results)&&0<c.length&&(z.some(c,a.hitch(this,function(c){return c&&"Output_JSON"===c.paramName?this.templateInfos=c.value:!1})),this.templateInfos&&0<this.templateInfos.length&&
(this.templateNames=z.map(this.templateInfos,function(c){return c.layoutTemplate}))):console.warn("Get Layout Templates Info Error",c&&c.error);!d.isDefined(m)||m&&m.error?this._handleError(m.error):this._handlePrintInfo(m)}))})).always(a.hitch(this,function(){this.shelter.hide()}));this.printTask._getPrintDefinition&&I.after(this.printTask,"_getPrintDefinition",a.hitch(this,"printDefInspector"),!1);this.printTask._createOperationalLayers&&(I.after(this.printTask,"_createOperationalLayers",a.hitch(this,
"_fixInvalidSymbol")),I.after(this.printTask,"_createOperationalLayers",a.hitch(this,"_excludeInvalidLegend")))},_onOutputSRChange:function(c){t.isValidWkid(+c)?(c=t.getSRLabel(+c),this.wkidLabel.innerHTML=J.sanitizeHTML(c),this.wkidLabel.title=c):(this.wkidLabel.innerHTML="",this.wkidLabel.title="")},_hasLabelLayer:function(){return z.some(this.map.graphicsLayerIds,function(c){return(c=this.map.getLayer(c))&&"esri.layers.LabelLayer"===c.declaredClass},this)},_getPrintTaskInfo:function(){var c=new D;
this._isNewPrintUrl?c.resolve({isGPPrint:!1}):n({url:this.printTaskURL,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4}).then(a.hitch(this,function(m){c.resolve({isGPPrint:!0,data:m})}),a.hitch(this,function(m){c.resolve({error:m})}));return c},_getLayerTemplatesInfo:function(){var c=new D,m=this.printTaskURL.split("/"),v=m.indexOf("GPServer");if(-1<v){var g=null,g=/Utilities\/PrintingTools\/GPServer/.test(this.printTaskURL)?m.slice(0,v+1).join("/")+"/"+encodeURIComponent("Get Layout Templates Info Task")+
"/execute":m.slice(0,v+1).join("/")+"/"+encodeURIComponent("Get Layout Templates Info")+"/execute";n({url:g,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4}).then(a.hitch(this,function(m){c.resolve(m)}),a.hitch(this,function(m){c.resolve({error:m})}))}else c.resolve(null);return c},_fixInvalidSymbol:function(c){z.forEach(c,function(c){"map_graphics"===c.id&&(c=a.getObject("featureCollection.layers",!1,c))&&0<c.length&&z.forEach(c,function(c){c&&c.featureSet&&"esriGeometryPoint"===
c.featureSet.geometryType&&z.forEach(c.featureSet.features,function(c){c&&c.symbol&&!c.symbol.style&&(c.symbol.style="esriSMSSquare")})})},this);return c},_excludeInvalidLegend:function(c){function m(c){return z.filter(c.subLayerIds,a.hitch(this,function(m){return(m=this.layerInfosObj.getLayerInfoById(c.id+"_"+m))&&m.getShowLegendOfWebmap()}))}if(this.printTask.allLayerslegend){for(var v=b.getLegendLayers({map:this.map,itemInfo:this.map.itemInfo}),v=z.map(v,function(c){return{id:c.layer.id}}),g=this.printTask.allLayerslegend,
B=[],d=0;d<g.length;d++){var k=g[d],h=this.map.getLayer(k.id),t=this.layerInfosObj.getLayerInfoById(k.id),J=h&&h.declaredClass&&"esri.layers.GraphicsLayer"!==h.declaredClass,h=!h.renderer||h.renderer&&!h.renderer.hasVisualVariables(),t=t&&t.getShowLegendOfWebmap();J&&h&&t&&(k.subLayerIds&&(k.subLayerIds=a.hitch(this,m,k)()),B.push(k))}z.forEach(v,a.hitch(this,function(c){var m=z.some(B,a.hitch(this,function(m){return m.id===c.id})),v=this.layerInfosObj.getLayerInfoById(c.id),v=v&&v.getShowLegendOfWebmap()&&
v.isShowInMap();!m&&v&&B.push(c)}));this.printTask.allLayerslegend=B}return c},printDefInspector:function(c){"force"===this.preserve.preserveScale&&(c.mapOptions.scale=this.preserve.forcedScale);return c},_handleError:function(c){console.log("print widget load error: ",c);new g({message:c.message||c})},onLayoutChange:function(c){var m=this.templateNames&&this.templateNames.indexOf(c);if(-1<m){k.empty(this.customTextElementsTable);c=this._currentTemplateInfo=this.templateInfos[m];if((m=a.getObject("layoutOptions.customTextElements",
!1,c))&&0<m.length){var v=[];z.forEach(m,a.hitch(this,function(c){for(var m in c)if(0>v.indexOf(m)){var a=this.customTextElementsTable.insertRow(-1);a.insertCell(-1).appendChild(k.toDom(m+": "));a.insertCell(-1).appendChild((new M({name:m,trim:!0,required:!1,value:c[m],style:"width:100%"})).domNode);v.push(m)}}))}a.getObject("layoutOptions.hasAuthorText",!1,c)?k.setStyle(this.authorTr,"display",""):k.setStyle(this.authorTr,"display","none");a.getObject("layoutOptions.hasCopyrightText",!1,c)?k.setStyle(this.copyrightTr,
"display",""):k.setStyle(this.copyrightTr,"display","none");a.getObject("layoutOptions.hasTitleText",!1,c)?k.setStyle(this.titleTr,"display",""):k.setStyle(this.titleTr,"display","none");a.getObject("layoutOptions.hasLegend",!1,c)?k.setStyle(this.legendTr,"display",""):k.setStyle(this.legendTr,"display","none")}else"MAP_ONLY"===c?(k.setStyle(this.authorTr,"display","none"),k.setStyle(this.copyrightTr,"display","none"),k.setStyle(this.titleTr,"display","none"),k.setStyle(this.legendTr,"display","none"),
this._currentTemplateInfo={layoutOptions:{hasTitleText:!1,hasCopyrightText:!1,hasAuthorText:!1,hasLegend:!1}}):(k.setStyle(this.authorTr,"display",""),k.setStyle(this.copyrightTr,"display",""),k.setStyle(this.titleTr,"display",""),k.setStyle(this.legendTr,"display",""),this._currentTemplateInfo={layoutOptions:{hasTitleText:!0,hasCopyrightText:!0,hasAuthorText:!0,hasLegend:!0}})},_getMapAttribution:function(){var c=this.map.attribution;return c&&c.domNode?k.getProp(c.domNode,"textContent"):""},closeSettings:function(){P.close(this.settingsDialog);
this._showSettings=!1},showSettings:function(c){c.preventDefault();c.stopPropagation();this._showSettings?(P.close(this.settingsDialog),this._showSettings=!1):(P.open({popup:this.settingsDialog,around:this.advancedButtonDijit}),this._showSettings=!0)},_handlePrintInfo:function(c){if(c.isGPPrint){c=c.data;E.set(this.layoutDijit.domNode.parentNode.parentNode,"display","");E.set(this.formatDijit.domNode.parentNode.parentNode,"display","");E.set(this.advancedButtonDijit,"display","");this.own(N(document.body,
"click",a.hitch(this,function(c){if(this._showSettings){c=c.target||c.srcElement;var m=this.settingsDialog.domNode;c===m||k.isDescendant(c,m)||(P.close(this.settingsDialog),this._showSettings=!1)}})));var m=z.filter(c.parameters,function(c){return"Layout_Template"===c.name});if(0===m.length)console.log('print service parameters name for templates must be "Layout_Template"');else{var v=z.map(m[0].choiceList,function(c){return{label:c,value:c}});v.sort(function(c,m){return c.label>m.label?1:m.label>
c.label?-1:0});0<v.length?(this.layoutDijit.addOption(v),this.defaultLayout?this.layoutDijit.set("value",this.defaultLayout):this.layoutDijit.set("value",m[0].defaultValue)):this.defaultLayout&&(this.layoutDijit.addOption([{label:this.defaultLayout,value:this.defaultLayout}]),this.layoutDijit.set("value",this.defaultLayout));c=z.filter(c.parameters,function(c){return"Format"===c.name});0===c.length?console.log('print service parameters name for format must be "Format"'):(m=z.map(c[0].choiceList,function(c){return{label:c,
value:c}}),m.sort(function(c,m){return c.label>m.label?1:m.label>c.label?-1:0}),0<m.length?(this.formatDijit.addOption(m),this.defaultFormat?this.formatDijit.set("value",this.defaultFormat):this.formatDijit.set("value",c[0].defaultValue)):this.defaultFormat&&(this.formatDijit.addOption([{label:this.defaultFormat,value:this.defaultFormat}]),this.formatDijit.set("value",this.defaultFormat)))}}else E.set(this.layoutDijit.domNode.parentNode.parentNode,"display","none"),E.set(this.formatDijit.domNode.parentNode.parentNode,
"display","none"),E.set(this.advancedButtonDijit,"display","none")},print:function(){if(this.printSettingsFormDijit.isValid()){var c=this.printSettingsFormDijit.get("value");a.mixin(c,this.layoutMetadataDijit.get("value"));a.mixin(c,this.forceAttributesFormDijit.get("value"));a.mixin(c,this.labelsFormDijit.get("value"));this.preserve=this.preserveFormDijit.get("value");a.mixin(c,this.preserve);this.layoutForm=this.layoutFormDijit.get("value");var m=this.mapQualityFormDijit.get("value"),g=this.mapOnlyFormDijit.get("value");
a.mixin(g,m);var b=this.customTextElementsDijit.get("value"),m=[],B=!1,d=h.locale||"en",k;for(k in b){var J={};"Date"===k&&(B=!0);J[k]=b[k];m.push(J)}B||m.push({Date:(new Date).toLocaleString(d)});B=this._currentTemplateInfo;k=a.getObject("layoutOptions.hasAuthorText",!1,B);b=a.getObject("layoutOptions.hasCopyrightText",!1,B);B=a.getObject("layoutOptions.hasTitleText",!1,B);d=new l;d.format=c.format;d.layout=c.layout;d.preserveScale="true"===c.preserveScale||"force"===c.preserveScale;"force"===c.preserveScale&&
(d.outScale=0<this.preserve.forcedScale?this.preserve.forcedScale:this.map.getScale());d.forceFeatureAttributes=c.forceFeatureAttributes&&c.forceFeatureAttributes[0];d.label=c.title;d.exportOptions=g;d.showLabels=c.showLabels&&c.showLabels[0];d.layoutOptions={authorText:k?c.author:"",copyrightText:b?c.copyright||this._getMapAttribution():"",legendLayers:this._getLegendLayers(),titleText:B?c.title:"",customTextElements:m,scalebarUnit:this.layoutForm.scalebarUnit};this.printparams.template=d;this.printparams.extraParameters=
{printFlag:!0};this.printparams.outSpatialReference=void 0;g=+this.wkidInput.get("value");t.isValidWkid(g)&&g!==this.map.spatialReference.wkid&&(this.printparams.outSpatialReference=new w(g));g=this.printTask.execute(this.printparams);(new v({count:this.count.toString(),icon:"PDF"===c.format?this.pdfIcon:this.imageIcon,docName:c.title,title:c.title+", "+c.format+", "+c.layout,fileHandle:g,nls:this.nls})).placeAt(this.printResultsNode,"last").startup();E.set(this.clearActionBarNode,"display","block");
this.count++}else this.printSettingsFormDijit.validate()},_getLegendLayers:function(){var c=a.getObject("layoutOptions.hasLegend",!1,this._currentTemplateInfo),m=0<this.layoutForm.legend.length&&this.layoutForm.legend[0];if(this.printTask&&!this.printTask._createOperationalLayers){var v=[];c&&m&&(c=b.getLegendLayers({map:this.map,itemInfo:this.map.itemInfo}),v=z.map(c,function(c){return{layerId:c.layer.id}}));return v}return c&&m?null:[]},clearResults:function(){C.empty(this.printResultsNode);E.set(this.clearActionBarNode,
"display","none");this.count=1},updateAuthor:function(c){(c=c||"")&&this.authorTB&&this.authorTB.set("value",c)},getCurrentMapScale:function(){this.forceScaleNTB.set("value",this.map.getScale())}});var v=f([q,r,u],{widgetsInTemplate:!0,templateString:H,url:null,postCreate:function(){this.inherited(arguments);this.progressBar.set("label",this.nls.creatingPrint);this.fileHandle.then(a.hitch(this,"_onPrintComplete"),a.hitch(this,"_onPrintError"))},_onPrintComplete:function(c){c.url?(this.url=c.url,k.setStyle(this.progressBar.domNode,
"display","none"),k.setStyle(this.successNode,"display","inline-block"),A.add(this.resultNode,"printResultHover")):this._onPrintError(this.nls.printError)},_onPrintError:function(c){console.log(c);k.setStyle(this.progressBar.domNode,"display","none");k.setStyle(this.errNode,"display","block");A.add(this.resultNode,"printResultError");k.setAttr(this.domNode,"title",c.details||c.message||"")},_openPrint:function(){null!==this.url&&window.open(this.url)}});return F})},"esri/tasks/PrintTask":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/_base/Deferred dojo/has ../kernel ../lang ../layerUtils ../deferredUtils ../Color ../request ../urlUtils ../geometry/Polygon ../renderers/SimpleRenderer ../symbols/FillSymbol ./Geoprocessor ./PrintTemplate ./Task dojo/dom-attr dojo/dom-construct dojox/gfx/_base dojox/gfx/canvas dojox/json/query dojo/has!extend-esri?./PrintParameters dojo/has!extend-esri?./LegendLayer".split(" "),
function(f,q,r,u,y,e,l,n,d,b,w,h,a,z,k,E,C,A,L,D,G,F,H,I){f=f(L,{declaredClass:"esri.tasks.PrintTask",constructor:function(a,d){this.url=a;this.printGp=new C(this.url);this._handler=q.hitch(this,this._handler);d&&d.async&&(this.async=!0);this._colorEvaluator=I("$..color")},async:!1,_vtlExtent:null,_cimVersion:null,_is11xService:!1,_loadGpServerMetadata:!0,execute:function(a,d,k){if(!this._loadGpServerMetadata)return this._execute(a,d,k);var g=new y(b._dfdCanceller),B=this._url.path,t=B.lastIndexOf("/GPServer/");
0<t&&(B=B.slice(0,t+9));g._pendingDfd=h({url:B,callbackParamName:"callback",content:q.mixin({},this._url.query,{f:"json"})}).then(q.hitch(this,function(d){this._loadGpServerMetadata=!1;this.async="esriExecutionTypeAsynchronous"===d.executionType;this._cimVersion=d.cimVersion;this._is11xService=!!this._cimVersion;g._pendingDfd=this._execute(a);return g._pendingDfd})).then(q.hitch(this,function(a){this._successHandler([a],null,d,g)})).otherwise(function(a){k&&k(a);g.errback(a)});return g},_handler:function(a,
d,b,g,k){try{var B;this.async?"esriJobSucceeded"===a.jobStatus?this.printGp.getResultData(a.jobId,"Output_File",q.hitch(this,function(a){B=a.value;this._successHandler([B],"onComplete",b,k)})):this._errorHandler(Error(a.jobStatus),g,k):(B=a[0].value,this._successHandler([B],"onComplete",b,k))}catch(N){this._errorHandler(N,g,k)}},_execute:function(a,d,k){var g=this._handler,B=this._errorHandler,h=a.template||new A;h.hasOwnProperty("showLabels")||(h.showLabels=!0);var l=h.exportOptions,f;l&&(f={outputSize:[l.width,
l.height],dpi:l.dpi});var l=h.layoutOptions,e,v=[];if(l){this.legendAll=!1;l.legendLayers?r.forEach(l.legendLayers,function(c){var m={};m.id=c.layerId;c.subLayerIds&&(m.subLayerIds=c.subLayerIds);v.push(m)}):this.legendAll=!0;var c,m;if("Miles"===l.scalebarUnit||"Kilometers"===l.scalebarUnit)c="esriKilometers",m="esriMiles";else if("Meters"===l.scalebarUnit||"Feet"===l.scalebarUnit)c="esriMeters",m="esriFeet";e={esriMiles:"mi",esriKilometers:"km",esriFeet:"ft",esriMeters:"m"};e={titleText:l.titleText,
authorText:l.authorText,copyrightText:l.copyrightText,customTextElements:l.customTextElements,scaleBarOptions:{metricUnit:c,metricLabel:e[c],nonMetricUnit:m,nonMetricLabel:e[m]},legendOptions:{operationalLayers:v}}}c=this._getPrintDefinition(a.map,h);a.outSpatialReference&&(c.mapOptions.spatialReference=a.outSpatialReference.toJson());a.template&&n.isDefined(a.template.showAttribution)&&(c.mapOptions.showAttribution=a.template.showAttribution);q.mixin(c,{exportOptions:f,layoutOptions:e});this.allLayerslegend&&
q.mixin(c.layoutOptions,{legendOptions:{operationalLayers:this.allLayerslegend}});if(c.operationalLayers){f=c.operationalLayers;var x,w=function(c){return n.fixJson(q.mixin(c,{type:"esriSLS",cap:void 0,join:void 0,meterLimit:void 0}))},z=/[\u4E00-\u9FFF\u0E00-\u0E7F\u0900-\u097F\u3040-\u309F\u30A0-\u30FF\u31F0-\u31FF]/,O=/[\u0600-\u06FF]/,E=function(c){var m=c.text,a=(c=c.font)&&c.family&&c.family.toLowerCase();m&&c&&("arial"===a||"arial unicode ms"===a)&&(c.family=z.test(m)?"Arial Unicode MS":"Arial",
"normal"!==c.style&&O.test(m)&&(c.family="Arial Unicode MS"))};for(e=0;e<f.length;e++)if(f[e].featureCollection&&f[e].featureCollection.layers)for(m=0;m<f[e].featureCollection.layers.length;m++){var K=f[e].featureCollection.layers[m];K.layerDefinition&&K.layerDefinition.drawingInfo&&K.layerDefinition.drawingInfo.renderer&&K.layerDefinition.drawingInfo.renderer.symbol&&(x=K.layerDefinition.drawingInfo.renderer,"esriCLS"===x.symbol.type?x.symbol=w(x.symbol):"esriTS"===x.symbol.type?E(x.symbol):x.symbol.outline&&
"esriCLS"===x.symbol.outline.type&&(x.symbol.outline=w(x.symbol.outline)));if(K.featureSet&&K.featureSet.features)for(l=0;l<K.featureSet.features.length;l++)x=K.featureSet.features[l],x.symbol&&("esriCLS"===x.symbol.type?x.symbol=w(x.symbol):"esriTS"===x.symbol.type?E(x.symbol):x.symbol.outline&&"esriCLS"===x.symbol.outline.type&&(x.symbol.outline=w(x.symbol.outline)))}}h={Web_Map_as_JSON:u.toJson(n.fixJson(c)),Format:h.format,Layout_Template:h.layout};a.extraParameters&&(h=q.mixin(h,a.extraParameters));
var I=new y(b._dfdCanceller);a=function(c,m){g(c,m,d,k,I)};c=function(c){B(c,k,I)};I._pendingDfd=this.async?this.printGp.submitJob(h,a,null,c):this.printGp.execute(h,a,c);return I},onComplete:function(){},_createMultipointLayer:function(){return{layerDefinition:{name:"multipointLayer",geometryType:"esriGeometryMultipoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryMultipoint",features:[]}}},_createPolygonLayer:function(){return{layerDefinition:{name:"polygonLayer",geometryType:"esriGeometryPolygon",
drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolygon",features:[]}}},_createPointLayer:function(){return{layerDefinition:{name:"pointLayer",geometryType:"esriGeometryPoint",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPoint",features:[]}}},_createPolylineLayer:function(){return{layerDefinition:{name:"polylineLayer",geometryType:"esriGeometryPolyline",drawingInfo:{renderer:null}},featureSet:{geometryType:"esriGeometryPolyline",features:[]}}},_convertSvgSymbol:function(a){if(!(8>=
e("ie")||!a.path&&"image/svg+xml"!==a.contentType)){var d,b=H.createSurface(G.create("div"),1024,1024);d="image/svg+xml"===a.contentType?b.createObject(H.Image,{src:"data:image/svg+xml;base64,"+a.imageData,width:F.pt2px(a.width),height:F.pt2px(a.height),x:0,y:0}):b.createObject(H.Path,a.path).setFill(a.color).setStroke(a.outline);"pendingRender"in b&&b._render(!0);var g=b.rawNode.getContext("2d"),k=Math.ceil(d.getBoundingBox().width),h=Math.ceil(d.getBoundingBox().height);d=g.getImageData(d.getBoundingBox().x,
d.getBoundingBox().y,k,h);g.canvas.width=k;g.canvas.height=h;g.putImageData(d,0,0);g=g.canvas.toDataURL("image/png");a={type:"esriPMS",imageData:g.substr(22,g.length),angle:a.angle,contentType:"image/png",height:a.size?a.size:F.px2pt(h),width:a.size?k/h*a.size:F.px2pt(k),xoffset:a.xoffset,yoffset:a.yoffset};b.destroy();return a}},_convertSvgRenderer:function(a){"simple"===a.type&&a.symbol&&(a.symbol.path||"image/svg+xml"===a.symbol.contentType)?a.symbol=this._convertSvgSymbol(a.symbol):"uniqueValue"===
a.type?(a.defaultSymbol&&(a.defaultSymbol.path||"image/svg+xml"===a.defaultSymbol.contentType)&&(a.defaultSymbol=this._convertSvgSymbol(a.defaultSymbol)),a.uniqueValueInfos&&r.forEach(a.uniqueValueInfos,function(a){if(a.symbol.path||"image/svg+xml"===a.symbol.contentType)a.symbol=this._convertSvgSymbol(a.symbol)},this)):"classBreaks"===a.type&&(a.defaultSymbol&&(a.defaultSymbol.path||"image/svg+xml"===a.defaultSymbol.contentType)&&(a.defaultSymbol=this._convertSvgSymbol(a.defaultSymbol)),a.classBreakInfos&&
r.forEach(a.classBreakInfos,function(a){if(a.symbol.path||"image/svg+xml"===a.symbol.contentType)a.symbol=this._convertSvgSymbol(a.symbol)},this))},_createFeatureCollection:function(a,d,b,g){var k=this._createPolygonLayer(),h=this._createPolylineLayer(),l=this._createPointLayer(),n=this._createMultipointLayer(),e=this._createPointLayer();e.layerDefinition.name="textLayer";delete e.layerDefinition.drawingInfo;if("esri.layers.FeatureLayer"===a.declaredClass||"esri.layers.StreamLayer"===a.declaredClass)k.layerDefinition.name=
h.layerDefinition.name=l.layerDefinition.name=n.layerDefinition.name=q.getObject("arcgisProps.title",!1,a)||a.name||a.id;var v=a.renderer&&"esri.renderer.SimpleRenderer"===a.renderer.declaredClass;if(!a.renderer||a.renderer.valueExpression||q.isFunction(a.renderer.attributeField))delete k.layerDefinition.drawingInfo,delete h.layerDefinition.drawingInfo,delete l.layerDefinition.drawingInfo,delete n.layerDefinition.drawingInfo;else{var c=a.renderer.toJson({useLegacyRotationProperties:!0});if("temporal"===
c.type){var c={latestObservationRenderer:c.latestObservationRenderer,trackLinesRenderer:c.trackRenderer,observationAger:c.observationAger,renderer:c.observationRenderer},m={};a._trackIdField&&(m.trackIdField=a._trackIdField);a._startTimeField&&(m.startTimeField=a._startTimeField);a._endTimeField&&(m.endTimeField=a._endTimeField);k.layerDefinition.drawingInfo=c;k.layerDefinition.timeInfo=m;h.layerDefinition.drawingInfo=c;h.layerDefinition.timeInfo=m;l.layerDefinition.drawingInfo=c;l.layerDefinition.timeInfo=
m;n.layerDefinition.drawingInfo=c;n.layerDefinition.timeInfo=m}else k.layerDefinition.drawingInfo.renderer=c,h.layerDefinition.drawingInfo.renderer=c,l.layerDefinition.drawingInfo.renderer=c,n.layerDefinition.drawingInfo.renderer=c}c=a.fields;c||!a.renderer||a.renderer.valueExpression||q.isFunction(a.renderer.attributeField)||("esri.renderer.ClassBreaksRenderer"===a.renderer.declaredClass?(c=[{name:a.renderer.attributeField,type:"esriFieldTypeDouble"}],a.renderer.normalizationField&&c.push({name:a.renderer.normalizationField,
type:"esriFieldTypeDouble"})):"esri.renderer.UniqueValueRenderer"===a.renderer.declaredClass&&(c=[{name:a.renderer.attributeField,type:"esriFieldTypeString"}],a.renderer.attributeField2&&c.push({name:a.renderer.attributeField2,type:"esriFieldTypeString"}),a.renderer.attributeField3&&c.push({name:a.renderer.attributeField3,type:"esriFieldTypeString"})));c&&(k.layerDefinition.fields=c,h.layerDefinition.fields=c,l.layerDefinition.fields=c,n.layerDefinition.fields=c);c=a.graphics;a.isFeatureReductionActive&&
a.isFeatureReductionActive()&&(c=a.getSingleGraphics());var m=c.length,x,f;for(f=0;f<m;f++){var w=c[f];if(!1!==w.visible&&w.geometry){x=w.toJson();x.symbol&&x.symbol.outline&&x.symbol.outline.color&&x.symbol.outline.color[3]&&!this._is11xService&&(x.symbol.outline.color[3]=255);if(a.renderer&&!x.symbol&&(q.isFunction(a.renderer.attributeField)||a.renderer.valueExpression||this._isFeatureCollectionRequired(a.renderer,a)||"esri.renderer.DotDensityRenderer"===a.renderer.declaredClass||b)){b=b||a.renderer;
var B=null;try{B=b.getSymbol(w)}catch(Q){}if(!B)continue;x.symbol=B.toJson();this._isFeatureCollectionRequired(b,a)&&this._applyVisualVariables(x.symbol,{renderer:b,graphic:w,symbol:B,mapResolution:d&&d.getResolutionInMeters(),mapScale:d&&d.getScale()})}x.symbol&&(x.symbol.path||"image/svg+xml"===x.symbol.contentType?x.symbol=this._convertSvgSymbol(x.symbol):x.symbol.text&&delete x.attributes);switch(w.geometry.type){case "polygon":k.featureSet.features.push(x);break;case "polyline":h.featureSet.features.push(x);
break;case "point":x.symbol&&x.symbol.text?e.featureSet.features.push(x):l.featureSet.features.push(x);break;case "multipoint":n.featureSet.features.push(x);break;case "extent":x.geometry=z.fromExtent(w.geometry).toJson(),k.featureSet.features.push(x)}}}d=[];0<k.featureSet.features.length&&d.push(k);0<h.featureSet.features.length&&d.push(h);0<n.featureSet.features.length&&d.push(n);0<l.featureSet.features.length&&d.push(l);0<e.featureSet.features.length&&d.push(e);if(!d.length)return null;r.forEach(d,
function(c){var a=r.every(c.featureSet.features,function(c){return c.symbol});if(v||a)g&&g.forceFeatureAttributes||r.forEach(c.featureSet.features,function(c){delete c.attributes}),g.forceFeatureAttributes||delete c.layerDefinition.fields;a&&delete c.layerDefinition.drawingInfo});r.forEach(d,function(c){c.layerDefinition.drawingInfo&&c.layerDefinition.drawingInfo.renderer&&this._convertSvgRenderer(c.layerDefinition.drawingInfo.renderer)},this);return{id:a.id,opacity:a.opacity,minScale:a.minScale||
0,maxScale:a.maxScale||0,featureCollection:{layers:d}}},_getPrintDefinition:function(a,d){var k={operationalLayers:this._createOperationalLayers(a,d)},g=this._vtlExtent||a.extent,b=a.spatialReference;this._vtlExtent=null;a.spatialReference._isWrappable()&&(g=g._normalize(!0),b=g.spatialReference);g={mapOptions:{showAttribution:a.showAttribution,extent:g.toJson(),spatialReference:b.toJson()}};d.preserveScale&&q.mixin(g.mapOptions,{scale:d.outScale||a.getScale()});a.timeExtent&&q.mixin(g.mapOptions,
{time:[a.timeExtent.startTime.getTime(),a.timeExtent.endTime.getTime()]});a={};q.mixin(a,g,k);return a},_createOperationalLayers:function(b,h){var n,g,e,t,f=[],w=0;h.preserveScale&&(w=h.outScale||b.getScale());this.allLayerslegend=this.legendAll?[]:null;this._vtlExtent=null;var z=r.map(b.layerIds,b.getLayer,b);b._mapImageLyr&&z.push(b._mapImageLyr);for(n=0;n<z.length;n++)if(g=z[n],g.loaded&&g.visible&&(!w||g.isVisibleAtScale(w)))switch(e=g.declaredClass,t={id:g.id,title:q.getObject("arcgisProps.title",
!1,g)||g.id,opacity:g.opacity,minScale:g.minScale||0,maxScale:g.maxScale||0},t=q.mixin(t,this._getUrlAndToken(g)),g.getNode()&&D.get(g.getNode(),"data-reference")&&(t._isRefLayer=!0),e){case "esri.layers.ArcGISDynamicMapServiceLayer":var v=[];e=!!g._params.layers;if(g._params.dynamicLayers)e=h.outScale?g._getDynLayerObjs(h.outScale):u.fromJson(g._params.dynamicLayers),r.forEach(e,function(c){v.push({id:c.id,name:c.name,layerDefinition:c});delete c.id;delete c.name;delete c.maxScale;delete c.minScale}),
0===v.length&&(t.visibleLayers=[-1]);else if(g.supportsDynamicLayers){if(e||g.layerDefinitions||g.layerTimeOptions){var c=g.createDynamicLayerInfosFromLayerInfos(),m=null;e&&(m=g.visibleLayers);var m=d._getVisibleLayers(c,m),x=d._getLayersForScale(h.outScale||b.getScale(),c);r.forEach(c,function(c){if(!c.subLayerIds){var a=c.id;-1<r.indexOf(m,a)&&-1<r.indexOf(x,a)&&(c={source:c.source.toJson()},g.layerDefinitions&&g.layerDefinitions[a]&&(c.definitionExpression=g.layerDefinitions[a]),g.layerTimeOptions&&
g.layerTimeOptions[a]&&(c.layerTimeOptions=g.layerTimeOptions[a].toJson()),v.push({id:a,layerDefinition:c}))}});0===v.length&&(t.visibleLayers=[-1])}}else r.forEach(g.layerInfos,function(c){var a={id:c.id,layerDefinition:{}};g.layerDefinitions&&g.layerDefinitions[c.id]&&(a.layerDefinition.definitionExpression=g.layerDefinitions[c.id]);g.layerTimeOptions&&g.layerTimeOptions[c.id]&&(a.layerDefinition.layerTimeOptions=g.layerTimeOptions[c.id].toJson());(a.layerDefinition.definitionExpression||a.layerDefinition.layerTimeOptions)&&
v.push(a)}),e&&(t.visibleLayers=g.visibleLayers.length?g.visibleLayers:[-1]);v.length&&(t.layers=v);f.push(t);this.allLayerslegend&&this.allLayerslegend.push({id:g.id,subLayerIds:g.visibleLayers});break;case "esri.layers.ArcGISImageServiceLayer":t=q.mixin(t,{url:g.url,bandIds:g.bandIds,compressionQuality:g.compressionQuality,format:g.format,interpolation:g.interpolation});g.mosaicRule&&q.mixin(t,{mosaicRule:g.mosaicRule.toJson()});if(g.renderingRule||g.renderer)this._is11xService?(g.renderingRule&&
(t.renderingRule=g.renderingRule.toJson()),g.renderer&&(t.layerDefinition=t.layerDefinition||{},t.layerDefinition.drawingInfo=t.layerDefinition.drawingInfo||{},t.layerDefinition.drawingInfo.renderer=g.renderer.toJson())):(e=g.getExportImageRenderingRule())&&q.mixin(t,{renderingRule:e.toJson()});f.push(t);this.allLayerslegend&&this.allLayerslegend.push({id:g.id});break;case "esri.layers.RasterXLayer":this._is11xService&&(t=q.mixin(t,{url:g.url,bandIds:g.bandIds,interpolation:g.interpolation}),g.renderer&&
(t.layerDefinition=t.layerDefinition||{},t.layerDefinition.drawingInfo=t.layerDefinition.drawingInfo||{},t.layerDefinition.drawingInfo.renderer=g.renderer.toJson()),f.push(t),this.allLayerslegend&&this.allLayerslegend.push({id:g.id}));break;case "esri.layers.WMSLayer":t=q.mixin(t,{url:g.url,title:g.title,type:"wms",version:g.version,transparentBackground:g.imageTransparency,visibleLayers:g.visibleLayers});f.push(t);this.allLayerslegend&&this.allLayerslegend.push({id:g.id,subLayerIds:g.visibleLayers});
break;case "esri.virtualearth.VETiledLayer":e=g.mapStyle;"roadOnDemand"===e?e="Road":"aerialWithLabelsOnDemand"===e&&(e="Hybrid");t=q.mixin(t,{visibility:g.visible,type:"BingMaps"+e,culture:g.culture,key:g.bingMapsKey});f.push(t);break;case "esri.layers.OpenStreetMapLayer":t=q.mixin(t,{credits:g.copyright,type:"OpenStreetMap",url:a.getAbsoluteUrl(g.tileServers[0])});f.push(t);break;case "esri.layers.WMTSLayer":t=q.mixin(t,{url:g.url,type:"wmts",layer:g._identifier,style:g._style,format:g.format,tileMatrixSet:g._tileMatrixSetId});
f.push(t);break;case "esri.layers.MapImageLayer":e=g.getImages();r.forEach(e,function(c,a){c.visible&&c.href&&(t={id:g.id+"_image"+a,type:"image",title:g.id,minScale:g.minScale||0,maxScale:g.maxScale||0,opacity:g.opacity*c.opacity,extent:c.extent.toJson()},"data:image/png;base64,"===c.href.substr(0,22)?t.imageData=c.href.substr(22):t.url=c.href,f.push(t))});break;case "esri.layers.VectorTileLayer":delete t.url;delete t.token;if(this._is11xService&&g.currentStyleInfo.serviceUrl&&g.currentStyleInfo.styleUrl&&
(e=l.id&&l.id.findCredential(g.currentStyleInfo.styleUrl),c=l.id&&l.id.findCredential(g.currentStyleInfo.serviceUrl),!e&&!c||"2.1.0"!==this._cimVersion)){t.type="VectorTileLayer";t.styleUrl=g.currentStyleInfo.styleUrl;e&&(t.token=e.token);c&&c.token!==t.token&&(t.additionalTokens=[{url:g.currentStyleInfo.serviceUrl,token:c.token}]);f.push(t);break}t.type="image";e=this._vtlExtent||b.extent.offset(0,0);var B=h.exportOptions&&h.exportOptions.dpi||96,c={format:"png",pixelRatio:B/96};"MAP_ONLY"!==h.layout||
!h.preserveScale||h.outScale&&h.outScale!==b.getScale()||96!==B||!h.exportOptions||h.exportOptions.width%2===b.width%2&&h.exportOptions.height%2===b.height%2||(c.area={x:0,y:0,width:b.width,height:b.height},h.exportOptions.width%2!==b.width%2&&--c.area.width,h.exportOptions.height%2!==b.height%2&&--c.area.height,this._vtlExtent||(B=b.toMap({x:c.area.width,y:c.area.height}),e.update(e.xmin,B.y,B.x,e.ymax,e.spatialReference),this._vtlExtent=e));t.extent=e._normalize(!0).toJson();e=g.takeScreenshot(c);
e.isResolved()?e.then(function(c){"data:image/png;base64,"===c.dataURL.substr(0,22)&&(t.imageData=c.dataURL.substr(22))}):console.error("PrintTask: VectorTileLayer.takeScreenshot() returned an unresolved Promise");t.imageData&&f.push(t);break;case "esri.layers.WebTiledLayer":e=g.url.replace(/\$\{/g,"{");t=q.mixin(t,{type:"WebTiledLayer",urlTemplate:e,credits:g.copyright});g.subDomains&&0<g.subDomains.length&&(t.subDomains=g.subDomains);g._wmtsInfo&&(t.wmtsInfo=g._wmtsInfo);delete t.url;f.push(t);
break;default:if(g.getTileUrl||g.getImageUrl)t=q.mixin(t,{url:g.url}),f.push(t)}z=r.map(b.graphicsLayerIds,b.getLayer,b);for(n=0;n<z.length;n++)g=z[n],g.isFeatureReductionActive&&g.isFeatureReductionActive()&&(g.getSingleGraphics().length?z.splice(++n,0,g.getFeatureReductionLayer()):z[n]=g.getFeatureReductionLayer());for(n=0;n<z.length;n++)if(g=z[n],g.loaded&&g.visible&&(!w||g.isVisibleAtScale(w)))switch(e=g.declaredClass,e){case "esri.layers.CSVLayer":if(this._is11xService){t={id:g.id,url:g.url,
title:g.title,opacity:g.opacity,minScale:g.minScale||0,maxScale:g.maxScale||0,type:"CSV",locationInfo:{latitudeFieldName:g.latitudeFieldName,longitudeFieldName:g.longitudeFieldName},layerDefinition:{drawingInfo:{renderer:g.renderer&&g.renderer.toJson({useLegacyRotationProperties:!0})}}};f.push(t);break}case "esri.layers.FeatureLayer":case "esri.layers.LabelLayer":case "esri.layers.StreamLayer":if("esri.layers.LabelLayer"===e&&!h.showLabels||g.renderer&&"esri.renderer.HeatmapRenderer"===g.renderer.declaredClass)continue;
e=null;g.url&&g.renderer&&("esri.renderer.ScaleDependentRenderer"===g.renderer.declaredClass?"scale"===g.renderer.rangeType?e=g.renderer.getRendererInfoByScale(b.getScale())&&g.renderer.getRendererInfoByScale(b.getScale()).renderer:"zoom"===g.renderer.rangeType&&(e=g.renderer.getRendererInfoByZoom(b.getZoom())&&g.renderer.getRendererInfoByZoom(b.getZoom()).renderer):e=g.renderer);c=e&&"esri.layers.CSVLayer"!==g.declaredClass&&!this._isFeatureCollectionRequired(e,g)&&!e.valueExpression;B=g.isFeatureReductionActive&&
g.isFeatureReductionActive();if(e&&!B&&"esri.renderer.DotDensityRenderer"!==e.declaredClass&&"esri.layers.StreamLayer"!==g.declaredClass&&(this._is11xService||c)&&("esri.renderer.SimpleRenderer"===e.declaredClass||"esri.renderer.TemporalRenderer"===e.declaredClass||null==e.attributeField||q.isString(e.attributeField)&&g._getField(e.attributeField,!0)))if(t={id:g.id,title:q.getObject("arcgisProps.title",!1,g)||g.id,opacity:g.opacity,minScale:g.minScale||0,maxScale:g.maxScale||0,layerDefinition:{drawingInfo:{renderer:e.toJson({useLegacyRotationProperties:!0})}}},
t=q.mixin(t,this._getUrlAndToken(g)),"esri.renderer.TemporalRenderer"===e.declaredClass&&(c=t.layerDefinition.drawingInfo,c.latestObservationRenderer=c.renderer.latestObservationRenderer,c.trackLinesRenderer=c.renderer.trackRenderer,c.observationAger=c.renderer.observationAger,c.renderer=c.renderer.observationRenderer,g._trackIdField&&(t.layerDefinition.timeInfo={trackIdField:g._trackIdField})),this._convertSvgRenderer(t.layerDefinition.drawingInfo.renderer),this._is11xService||1>g.opacity||"esri.renderer.TemporalRenderer"===
e.declaredClass||this._updateLayerOpacity(t))if(g._params.source&&(e=g._params.source.toJson(),q.mixin(t.layerDefinition,{source:e})),g.getDefinitionExpression()&&q.mixin(t.layerDefinition,{definitionExpression:g.getDefinitionExpression()}),2!==g.mode)0<g.getSelectedFeatures().length&&(e=r.map(g.getSelectedFeatures(),function(c){return c.attributes[g.objectIdField]}),0<e.length&&g.getSelectionSymbol()&&q.mixin(t,{selectionObjectIds:e,selectionSymbol:g.getSelectionSymbol().toJson()}));else{e=r.map(g.getSelectedFeatures(),
function(c){return c.attributes[g.objectIdField]});if(0===e.length||!g._params.drawMode)break;q.mixin(t.layerDefinition,{objectIds:e});e=null;g.getSelectionSymbol()&&(e=new k(g.getSelectionSymbol()));q.mixin(t.layerDefinition.drawingInfo,{renderer:e&&e.toJson()})}else t=this._createFeatureCollection(g,b,null,h);else t=e&&(e.valueExpression||this._isFeatureCollectionRequired(e,g)||"esri.renderer.DotDensityRenderer"===e.declaredClass)?this._createFeatureCollection(g,b,e,h):this._createFeatureCollection(g,
b,null,h);if(!t)continue;f.push(t);this.allLayerslegend&&this.allLayerslegend.push({id:g.id});break;case "esri.layers._GraphicsLayer":case "esri.layers.GraphicsLayer":case "esri.layers.WFSLayer":t=this._createFeatureCollection(g,b,null,h);if(!t)continue;f.push(t);this.allLayerslegend&&this.allLayerslegend.push({id:g.id});break;case "esri.layers.ArcGISImageServiceVectorLayer":t={id:g.id,title:q.getObject("arcgisProps.title",!1,g)||g.id,opacity:g.opacity,minScale:g.minScale||0,maxScale:g.maxScale||
0,visibility:g.visible,symbolTileSize:g.symbolTileSize,layerDefinition:{drawingInfo:{renderer:g.renderer.toJson({useLegacyRotationProperties:!0})}}},t=q.mixin(t,this._getUrlAndToken(g)),g.mosaicRule&&q.mixin(t,{mosaicRule:g.mosaicRule.toJson()}),f.push(t),this.allLayerslegend&&this.allLayerslegend.push({id:g.id})}w&&r.forEach(f,function(c){c.minScale=0;c.maxScale=0});b.graphics&&0<b.graphics.graphics.length&&(t=this._createFeatureCollection(b.graphics,b,null,h))&&f.push(t);b._labels&&h.showLabels&&
(t=this._createFeatureCollection(b._labels,b,null,h))&&f.push(t);r.forEach(f,function(c,a,m){c._isRefLayer&&(delete c._isRefLayer,m.splice(a,1),m.push(c))});return f},_getUrlAndToken:function(a){return{token:a._getToken(),url:a._url?a._url.path:null}},_updateLayerOpacity:function(a){var b=this._colorEvaluator(a),b=r.filter(b,function(a){return q.isArray(a)&&4===a.length}),d=!0;if(b.length){var g=b[0][3],k;for(k=1;k<b.length;k++)if(g!==b[k][3]){d=!1;break}if(d)for(a.opacity=g/255,k=0;k<b.length;k++)b[k][3]=
255}return d},_isFeatureCollectionRequired:function(a,b){if(b&&b.isFeatureReductionActive&&b.isFeatureReductionActive())return!0;var d=!1;if(b=this._getVariable(a,"rotationInfo",!1))d=(d=b.field)&&q.isFunction(d)||b.valueExpression;return a.hasVisualVariables("sizeInfo")||a.hasVisualVariables("colorInfo")||a.hasVisualVariables("opacityInfo")||d},_getVariable:function(a,b,d){var g;a&&(g=(a=a.getVisualVariablesForType(b,d))&&a[0]);return g},_applyVisualVariables:function(a,b){var d=b.renderer,g=b.graphic,
k=b.symbol,h=b.mapResolution,e=b.mapScale,l=k.type;if("textsymbol"!==l&&"shieldlabelsymbol"!==l){var n=this._getVariable(d,"sizeInfo",!1),v=this._getVariable(d,"colorInfo",!1),c=this._getVariable(d,"opacityInfo",!1);b=this._getVariable(d,"rotationInfo",!1);k instanceof E&&(n=this._getVariable(d,"sizeInfo","outline")||n);h=n?d.getSize(g,{sizeInfo:n,shape:"simplemarkersymbol"===l?k.style:null,resolution:h,scale:e}):g.size;null!=h&&("simplemarkersymbol"===l?a.size=F.px2pt(h):"picturemarkersymbol"===
l?(e=k.width/k.height*h,a.width=F.px2pt(e),a.height=F.px2pt(h),0!==k.xoffset&&(a.xoffset=F.px2pt(k.xoffset/k.width*e)),0!==k.yoffset&&(a.yoffset=F.px2pt(k.yoffset/k.height*h))):"simplelinesymbol"===l?a.width=F.px2pt(h):a.outline&&(a.outline.width=F.px2pt(h)));v&&(!(k=d.getColor(g,{colorInfo:v}))||"simplemarkersymbol"!==l&&"simplelinesymbol"!==l&&"simplefillsymbol"!==l||(a.color=w.toJsonColor(k)));c&&(k=d.getOpacity(g,{opacityInfo:c}),null!=k&&a.color&&(a.color[3]=Math.round(255*k)));b&&(d=d.getRotationAngle(g,
{rotationInfo:b}))&&(a.angle=-d)}}});e("extend-esri")&&q.setObject("tasks.PrintTask",f,l);return f})},"esri/tasks/Geoprocessor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has dojo/io-query ../kernel ../request ../deferredUtils ../geometry/normalizeUtils ./Task ./FeatureSet ./JobInfo ./GPMessage ./LinearUnit ./DataFile ./RasterData ./Date ./ParameterValue ./GPResultImageLayer ../layers/ArcGISDynamicMapServiceLayer ../layers/MapImage".split(" "),
function(f,q,r,u,y,e,l,n,d,b,w,h,a,z,k,E,C,A,L,D,G,F,H){f=f(h,{declaredClass:"esri.tasks.Geoprocessor",_eventMap:{"execute-complete":["results","messages"],"get-result-data-complete":["result"],"get-result-image-complete":["mapImage"],"get-result-image-layer-complete":["layer"],"job-cancel":["jobInfo"],"job-complete":["jobInfo"],"status-update":["jobInfo"]},constructor:function(a){this._jobUpdateHandler=q.hitch(this,this._jobUpdateHandler);this._getJobStatus=q.hitch(this,this._getJobStatus);this._getResultDataHandler=
q.hitch(this,this._getResultDataHandler);this._getResultImageHandler=q.hitch(this,this._getResultImageHandler);this._executeHandler=q.hitch(this,this._executeHandler);this._updateTimers=[];this.registerConnectEvents()},updateDelay:1E3,processSpatialReference:null,outputSpatialReference:null,outSpatialReference:null,setUpdateDelay:function(a){this.updateDelay=a},setProcessSpatialReference:function(a){this.processSpatialReference=a},setOutputSpatialReference:function(a){this._setOutSR(a)},setOutSpatialReference:function(a){this._setOutSR(a)},
__msigns:[{n:"execute",c:3,a:[{i:0,p:["*"]}],e:2,f:1},{n:"submitJob",c:4,a:[{i:0,p:["*"]}],e:3}],_setOutSR:function(a){this.outSpatialReference=this.outputSpatialReference=a},_getOutSR:function(){return this.outSpatialReference||this.outputSpatialReference},_gpEncode:function(a,b,d){for(var k in a){var g=a[k];q.isArray(g)?a[k]=y.toJson(r.map(g,function(a){return this._gpEncode({item:a},!0).item},this)):g instanceof Date&&(a[k]=g.getTime())}return this._encode(a,b,d)},_decode:function(b){var d=b.dataType,
k=new D(b);if(-1!==r.indexOf(["GPBoolean","GPDouble","GPLong","GPString"],d))return k;if("GPLinearUnit"===d)k.value=new E(k.value);else if("GPFeatureRecordSetLayer"===d||"GPRecordSet"===d)k.value=new a(k.value);else if("GPDataFile"===d)k.value=new C(k.value);else if("GPDate"===d)b=k.value,q.isString(b)?k.value=new L({date:b}):k.value=new Date(b);else if("GPRasterData"===d||"GPRasterDataLayer"===d)b=b.value.mapImage,k.value=b?new H(b):new A(k.value);else if(-1!==d.indexOf("GPMultiValue:")){var h=d.split(":")[1];
b=k.value;k.value=r.map(b,function(a){return this._decode({paramName:"_name",dataType:h,value:a}).value},this)}else console.log(this.declaredClass+" : GP Data type not handled. : "+k.dataType),k=null;return k},submitJob:function(a,b,k,h,g){var e=this._getOutSR(),l=g.assembly;a=this._gpEncode(q.mixin({},this._url.query,{f:"json","env:outSR":e?e.wkid||y.toJson(e.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||y.toJson(this.processSpatialReference.toJson()):
null},a),null,l&&l[0]);var n=this._jobUpdateHandler,f=this._errorHandler;return d({url:this._url.path+"/submitJob",content:a,callbackParamName:"callback",load:function(a,v){n(a,v,!1,b,k,g.dfd)},error:function(a){f(a,h,g.dfd)}})},_jobUpdateHandler:function(a,b,d,k,g,h){var e=a.jobId;b=new z(a);this._successHandler([b],"onStatusUpdate",g,d&&h);if(!d)switch(clearTimeout(this._updateTimers[e]),this._updateTimers[e]=null,h&&h.progress(b),a.jobStatus){case z.STATUS_SUBMITTED:case z.STATUS_EXECUTING:case z.STATUS_WAITING:case z.STATUS_NEW:var l=
this._getJobStatus;this._updateTimers[e]=setTimeout(function(){l(e,d,k,g,h)},this.updateDelay);break;default:this._successHandler([b],"onJobComplete",k,h)}},_getJobStatus:function(a,b,k,h,g){var e=this._jobUpdateHandler;d({url:this._url.path+"/jobs/"+a,content:q.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,d){e(a,d,b,k,h,g)},error:this._errorHandler})},_getResultDataHandler:function(a,b,d,k,g){try{var h=this._decode(a);this._successHandler([h],"onGetResultDataComplete",
d,g)}catch(t){this._errorHandler(t,k,g)}},getResultData:function(a,k,h,e){var g=this._getResultDataHandler,l=this._errorHandler,n=new u(b._dfdCanceller);n._pendingDfd=d({url:this._url.path+"/jobs/"+a+"/results/"+k,content:q.mixin({},this._url.query,{f:"json",returnType:"data"}),callbackParamName:"callback",load:function(a,b){g(a,b,h,e,n)},error:function(a){l(a,e,n)}});return n},checkJobStatus:function(a,k,h){var e=this._jobUpdateHandler,g=this._errorHandler,l=new u(b._dfdCanceller);l._pendingDfd=
d({url:this._url.path+"/jobs/"+a,content:q.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:function(a,b){e(a,b,!0,null,k,l)},error:function(a){g(a,h,l)}});return l},cancelJob:function(a,k,h){var e=this._errorHandler,g=new u(b._dfdCanceller);g._pendingDfd=d({url:this._url.path+"/jobs/"+a+"/cancel",content:q.mixin({},this._url.query,{f:"json"}),callbackParamName:"callback",load:q.hitch(this,function(a,b){this._successHandler([a],"onJobCancel",k,g)}),error:function(a){e(a,h,g)}});
return g},execute:function(a,b,k,h){var g=this._getOutSR(),e=h.assembly;a=this._gpEncode(q.mixin({},this._url.query,{f:"json","env:outSR":g?g.wkid||y.toJson(g.toJson()):null,"env:processSR":this.processSpatialReference?this.processSpatialReference.wkid||y.toJson(this.processSpatialReference.toJson()):null},a),null,e&&e[0]);var l=this._executeHandler,n=this._errorHandler;return d({url:this._url.path+"/execute",content:a,callbackParamName:"callback",load:function(a,d){l(a,d,b,k,h.dfd)},error:function(a){n(a,
k,h.dfd)}})},_executeHandler:function(a,b,d,h,g){try{var e=a.results,l,n,f=a.messages;l=0;for(n=e.length;l<n;l++)e[l]=this._decode(e[l]);l=0;for(n=f.length;l<n;l++)f[l]=new k(f[l]);this._successHandler([e,f],"onExecuteComplete",d,g)}catch(M){this._errorHandler(M,h,g)}},_getResultImageHandler:function(a,b,d,k,h){try{var g=this._decode(a);this._successHandler([g],"onGetResultImageComplete",d,h)}catch(t){this._errorHandler(t,k,h)}},getResultImage:function(a,k,h,e,g){var l=this._getResultImageHandler,
n=this._errorHandler;h=this._gpEncode(q.mixin({},this._url.query,{f:"json"},h.toJson()));var f=new u(b._dfdCanceller);f._pendingDfd=d({url:this._url.path+"/jobs/"+a+"/results/"+k,content:h,callbackParamName:"callback",load:function(a,b){l(a,b,e,g,f)},error:function(a){n(a,g,f)}});return f},cancelJobStatusUpdates:function(a){clearTimeout(this._updateTimers[a]);this._updateTimers[a]=null},getResultImageLayer:function(a,b,d,k){if(null==b){var h=this._url.path.indexOf("/GPServer/");a=this._url.path.substring(0,
h)+"/MapServer/jobs/"+a}else a=this._url.path+"/jobs/"+a+"/results/"+b;this._url.query&&(a+="?"+l.objectToQuery(this._url.query));b=null==b?new F(a,{imageParameters:d}):new G(a,{imageParameters:d},!0);this.onGetResultImageLayerComplete(b);k&&k(b);return b},onStatusUpdate:function(){},onJobComplete:function(){},onExecuteComplete:function(){},onGetResultDataComplete:function(){},onGetResultImageComplete:function(){},onGetResultImageLayerComplete:function(){},onJobCancel:function(){}});w._createWrappers(f);
e("extend-esri")&&q.setObject("tasks.Geoprocessor",f,n);return f})},"esri/tasks/JobInfo":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel","./GPMessage"],function(f,q,r,u,y){f=f(null,{declaredClass:"esri.tasks.JobInfo",constructor:function(e){this.messages=[];q.mixin(this,e);e=this.messages;var l,n=e.length;for(l=0;l<n;l++)e[l]=new y(e[l])},jobId:"",jobStatus:""});q.mixin(f,{STATUS_CANCELLED:"esriJobCancelled",STATUS_CANCELLING:"esriJobCancelling",STATUS_DELETED:"esriJobDeleted",
STATUS_DELETING:"esriJobDeleting",STATUS_EXECUTING:"esriJobExecuting",STATUS_FAILED:"esriJobFailed",STATUS_NEW:"esriJobNew",STATUS_SUBMITTED:"esriJobSubmitted",STATUS_SUCCEEDED:"esriJobSucceeded",STATUS_TIMED_OUT:"esriJobTimedOut",STATUS_WAITING:"esriJobWaiting"});r("extend-esri")&&q.setObject("tasks.JobInfo",f,u);return f})},"esri/tasks/GPMessage":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,q,r,u){f=f(null,{declaredClass:"esri.tasks.GPMessage",constructor:function(f){q.mixin(this,
f)}});q.mixin(f,{TYPE_INFORMATIVE:"esriJobMessageTypeInformative",TYPE_PROCESS_DEFINITION:"esriJobMessageTypeProcessDefinition",TYPE_PROCESS_START:"esriJobMessageTypeProcessStart",TYPE_PROCESS_STOP:"esriJobMessageTypeProcessStop",TYPE_WARNING:"esriJobMessageTypeWarning",TYPE_ERROR:"esriJobMessageTypeError",TYPE_EMPTY:"esriJobMessageTypeEmpty",TYPE_ABORT:"esriJobMessageTypeAbort"});r("extend-esri")&&q.setObject("tasks.GPMessage",f,u);return f})},"esri/tasks/LinearUnit":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel"],function(f,q,r,u){f=f(null,{declaredClass:"esri.tasks.LinearUnit",constructor:function(f){f&&q.mixin(this,f)},distance:0,units:null,toJson:function(){var f={};this.distance&&(f.distance=this.distance);this.units&&(f.units=this.units);return f}});r("extend-esri")&&q.setObject("tasks.LinearUnit",f,u);return f})},"esri/tasks/DataFile":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,q,r,u){f=f(null,{declaredClass:"esri.tasks.DataFile",
constructor:function(f){f&&q.mixin(this,f)},url:null,itemID:null,toJson:function(){var f={};this.url&&(f.url=this.url);this.itemID&&(f.itemID=this.itemID);return f}});r("extend-esri")&&q.setObject("tasks.DataFile",f,u);return f})},"esri/tasks/RasterData":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,q,r,u){f=f(null,{declaredClass:"esri.tasks.RasterData",constructor:function(f){f&&q.mixin(this,f)},url:null,format:null,itemID:null,toJson:function(){var f=
{};this.url&&(f.url=this.url);this.format&&(f.format=this.format);this.itemID&&(f.itemID=this.itemID);return f}});r("extend-esri")&&q.setObject("tasks.RasterData",f,u);return f})},"esri/tasks/Date":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/date/locale","dojo/has","../kernel"],function(f,q,r,u,y){f=f(null,{declaredClass:"esri.tasks.Date",constructor:function(e){e&&(e.format&&(this.format=e.format),this.date=r.parse(e.date,{selector:"date",datePattern:this.format}))},date:new Date,
format:"EEE MMM dd HH:mm:ss zzz yyyy",toJson:function(){return{date:r.format(this.date,{selector:"date",datePattern:this.format}),format:this.format}}});u("extend-esri")&&q.setObject("tasks.Date",f,y);return f})},"esri/tasks/ParameterValue":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,q,r,u){f=f(null,{declaredClass:"esri.tasks.ParameterValue",constructor:function(f){q.mixin(this,f)}});r("extend-esri")&&q.setObject("tasks.ParameterValue",f,u);return f})},
"esri/tasks/GPResultImageLayer":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/json dojo/has dojo/io-query ../kernel ../layers/ArcGISDynamicMapServiceLayer".split(" "),function(f,q,r,u,y,e,l){f=f(l,{declaredClass:"esri.tasks._GPResultImageLayer",constructor:function(e,d){d&&d.imageParameters&&d.imageParameters.extent&&(this.initialExtent=this.fullExtent=d.imageParameters.extent,this.spatialReference=this.initialExtent.spatialReference);this.getImageUrl=q.hitch(this,this.getImageUrl);
this.loaded=!0;this.onLoad(this)},getImageUrl:function(e,d,b,l){var h=e.spatialReference.wkid;l(this._url.path+"?"+y.objectToQuery(q.mixin(this._params,{f:"image",bbox:r.toJson(e.toJson()),bboxSR:h,imageSR:h,size:d+","+b})))}});u("extend-esri")&&q.setObject("tasks._GPResultImageLayer",f,e);return f})},"esri/tasks/PrintTemplate":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/has","../kernel"],function(f,q,r,u){f=f(null,{declaredClass:"esri.tasks.PrintTemplate",label:null,exportOptions:{width:800,
height:1100,dpi:96},layoutOptions:null,format:"PNG32",layout:"MAP_ONLY",outScale:0,preserveScale:!0,forceFeatureAttributes:!1,showAttribution:null,showLabels:!0});r("extend-esri")&&q.setObject("tasks.PrintTemplate",f,u);return f})},"dojox/gfx/canvas":function(){define("./_base dojo/_base/lang dojo/_base/array dojo/_base/declare dojo/_base/window dojo/dom-geometry dojo/dom ./shape ./path ./arc ./matrix ./decompose ./bezierutils".split(" "),function(f,q,r,u,y,e,l,n,d,b,w,h,a){function z(a,c,m,b,d,k,
h,g,e,l){var v,f,n=c.length,x=0;l?(f=l.l/d,x=l.i):f=c[0]/d;for(;k<h;)k+f>h&&(v={l:(k+f-h)*d,i:x},f=h-k),x%2||(a.beginPath(),a.arc(m,b,d,k,k+f,g),e&&a.stroke()),k+=f,++x,f=c[x%n]/d;return v}function k(b,c,m,k){var v=0,d=0,h,g=0;k?(h=k.l,g=k.i):h=c[0];for(;1>d;)d=a.tAtLength(b,h),1==d&&(v=a.computeLength(b),v={l:h-v,i:g}),b=a.splitBezierAtT(b,d),g%2||m.push(b[0]),b=b[1],++g,h=c[g%c.length];return v}function E(a,c,m,b){var v=[c.last.x,c.last.y].concat(m),d=!(a instanceof Array);m=4===m.length?"quadraticCurveTo":
"bezierCurveTo";var h=[];c=k(v,c.canvasDash,h,b);for(b=0;b<h.length;++b)v=h[b],d?(a.moveTo(v[0],v[1]),a[m].apply(a,v.slice(2))):(a.push("moveTo",[v[0],v[1]]),a.push(m,v.slice(2)));return c}function C(b,c,m,d,k,h,g){var v=0,e=0,l=0,f=a.distance(m,d,k,h),n=0;c=c.canvasDash;var x=m,w=d,z,q=!(b instanceof Array);g?(l=g.l,n=g.i):l+=c[0];for(;.01<Math.abs(1-e);)l>f&&(v={l:l-f,i:n},l=f),e=l/f,g=m+(k-m)*e,z=d+(h-d)*e,n++%2||(q?(b.moveTo(x,w),b.lineTo(g,z)):(b.push("moveTo",[x,w]),b.push("lineTo",[g,z]))),
x=g,w=z,l+=c[n%c.length];return v}var A=f.canvas={},L=null,D=w.multiplyPoint,G=Math.PI,F=2*G,H=G/2;h=q.extend;if(y.global.CanvasRenderingContext2D){y=y.doc.createElement("canvas").getContext("2d");var I="function"==typeof y.setLineDash,B="function"==typeof y.fillText}var O={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]};A.Shape=u("dojox.gfx.canvas.Shape",
n.Shape,{_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);this._renderShape(a);this._renderFill(a,!0);this._renderStroke(a,!0);a.restore()},_renderClip:function(a){this.canvasClip&&(this.canvasClip.render(a),a.clip())},_renderTransform:function(a){if("canvasTransform"in this){var c=this.canvasTransform;a.translate(c.dx,c.dy);a.rotate(c.angle2);a.scale(c.sx,c.sy);a.rotate(c.angle1)}},_renderShape:function(a){},_renderFill:function(a,c){if("canvasFill"in this){var m=this.fillStyle;
if("canvasFillImage"in this){var b=m.width,d=m.height,k=this.canvasFillImage.width,v=this.canvasFillImage.height,h=Math.min(b==k?1:b/k,d==v?1:d/v),g=(b-h*k)/2,e=(d-h*v)/2;L.width=b;L.height=d;var l=L.getContext("2d");l.clearRect(0,0,b,d);l.drawImage(this.canvasFillImage,0,0,k,v,g,e,h*k,h*v);this.canvasFill=a.createPattern(L,"repeat");delete this.canvasFillImage}a.fillStyle=this.canvasFill;c&&("pattern"!==m.type||0===m.x&&0===m.y||a.translate(m.x,m.y),a.fill())}else a.fillStyle="rgba(0,0,0,0.0)"},
_renderStroke:function(a,c){var m=this.strokeStyle;m?(a.strokeStyle=m.color.toString(),a.lineWidth=m.width,a.lineCap=m.cap,"number"==typeof m.join?(a.lineJoin="miter",a.miterLimit=m.join):a.lineJoin=m.join,this.canvasDash?I?(a.setLineDash(this.canvasDash),c&&a.stroke()):this._renderDashedStroke(a,c):c&&a.stroke()):c||(a.strokeStyle="rgba(0,0,0,0.0)")},_renderDashedStroke:function(a,c){},getEventSource:function(){return null},on:function(){},connect:function(){},disconnect:function(){},canvasClip:null,
setClip:function(a){this.inherited(arguments);var c=a?"width"in a?"rect":"cx"in a?"ellipse":"points"in a?"polyline":"d"in a?"path":null:null;if(a&&!c)return this;this.canvasClip=a?K(c,a):null;this.parent&&this.parent._makeDirty();return this}});var K=function(a,c){switch(a){case "ellipse":return{canvasEllipse:N({shape:c}),render:function(a){return A.Ellipse.prototype._renderShape.call(this,a)}};case "rect":return{shape:q.delegate(c,{r:0}),render:function(a){return A.Rect.prototype._renderShape.call(this,
a)}};case "path":return{canvasPath:g(c),render:function(a){this.canvasPath._renderShape(a)}};case "polyline":return{canvasPolyline:c.points,render:function(a){return A.Polyline.prototype._renderShape.call(this,a)}}}return null},g=function(a){var c=new dojox.gfx.canvas.Path;c.canvasPath=[];c._setPath(a.d);return c},J=function(a,c,m){var b=a.prototype[c];a.prototype[c]=m?function(){this.parent&&this.parent._makeDirty();b.apply(this,arguments);m.call(this);return this}:function(){this.parent&&this.parent._makeDirty();
return b.apply(this,arguments)}};J(A.Shape,"setTransform",function(){this.matrix?this.canvasTransform=f.decompose(this.matrix):delete this.canvasTransform});J(A.Shape,"setFill",function(){var a=this.fillStyle,c;if(a){if("object"==typeof a&&"type"in a){var m=this.surface.rawNode.getContext("2d");switch(a.type){case "linear":case "radial":c="linear"==a.type?m.createLinearGradient(a.x1,a.y1,a.x2,a.y2):m.createRadialGradient(a.cx,a.cy,0,a.cx,a.cy,a.r);r.forEach(a.colors,function(a){c.addColorStop(a.offset,
f.normalizeColor(a.color).toString())});break;case "pattern":L||(L=document.createElement("canvas")),m=new Image,this.surface.downloadImage(m,a.src),this.canvasFillImage=m}}else c=a.toString();this.canvasFill=c}else delete this.canvasFill});J(A.Shape,"setStroke",function(){var a=this.strokeStyle;if(a){var c=this.strokeStyle.style.toLowerCase();c in O&&(c=O[c]);if(c instanceof Array){this.canvasDash=c=c.slice();var m;for(m=0;m<c.length;++m)c[m]*=a.width;if("butt"!=a.cap){for(m=0;m<c.length;m+=2)c[m]-=
a.width,1>c[m]&&(c[m]=1);for(m=1;m<c.length;m+=2)c[m]+=a.width}}else delete this.canvasDash}else delete this.canvasDash;this._needsDash=!I&&!!this.canvasDash});J(A.Shape,"setShape");A.Group=u("dojox.gfx.canvas.Group",A.Shape,{constructor:function(){n.Container._init.call(this)},_render:function(a){a.save();this._renderTransform(a);this._renderClip(a);for(var c=0;c<this.children.length;++c)this.children[c]._render(a);a.restore()},destroy:function(){n.Container.clear.call(this,!0);A.Shape.prototype.destroy.apply(this,
arguments)}});A.Rect=u("dojox.gfx.canvas.Rect",[A.Shape,n.Rect],{_renderShape:function(a){var c=this.shape,m=Math.min(c.r,c.height/2,c.width/2),b=c.x,d=b+c.width,k=c.y,c=k+c.height,h=b+m,g=d-m,e=k+m,v=c-m;a.beginPath();a.moveTo(h,k);m?(a.arc(g,e,m,-H,0,!1),a.arc(g,v,m,0,H,!1),a.arc(h,v,m,H,G,!1),a.arc(h,e,m,G,G+H,!1)):(a.lineTo(g,k),a.lineTo(d,v),a.lineTo(h,c),a.lineTo(b,e));a.closePath()},_renderDashedStroke:function(a,c){var m=this.shape,b=Math.min(m.r,m.height/2,m.width/2),d=m.x,k=d+m.width,h=
m.y,g=h+m.height,e=d+b,v=k-b,l=h+b,f=g-b;b?(a.beginPath(),m=C(a,this,e,h,v,h),c&&a.stroke(),m=z(a,this.canvasDash,v,l,b,-H,0,!1,c,m),a.beginPath(),m=C(a,this,k,l,k,f,m),c&&a.stroke(),m=z(a,this.canvasDash,v,f,b,0,H,!1,c,m),a.beginPath(),m=C(a,this,v,g,e,g,m),c&&a.stroke(),m=z(a,this.canvasDash,e,f,b,H,G,!1,c,m),a.beginPath(),m=C(a,this,d,f,d,l,m),c&&a.stroke(),z(a,this.canvasDash,e,l,b,G,G+H,!1,c,m)):(a.beginPath(),m=C(a,this,e,h,v,h),m=C(a,this,v,h,k,f,m),m=C(a,this,k,f,e,g,m),C(a,this,e,g,d,l,m),
c&&a.stroke())}});var t=[];(function(){var a=b.curvePI4;t.push(a.s,a.c1,a.c2,a.e);for(var c=45;360>c;c+=45){var m=w.rotateg(c);t.push(D(m,a.c1),D(m,a.c2),D(m,a.e))}})();var N=function(a){var c,b,d,h=[],g=a.shape,e=w.normalize([w.translate(g.cx,g.cy),w.scale(g.rx,g.ry)]);c=D(e,t[0]);h.push([c.x,c.y]);for(g=1;g<t.length;g+=3)b=D(e,t[g]),d=D(e,t[g+1]),c=D(e,t[g+2]),h.push([b.x,b.y,d.x,d.y,c.x,c.y]);if(a._needsDash){c=[];b=h[0];for(g=1;g<h.length;++g)d=[],k(b.concat(h[g]),a.canvasDash,d),b=[h[g][4],h[g][5]],
c.push(d);a._dashedPoints=c}return h};A.Ellipse=u("dojox.gfx.canvas.Ellipse",[A.Shape,n.Ellipse],{setShape:function(){this.inherited(arguments);this.canvasEllipse=N(this);return this},setStroke:function(){this.inherited(arguments);I||(this.canvasEllipse=N(this));return this},_renderShape:function(a){var c=this.canvasEllipse,b;a.beginPath();a.moveTo.apply(a,c[0]);for(b=1;b<c.length;++b)a.bezierCurveTo.apply(a,c[b]);a.closePath()},_renderDashedStroke:function(a,c){var b=this._dashedPoints;a.beginPath();
for(var d=0;d<b.length;++d)for(var k=b[d],h=0;h<k.length;++h){var g=k[h];a.moveTo(g[0],g[1]);a.bezierCurveTo(g[2],g[3],g[4],g[5],g[6],g[7])}c&&a.stroke()}});A.Circle=u("dojox.gfx.canvas.Circle",[A.Shape,n.Circle],{_renderShape:function(a){var c=this.shape;a.beginPath();a.arc(c.cx,c.cy,c.r,0,F,1)},_renderDashedStroke:function(a,c){var b=this.shape,d=0,k,h=this.canvasDash.length;for(i=0;d<F;)k=this.canvasDash[i%h]/b.r,i%2||(a.beginPath(),a.arc(b.cx,b.cy,b.r,d,d+k,0),c&&a.stroke()),d+=k,++i}});A.Line=
u("dojox.gfx.canvas.Line",[A.Shape,n.Line],{_renderShape:function(a){var c=this.shape;a.beginPath();a.moveTo(c.x1,c.y1);a.lineTo(c.x2,c.y2)},_renderDashedStroke:function(a,c){var b=this.shape;a.beginPath();C(a,this,b.x1,b.y1,b.x2,b.y2);c&&a.stroke()}});A.Polyline=u("dojox.gfx.canvas.Polyline",[A.Shape,n.Polyline],{setShape:function(){this.inherited(arguments);var a=this.shape.points,c=a[0],b,d;this.bbox=null;this._normalizePoints();if(a.length)if("number"==typeof c)c=a;else for(c=[],d=0;d<a.length;++d)b=
a[d],c.push(b.x,b.y);else c=[];this.canvasPolyline=c;return this},_renderShape:function(a){var c=this.canvasPolyline;if(c.length){a.beginPath();a.moveTo(c[0],c[1]);for(var b=2;b<c.length;b+=2)a.lineTo(c[b],c[b+1])}},_renderDashedStroke:function(a,c){var b=this.canvasPolyline,d=0;a.beginPath();for(var k=0;k<b.length;k+=2)d=C(a,this,b[k],b[k+1],b[k+2],b[k+3],d);c&&a.stroke()}});A.Image=u("dojox.gfx.canvas.Image",[A.Shape,n.Image],{setShape:function(){this.inherited(arguments);var a=new Image;this.surface.downloadImage(a,
this.shape.src);this.canvasImage=a;return this},_renderShape:function(a){var c=this.shape;a.drawImage(this.canvasImage,c.x,c.y,c.width,c.height)}});A.Text=u("dojox.gfx.canvas.Text",[A.Shape,n.Text],{_setFont:function(){this.fontStyle?this.canvasFont=f.makeFontString(this.fontStyle):delete this.canvasFont},getTextWidth:function(){var a=this.shape,c=0,b;a.text&&(b=this.surface.rawNode.getContext("2d"),b.save(),this._renderTransform(b),this._renderFill(b,!1),this._renderStroke(b,!1),this.canvasFont&&
(b.font=this.canvasFont),c=b.measureText(a.text).width,b.restore());return c},_render:function(a){a.save();this._renderTransform(a);this._renderFill(a,!1);this._renderStroke(a,!1);this._renderShape(a);a.restore()},_renderShape:function(a){var c=this.shape;c.text&&(a.textAlign="middle"===c.align?"center":c.align,this.canvasFont&&(a.font=this.canvasFont),this.canvasFill&&a.fillText(c.text,c.x,c.y),this.strokeStyle&&(a.beginPath(),a.strokeText(c.text,c.x,c.y),a.closePath()))}});J(A.Text,"setFont");B||
A.Text.extend({getTextWidth:function(){return 0},getBoundingBox:function(){return null},_renderShape:function(){}});var P={M:"_moveToA",m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"};A.Path=u("dojox.gfx.canvas.Path",[A.Shape,d.Path],{constructor:function(){this.lastControl=
{}},setShape:function(){this.canvasPath=[];this._dashedPath=[];return this.inherited(arguments)},setStroke:function(){this.inherited(arguments);I||(this.segmented=!1,this._confirmSegmented());return this},_setPath:function(){this._dashResidue=null;this.inherited(arguments)},_updateWithSegment:function(a){var c=q.clone(this.last);this[P[a.action]](this.canvasPath,a.action,a.args,this._needsDash?this._dashedPath:null);this.last=c;this.inherited(arguments)},_renderShape:function(a){var c=this.canvasPath;
a.beginPath();for(var b=0;b<c.length;b+=2)a[c[b]].apply(a,c[b+1])},_renderDashedStroke:I?function(){}:function(a,c){var b=this._dashedPath;a.beginPath();for(var d=0;d<b.length;d+=2)a[b[d]].apply(a,b[d+1]);c&&a.stroke()},_moveToA:function(a,c,b,d){a.push("moveTo",[b[0],b[1]]);d&&d.push("moveTo",[b[0],b[1]]);for(c=2;c<b.length;c+=2)a.push("lineTo",[b[c],b[c+1]]),d&&(this._dashResidue=C(d,this,b[c-2],b[c-1],b[c],b[c+1],this._dashResidue));this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl=
{}},_moveToR:function(a,c,b,d){c="x"in this.last?[this.last.x+=b[0],this.last.y+=b[1]]:[this.last.x=b[0],this.last.y=b[1]];a.push("moveTo",c);d&&d.push("moveTo",c);for(c=2;c<b.length;c+=2)a.push("lineTo",[this.last.x+=b[c],this.last.y+=b[c+1]]),d&&(this._dashResidue=C(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_lineToA:function(a,c,b,d){for(c=0;c<b.length;c+=2)d&&(this._dashResidue=C(d,this,this.last.x,this.last.y,b[c],b[c+1],this._dashResidue)),
a.push("lineTo",[b[c],b[c+1]]);this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl={}},_lineToR:function(a,c,b,d){for(c=0;c<b.length;c+=2)a.push("lineTo",[this.last.x+=b[c],this.last.y+=b[c+1]]),d&&(this._dashResidue=C(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_hLineToA:function(a,c,b,d){for(c=0;c<b.length;++c)a.push("lineTo",[b[c],this.last.y]),d&&(this._dashResidue=C(d,this,d[d.length-1][0],d[d.length-1][1],b[c],this.last.y,
this._dashResidue));this.last.x=b[b.length-1];this.lastControl={}},_hLineToR:function(a,c,b,d){for(c=0;c<b.length;++c)a.push("lineTo",[this.last.x+=b[c],this.last.y]),d&&(this._dashResidue=C(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_vLineToA:function(a,c,b,d){for(c=0;c<b.length;++c)a.push("lineTo",[this.last.x,b[c]]),d&&(this._dashResidue=C(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,b[c],this._dashResidue));this.last.y=b[b.length-
1];this.lastControl={}},_vLineToR:function(a,c,b,d){for(c=0;c<b.length;++c)a.push("lineTo",[this.last.x,this.last.y+=b[c]]),d&&(this._dashResidue=C(d,this,d[d.length-1][0],d[d.length-1][1],this.last.x,this.last.y,this._dashResidue));this.lastControl={}},_curveToA:function(a,c,b,d){for(c=0;c<b.length;c+=6)a.push("bezierCurveTo",b.slice(c,c+6)),d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue));this.last.x=b[b.length-2];this.last.y=b[b.length-1];this.lastControl.x=b[b.length-4];this.lastControl.y=
b[b.length-3];this.lastControl.type="C"},_curveToR:function(a,c,b,d){for(c=0;c<b.length;c+=6)a.push("bezierCurveTo",[this.last.x+b[c],this.last.y+b[c+1],this.lastControl.x=this.last.x+b[c+2],this.lastControl.y=this.last.y+b[c+3],this.last.x+b[c+4],this.last.y+b[c+5]]),d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue)),this.last.x+=b[c+4],this.last.y+=b[c+5];this.lastControl.type="C"},_smoothCurveToA:function(a,c,b,d){for(c=0;c<b.length;c+=4){var k="C"==this.lastControl.type;a.push("bezierCurveTo",
[k?2*this.last.x-this.lastControl.x:this.last.x,k?2*this.last.y-this.lastControl.y:this.last.y,b[c],b[c+1],b[c+2],b[c+3]]);d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=b[c];this.lastControl.y=b[c+1];this.lastControl.type="C"}this.last.x=b[b.length-2];this.last.y=b[b.length-1]},_smoothCurveToR:function(a,c,b,d){for(c=0;c<b.length;c+=4){var k="C"==this.lastControl.type;a.push("bezierCurveTo",[k?2*this.last.x-this.lastControl.x:this.last.x,k?2*this.last.y-this.lastControl.y:
this.last.y,this.last.x+b[c],this.last.y+b[c+1],this.last.x+b[c+2],this.last.y+b[c+3]]);d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue));this.lastControl.x=this.last.x+b[c];this.lastControl.y=this.last.y+b[c+1];this.lastControl.type="C";this.last.x+=b[c+2];this.last.y+=b[c+3]}},_qCurveToA:function(a,c,b,d){for(c=0;c<b.length;c+=4)a.push("quadraticCurveTo",b.slice(c,c+4));d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue));this.last.x=b[b.length-2];this.last.y=b[b.length-
1];this.lastControl.x=b[b.length-4];this.lastControl.y=b[b.length-3];this.lastControl.type="Q"},_qCurveToR:function(a,c,b,d){for(c=0;c<b.length;c+=4)a.push("quadraticCurveTo",[this.lastControl.x=this.last.x+b[c],this.lastControl.y=this.last.y+b[c+1],this.last.x+b[c+2],this.last.y+b[c+3]]),d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue)),this.last.x+=b[c+2],this.last.y+=b[c+3];this.lastControl.type="Q"},_qSmoothCurveToA:function(a,c,b,d){for(c=0;c<b.length;c+=2){var k="Q"==this.lastControl.type;
a.push("quadraticCurveTo",[this.lastControl.x=k?2*this.last.x-this.lastControl.x:this.last.x,this.lastControl.y=k?2*this.last.y-this.lastControl.y:this.last.y,b[c],b[c+1]]);d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q"}this.last.x=b[b.length-2];this.last.y=b[b.length-1]},_qSmoothCurveToR:function(a,c,b,d){for(c=0;c<b.length;c+=2){var k="Q"==this.lastControl.type;a.push("quadraticCurveTo",[this.lastControl.x=k?2*this.last.x-this.lastControl.x:this.last.x,
this.lastControl.y=k?2*this.last.y-this.lastControl.y:this.last.y,this.last.x+b[c],this.last.y+b[c+1]]);d&&(this._dashResidue=E(d,this,a[a.length-1],this._dashResidue));this.lastControl.type="Q";this.last.x+=b[c];this.last.y+=b[c+1]}},_arcTo:function(a,c,d,k){c="a"==c;for(var h=0;h<d.length;h+=7){var g=d[h+5],e=d[h+6];c&&(g+=this.last.x,e+=this.last.y);var l=b.arcAsBezier(this.last,d[h],d[h+1],d[h+2],d[h+3]?1:0,d[h+4]?1:0,g,e);r.forEach(l,function(c){a.push("bezierCurveTo",c)});k&&(this._dashResidue=
E(k,this,p,this._dashResidue));this.last.x=g;this.last.y=e}this.lastControl={}},_closePath:function(a,c,b,d){a.push("closePath",[]);d&&(this._dashResidue=C(d,this,this.last.x,this.last.y,d[1][0],d[1][1],this._dashResidue));this.lastControl={}}});r.forEach("moveTo lineTo hLineTo vLineTo curveTo smoothCurveTo qCurveTo qSmoothCurveTo arcTo closePath".split(" "),function(a){J(A.Path,a)});A.TextPath=u("dojox.gfx.canvas.TextPath",[A.Shape,d.TextPath],{_renderShape:function(a){},_setText:function(){},_setFont:function(){}});
A.Surface=u("dojox.gfx.canvas.Surface",n.Surface,{constructor:function(){n.Container._init.call(this);this.pendingImageCount=0;this.makeDirty()},destroy:function(){n.Container.clear.call(this,!0);this.inherited(arguments)},setDimensions:function(a,c){this.width=f.normalizedLength(a);this.height=f.normalizedLength(c);if(!this.rawNode)return this;a=!1;this.rawNode.width!=this.width&&(this.rawNode.width=this.width,a=!0);this.rawNode.height!=this.height&&(this.rawNode.height=this.height,a=!0);a&&this.makeDirty();
return this},getDimensions:function(){return this.rawNode?{width:this.rawNode.width,height:this.rawNode.height}:null},_render:function(a){!this.rawNode||!a&&this.pendingImageCount||(a=this.rawNode.getContext("2d"),a.clearRect(0,0,this.rawNode.width,this.rawNode.height),this.render(a),"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender))},render:function(a){a.save();for(var c=0;c<this.children.length;++c)this.children[c]._render(a);a.restore()},makeDirty:function(){this.pendingImagesCount||
"pendingRender"in this||this._batch||(this.pendingRender=setTimeout(q.hitch(this,this._render),0))},downloadImage:function(a,c){var b=q.hitch(this,this.onImageLoad);!this.pendingImageCount++&&"pendingRender"in this&&(clearTimeout(this.pendingRender),delete this.pendingRender);a.onload=b;a.onerror=b;a.onabort=b;a.src=c},onImageLoad:function(){--this.pendingImageCount||(this.onImagesLoaded(),this._render())},onImagesLoaded:function(){},getEventSource:function(){return null},connect:function(){},disconnect:function(){},
on:function(){}});A.createSurface=function(a,c,b){if(!c&&!b){var d=e.position(a);c=c||d.w;b=b||d.h}"number"==typeof c&&(c+="px");"number"==typeof b&&(b+="px");d=new A.Surface;a=l.byId(a);var k=a.ownerDocument.createElement("canvas");k.width=f.normalizedLength(c);k.height=f.normalizedLength(b);a.appendChild(k);d.rawNode=k;d._parent=a;return d.surface=d};var M=n.Container;u={openBatch:function(){++this._batch;return this},closeBatch:function(){this._batch=0<this._batch?--this._batch:0;this._makeDirty();
return this},_makeDirty:function(){this._batch||this.surface.makeDirty()},add:function(a){this._makeDirty();return M.add.apply(this,arguments)},remove:function(a,c){this._makeDirty();return M.remove.apply(this,arguments)},clear:function(){this._makeDirty();return M.clear.apply(this,arguments)},getBoundingBox:M.getBoundingBox,_moveChildToFront:function(a){this._makeDirty();return M._moveChildToFront.apply(this,arguments)},_moveChildToBack:function(a){this._makeDirty();return M._moveChildToBack.apply(this,
arguments)}};d={createObject:function(a,c){a=new a;a.surface=this.surface;a.setShape(c);this.add(a);return a}};h(A.Group,u);h(A.Group,n.Creator);h(A.Group,d);h(A.Surface,u);h(A.Surface,n.Creator);h(A.Surface,d);A.fixTarget=function(a,c){return!0};return A})},"dojox/gfx/shape":function(){define("./_base dojo/_base/lang dojo/_base/declare dojo/_base/kernel dojo/_base/sniff dojo/on dojo/_base/array dojo/dom-construct dojo/_base/Color ./matrix".split(" "),function(f,q,r,u,y,e,l,n,d,b){function w(a,b){for(var d=
a.length-1;b<d;)a[b]=a[++b];a.length=d}var h=f.shape={};h.Shape=r("dojox.gfx.shape.Shape",null,{constructor:function(){this.parentMatrix=this.parent=this.bbox=this.strokeStyle=this.fillStyle=this.matrix=this.shape=this.rawNode=null;if(y("gfxRegistry")){var a=h.register(this);this.getUID=function(){return a}}},destroy:function(){y("gfxRegistry")&&h.dispose(this);this.rawNode&&"__gfxObject__"in this.rawNode&&(this.rawNode.__gfxObject__=null);this.rawNode=null},getNode:function(){return this.rawNode},
getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var a=this.getBoundingBox();if(!a)return null;var d=this._getRealMatrix();return[b.multiplyPoint(d,a.x,a.y),b.multiplyPoint(d,a.x+a.width,a.y),b.multiplyPoint(d,a.x+a.width,a.y+a.height),b.multiplyPoint(d,a.x,
a.y+a.height)]},getEventSource:function(){return this.rawNode},setClip:function(a){this.clip=a},getClip:function(){return this.clip},setShape:function(a){this.shape=f.makeParameters(this.shape,a);this.bbox=null;return this},setFill:function(a){if(!a)return this.fillStyle=null,this;var b=null;if("object"==typeof a&&"type"in a)switch(a.type){case "linear":b=f.makeParameters(f.defaultLinearGradient,a);break;case "radial":b=f.makeParameters(f.defaultRadialGradient,a);break;case "pattern":b=f.makeParameters(f.defaultPattern,
a)}else b=f.normalizeColor(a);this.fillStyle=b;return this},setStroke:function(a){if(!a)return this.strokeStyle=null,this;if("string"==typeof a||q.isArray(a)||a instanceof d)a={color:a};a=this.strokeStyle=f.makeParameters(f.defaultStroke,a);a.color=f.normalizeColor(a.color);return this},setTransform:function(a){this.matrix=b.clone(a?b.normalize(a):b.identity);return this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var a=this.getParent();a&&(a._moveChildToFront(this),
this._moveToFront());return this},moveToBack:function(){var a=this.getParent();a&&(a._moveChildToBack(this),this._moveToBack());return this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(a){return a?this.setTransform([this.matrix,a]):this},applyLeftTransform:function(a){return a?this.setTransform([a,this.matrix]):this},applyTransform:function(a){return a?this.setTransform([this.matrix,a]):this},removeShape:function(a){this.parent&&this.parent.remove(this,a);return this},
_setParent:function(a,b){this.parent=a;return this._updateParentMatrix(b)},_updateParentMatrix:function(a){this.parentMatrix=a?b.clone(a):null;return this._applyTransform()},_getRealMatrix:function(){for(var a=this.matrix,d=this.parent;d;)d.matrix&&(a=b.multiply(d.matrix,a)),d=d.parent;return a}});h._eventsProcessing={on:function(a,b){return e(this.getEventSource(),a,h.fixCallback(this,f.fixTarget,b))},connect:function(a,b,d){"on"==a.substring(0,2)&&(a=a.substring(2));return this.on(a,d?q.hitch(b,
d):b)},disconnect:function(a){return a.remove()}};h.fixCallback=function(a,b,d,h){h||(h=d,d=null);if(q.isString(h)){d=d||u.global;if(!d[h])throw['dojox.gfx.shape.fixCallback: scope["',h,'"] is null (scope\x3d"',d,'")'].join("");return function(k){return b(k,a)?d[h].apply(d,arguments||[]):void 0}}return d?function(k){return b(k,a)?h.apply(d,arguments||[]):void 0}:function(k){return b(k,a)?h.apply(d,arguments):void 0}};q.extend(h.Shape,h._eventsProcessing);h.Container={_init:function(){this.children=
[];this._batch=0},openBatch:function(){return this},closeBatch:function(){return this},add:function(a){var b=a.getParent();b&&b.remove(a,!0);this.children.push(a);return a._setParent(this,this._getRealMatrix())},remove:function(a,b){for(var d=0;d<this.children.length;++d)if(this.children[d]==a){b||(a.parent=null,a.parentMatrix=null);w(this.children,d);break}return this},clear:function(a){for(var b,d=0;d<this.children.length;++d)b=this.children[d],b.parent=null,b.parentMatrix=null,a&&b.destroy();this.children=
[];return this},getBoundingBox:function(){if(this.children){var a=null;l.forEach(this.children,function(d){var k=d.getBoundingBox();k&&((d=d.getTransform())&&(k=b.multiplyRectangle(d,k)),a?(a.x=Math.min(a.x,k.x),a.y=Math.min(a.y,k.y),a.endX=Math.max(a.endX,k.x+k.width),a.endY=Math.max(a.endY,k.y+k.height)):a={x:k.x,y:k.y,endX:k.x+k.width,endY:k.y+k.height})});a&&(a.width=a.endX-a.x,a.height=a.endY-a.y);return a}return null},_moveChildToFront:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==
a){w(this.children,b);this.children.push(a);break}return this},_moveChildToBack:function(a){for(var b=0;b<this.children.length;++b)if(this.children[b]==a){w(this.children,b);this.children.unshift(a);break}return this}};h.Surface=r("dojox.gfx.shape.Surface",null,{constructor:function(){this._parent=this.rawNode=null;this._nodes=[];this._events=[]},destroy:function(){l.forEach(this._nodes,n.destroy);this._nodes=[];l.forEach(this._events,function(a){a&&a.remove()});this._events=[];this.rawNode=null;
if(y("ie"))for(;this._parent.lastChild;)n.destroy(this._parent.lastChild);else this._parent.innerHTML="";this._parent=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null},isLoaded:!0,onLoad:function(a){},whenLoaded:function(a,b){var d=q.hitch(a,b);if(this.isLoaded)d(this);else e.once(this,"load",function(a){d(a)})}});q.extend(h.Surface,h._eventsProcessing);h.Rect=r("dojox.gfx.shape.Rect",h.Shape,{constructor:function(a){this.shape=f.getDefault("Rect");this.rawNode=
a},getBoundingBox:function(){return this.shape}});h.Ellipse=r("dojox.gfx.shape.Ellipse",h.Shape,{constructor:function(a){this.shape=f.getDefault("Ellipse");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-a.rx,y:a.cy-a.ry,width:2*a.rx,height:2*a.ry}}return this.bbox}});h.Circle=r("dojox.gfx.shape.Circle",h.Shape,{constructor:function(a){this.shape=f.getDefault("Circle");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:a.cx-
a.r,y:a.cy-a.r,width:2*a.r,height:2*a.r}}return this.bbox}});h.Line=r("dojox.gfx.shape.Line",h.Shape,{constructor:function(a){this.shape=f.getDefault("Line");this.rawNode=a},getBoundingBox:function(){if(!this.bbox){var a=this.shape;this.bbox={x:Math.min(a.x1,a.x2),y:Math.min(a.y1,a.y2),width:Math.abs(a.x2-a.x1),height:Math.abs(a.y2-a.y1)}}return this.bbox}});h.Polyline=r("dojox.gfx.shape.Polyline",h.Shape,{constructor:function(a){this.shape=f.getDefault("Polyline");this.rawNode=a},setShape:function(a,
b){a&&a instanceof Array?(this.inherited(arguments,[{points:a}]),b&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.inherited(arguments,[a]);return this},_normalizePoints:function(){var a=this.shape.points,b=a&&a.length;if(b&&"number"==typeof a[0]){for(var d=[],h=0;h<b;h+=2)d.push({x:a[h],y:a[h+1]});this.shape.points=d}},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var a=this.shape.points,b=a.length,d=a[0],h=d.x,e=d.y,l=d.x,f=d.y,n=1;n<b;++n)d=
a[n],h>d.x&&(h=d.x),l<d.x&&(l=d.x),e>d.y&&(e=d.y),f<d.y&&(f=d.y);this.bbox={x:h,y:e,width:l-h,height:f-e}}return this.bbox}});h.Image=r("dojox.gfx.shape.Image",h.Shape,{constructor:function(a){this.shape=f.getDefault("Image");this.rawNode=a},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}});h.Text=r(h.Shape,{constructor:function(a){this.fontStyle=null;this.shape=f.getDefault("Text");this.rawNode=a},getFont:function(){return this.fontStyle},
setFont:function(a){this.fontStyle="string"==typeof a?f.splitFontString(a):f.makeParameters(f.defaultFont,a);this._setFont();return this},getBoundingBox:function(){var a=null;this.getShape().text&&(a=f._base._computeTextBoundingBox(this));return a}});h.Creator={createShape:function(a){switch(a.type){case f.defaultPath.type:return this.createPath(a);case f.defaultRect.type:return this.createRect(a);case f.defaultCircle.type:return this.createCircle(a);case f.defaultEllipse.type:return this.createEllipse(a);
case f.defaultLine.type:return this.createLine(a);case f.defaultPolyline.type:return this.createPolyline(a);case f.defaultImage.type:return this.createImage(a);case f.defaultText.type:return this.createText(a);case f.defaultTextPath.type:return this.createTextPath(a)}return null},createGroup:function(){return this.createObject(f.Group)},createRect:function(a){return this.createObject(f.Rect,a)},createEllipse:function(a){return this.createObject(f.Ellipse,a)},createCircle:function(a){return this.createObject(f.Circle,
a)},createLine:function(a){return this.createObject(f.Line,a)},createPolyline:function(a){return this.createObject(f.Polyline,a)},createImage:function(a){return this.createObject(f.Image,a)},createText:function(a){return this.createObject(f.Text,a)},createPath:function(a){return this.createObject(f.Path,a)},createTextPath:function(a){return this.createObject(f.TextPath,{}).setText(a)},createObject:function(a,b){return null}};return h})},"dojox/gfx/path":function(){define(["./_base","dojo/_base/lang",
"dojo/_base/declare","./matrix","./shape"],function(f,q,r,u,y){y=r("dojox.gfx.path.Path",y.Shape,{constructor:function(e){this.shape=q.clone(f.defaultPath);this.segments=[];this.tbbox=null;this.absolute=!0;this.last={};this.rawNode=e;this.segmented=!1},setAbsoluteMode:function(e){this._confirmSegmented();this.absolute="string"==typeof e?"absolute"==e:e;return this},getAbsoluteMode:function(){this._confirmSegmented();return this.absolute},getBoundingBox:function(){this._confirmSegmented();return this.bbox&&
"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},_getRealBBox:function(){this._confirmSegmented();if(this.tbbox)return this.tbbox;var e=this.bbox,l=this._getRealMatrix();this.bbox=null;for(var f=0,d=this.segments.length;f<d;++f)this._updateWithSegment(this.segments[f],l);l=this.bbox;this.bbox=e;return this.tbbox=l?[{x:l.l,y:l.t},{x:l.r,y:l.t},{x:l.r,y:l.b},{x:l.l,y:l.b}]:null},getLastPosition:function(){this._confirmSegmented();return"x"in
this.last?this.last:null},_applyTransform:function(){this.tbbox=null;return this.inherited(arguments)},_updateBBox:function(e,l,f){f&&(l=u.multiplyPoint(f,e,l),e=l.x,l=l.y);this.bbox&&"l"in this.bbox?(this.bbox.l>e&&(this.bbox.l=e),this.bbox.r<e&&(this.bbox.r=e),this.bbox.t>l&&(this.bbox.t=l),this.bbox.b<l&&(this.bbox.b=l)):this.bbox={l:e,b:l,r:e,t:l}},_updateWithSegment:function(e,l){var n=e.args,d=n.length,b;switch(e.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(b=0;b<d;b+=2)this._updateBBox(n[b],
n[b+1],l);this.last.x=n[d-2];this.last.y=n[d-1];this.absolute=!0;break;case "H":for(b=0;b<d;++b)this._updateBBox(n[b],this.last.y,l);this.last.x=n[d-1];this.absolute=!0;break;case "V":for(b=0;b<d;++b)this._updateBBox(this.last.x,n[b],l);this.last.y=n[d-1];this.absolute=!0;break;case "m":b=0;"x"in this.last||(this._updateBBox(this.last.x=n[0],this.last.y=n[1],l),b=2);for(;b<d;b+=2)this._updateBBox(this.last.x+=n[b],this.last.y+=n[b+1],l);this.absolute=!1;break;case "l":case "t":for(b=0;b<d;b+=2)this._updateBBox(this.last.x+=
n[b],this.last.y+=n[b+1],l);this.absolute=!1;break;case "h":for(b=0;b<d;++b)this._updateBBox(this.last.x+=n[b],this.last.y,l);this.absolute=!1;break;case "v":for(b=0;b<d;++b)this._updateBBox(this.last.x,this.last.y+=n[b],l);this.absolute=!1;break;case "c":for(b=0;b<d;b+=6)this._updateBBox(this.last.x+n[b],this.last.y+n[b+1],l),this._updateBBox(this.last.x+n[b+2],this.last.y+n[b+3],l),this._updateBBox(this.last.x+=n[b+4],this.last.y+=n[b+5],l);this.absolute=!1;break;case "s":case "q":for(b=0;b<d;b+=
4)this._updateBBox(this.last.x+n[b],this.last.y+n[b+1],l),this._updateBBox(this.last.x+=n[b+2],this.last.y+=n[b+3],l);this.absolute=!1;break;case "A":for(b=0;b<d;b+=7)this._updateBBox(n[b+5],n[b+6],l);this.last.x=n[d-2];this.last.y=n[d-1];this.absolute=!0;break;case "a":for(b=0;b<d;b+=7)this._updateBBox(this.last.x+=n[b+5],this.last.y+=n[b+6],l);this.absolute=!1}e=[e.action];for(b=0;b<d;++b)e.push(f.formatNumber(n[b],!0));if("string"==typeof this.shape.path)this.shape.path+=e.join("");else for(b=
0,d=e.length;b<d;++b)this.shape.path.push(e[b])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(e,l){this.tbbox=null;var f=this._validSegments[e.toLowerCase()];"number"==typeof f&&(f?l.length>=f&&(e={action:e,args:l.slice(0,l.length-l.length%f)},this.segments.push(e),this._updateWithSegment(e)):(e={action:e,args:[]},this.segments.push(e),this._updateWithSegment(e)))},_collectArgs:function(e,f){for(var l=0;l<f.length;++l){var d=f[l];"boolean"==typeof d?e.push(d?1:0):
"number"==typeof d?e.push(d):d instanceof Array?this._collectArgs(e,d):"x"in d&&"y"in d&&e.push(d.x,d.y)}},moveTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"M":"m",e);return this},lineTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"L":"l",e);return this},hLineTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?
"H":"h",e);return this},vLineTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"V":"v",e);return this},curveTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"C":"c",e);return this},smoothCurveTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"S":"s",e);return this},qCurveTo:function(){this._confirmSegmented();var e=
[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"Q":"q",e);return this},qSmoothCurveTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"T":"t",e);return this},arcTo:function(){this._confirmSegmented();var e=[];this._collectArgs(e,arguments);this._pushSegment(this.absolute?"A":"a",e);return this},closePath:function(){this._confirmSegmented();this._pushSegment("Z",[]);return this},_confirmSegmented:function(){if(!this.segmented){var e=
this.shape.path;this.shape.path=[];this._setPath(e);this.shape.path=this.shape.path.join("");this.segmented=!0}},_setPath:function(e){e=q.isArray(e)?e:e.match(f.pathSvgRegExp);this.segments=[];this.absolute=!0;this.bbox={};this.last={};if(e){for(var l="",n=[],d=e.length,b=0;b<d;++b){var w=e[b],h=parseFloat(w);isNaN(h)?(l&&this._pushSegment(l,n),n=[],l=w):n.push(h)}this._pushSegment(l,n)}},setShape:function(e){this.inherited(arguments,["string"==typeof e?{path:e}:e]);this.segmented=!1;this.segments=
[];f.lazyPathSegmentation||this._confirmSegmented();return this},_2PI:2*Math.PI});r=r("dojox.gfx.path.TextPath",y,{constructor:function(e){"text"in this||(this.text=q.clone(f.defaultTextPath));"fontStyle"in this||(this.fontStyle=q.clone(f.defaultFont))},getText:function(){return this.text},setText:function(e){this.text=f.makeParameters(this.text,"string"==typeof e?{text:e}:e);this._setText();return this},getFont:function(){return this.fontStyle},setFont:function(e){this.fontStyle="string"==typeof e?
f.splitFontString(e):f.makeParameters(f.defaultFont,e);this._setFont();return this}});return f.path={Path:y,TextPath:r}})},"dojox/gfx/arc":function(){define(["./_base","dojo/_base/lang","./matrix"],function(f,q,r){function u(b){var d=Math.cos(b);b=Math.sin(b);var h={x:d+4/3*(1-d),y:b-4/3*d*(1-d)/b};return{s:{x:d,y:-b},c1:{x:h.x,y:-h.y},c2:h,e:{x:d,y:b}}}var y=2*Math.PI,e=Math.PI/4,l=Math.PI/8,n=e+l,d=u(l);return f.arc={unitArcAsBezier:u,curvePI4:d,arcAsBezier:function(b,f,h,a,q,k,E,C){q=!!q;k=!!k;
var w=r._degToRad(a);a=f*f;var z=h*h,D=r.multiplyPoint(r.rotate(-w),{x:(b.x-E)/2,y:(b.y-C)/2}),G=D.x*D.x,F=D.y*D.y;a=Math.sqrt((a*z-a*F-z*G)/(a*F+z*G));isNaN(a)&&(a=0);a={x:a*f*D.y/h,y:-a*h*D.x/f};q==k&&(a={x:-a.x,y:-a.y});a=r.multiplyPoint([r.translate((b.x+E)/2,(b.y+C)/2),r.rotate(w)],a);f=r.normalize([r.translate(a.x,a.y),r.rotate(w),r.scale(f,h)]);a=r.invert(f);b=r.multiplyPoint(a,b);C=r.multiplyPoint(a,E,C);E=Math.atan2(b.y,b.x);a=E-Math.atan2(C.y,C.x);k&&(a=-a);0>a?a+=y:a>y&&(a-=y);h=l;C=d;
h=k?h:-h;b=[];for(q=a;0<q;q-=e)q<n&&(h=q/2,C=u(h),h=k?h:-h,q=0),D=r.normalize([f,r.rotate(E+h)]),k?(a=r.multiplyPoint(D,C.c1),w=r.multiplyPoint(D,C.c2),D=r.multiplyPoint(D,C.e)):(a=r.multiplyPoint(D,C.c2),w=r.multiplyPoint(D,C.c1),D=r.multiplyPoint(D,C.s)),b.push([a.x,a.y,w.x,w.y,D.x,D.y]),E+=2*h;return b}}})},"dojox/gfx/decompose":function(){define(["./_base","dojo/_base/lang","./matrix"],function(f,q,r){function u(d,b){return Math.abs(d-b)<=1E-6*(Math.abs(d)+Math.abs(b))}function y(d,b,e,h){if(!isFinite(d))return e;
if(!isFinite(e))return d;b=Math.abs(b);h=Math.abs(h);return(b*d+h*e)/(b+h)}function e(d){d=r.normalize(d);var b=-d.xx-d.yy,e=d.xx*d.yy-d.xy*d.yx,h=Math.sqrt(b*b-4*e),b=-(b+(0>b?-h:h))/2,e=e/b,h=d.xy/(b-d.xx),a=1,f=d.xy/(e-d.xx),k=1;u(b,e)&&(h=1,f=a=0,k=1);isFinite(h)||(h=1,a=(b-d.xx)/d.xy,isFinite(a)||(h=(b-d.yy)/d.yx,a=1,isFinite(h)||(h=1,a=d.yx/(b-d.yy))));isFinite(f)||(f=1,k=(e-d.xx)/d.xy,isFinite(k)||(f=(e-d.yy)/d.yx,k=1,isFinite(f)||(f=1,k=d.yx/(e-d.yy))));d=Math.sqrt(h*h+a*a);var l=Math.sqrt(f*
f+k*k);isFinite(h/=d)||(h=0);isFinite(a/=d)||(a=0);isFinite(f/=l)||(f=0);isFinite(k/=l)||(k=0);return{value1:b,value2:e,vector1:{x:h,y:a},vector2:{x:f,y:k}}}function l(d,b){var e=0>d.xx*d.yy||0<d.xy*d.yx?-1:1,h=b.angle1=(Math.atan2(d.yx,d.yy)+Math.atan2(-e*d.xy,e*d.xx))/2,e=Math.cos(h),h=Math.sin(h);b.sx=y(d.xx/e,e,-d.xy/h,h);b.sy=y(d.yy/e,e,d.yx/h,h);return b}function n(d,b){var e=0>d.xx*d.yy||0<d.xy*d.yx?-1:1,h=b.angle2=(Math.atan2(e*d.yx,e*d.xx)+Math.atan2(-d.xy,d.yy))/2,e=Math.cos(h),h=Math.sin(h);
b.sx=y(d.xx/e,e,d.yx/h,h);b.sy=y(d.yy/e,e,-d.xy/h,h);return b}return f.decompose=function(d){var b=r.normalize(d);d={dx:b.dx,dy:b.dy,sx:1,sy:1,angle1:0,angle2:0};if(u(b.xy,0)&&u(b.yx,0))return q.mixin(d,{sx:b.xx,sy:b.yy});if(u(b.xx*b.yx,-b.xy*b.yy))return l(b,d);if(u(b.xx*b.xy,-b.yx*b.yy))return n(b,d);var f,h=new r.Matrix2D(b);f=q.mixin(h,{dx:0,dy:0,xy:h.yx,yx:h.xy});h=e([b,f]);f=e([f,b]);h=new r.Matrix2D({xx:h.vector1.x,xy:h.vector2.x,yx:h.vector1.y,yy:h.vector2.y});f=new r.Matrix2D({xx:f.vector1.x,
xy:f.vector1.y,yx:f.vector2.x,yy:f.vector2.y});b=new r.Matrix2D([r.invert(h),b,r.invert(f)]);l(f,d);b.xx*=d.sx;b.yy*=d.sy;n(h,d);b.xx*=d.sx;b.yy*=d.sy;return q.mixin(d,{sx:b.xx,sy:b.yy})}})},"dojox/gfx/bezierutils":function(){define(["./_base"],function(f){f=f.bezierutils={};f.tAtLength=function(f,n){var d=0,b=6==f.length,l=0,h=0,a=b?u:e,q=function(k,e){for(var w=0,u=0;u<k.length-2;u+=2)w+=r(k[u],k[u+1],k[u+2],k[u+3]);u=b?r(f[0],f[1],f[4],f[5]):r(f[0],f[1],f[6],f[7]);w-u>e||l+w>n+e?(++h,k=a(k,.5),
q(k[0],e),Math.abs(l-n)<=e||q(k[1],e)):(l+=w,d+=1/(1<<h))};n&&q(f,.5);return d};var q=f.computeLength=function(e){for(var f=6==e.length,d=0,b=0;b<e.length-2;b+=2)d+=r(e[b],e[b+1],e[b+2],e[b+3]);b=f?r(e[0],e[1],e[4],e[5]):r(e[0],e[1],e[6],e[7]);.1<d-b&&(e=f?u(e,.5):y(e,.5),d=q(e[0],f),d+=q(e[1],f));return d},r=f.distance=function(e,f,d,b){return Math.sqrt((d-e)*(d-e)+(b-f)*(b-f))},u=function(e,f){var d=1-f,b=d*d,l=f*f,h=e[0],a=e[1],n=e[2],k=e[3],q=e[4];e=e[5];var r=b*h+2*d*f*n+l*q,b=b*a+2*d*f*k+l*
e;return[[h,a,d*h+f*n,d*a+f*k,r,b],[r,b,d*n+f*q,d*k+f*e,q,e]]},y=function(e,f){var d=1-f,b=d*d,l=b*d,h=f*f,a=h*f,n=e[0],k=e[1],q=e[2],r=e[3],u=e[4],y=e[5],D=e[6];e=e[7];var G=l*n+3*b*f*q+3*d*h*u+a*D,l=l*k+3*b*f*r+3*d*h*y+a*e;return[[n,k,d*n+f*q,d*k+f*r,b*n+2*d*f*q+h*u,b*k+2*d*f*r+h*y,G,l],[G,l,b*q+2*d*f*u+h*D,b*r+2*d*f*y+h*e,d*u+f*D,d*y+f*e,D,e]]},e=f.splitBezierAtT=function(e,f){return 6==e.length?u(e,f):y(e,f)};return f})},"dojox/json/query":function(){define(["dojo/_base/kernel","dojo/_base/lang",
"dojox","dojo/_base/array"],function(f,q,r){q.getObject("json",!0,r);r.json._slice=function(f,q,e,l){var n=f.length,d=[];e=e||n;q=0>q?Math.max(0,q+n):Math.min(n,q);for(e=0>e?Math.max(0,e+n):Math.min(n,e);q<e;q+=l)d.push(f[q]);return d};r.json._find=function(f,q){function e(d){q&&(!0!==q||d instanceof Array?d[q]&&l.push(d[q]):l.push(d));for(var b in d){var f=d[b];q?f&&"object"==typeof f&&e(f):l.push(f)}}var l=[];if(q instanceof Array){if(1==q.length)return f[q[0]];for(var n=0;n<q.length;n++)l.push(f[q[n]])}else e(f);
return l};r.json._distinctFilter=function(f,q){for(var e=[],l={},n=0,d=f.length;n<d;++n){var b=f[n];q(b,n,f)&&("object"==typeof b&&b?b.__included||(b.__included=!0,e.push(b)):l[b+typeof b]||(l[b+typeof b]=!0,e.push(b)))}n=0;for(d=e.length;n<d;++n)e[n]&&delete e[n].__included;return e};return r.json.query=function(f,q){function e(b,a,d,e,f,l,q,r){return n[r].match(/[\*\?]/)||"~"==q?"/^"+n[r].substring(1,n[r].length-1).replace(/\\([btnfr\\"'])|([^\w\*\?])/g,"\\$1$2").replace(/([\*\?])/g,"[\\w\\W]$1")+
("~"==q?"$/i":"$/")+".test("+a+")":b}var l=0,n=[];f=f.replace(/"(\\.|[^"\\])*"|'(\\.|[^'\\])*'|[\[\]]/g,function(b){l+="["==b?1:"]"==b?-1:0;return"]"==b&&0<l?"`]":'"'==b.charAt(0)||"'"==b.charAt(0)?"`"+(n.push(b)-1):b});var d="";f.replace(/(\]|\)|push|pop|shift|splice|sort|reverse)\s*\(/,function(){throw Error("Unsafe function call");});f=f.replace(/([^<>=]=)([^=])/g,"$1\x3d$2").replace(/@|(\.\s*)?[a-zA-Z\$_]+(\s*:)?/g,function(b){return"."==b.charAt(0)?b:"@"==b?"$obj":(b.match(/:|^(\$|Math|true|false|null)$/)?
"":"$obj.")+b}).replace(/\.?\.?\[(`\]|[^\]])*\]|\?.*|\.\.([\w\$_]+)|\.\*/g,function(b,a,e){return(a=b.match(/^\.?\.?(\[\s*\^?\?|\^?\?|\[\s*==)(.*?)\]?$/))?(e="",b.match(/^\./)&&(d="dojox.json._find("+d,e=",true)"),d=(a[1].match(/\=/)?"dojo.map":a[1].match(/\^/)?"dojox.json._distinctFilter":"dojo.filter")+"("+d,e+",function($obj){return "+a[2]+"})"):(a=b.match(/^\[\s*([\/\\].*)\]/))?".concat().sort(function(a,b){"+a[1].replace(/\s*,?\s*([\/\\])\s*([^,\\\/]+)/g,function(a,b,d){return"var av\x3d "+d.replace(/\$obj/,
"a")+",bv\x3d "+d.replace(/\$obj/,"b")+";if(av\x3ebv||bv\x3d\x3dnull){return "+("/"==b?1:-1)+";}\nif(bv\x3eav||av\x3d\x3dnull){return "+("/"==b?-1:1)+";}\n"})+"return 0;})":(a=b.match(/^\[(-?[0-9]*):(-?[0-9]*):?(-?[0-9]*)\]/))?(d="dojox.json._slice("+d,","+(a[1]||0)+","+(a[2]||0)+","+(a[3]||1)+")"):b.match(/^\.\.|\.\*|\[\s*\*\s*\]|,/)?(d="dojox.json._find("+d,("."==b.charAt(1)?",'"+e+"'":b.match(/,/)?","+b:"")+")"):b}).replace(/(\$obj\s*((\.\s*[\w_$]+\s*)|(\[\s*`([0-9]+)\s*`\]))*)(==|~)\s*`([0-9]+)/g,
e).replace(/`([0-9]+)\s*(==|~)\s*(\$obj\s*((\.\s*[\w_$]+)|(\[\s*`([0-9]+)\s*`\]))*)/g,function(b,a,d,f,l,n,q,r){return e(b,f,l,n,q,r,d,a)});f=d+("$"==f.charAt(0)?"":"$")+f.replace(/`([0-9]+|\])/g,function(b,a){return"]"==a?"]":n[a]});for(var b=eval("1\x26\x26function($,$1,$2,$3,$4,$5,$6,$7,$8,$9){var $obj\x3d$;return "+f+"}"),r=0;r<arguments.length-1;r++)arguments[r]=arguments[r+1];return q?b.apply(this,arguments):b}})},"esri/tasks/PrintParameters":function(){define(["dojo/_base/declare","dojo/_base/lang",
"dojo/has","../kernel"],function(f,q,r,u){f=f(null,{declaredClass:"esri.tasks.PrintParameters",map:null,template:null,outSpatialReference:null,extraParameters:null});r("extend-esri")&&q.setObject("tasks.PrintParameters",f,u);return f})},"jimu/SpatialReference/srUtils":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all dojo/request esri/SpatialReference ./unitUtils".split(" "),function(f,q,r,u,y,e,l,n){var d=null,b=null,w=!1,h=f(null,function(){});
f=require.toUrl("jimu");var a=e(f+"/SpatialReference/cs.json",{handleAs:"json"}),z=e(f+"/SpatialReference/transform.json",{handleAs:"json"});h.loadResource=function(){var e=new u;if(d&&b)return e.resolve(),e;y([a,z]).then(function(a){d=a[0];b=a[1];w=!0;e.resolve()},function(a){console.error(a);w=!1;e.reject(a)});return e};h.getAllCSUnits=function(){if(w){var a=[];r.forEach(d.wkids,q.hitch(this,function(b){b=this.getCSUnit(b);-1===r.indexOf(a,b)&&a.push(b)}));return a}};h.convertUnit=function(a,b,
d){if(w)return n.convertUnit(a,b,d)};h.getUnitRate=function(a,b){if(w)return n.getUnitRate(a,b)};h.isProjectUnit=function(a){if(w)return n.isProjectUnit(a)};h.isGeographicUnit=function(a){if(w)return n.isGeographicUnit(a)};h.getGeographicUnits=function(){if(w)return n.getGeographicUnits()};h.getProjectUnits=function(){if(w)return n.getProjectUnits()};h.getCSUnit=function(a){if(w)return a=r.indexOf(d.wkids,a),d.units[a]};h.isSameSR=function(a,b){if(w)return a=this.indexOfWkid(a),b=this.indexOfWkid(b),
d.labels[a]===d.labels[b]};h.isValidWkid=function(a){if(w)return-1<this.indexOfWkid(a)};h.getSRLabel=function(a){if(w&&this.isValidWkid(a))return a=this.indexOfWkid(a),d.labels[a]};h.indexOfWkid=function(a){if(w)return r.indexOf(d.wkids,a)};h.isWebMercator=function(a){return l.prototype._isWebMercator?l.prototype._isWebMercator.apply({wkid:parseInt(a,10)},[]):(new l(parseInt(a,10))).isWebMercator()};h.standardizeWkid=function(a){return this.isWebMercator(a)?3857:parseInt(a,10)};h.isValidTfWkid=function(a){if(w)return-1<
this.indexOfTfWkid(a)};h.getTransformationLabel=function(a){if(w)return this.isValidTfWkid(a)?(a=this.indexOfTfWkid(a),b.labels[a]):""};h.indexOfTfWkid=function(a){if(w)return r.indexOf(b.tfWkids,a)};h.isGeographicCS=function(a){if(w)return this.isValidWkid(a)?(a=this.indexOfWkid(a),!d.projSR[a]):!1};h.isProjectedCS=function(a){if(w)return this.isValidWkid(a)?(a=this.indexOfWkid(a),d.projSR[a]):!1};h.getGeoCSByProj=function(a){if(w&&this.isProjectedCS(a))return a=this.indexOfWkid(a),d.spheroids[a]};
h.getSpheroidStr=function(a){if(w)return this.isGeographicCS(a)?d.labels[this.indexOfWkid(a)]:this.isProjectedCS(a)?(a=h.getGeoCSByProj(a),d.labels[this.indexOfWkid(a)]):null};h.isSameSpheroid=function(a,b){if(w)return a=this.getSpheroidStr(a),b=this.getSpheroidStr(b),a&&b&&a===b?!0:!1};return h})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),function(f,q,
r,u,y,e,l,n){return q("dijit.ProgressBar",[e,l],{progress:"0",value:"",maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:n,_indeterminateHighContrastImagePath:f.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());
this.update()},_setDirAttr:function(d){var b="rtl"==d.toLowerCase();r.toggle(this.domNode,"dijitProgressBarRtl",b);r.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&b);this.inherited(arguments)},update:function(d){u.mixin(this,d||{});d=this.internalProgress;var b=this.domNode,e=1;this.indeterminate?b.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(e=Math.min(parseFloat(this.progress)/100,1),this.progress=e*this.maximum):(this.progress=Math.min(this.progress,
this.maximum),e=this.maximum?this.progress/this.maximum:0),b.setAttribute("aria-valuenow",this.progress));b.setAttribute("aria-labelledby",this.labelNode.id);b.setAttribute("aria-valuemin",0);b.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(e);r.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);r.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());d.style.width=100*e+"%";this.onChange()},_setValueAttr:function(d){this._set("value",
d);Infinity==d?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:d})},_setLabelAttr:function(d){this._set("label",d);this.update()},_setIndeterminateAttr:function(d){this._set("indeterminate",d);this.update()},report:function(d){return this.label?this.label:this.indeterminate?"\x26#160;":y.format(d,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"widgets/Print/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css",
"dojo/i18n!./nls/strings"],function(){})},"url:widgets/Print/templates/Print.html":'\x3cdiv class\x3d"gis_PrintDijit"\x3e\r\n    \x3cdiv class\x3d"formContainer"\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"printSettingsFormDijit"\x3e\r\n            \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\r\n                \x3ctr data-dojo-attach-point\x3d"titleTr"\x3e\r\n                    \x3ctd style\x3d"width:65px;"\x3e\r\n                        ${nls.title}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"text" data-dojo-attach-point\x3d"titleNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'title\',trim:true,required:true,style:\'width:100%;\'" /\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr style\x3d"display: none"\x3e\r\n                    \x3ctd\x3e\r\n                        ${nls.layout}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'layout\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"layoutDijit" data-dojo-attach-event\x3d"Change:onLayoutChange"/\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n                \x3ctr style\x3d"display: none"\x3e\r\n                    \x3ctd\x3e\r\n                        ${nls.format}:\r\n                    \x3c/td\x3e\r\n                    \x3ctd\x3e\r\n                        \x3cinput type\x3d"select" data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'format\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"formatDijit" /\x3e\r\n                    \x3c/td\x3e\r\n                \x3c/tr\x3e\r\n            \x3c/table\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"buttonActionBar jimu-align-trailing"\x3e\r\n        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"advancedButtonDijit" style\x3d"display: none"\r\n            data-dojo-attach-event\x3d"onclick:showSettings"\x3e\x3cdiv class\x3d"btn-icon settingsIcon"\x3e\x3c/div\x3e${nls.settings}\x3c/div\x3e\r\n        \x3cdiv data-dojo-type\x3d"dijit/TooltipDialog" data-dojo-attach-point\x3d"settingsDialog"\r\n            style\x3d"display: none" class\x3d"gis_PrintDijit"\x3e\r\n            \x3cdiv style\x3d"width:250px;"\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.mapScaleExtent}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"preserveFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd style\x3d"vertical-align:middle;"\x3e\r\n                                ${nls.preserve}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"printWidgetMapScale" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',checked:true,value:\'true\'"\r\n                                /\x3e\x3clabel data-dojo-attach-point\x3d"printWidgetMapScaleLabel"\x3e${nls.mapScale}\x3c/label\x3e\r\n                                \x3cbr /\x3e\r\n                                \x3cinput type\x3d"radio" data-dojo-attach-point\x3d"printWidgetMapExtent" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'false\'"\r\n                                /\x3e\x3clabel data-dojo-attach-point\x3d"printWidgetMapExtentLabel"\x3e${nls.mapExtent}\x3c/label\x3e\r\n                            \x3c/td\x3e\r\n                            \x3ctr\x3e\r\n                                \x3ctd style\x3d"vertical-align: top; padding-top: 7px;"\x3e\r\n                                    ${nls.forceScale}:\r\n                                \x3c/td\x3e\r\n                                \x3ctd\x3e\r\n                                    \x3cdiv style\x3d"display: flex;"\x3e\r\n                                        \x3cinput type\x3d"radio" style\x3d"margin-top: 7px;" data-dojo-type\x3d"dijit/form/RadioButton" data-dojo-props\x3d"name:\'preserveScale\',value:\'force\',checked:false"/\x3e\r\n                                        \x3cdiv style\x3d"display: flex; flex-direction: column;"\x3e\r\n                                            \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'forcedScale\',required:false,style:\'width:100px;\'" data-dojo-attach-point\x3d"forceScaleNTB"/\x3e\r\n                                            \x3ca href\x3d"#" data-dojo-attach-event\x3d"click:getCurrentMapScale"\x3e${nls.getCurrentScale}\x3c/a\x3e\r\n                                        \x3c/div\x3e\r\n                                    \x3c/div\x3e\r\n                                \x3c/td\x3e\r\n                            \x3c/tr\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold; margin-bottom: 5px"\x3e\r\n                    \x3cspan\x3e${nls.outputSR}\x3c/span\x3e\r\n                    \x3ca href\x3d"https://developers.arcgis.com/javascript/jshelp/ref_coordsystems.html" target\x3d"blank"\x3eWKID\x3c/a\x3e\r\n                    \x3cspan\x3e:\x3c/span\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"margin-bottom: 5px"\x3e\r\n                    \x3cdiv\x3e\r\n                        \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-attach-event\x3d"onChange:_onOutputSRChange"\r\n                            data-dojo-attach-point\x3d"wkidInput" data-dojo-props\x3d\'style:{width:"100%"}\'\r\n                            data-dojo-props\x3d"required: false"/\x3e\r\n                    \x3c/div\x3e\r\n                    \x3cdiv class\x3d"wkid-label jimu-ellipsis" data-dojo-attach-point\x3d"wkidLabel"\x3e\r\n                    \x3c/div\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;" data-dojo-attach-point\x3d"labelsTitleNode"\x3e\r\n                    ${nls.labels}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"labelsFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd style\x3d"vertical-align:middle;"\x3e\r\n                                ${nls.showLabels}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'showLabels\',value:true,checked:true" /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.mapMetadata}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutMetadataDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5" style\x3d"width:100%;"\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"authorTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.author}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-attach-point\x3d"authorNode" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"name:\'author\',trim:true,required:false,style:\'width:100%;\'" data-dojo-attach-point\x3d"authorTB"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"copyrightTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.copyright}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3ctextarea data-dojo-attach-point\x3d"copyrightNode" name\x3d"copyright"\r\n                                    data-dojo-type\x3d"dijit/form/SimpleTextarea"\r\n                                    style\x3d"width:100%;height:60px;resize:none;"\x3e\x3c/textarea\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"customTextElementsDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5" style\x3d"width:100%;" data-dojo-attach-point\x3d"customTextElementsTable"\x3e\r\n\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"layoutFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"legendTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.lncludeLegend}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'legend\',value:true,checked:true"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr data-dojo-attach-point\x3d"scalebarTr"\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.scaleBarUnit}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cselect data-dojo-type\x3d"dijit/form/Select" data-dojo-props\x3d"name:\'scalebarUnit\',style:\'width:100%;\'"\r\n                        data-dojo-attach-point\x3d"scalebarUnitDijit"\x3e\r\n                                    \x3coption value\x3d"Miles" selected\x3d"selected"\x3e${nls.unitsMiles}\x3c/option\x3e\r\n                                    \x3coption value\x3d"Kilometers"\x3e${nls.unitsKilometers}\x3c/option\x3e\r\n                                    \x3coption value\x3d"Meters"\x3e${nls.unitsMeters}\x3c/option\x3e\r\n                                    \x3coption value\x3d"Feet"\x3e${nls.unitsFeet}\x3c/option\x3e\r\n                                \x3c/select\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.mapOnlyOptions}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapOnlyFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.width}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'width\',required:true,value:670,style:\'width:100px;\'"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.height}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'height\',required:true,value:500,style:\'width:100px;\'"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.printQualityOptions}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"mapQualityFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd\x3e\r\n                                ${nls.dpi}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"text" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d"name:\'dpi\',required:true,value:96,style:\'width:100px;\'"\r\n                                /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n                \x3cdiv style\x3d"font-weight:bold;"\x3e\r\n                    ${nls.forceFeatureAttributes}:\r\n                \x3c/div\x3e\r\n                \x3cdiv data-dojo-type\x3d"dijit/form/Form" data-dojo-attach-point\x3d"forceAttributesFormDijit"\x3e\r\n                    \x3ctable cellspacing\x3d"5"\x3e\r\n                        \x3ctr\x3e\r\n                            \x3ctd style\x3d"vertical-align:middle;"\x3e\r\n                                ${nls.includeFeatureAttributes}:\r\n                            \x3c/td\x3e\r\n                            \x3ctd\x3e\r\n                                \x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox" data-dojo-props\x3d"name:\'forceFeatureAttributes\',value:true,checked:false" /\x3e\r\n                            \x3c/td\x3e\r\n                        \x3c/tr\x3e\r\n                    \x3c/table\x3e\r\n                \x3c/div\x3e\r\n            \x3c/div\x3e\r\n        \x3c/div\x3e\r\n        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"printButtonDijit"\r\n            data-dojo-attach-event\x3d"onclick:print"\x3e\x3cdiv class\x3d"btn-icon printIcon"\x3e\x3c/div\x3e${nls.print}\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- \x3chr calss\x3d"spacer"\x3e --\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"printResultsNode" class\x3d"resultsContainer"\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"clearActionBarNode" class\x3d"buttonActionBar"\r\n    style\x3d"display:none;padding:0;"\x3e\r\n        \x3cdiv class\x3d"jimu-btn" data-dojo-attach-event\x3d"onclick:clearResults"\x3e\r\n            \x3cdiv class\x3d"btn-icon clearIcon"\x3e\x3c/div\x3e${nls.clearList}\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/Print/templates/PrintResult.html":'\x3cdiv class\x3d"printResult" data-dojo-attach-point\x3d"resultNode" data-dojo-attach-event\x3d"onclick:_openPrint"\x3e\r\n  \x3ctable class\x3d"printResultTable"\x3e\r\n    \x3ctr\x3e\r\n      \x3ctd width\x3d"25px"\x3e\r\n        \x3cspan class\x3d"bold"\x3e${count}.\x3c/span\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd width\x3d"30px"\x3e\r\n        \x3cimg src\x3d"${icon}"\x3e\r\n      \x3c/td\x3e\r\n      \x3ctd data-dojo-attach-point\x3d"nameNode"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"progressBar" data-dojo-type\x3d"dijit/ProgressBar" data-dojo-props\x3d\'value:Infinity\'\x3e\x3c/div\x3e\r\n        \x3cspan data-dojo-attach-point\x3d"successNode" class\x3d"bold" style\x3d"display:none;"\x3e${docName}\x3c/span\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"errNode" style\x3d"display:none;"\x3e\r\n          \x3cspan class\x3d"bold"\x3e${nls.printError}\x3c/span\x3e\r\n          \x3cdiv class\x3d"jimu-icon jimu-icon-error jimu-float-trailing"\x3e\x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/td\x3e\r\n    \x3c/tr\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\r\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\r\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\r\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\r\n\x3e\x3c/div\x3e\r\n',
"url:widgets/Print/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"printNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/Print/css/style.css":".jimu-widget-print{width: 100%; height: 100%; position: relative;}.jimu-widget-print .dijitSelect{height: 20px; width: 100%;}.gis_PrintDijit {width: 100%;}.gis_PrintDijit .printResult {height: 28px; margin-bottom: -1px; width: 100%;}.gis_PrintDijit .printResult .printResultTable {width: 100%;}.gis_PrintDijit .printResult .bold {font-weight: bold;}.gis_PrintDijit .printResultError {font-weight: bold; color: red; cursor: help;}.gis_PrintDijit .printResultHover table:hover {background-color: #D4E7F8; cursor: pointer;}.gis_PrintDijit .buttonActionBar {padding: 3px 0px 2px 0px; width: 100%;}.gis_PrintDijit .formContainer {margin-bottom: -1px; width: 100%;}.gis_PrintDijit .resultsContainer {width: 100%; margin-top: 10px;}.gis_PrintDijit .btn-icon {width: 16px; height: 16px; display: inline-block; vertical-align: text-top; margin-right: 10px;}.jimu-rtl .gis_PrintDijit .btn-icon {margin-right: auto; margin-left: 10px;}.gis_PrintDijit .printIcon {background-image: url(../images/print.png);}.gis_PrintDijit .clearIcon {background-image: url(../images/clear.png);}.gis_PrintDijit .settingsIcon {background-image: url(../images/settings.png); width: 16px; height: 16px;}.gis_PrintDijit .dijitArrowButtonContainer{width: 17px;}.gis_PrintDijit .wkid-label{font-size: 12px; font-style: italic; color: #a0acbf; width: 100%;}",
"*now":function(f){f(['dojo/i18n!*preload*widgets/Print/nls/Widget*["ar","bs","ca","cs","da","de","en","el","es","et","fi","fr","he","hr","hu","id","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sl","sr","sv","th","tr","zh-cn","uk","vi","zh-hk","zh-tw","ROOT"]'])},"*noref":1}});
define("dojo/_base/declare jimu/BaseWidget jimu/portalUtils dojo/_base/lang dojo/Deferred jimu/dijit/Message jimu/dijit/LoadingIndicator ./Print esri/request jimu/portalUrlUtils".split(" "),function(f,q,r,u,y,e,l,n,d,b){return f([q],{baseClass:"jimu-widget-print",name:"Print",className:"esri.widgets.Print",_portalPrintTaskURL:null,postCreate:function(){this.inherited(arguments);this.shelter=new l({hidden:!0});this.shelter.placeAt(this.domNode);this.shelter.startup()},startup:function(){this.inherited(arguments);
this.shelter.show();this._initPrinter()},destroy:function(){this.print&&this.print.closeSettings();this.inherited(arguments)},onClose:function(){this.print&&this.print.closeSettings()},_initPrinter:function(){this._getPrintTaskURL(this.appConfig.portalUrl).then(u.hitch(this,function(b){this.shelter.show();this.isAsync(b).then(u.hitch(this,function(d){this.print=new n({map:this.map,appConfig:this.appConfig,printTaskURL:b,defaultAuthor:this.config.defaultAuthor,defaultCopyright:this.config.defaultCopyright,
copyrightEditable:!1!==this.config.copyrightEditable,defaultTitle:this.config.defaultTitle,defaultFormat:this.config.defaultFormat,defaultLayout:this.config.defaultLayout,nls:this.nls,async:d});this.print.placeAt(this.printNode);this.print.startup()}),u.hitch(this,function(b){new e({message:b.message})})).always(u.hitch(this,function(){this.shelter.hide()}))}),u.hitch(this,function(b){new e({message:b});console.error(b);this.shelter.hide()}))},_getPrintTaskURL:function(b){var d=new y;if(this.config&&
this.config.serviceURL)return d.resolve(this.config.serviceURL),d;r.getPortalSelfInfo(b).then(u.hitch(this,function(a){(a=a&&a.helperServices&&a.helperServices.printTask&&a.helperServices.printTask.url)?d.resolve(a):d.reject("error")}),u.hitch(this,function(a){new e({message:this.nls.portalConnectionError});d.reject("error");console.error(a)}));return d},isAsync:function(e){var f=new y,a=b.setHttpProtocol(e),l=b.getNewPrintUrl(this.appConfig.portalUrl);a===l||/sharing\/tools\/newPrint$/.test(a)?f.resolve(!1):
d({url:e,content:{f:"json"},callbackParamName:"callback",handleAs:"json",timeout:6E4,load:u.hitch(this,function(a){"esriExecutionTypeAsynchronous"===a.executionType?f.resolve(!0):f.resolve(!1)}),error:u.hitch(this,function(a){f.reject(a)})});return f},onSignIn:function(b){b=b||{};b.userId&&this.print&&this.print.updateAuthor(b.userId)}})});